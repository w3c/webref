{
  "spec": {
    "title": "CSS Grid Layout Module Level 2",
    "url": "https://drafts.csswg.org/css-grid-2/"
  },
  "algorithms": [
    {
      "html": "To aid in clarity,\n\tthis algorithm is written with the assumption that <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-grid-2/#propdef-grid-auto-flow\" id=\"ref-for-propdef-grid-auto-flow⑨\">grid-auto-flow</a> has <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-auto-flow-row\" id=\"ref-for-valdef-grid-auto-flow-row④\">row</a> specified.\n\tIf it is instead set to <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-auto-flow-column\" id=\"ref-for-valdef-grid-auto-flow-column②\">column</a>,\n\tswap all mentions of rows and columns, inline and block, etc. in this algorithm.",
      "rationale": "generate",
      "steps": [
        {
          "html": "<p><strong>Generate anonymous grid items</strong> as described in <a href=\"https://drafts.csswg.org/css-grid-2/#grid-items\">§ 6 Grid Items</a>.\n(Anonymous <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑦⑨\">grid items</a> are always auto-placed,\nsince their boxes can’t have any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-placement-property\" id=\"ref-for-grid-placement-property①⑤\">grid-placement properties</a> specified.)</p>"
        },
        {
          "html": "<p><strong>Position anything that’s not auto-positioned.</strong></p>"
        },
        {
          "html": "<p><strong>Process the items locked to a given row.</strong></p>\n     <p>For each <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑧⓪\">grid item</a> with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#definite-grid-position\" id=\"ref-for-definite-grid-position②\">definite row position</a> (that is, the <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-grid-2/#propdef-grid-row-start\" id=\"ref-for-propdef-grid-row-start①②\">grid-row-start</a> and <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-grid-2/#propdef-grid-row-end\" id=\"ref-for-propdef-grid-row-end①②\">grid-row-end</a> properties define a <span id=\"ref-for-definite-grid-position③\">definite grid position</span>),\nin <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-flexbox-1/#order-modified-document-order\" id=\"ref-for-order-modified-document-order③\">order-modified document order</a>:</p>\n     <dl>\n      <dt data-md=\"\">“sparse” packing (default behavior)\n      </dt><dd data-md=\"\">\n       <p>Set the column-start line of its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-placement\" id=\"ref-for-grid-placement①⓪\">placement</a> to the earliest (smallest positive index) line index\nthat ensures this item’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area②④\">grid area</a> will not overlap any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#occupied\" id=\"ref-for-occupied②\">occupied</a> grid cells\nand that is past any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑧①\">grid items</a> previously placed in this row by this step.</p>\n      </dd><dt data-md=\"\">“dense” packing (<a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-auto-flow-dense\" id=\"ref-for-valdef-grid-auto-flow-dense②\">dense</a> specified)\n      </dt><dd data-md=\"\">\n       <p>Set the column-start line of its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-placement\" id=\"ref-for-grid-placement①①\">placement</a> to the earliest (smallest positive index) line index\nthat ensures this item’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area②⑤\">grid area</a> will not overlap any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#occupied\" id=\"ref-for-occupied③\">occupied</a> grid cells.</p>\n     </dd></dl>"
        },
        {
          "html": "Create columns in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid⑦\">implicit grid</a>:",
          "rationale": "start",
          "steps": [
            {
              "html": "<p>Start with the columns from the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#explicit-grid\" id=\"ref-for-explicit-grid②⑨\">explicit grid</a>.</p>"
            },
            {
              "html": "<p>Among all the items with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#definite-grid-position\" id=\"ref-for-definite-grid-position④\">definite column position</a> (explicitly positioned items, items positioned in the previous step, and items not yet positioned but with a definite column)\nadd columns to the beginning and end of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid⑧\">implicit grid</a> as necessary to accommodate those items.</p>"
            },
            {
              "html": "<p>If the largest <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-span\" id=\"ref-for-grid-span①①\">column span</a> among all the items <em>without</em> a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#definite-grid-position\" id=\"ref-for-definite-grid-position⑤\">definite column position</a> is larger than the width of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid⑨\">implicit grid</a>,\nadd columns to the end of the <span id=\"ref-for-implicit-grid①⓪\">implicit grid</span> to accommodate that <span id=\"ref-for-grid-span①②\">column span</span>.</p>"
            }
          ]
        },
        {
          "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" data-local-lt=\"cursor\" id=\"auto-placement-cursor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">auto-placement cursor</dfn> defines the current “insertion point” in the grid,\nspecified as a pair of row and column <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-line\" id=\"ref-for-grid-line②⓪\">grid lines</a>.\nInitially the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor\">auto-placement cursor</a> is set to the start-most row and column lines in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①②\">implicit grid</a>.",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set the column position of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor①\">cursor</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑧③\">grid item’s</a> column-start line.\nIf this is less than the previous column position of the <span id=\"ref-for-auto-placement-cursor②\">cursor</span>,\nincrement the row position by 1.</p>"
            },
            {
              "html": "<p>Increment the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor③\">cursor</a>’s row position until a value is found\nwhere the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑧④\">grid item</a> does not overlap any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#occupied\" id=\"ref-for-occupied④\">occupied</a> grid cells\n(creating new rows in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①③\">implicit grid</a> as necessary).</p>"
            },
            {
              "html": "<p>Set the item’s row-start line to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor④\">cursor’s</a> row position,\nand set the item’s row-end line according to its span from that position.</p>"
            }
          ],
          "additional": [
            {
              "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" data-local-lt=\"cursor\" id=\"auto-placement-cursor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">auto-placement cursor</dfn> defines the current “insertion point” in the grid,\nspecified as a pair of row and column <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-line\" id=\"ref-for-grid-line②⓪\">grid lines</a>.\nInitially the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor\">auto-placement cursor</a> is set to the start-most row and column lines in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①②\">implicit grid</a>.",
              "rationale": "increment",
              "steps": [
                {
                  "html": "<p>Increment the column position of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor⑤\">auto-placement cursor</a> until either this item’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area②⑥\">grid area</a> does not overlap any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#occupied\" id=\"ref-for-occupied⑤\">occupied</a> grid cells,\nor the <span id=\"ref-for-auto-placement-cursor⑥\">cursor’s</span> column position,\nplus the item’s column span,\noverflow the number of columns in the implicit grid,\nas determined earlier in this algorithm.</p>"
                },
                {
                  "html": "<p>If a non-overlapping position was found in the previous step,\nset the item’s row-start and column-start lines to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor⑦\">cursor’s</a> position.\nOtherwise,\nincrement the <span id=\"ref-for-auto-placement-cursor⑧\">auto-placement cursor</span>’s row position\n(creating new rows in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①④\">implicit grid</a> as necessary),\nset its column position to the start-most column line in the <span id=\"ref-for-implicit-grid①⑤\">implicit grid</span>,\nand return to the previous step.</p>"
                }
              ]
            },
            {
              "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" data-local-lt=\"cursor\" id=\"auto-placement-cursor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">auto-placement cursor</dfn> defines the current “insertion point” in the grid,\nspecified as a pair of row and column <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-line\" id=\"ref-for-grid-line②⓪\">grid lines</a>.\nInitially the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor\">auto-placement cursor</a> is set to the start-most row and column lines in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①②\">implicit grid</a>.",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set the row position of the cursor to the start-most row line in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①⑥\">implicit grid</a>.\nSet the column position of the cursor to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑧⑥\">grid item’s</a> column-start line.</p>"
                },
                {
                  "html": "<p>Increment the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor⑨\">auto-placement cursor</a>’s row position until a value is found\nwhere the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item⑧⑦\">grid item</a> does not overlap any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#occupied\" id=\"ref-for-occupied⑥\">occupied</a> grid cells\n(creating new rows in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①⑦\">implicit grid</a> as necessary).</p>"
                },
                {
                  "html": "<p>Set the item’s row-start line index to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor①⓪\">cursor’s</a> row position.\n(Implicitly setting the item’s row-end line according to its span, as well.)</p>"
                }
              ]
            },
            {
              "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" data-local-lt=\"cursor\" id=\"auto-placement-cursor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">auto-placement cursor</dfn> defines the current “insertion point” in the grid,\nspecified as a pair of row and column <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-line\" id=\"ref-for-grid-line②⓪\">grid lines</a>.\nInitially the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor\">auto-placement cursor</a> is set to the start-most row and column lines in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①②\">implicit grid</a>.",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set the cursor’s row and column positions to start-most row and column lines in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①⑧\">implicit grid</a>.</p>"
                },
                {
                  "html": "<p>Increment the column position of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor①①\">auto-placement cursor</a> until either this item’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area②⑦\">grid area</a> does not overlap any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#occupied\" id=\"ref-for-occupied⑦\">occupied</a> grid cells,\nor the <span id=\"ref-for-auto-placement-cursor①②\">cursor’s</span> column position,\nplus the item’s column span,\noverflow the number of columns in the implicit grid,\nas determined earlier in this algorithm.</p>"
                },
                {
                  "html": "<p>If a non-overlapping position was found in the previous step,\nset the item’s row-start and column-start lines to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#auto-placement-cursor\" id=\"ref-for-auto-placement-cursor①③\">cursor’s</a> position.\nOtherwise,\nincrement the <span id=\"ref-for-auto-placement-cursor①④\">auto-placement cursor</span>’s row position\n(creating new rows in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#implicit-grid\" id=\"ref-for-implicit-grid①⑨\">implicit grid</a> as necessary),\nreset its column position to the start-most column line in the <span id=\"ref-for-implicit-grid②⓪\">implicit grid</span>,\nand return to the previous step.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "The first (last) baselines of a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨②\">grid container</a> are determined as follows:",
      "rationale": "find",
      "steps": [
        {
          "html": "Find the first (last) row of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨③\">grid container</a> containing at least one <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①①②\">grid item</a>. \n     <p>If any of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①①③\">grid items</a> intersecting this row\n\t\t\tparticipate in <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#baseline-alignment\" id=\"ref-for-baseline-alignment③\">baseline alignment</a> in that row,\n\t\t\tthe grid container’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#baseline-set\" id=\"ref-for-baseline-set\">baseline set</a> is <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#generate-baselines\" id=\"ref-for-generate-baselines\">generated</a> from\n\t\t\tthe shared <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#alignment-baseline\" id=\"ref-for-alignment-baseline\">alignment baseline</a> of those <span id=\"ref-for-grid-item①①④\">grid items</span>.</p>\n     <p>Otherwise,\n\t\t\tthe grid container’s first (last) baseline set\n\t\t\tis <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#generate-baselines\" id=\"ref-for-generate-baselines①\">generated</a> from\n\t\t\tthe <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#alignment-baseline\" id=\"ref-for-alignment-baseline①\">alignment baseline</a> of the first (last) <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①①⑤\">grid item</a> in row-major <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-order\" id=\"ref-for-grid-order\">grid order</a> (according to the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#writing-mode\" id=\"ref-for-writing-mode③\">writing mode</a> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨④\">grid container</a>).\n\t\t\tIf the <span id=\"ref-for-grid-item①①⑥\">grid item</span> has no <span id=\"ref-for-alignment-baseline②\">alignment baseline</span> in the grid’s inline axis,\n\t\t\tthen one is first <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#synthesize-baseline\" id=\"ref-for-synthesize-baseline\">synthesized</a> from its border edges.</p>"
        },
        {
          "html": "If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨⑤\">grid container</a> does not contain any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①①⑦\">grid items</a>,\n\t\t\tthe grid container has no first (last) <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#baseline-set\" id=\"ref-for-baseline-set①\">baseline set</a>,\n\t\t\tand one is <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#synthesize-baseline\" id=\"ref-for-synthesize-baseline①\">synthesized</a> if needed\n\t\t\taccording to the rules of its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#shared-alignment-context\" id=\"ref-for-shared-alignment-context\">alignment context</a>.\n\t\t\tExit from this algorithm."
        }
      ]
    },
    {
      "html": "This section defines the <b>grid layout algorithm</b>,\n\twhich sizes the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨⑥\">grid container</a>,\n\tsizes and positions all the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-track\" id=\"ref-for-grid-track③⓪\">grid tracks</a>,\n\tand lays out the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①①⑨\">grid items</a> which have been <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item-placement-algorithm\" id=\"ref-for-grid-item-placement-algorithm⑨\">placed</a> into its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area③③\">grid areas</a>.",
      "rationale": "run",
      "steps": [
        {
          "html": "<p>Run the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item-placement-algorithm\" id=\"ref-for-grid-item-placement-algorithm①⓪\">Grid Item Placement Algorithm</a> to resolve the placement of all <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①②⓪\">grid items</a> (including <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#subgrid\" id=\"ref-for-subgrid⑤⑤\">subgrids</a> and their sub-items)\nin the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid\" id=\"ref-for-grid②⑧\">grid</a>.</p>"
        },
        {
          "html": "<p>Find the size of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨⑦\">grid container</a>,\nper <a href=\"https://drafts.csswg.org/css-grid-2/#intrinsic-sizes\">§ 5.2 Sizing Grid Containers</a>.</p>"
        },
        {
          "html": "<p>Given the resulting <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container⑨⑧\">grid container</a> size,\nrun the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#algo-grid-sizing\" id=\"ref-for-algo-grid-sizing②\">Grid Sizing Algorithm</a> to size the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid\" id=\"ref-for-grid②⑨\">grid</a>.</p>"
        },
        {
          "html": "<p>Lay out the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①②①\">grid items</a> into their respective containing blocks.\nEach <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area③④\">grid area’s</a> width and height\nare considered <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#definite\" id=\"ref-for-definite①④\">definite</a> for this purpose.</p>"
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#algo-grid-sizing\" id=\"ref-for-algo-grid-sizing①\">grid sizing algorithm</a> defines how to resolve these sizing constraints into used track sizes.",
      "rationale": "resolve",
      "steps": [
        {
          "html": "First, the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#track-sizing-algorithm\" id=\"ref-for-track-sizing-algorithm①\">track sizing algorithm</a> is used to resolve the sizes of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-column\" id=\"ref-for-grid-column③\">grid columns</a>. \n     <p>In this process,\n\t\t\tany <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①②②\">grid item</a> which is subgridded\n\t\t\tin the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪⓪\">grid container</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-axis\" id=\"ref-for-inline-axis①\">inline axis</a> is treated as empty\n\t\t\tand its <span id=\"ref-for-grid-item①②③\">grid items</span> (the grandchildren)\n\t\t\tare treated as direct children of the <span id=\"ref-for-grid-container①⓪①\">grid container</span> (their grandparent).\n\t\t\tThis introspection is recursive.</p>\n     <p>Items which are subgridded only in the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis\">block axis</a>,\n\t\t\tand whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪②\">grid container</a> size in the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-axis\" id=\"ref-for-inline-axis②\">inline axis</a> depends on the size of its contents\n\t\t\tare also introspected:\n\t\t\tsince the size of the item in this dimension\n\t\t\tcan be dependent on the sizing of its subgridded tracks in the other,\n\t\t\tthe size contribution of any such item to this grid’s column sizing\n\t\t\t(see <a href=\"https://www.w3.org/TR/css-grid-1/#algo-content\">Resolve Intrinsic Track Sizes</a>)\n\t\t\tis taken under the provision\n\t\t\tof having determined its track sizing only up to the same point\n\t\t\tin the Grid Sizing Algorithm as this itself.\n\t\t\tE.g. for the first pass through this step,\n\t\t\tthe item will have its tracks sized only through this first step;\n\t\t\tif a second pass of this step is triggered then\n\t\t\tthe item will have completed a first pass through steps 1-3\n\t\t\tas well as the second pass of this step\n\t\t\tprior to returning its size for consideration in this grid’s column sizing.\n\t\t\tAgain, this introspection is recursive.</p>\n     <p>If calculating the layout of a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①②④\">grid item</a> in this step\n\t\t\tdepends on the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#available\" id=\"ref-for-available\">available space</a> in the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis①\">block axis</a>,\n\t\t\tassume the <span id=\"ref-for-available①\">available space</span> that it would have\n\t\t\tif any row with a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#definite\" id=\"ref-for-definite①⑤\">definite</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function⑦\">max track sizing function</a> had that size and all other rows were infinite.\n\t\t\tIf both the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪③\">grid container</a> and all tracks have <span id=\"ref-for-definite①⑥\">definite</span> sizes,\n\t\t\talso apply <a class=\"property css\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-align-3/#propdef-align-content\" id=\"ref-for-propdef-align-content⑧\">align-content</a> to find the final effective size\n\t\t\tof any gaps spanned by such items;\n\t\t\totherwise ignore the effects of track alignment in this estimation.</p>"
        },
        {
          "html": "Next, the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#track-sizing-algorithm\" id=\"ref-for-track-sizing-algorithm②\">track sizing algorithm</a> resolves the sizes of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-row\" id=\"ref-for-grid-row③\">grid rows</a>. \n     <p>In this process,\n\t\t\tany <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-item\" id=\"ref-for-grid-item①②⑤\">grid item</a> which is subgridded\n\t\t\tin the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪④\">grid container</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis②\">block axis</a> is treated as empty\n\t\t\tand its <span id=\"ref-for-grid-item①②⑥\">grid items</span> (the grandchildren)\n\t\t\tare treated as direct children of the <span id=\"ref-for-grid-container①⓪⑤\">grid container</span> (their grandparent).\n\t\t\tThis introspection is recursive.</p>\n     <p>As with sizing columns,\n\t\t\titems which are subgridded only in the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-axis\" id=\"ref-for-inline-axis③\">inline axis</a>,\n\t\t\tand whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪⑥\">grid container</a> size in the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis③\">block axis</a> depends on the size of its contents\n\t\t\tare also introspected.\n\t\t\t(As with sizing columns,\n\t\t\tthe size contribution to this grid’s row sizing\n\t\t\tis taken under the provision\n\t\t\tof having determined its track sizing\n\t\t\tonly up to this corresponding point in the algorithm;\n\t\t\tand again, this introspection is recursive.)</p>\n     <p>To find the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-axis\" id=\"ref-for-inline-axis④\">inline-axis</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#available\" id=\"ref-for-available②\">available space</a> for any items whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis④\">block-axis</a> size contributions require it,\n\t\t\tuse the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-column\" id=\"ref-for-grid-column④\">grid column</a> sizes calculated in the previous step.\n\t\t\tIf the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪⑦\">grid container</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-size\" id=\"ref-for-inline-size④\">inline size</a> is <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#definite\" id=\"ref-for-definite①⑦\">definite</a>,\n\t\t\talso apply <a class=\"property css\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-align-3/#propdef-justify-content\" id=\"ref-for-propdef-justify-content⑧\">justify-content</a> to account for the effective column gap sizes.</p>"
        },
        {
          "html": "Then, if the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution①\">min-content contribution</a> of any grid item has changed\n\t\t\tbased on the row sizes and alignment calculated in step 2,\n\t\t\tre-resolve the sizes of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-column\" id=\"ref-for-grid-column⑤\">grid columns</a> with the new <span id=\"ref-for-min-content-contribution②\">min-content</span> and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution②\">max-content contributions</a> (once only). \n     <p>To find the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis⑤\">block-axis</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#available\" id=\"ref-for-available③\">available space</a> for any items whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-axis\" id=\"ref-for-inline-axis⑤\">inline-axis</a> size contributions require it,\n\t\t\tuse the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-row\" id=\"ref-for-grid-row④\">grid row</a> sizes calculated in the previous step.\n\t\t\tIf the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪⑧\">grid container</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-size\" id=\"ref-for-block-size②\">block size</a> is <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#definite\" id=\"ref-for-definite①⑧\">definite</a>,\n\t\t\talso apply <a class=\"property css\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-align-3/#propdef-align-content\" id=\"ref-for-propdef-align-content⑨\">align-content</a> to account for the effective row gap sizes.</p>"
        },
        {
          "html": "Next, if the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution③\">min-content contribution</a> of any grid item has changed\n\t\t\tbased on the column sizes and alignment calculated in step 3,\n\t\t\tre-resolve the sizes of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-row\" id=\"ref-for-grid-row⑤\">grid rows</a> with the new <span id=\"ref-for-min-content-contribution④\">min-content</span> and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution③\">max-content contributions</a> (once only). \n     <p>To find the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-axis\" id=\"ref-for-inline-axis⑥\">inline-axis</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#available\" id=\"ref-for-available④\">available space</a> for any items whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" id=\"ref-for-block-axis⑥\">block-axis</a> size contributions require it,\n\t\t\tuse the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-column\" id=\"ref-for-grid-column⑥\">grid column</a> sizes calculated in the previous step.\n\t\t\tIf the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①⓪⑨\">grid container</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-writing-modes-4/#inline-size\" id=\"ref-for-inline-size⑥\">inline size</a> is <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#definite\" id=\"ref-for-definite①⑨\">definite</a>,\n\t\t\talso apply <a class=\"property css\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-align-3/#propdef-justify-content\" id=\"ref-for-propdef-justify-content⑨\">justify-content</a> to account for the effective column gap sizes.</p>"
        },
        {
          "html": "Finally, align the tracks within the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①①⓪\">grid container</a> according to the <a class=\"property css\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-align-3/#propdef-align-content\" id=\"ref-for-propdef-align-content①⓪\">align-content</a> and <a class=\"property css\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-align-3/#propdef-justify-content\" id=\"ref-for-propdef-justify-content①⓪\">justify-content</a> properties."
        }
      ]
    },
    {
      "name": "track sizing algorithm",
      "href": "https://drafts.csswg.org/css-grid-2/#track-sizing-algorithm",
      "html": "The remainder of this section is the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"track-sizing-algorithm\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">track sizing algorithm</dfn>,\n\twhich calculates from the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function⑤\">min</a> and <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function⑧\">max track sizing functions</a> the used track size.\n\tEach track has a <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"base-size\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">base size</dfn>,\n\ta <a class=\"production css\" data-link-type=\"type\" href=\"https://www.w3.org/TR/css-values-4/#length-value\" id=\"ref-for-length-value③\" title=\"Expands to: advance measure | cap | ch | cm | dvb | dvh | dvi | dvmax | dvmin | dvw | em | ex | ic | in | lh | lvb | lvh | lvi | lvmax | lvmin | lvw | mm | pc | pt | px | rcap | rch | rem | rex | ric | rlh | svb | svh | svi | svmax | svmin | svw | vb | vh | vi | vmax | vmin | vw\">&lt;length&gt;</a> which grows throughout the algorithm\n\tand which will eventually be the track’s final size,\n\tand a <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"growth-limit\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">growth limit</dfn>,\n\ta <span class=\"production\" id=\"ref-for-length-value④\">&lt;length&gt;</span> which provides a desired maximum size for the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①\">base size</a>.\n\tThere are 5 steps:",
      "rationale": "initialize",
      "steps": [
        {
          "html": "<a href=\"https://drafts.csswg.org/css-grid-2/#algo-init\">Initialize Track Sizes</a>"
        },
        {
          "html": "<a href=\"https://drafts.csswg.org/css-grid-2/#algo-content\">Resolve Intrinsic Track Sizes</a>"
        },
        {
          "html": "<a href=\"https://drafts.csswg.org/css-grid-2/#algo-grow-tracks\">Maximize Tracks</a>"
        },
        {
          "html": "<a href=\"https://drafts.csswg.org/css-grid-2/#algo-flex-tracks\">Expand Flexible Tracks</a>"
        },
        {
          "html": "<a href=\"https://drafts.csswg.org/css-grid-2/#algo-stretch\">Expand Stretched <span class=\"css\">auto</span> Tracks</a>"
        }
      ]
    },
    {
      "html": "<strong>Initialize each track’s base size and growth limit.</strong> For each track,\n\tif the track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function⑥\">min track sizing function</a> is:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "A fixed sizing function",
              "html": "Resolve to an absolute length and use that size as the track’s initial <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②\">base size</a>."
            },
            {
              "case": "An intrinsic sizing function",
              "html": "Use an initial <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size③\">base size</a> of zero."
            }
          ]
        }
      ]
    },
    {
      "html": "For each track,\n\tif the track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function⑨\">max track sizing function</a> is:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "A fixed sizing function",
              "html": "Resolve to an absolute length and use that size as the track’s initial <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit\">growth limit</a>."
            },
            {
              "case": "An intrinsic sizing function",
              "html": "Use an initial <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①\">growth limit</a> of infinity."
            },
            {
              "case": "A flexible sizing function",
              "html": "Use an initial <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①\">growth limit</a> of infinity."
            }
          ]
        }
      ]
    },
    {
      "html": "This step resolves intrinsic track <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-template-rows-track-sizing-function\" id=\"ref-for-grid-template-rows-track-sizing-function⑦\">sizing functions</a> to absolute lengths.\n\tFirst it resolves those sizes based on items that are contained wholly within a single track.\n\tThen it gradually adds in the space requirements of items that span multiple tracks,\n\tevenly distributing the extra space across those tracks\n\tinsofar as possible.",
      "rationale": "increase",
      "steps": [
        {
          "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#algo-baseline-shims\"></a> <strong>Shim baseline-aligned items\n\t\t\tso their intrinsic size contributions reflect their baseline alignment.</strong> For the items in each <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-align-3/#baseline-sharing-group\" id=\"ref-for-baseline-sharing-group\">baseline-sharing group</a>,\n\t\t\tadd a “shim” (effectively, additional margin)\n\t\t\ton the start/end side (for first/last-baseline alignment)\n\t\t\tof each item\n\t\t\tso that,\n\t\t\twhen start/end-aligned together\n\t\t\ttheir <a href=\"https://www.w3.org/TR/css-align-3/#baseline-values\">baselines align as specified</a>. \n     <p>Consider these “shims” as part of the items’ intrinsic size contribution\n\t\t\tfor the purpose of track sizing, below.\n\t\t\tIf an item uses multiple intrinsic size contributions,\n\t\t\tit can have different shims for each one.</p>"
        },
        {
          "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#algo-single-span-items\"></a> <strong>Size tracks to fit non-spanning items:</strong> For each track with an intrinsic <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-template-rows-track-sizing-function\" id=\"ref-for-grid-template-rows-track-sizing-function⑧\">track sizing function</a> and not a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-sizing-function\" id=\"ref-for-flexible-sizing-function②\">flexible sizing function</a>,\n\t\t\tconsider the items in it with a span of 1:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "For min-content minimums:",
                  "html": "If the track has a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-min-content\" id=\"ref-for-valdef-grid-template-columns-min-content⑤\">min-content</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function⑦\">min track sizing function</a>,\n\t\t\t\t\tset its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size⑦\">base size</a> to the maximum of the items’ <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution⑤\">min-content contributions</a>,\n\t\t\t\t\tfloored at zero."
                },
                {
                  "case": "For max-content minimums:",
                  "html": "If the track has a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content⑧\">max-content</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function⑧\">min track sizing function</a>,\n\t\t\t\t\tset its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size⑧\">base size</a> to the maximum of the items’ <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution④\">max-content contributions</a>,\n\t\t\t\t\tfloored at zero."
                },
                {
                  "case": "For auto minimums:",
                  "html": "If the track has an <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto\" id=\"ref-for-valdef-grid-template-columns-auto①②\">auto</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function⑨\">min track sizing function</a> and the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-container\" id=\"ref-for-grid-container①①⑤\">grid container</a> is being sized\n\t\t\t\t\tunder a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-constraint\" id=\"ref-for-min-content-constraint②\">min-</a>/<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-constraint\" id=\"ref-for-max-content-constraint②\">max-content constraint</a>,\n\t\t\t\t\tset the track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size⑨\">base size</a> to the maximum of its items’ <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#limited-contribution\" id=\"ref-for-limited-contribution\">limited min-content contributions</a>,\n\t\t\t\t\tfloored at zero.\n\t\t\t\t\tThe <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"limited min-content contribution | limited max-content contribution\" data-noexport=\"\" id=\"limited-contribution\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">limited min-/max-content contribution</dfn> of an item\n\t\t\t\t\tis (for this purpose) its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution⑥\">min-</a>/<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution⑤\">max-content contribution</a> (accordingly),\n\t\t\t\t\tlimited by the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①①\">max track sizing function</a> (which could be the argument to a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#funcdef-grid-template-columns-fit-content\" id=\"ref-for-funcdef-grid-template-columns-fit-content⑦\">fit-content()</a> track sizing function)\n\t\t\t\t\tif that is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#fixed-sizing-function\" id=\"ref-for-fixed-sizing-function⑤\">fixed</a> and ultimately floored by its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#minimum-contribution\" id=\"ref-for-minimum-contribution\">minimum contribution</a> (defined below). \n       <p>Otherwise,\n\t\t\t\t\tset the track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①⓪\">base size</a> to the maximum of its items’ <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#minimum-contribution\" id=\"ref-for-minimum-contribution①\">minimum contributions</a>,\n\t\t\t\t\tfloored at zero.\n\t\t\t\t\tThe <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"minimum-contribution\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><span class=\"bs-old-id\" id=\"min-size-contribution\"></span>minimum contribution</dfn> of an item\n\t\t\t\t\tis the smallest <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#outer-size\" id=\"ref-for-outer-size\">outer size</a> it can have.\n\t\t\t\t\tSpecifically,\n\t\t\t\t\tif the item’s computed <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#preferred-size\" id=\"ref-for-preferred-size⑤\">preferred size</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#behave-as-auto\" id=\"ref-for-behave-as-auto①\">behaves as auto</a> or depends on the size of its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-display-4/#containing-block\" id=\"ref-for-containing-block⑧\">containing block</a> in the relevant axis,\n\t\t\t\t\tits <span id=\"ref-for-minimum-contribution②\">minimum contribution</span> is\n\t\t\t\t\tthe <span id=\"ref-for-outer-size①\">outer size</span> that would result from assuming\n\t\t\t\t\tthe item’s used <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-width\" id=\"ref-for-min-width⑥\">minimum size</a> as its <span id=\"ref-for-preferred-size⑥\">preferred size</span>;\n\t\t\t\t\telse the item’s <span id=\"ref-for-minimum-contribution③\">minimum contribution</span> is\n\t\t\t\t\tits <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution⑦\">min-content contribution</a>.\n\t\t\t\t\tBecause the <span id=\"ref-for-minimum-contribution④\">minimum contribution</span> often depends\n\t\t\t\t\ton the size of the item’s content,\n\t\t\t\t\tit is considered a type of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#intrinsic-size-contribution\" id=\"ref-for-intrinsic-size-contribution①\">intrinsic size contribution</a>.</p>"
                },
                {
                  "case": "For min-content maximums:",
                  "html": "If the track has a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-min-content\" id=\"ref-for-valdef-grid-template-columns-min-content⑥\">min-content</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①②\">max track sizing function</a>,\n\t\t\t\t\tset its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit⑤\">growth limit</a> to the maximum of the items’ <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution①⓪\">min-content contributions</a>."
                },
                {
                  "case": "For max-content maximums:",
                  "html": "If the track has a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content⑨\">max-content</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①③\">max track sizing function</a>,\n\t\t\t\t\tset its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit⑥\">growth limit</a> to the maximum of the items’ <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution⑦\">max-content contributions</a>.\n\t\t\t\t\tFor <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#funcdef-grid-template-columns-fit-content\" id=\"ref-for-funcdef-grid-template-columns-fit-content⑧\">fit-content()</a> maximums,\n\t\t\t\t\tfurthermore clamp this <span id=\"ref-for-growth-limit⑦\">growth limit</span> by the <span class=\"css\" id=\"ref-for-funcdef-grid-template-columns-fit-content⑨\">fit-content()</span> argument."
                }
              ]
            }
          ]
        },
        {
          "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#algo-spanning-items\"></a> <strong>Increase sizes to accommodate spanning items crossing content-sized tracks:</strong> Next, consider the items with a span of 2\n\t\t\tthat do not span a track with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-sizing-function\" id=\"ref-for-flexible-sizing-function③\">flexible sizing function</a>.",
          "rationale": "for",
          "steps": [
            {
              "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#track-size-intrinsic-min\"></a> <strong>For intrinsic minimums:</strong> First <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#distribute-extra-space\" id=\"ref-for-distribute-extra-space\">distribute extra space</a> to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①③\">base sizes</a> of tracks with\n\t\t\t\t\tan <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#intrinsic-sizing-function\" id=\"ref-for-intrinsic-sizing-function④\">intrinsic</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function①⓪\">min track sizing function</a>,\n\t\t\t\t\tto accommodate these items’ <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#minimum-contribution\" id=\"ref-for-minimum-contribution⑦\">minimum contributions</a>. \n       <p>If the grid container is being sized under a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-constraint\" id=\"ref-for-min-content-constraint③\">min-</a> or <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-constraint\" id=\"ref-for-max-content-constraint③\">max-content constraint</a>,\n\t\t\t\t\tuse the items’ <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#limited-contribution\" id=\"ref-for-limited-contribution①\">limited min-content contributions</a> in place of their <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#minimum-contribution\" id=\"ref-for-minimum-contribution⑧\">minimum contributions</a> here.\n\t\t\t\t\t(For an item spanning multiple tracks,\n\t\t\t\t\tthe upper limit used to calculate\n\t\t\t\t\tits <span id=\"ref-for-limited-contribution②\">limited min-/max-content contribution</span> is the <em>sum</em> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#fixed-sizing-function\" id=\"ref-for-fixed-sizing-function⑥\">fixed</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①④\">max track sizing functions</a> of any tracks it spans,\n\t\t\t\t\tand is applied if it only spans such tracks.)</p>"
            },
            {
              "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#track-size-content-min\"></a> <strong>For content-based minimums:</strong> Next continue to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#distribute-extra-space\" id=\"ref-for-distribute-extra-space①\">distribute extra space</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①④\">base sizes</a> of tracks with\n\t\t\t\t\ta <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function①①\">min track sizing function</a> of <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-min-content\" id=\"ref-for-valdef-grid-template-columns-min-content⑦\">min-content</a> or <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content①⓪\">max-content</a>,\n\t\t\t\t\tto accommodate these items' <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution①①\">min-content contributions</a>."
            },
            {
              "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#track-size-max-content-min\"></a> <strong>For max-content minimums:</strong> Next, if the grid container is being sized\n\t\t\t\t\tunder a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-constraint\" id=\"ref-for-max-content-constraint④\">max-content constraint</a>,\n\t\t\t\t\tcontinue to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#distribute-extra-space\" id=\"ref-for-distribute-extra-space②\">distribute extra space</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①⑤\">base sizes</a> of tracks with\n\t\t\t\t\ta <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function①②\">min track sizing function</a> of <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-auto\" id=\"ref-for-valdef-grid-template-columns-auto①③\">auto</a> or <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content①①\">max-content</a>,\n\t\t\t\t\tto accommodate these items' <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#limited-contribution\" id=\"ref-for-limited-contribution③\">limited max-content contributions</a>. \n       <p>In all cases,\n\t\t\t\t\tcontinue to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#distribute-extra-space\" id=\"ref-for-distribute-extra-space③\">distribute extra space</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①⑥\">base sizes</a> of tracks with\n\t\t\t\t\ta <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#min-track-sizing-function\" id=\"ref-for-min-track-sizing-function①③\">min track sizing function</a> of <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content①②\">max-content</a>,\n\t\t\t\t\tto accommodate these items' <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution⑧\">max-content contributions</a>.</p>"
            },
            {
              "html": "If at this point any track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①⓪\">growth limit</a> is now less than its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①⑦\">base size</a>,\n\t\t\t\t\tincrease its <span id=\"ref-for-growth-limit①①\">growth limit</span> to match its <span id=\"ref-for-base-size①⑧\">base size</span>."
            },
            {
              "html": "<strong>For intrinsic maximums:</strong> Next <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#distribute-extra-space\" id=\"ref-for-distribute-extra-space④\">distribute extra space</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①②\">growth limits</a> of tracks with <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#intrinsic-sizing-function\" id=\"ref-for-intrinsic-sizing-function⑤\">intrinsic</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①⑤\">max track sizing function</a>,\n\t\t\t\t\tto accommodate these items' <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#min-content-contribution\" id=\"ref-for-min-content-contribution①②\">min-content contributions</a>.\n\t\t\t\t\tMark any tracks whose <span id=\"ref-for-growth-limit①③\">growth limit</span> changed\n\t\t\t\t\tfrom infinite to finite in this step\n\t\t\t\t\tas <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"infinitely-growable\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">infinitely growable</dfn> for the next step."
            },
            {
              "html": "<strong>For max-content maximums:</strong> Lastly continue to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#distribute-extra-space\" id=\"ref-for-distribute-extra-space⑤\">distribute extra space</a> to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①④\">growth limits</a> of tracks with\n\t\t\t\t\ta <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①⑥\">max track sizing function</a> of <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content①③\">max-content</a>,\n\t\t\t\t\tto accommodate these items' <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-sizing-3/#max-content-contribution\" id=\"ref-for-max-content-contribution⑨\">max-content contributions</a>."
            }
          ]
        },
        {
          "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#algo-spanning-flex-items\"></a> <strong>Increase sizes to accommodate spanning items crossing <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-tracks\" id=\"ref-for-flexible-tracks①\">flexible tracks</a>:</strong> Next, repeat the previous step\n\t\t\tinstead considering (together, rather than grouped by span size)\n\t\t\tall items\n\t\t\tthat <em>do</em> span a track with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-sizing-function\" id=\"ref-for-flexible-sizing-function④\">flexible sizing function</a> while \n     <ul>\n      <li> distributing space <em>only</em> to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-tracks\" id=\"ref-for-flexible-tracks②\">flexible tracks</a> (i.e. treating all other tracks as having a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#fixed-sizing-function\" id=\"ref-for-fixed-sizing-function⑦\">fixed sizing function</a>) \n      </li><li> if the sum of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-sizing-function\" id=\"ref-for-flexible-sizing-function⑤\">flexible sizing functions</a> of all <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-tracks\" id=\"ref-for-flexible-tracks③\">flexible tracks</a> spanned by the item\n\t\t\t\t\tis greater than or equal to one,\n\t\t\t\t\tdistributing space to such tracks\n\t\t\t\t\taccording to the ratios of their <span id=\"ref-for-flexible-sizing-function⑥\">flexible sizing functions</span> rather than distributing space equally;\n\t\t\t\t\tand if the sum is less than one,\n\t\t\t\t\tdistributing that proportion of space\n\t\t\t\t\taccording to the ratios of their <span id=\"ref-for-flexible-sizing-function⑦\">flexible sizing functions</span> and the rest equally \n     </li></ul>"
        },
        {
          "html": "<a class=\"self-link\" href=\"https://drafts.csswg.org/css-grid-2/#algo-finite-growth\"></a> If any track still has an infinite <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①⑤\">growth limit</a> (because, for example, it had no items placed in it\n\t\t\tor it is a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-tracks\" id=\"ref-for-flexible-tracks④\">flexible track</a>),\n\t\t\tset its <span id=\"ref-for-growth-limit①⑥\">growth limit</span> to its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size①⑨\">base size</a>."
        }
      ]
    },
    {
      "name": "distribute extra space",
      "href": "https://drafts.csswg.org/css-grid-2/#distribute-extra-space",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"distribute-extra-space\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">distribute extra space</dfn>,\n\t\tperform the following steps,\n\t\twith these inputs: \n    <ul>\n     <li data-md=\"\">\n      <p>whether to affect <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②⓪\">base sizes</a> or <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①⑦\">growth limits</a> (the <var>affected size</var>s).</p>\n     </li><li data-md=\"\">\n      <p>which tracks to affect (the <var>affected track</var>s).</p>\n     </li><li data-md=\"\">\n      <p>what intrinsic size contributions are being accommodated (the <var>size contribution</var>s)\nof which grid items spanning those tracks (the <var>item</var>s).</p>\n    </li></ul>",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Maintain separately for each <var>affected track</var> a <var>planned increase</var>,\n\t\t\t\tinitially set to 0.\n\t\t\t\t(This prevents the size increases from becoming order-dependent.)"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate\">For each</a> accommodated <var>item</var>,\n\t\t\t\tconsidering only tracks the item spans:",
          "rationale": "find",
          "steps": [
            {
              "html": "<strong>Find the space to distribute:</strong> Subtract the <var>affected size</var> of every spanned track\n\t\t\t\t\t\t(not just the <var>affected track</var>s)\n\t\t\t\t\t\tfrom the item’s <var>size contribution</var>,\n\t\t\t\t\t\tflooring it at zero.\n\t\t\t\t\t\t(For infinite <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①⑧\">growth limits</a>, substitute the track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②①\">base size</a>.)\n\t\t\t\t\t\tThis remaining size contribution is the <var>space</var> to distribute. \n<pre><var>space</var> = max(0, <var>size contribution</var> - ∑<var>track-sizes</var>)</pre>"
            },
            {
              "html": "<strong>Distribute <var>space</var> up to limits:</strong> \n        <p>Find the <var>item-incurred increase</var> for each <var>affected track</var> by:\n\t\t\t\t\t\tdistributing the <var>space</var> equally among these tracks,\n\t\t\t\t\t\tfreezing a track’s <var>item-incurred increase</var> as its <var>affected size</var> + <var>item-incurred increase</var> reaches its <var>limit</var> (and continuing to grow the unfrozen tracks as needed).</p>\n        <p>For <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②②\">base sizes</a>,\n\t\t\t\t\t\tthe <var>limit</var> is its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit①⑨\">growth limit</a>,\n\t\t\t\t\t\t  capped by its <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#funcdef-grid-template-columns-fit-content\" id=\"ref-for-funcdef-grid-template-columns-fit-content①⓪\">fit-content()</a> argument if any.\n\t\t\t\t\t\tFor <span id=\"ref-for-growth-limit②⓪\">growth limits</span>,\n\t\t\t\t\t\tthe <var>limit</var> is the <span id=\"ref-for-growth-limit②①\">growth limit</span> if the <span id=\"ref-for-growth-limit②②\">growth limit</span> is finite\n\t\t\t\t\t\t  and the track is not <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#infinitely-growable\" id=\"ref-for-infinitely-growable①\">infinitely growable</a>,\n\t\t\t\t\t\totherwise its <span class=\"css\" id=\"ref-for-funcdef-grid-template-columns-fit-content①①\">fit-content()</span> argument\n\t\t\t\t\t\t  if it has a <span class=\"css\" id=\"ref-for-funcdef-grid-template-columns-fit-content①②\">fit-content()</span> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-template-rows-track-sizing-function\" id=\"ref-for-grid-template-rows-track-sizing-function⑨\">track sizing function</a>,\n\t\t\t\t\t\tand infinity otherwise.</p>"
            },
            {
              "html": "<strong>Distribute <var>space</var> to non-affected tracks:</strong> \n        <p>If extra <var>space</var> remains at this point,\n\t\t\t\t\t\tand the item spans both <var>affected tracks</var> and non-<var>affected tracks</var>,\n\t\t\t\t\t\tdistribute space as for the previous step,\n\t\t\t\t\t\tbut into the non-<var>affected tracks</var> instead.</p>"
            },
            {
              "html": "<strong>Distribute <var>space</var> beyond limits:</strong> \n        <p>If extra <var>space</var> remains at this point,\n\t\t\t\t\t\tunfreeze and continue to distribute <var>space</var> to the <var>item-incurred increase</var> of…</p>\n        <ul>\n         <li> when <a href=\"https://drafts.csswg.org/css-grid-2/#track-size-intrinsic-min\">accommodating minimum contributions</a> or <a href=\"https://drafts.csswg.org/css-grid-2/#track-size-content-min\">accommodating min-content contributions</a> into <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②③\">base sizes</a>:\n\t\t\t\t\t\t\t\tany <var>affected track</var> that happens to also have an intrinsic <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①⑦\">max track sizing function</a>;\n\t\t\t\t\t\t\t\tif there are no such tracks, then all <var>affected track</var>s. \n         </li><li> when <a href=\"https://drafts.csswg.org/css-grid-2/#track-size-max-content-min\">accommodating max-content contributions</a> into <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②④\">base sizes</a>:\n\t\t\t\t\t\t\t\tany <var>affected track</var> that happens to also have a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content①④\">max-content</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①⑧\">max track sizing function</a>;\n\t\t\t\t\t\t\t\tif there are no such tracks, then all <var>affected track</var>s. \n         </li><li> when accommodating any contribution\n\t\t\t\t\t\t\t\tinto <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit②④\">growth limits</a>:\n\t\t\t\t\t\t\t\tany <var>affected track</var> that has an intrinsic <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function①⑨\">max track sizing function</a>. \n        </li></ul>\n        <p>For this purpose,\n\t\t\t\t\t\tthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#max-track-sizing-function\" id=\"ref-for-max-track-sizing-function②⓪\">max track sizing function</a> of a <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#funcdef-grid-template-columns-fit-content\" id=\"ref-for-funcdef-grid-template-columns-fit-content①③\">fit-content()</a> track\n\t\t\t\t\t\tis treated as <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-grid-template-columns-max-content\" id=\"ref-for-valdef-grid-template-columns-max-content①⑤\">max-content</a> until the track reaches the limit specified as the <span class=\"css\" id=\"ref-for-funcdef-grid-template-columns-fit-content①④\">fit-content()</span> argument,\n\t\t\t\t\t\tafter which its <span id=\"ref-for-max-track-sizing-function②①\">max track sizing function</span> is treated as being\n\t\t\t\t\t\ta <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#fixed-sizing-function\" id=\"ref-for-fixed-sizing-function⑧\">fixed sizing function</a> of that argument\n\t\t\t\t\t\t(which can change which tracks continue to receive space in this step).</p>"
            },
            {
              "html": "For each <var>affected track</var>,\n\t\t\t\t\t\tif the track’s <var>item-incurred increase</var> is larger than the track’s <var>planned increase</var> set the track’s <var>planned increase</var> to that value."
            }
          ]
        },
        {
          "html": "<strong>Update the tracks' <var>affected size</var>s</strong> by adding in the <var>planned increase</var>,\n\t\t\t\tso that the next round of space distribution will account for the increase.\n\t\t\t\t(If the affected size is an infinite <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#growth-limit\" id=\"ref-for-growth-limit②⑤\">growth limit</a>,\n\t\t\t\tset it to the track’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size②⑤\">base size</a> plus the <var>planned increase</var>.)"
        }
      ]
    },
    {
      "name": "space to fill",
      "href": "https://drafts.csswg.org/css-grid-2/#space-to-fill",
      "html": "This algorithm finds the largest size that an <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-flex-fr\" id=\"ref-for-valdef-flex-fr⑧\">fr</a> unit can be\n\twithout exceeding the target size.\n\tIt must be called with a set of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-track\" id=\"ref-for-grid-track③④\">grid tracks</a> and some quantity of <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"space-to-fill\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">space to fill</dfn>.",
      "rationale": "let",
      "steps": [
        {
          "html": "Let <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"leftover-space\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">leftover space</dfn> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#space-to-fill\" id=\"ref-for-space-to-fill②\">space to fill</a> minus the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#base-size\" id=\"ref-for-base-size③①\">base sizes</a> of the non-flexible <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-track\" id=\"ref-for-grid-track③⑤\">grid tracks</a>."
        },
        {
          "html": "Let <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"flex-factor-sum\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">flex factor sum</dfn> be the sum of\n\t\t\tthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-template-columns-flex-factor\" id=\"ref-for-grid-template-columns-flex-factor①⓪\">flex factors</a> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-tracks\" id=\"ref-for-flexible-tracks⑦\">flexible tracks</a>.\n\t\t\tIf this value is less than 1,\n\t\t\tset it to 1 instead."
        },
        {
          "html": "Let the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"hypothetical-fr-size\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">hypothetical fr size</dfn> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#leftover-space\" id=\"ref-for-leftover-space⑦\">leftover space</a> divided by the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flex-factor-sum\" id=\"ref-for-flex-factor-sum\">flex factor sum</a>."
        },
        {
          "html": "If the product of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#hypothetical-fr-size\" id=\"ref-for-hypothetical-fr-size\">hypothetical fr size</a> and a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#flexible-tracks\" id=\"ref-for-flexible-tracks⑧\">flexible track</a>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-template-columns-flex-factor\" id=\"ref-for-grid-template-columns-flex-factor①①\">flex factor</a> is less than the track’s base size,\n\t\t\trestart this algorithm\n\t\t\ttreating all such tracks as inflexible."
        },
        {
          "html": "Return the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#hypothetical-fr-size\" id=\"ref-for-hypothetical-fr-size①\">hypothetical fr size</a>."
        }
      ]
    },
    {
      "html": "<em>This section is non-normative.</em>",
      "rationale": "resolve",
      "steps": [
        {
          "html": "Layout the grid following the <a href=\"https://drafts.csswg.org/css-grid-2/#layout-algorithm\" id=\"ref-for-layout-algorithm②\">§ 12 Grid Layout Algorithm</a> by using the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-break-4/#fragmentation-container\" id=\"ref-for-fragmentation-container②\">fragmentation container</a>’s inline size and assume unlimited block size.\n\t\t\tDuring this step all <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-grid-2/#propdef-grid-row\" id=\"ref-for-propdef-grid-row⑥\">grid-row</a> <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#grid-placement-auto\" id=\"ref-for-grid-placement-auto①②\">auto</a> and <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#valdef-flex-fr\" id=\"ref-for-valdef-flex-fr⑨\">fr</a> values must be resolved."
        },
        {
          "html": "Layout the grid container using the values resolved in the previous step."
        },
        {
          "html": "If a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-grid-2/#grid-area\" id=\"ref-for-grid-area③⑥\">grid area</a>’s size changes due to fragmentation (do not include items that\n\t\t\tspan rows in this decision), increase the grid row size as necessary for rows that either: \n     <ul>\n      <li> have a content min track sizing function. \n      </li><li> are in a grid that does not have an explicit height and the grid row is flexible. \n     </li></ul>"
        },
        {
          "html": "If the grid height is <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-grid-2/#grid-placement-auto\" id=\"ref-for-grid-placement-auto①③\">auto</a>, the height of the grid should be the sum of the final\n\t\t\trow sizes."
        },
        {
          "html": "If a grid area overflows the grid container due to margins being collapsed during\n\t\t\tfragmentation, extend the grid container to contain this grid area (this step is\n\t\t\tnecessary in order to avoid circular layout dependencies due to fragmentation)."
        }
      ]
    }
  ]
}