{
  "spec": {
    "title": "Cookie Store API",
    "url": "https://wicg.github.io/cookie-store/"
  },
  "algorithms": [
    {
      "name": "CookieStore/get(name)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-get",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestore-get\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>get(<var>name</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url\">creation URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>list</var> be the results of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#query-cookies\" id=\"ref-for-query-cookies\">query cookies</a> with <var>url</var> and <var>name</var>.</p>"
            },
            {
              "html": "<p>If <var>list</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror\">TypeError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p>If <var>list</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-list-is-empty\">is empty</a>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve\">resolve</a> <var>p</var> with null.</p>"
            },
            {
              "html": "<p>Otherwise, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①\">resolve</a> <var>p</var> with the first item of <var>list</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/get(options)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-get-options",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"get(options)|get()\" id=\"dom-cookiestore-get-options\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>get(<var>options</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object①\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin①\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque①\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with①\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror①\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException①\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url①\">creation URL</a>.</p>"
        },
        {
          "html": "<p>If <var>options</var> is empty, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with②\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①\">TypeError</a></code>.</p>"
        },
        {
          "html": "If <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-url\" id=\"ref-for-dom-cookiestoregetoptions-url①\">url</a></code>\"] is present, then run these steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>parsed</var> be the result of <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-basic-url-parser\" id=\"ref-for-concept-basic-url-parser\">parsing</a> <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-url\" id=\"ref-for-dom-cookiestoregetoptions-url②\">url</a></code>\"] with <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url\" id=\"ref-for-api-base-url\">API base URL</a>.</p>"
            },
            {
              "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global\">relevant global object</a> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window①\">Window</a></code> object and <var>parsed</var> does not <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-equals\" id=\"ref-for-concept-url-equals\">equal</a> <var>url</var>,\nthen return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with③\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror②\">TypeError</a></code>.</p>"
            },
            {
              "html": "<p>If <var>parsed</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-origin\" id=\"ref-for-concept-url-origin\">origin</a> and <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-origin\" id=\"ref-for-concept-url-origin①\">origin</a> are not the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#same-origin\" id=\"ref-for-same-origin\">same origin</a>,\nthen return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with④\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror③\">TypeError</a></code>.</p>"
            },
            {
              "html": "<p>Set <var>url</var> to <var>parsed</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise①\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>list</var> be the results of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#query-cookies\" id=\"ref-for-query-cookies①\">query cookies</a> with <var>url</var> and <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-name\" id=\"ref-for-dom-cookiestoregetoptions-name\">name</a></code>\"] (if present).</p>"
            },
            {
              "html": "<p>If <var>list</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror④\">TypeError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p>If <var>list</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-list-is-empty①\">is empty</a>, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve②\">resolve</a> <var>p</var> with null.</p>"
            },
            {
              "html": "<p>Otherwise, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve③\">resolve</a> <var>p</var> with the first item of <var>list</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/getAll(name)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-getall",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestore-getall\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getAll(<var>name</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object②\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin②\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque②\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑤\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror②\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException②\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url②\">creation URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise②\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel②\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>list</var> be the results of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#query-cookies\" id=\"ref-for-query-cookies②\">query cookies</a> with <var>url</var> and <var>name</var>.</p>"
            },
            {
              "html": "<p>If <var>list</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑤\">TypeError</a></code>.</p>"
            },
            {
              "html": "<p>Otherwise, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve④\">resolve</a> <var>p</var> with <var>list</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/getAll(options)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-getall-options",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"getAll(options)|getAll()\" id=\"dom-cookiestore-getall-options\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getAll(<var>options</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object③\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin③\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque③\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑥\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror③\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException③\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url③\">creation URL</a>.</p>"
        },
        {
          "html": "If <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-url\" id=\"ref-for-dom-cookiestoregetoptions-url③\">url</a></code>\"] is present, then run these steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>parsed</var> be the result of <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-basic-url-parser\" id=\"ref-for-concept-basic-url-parser①\">parsing</a> <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-url\" id=\"ref-for-dom-cookiestoregetoptions-url④\">url</a></code>\"] with <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url\" id=\"ref-for-api-base-url①\">API base URL</a>.</p>"
            },
            {
              "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global①\">relevant global object</a> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window②\">Window</a></code> object and <var>parsed</var> does not <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-equals\" id=\"ref-for-concept-url-equals①\">equal</a> <var>url</var>,\nthen return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑦\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑥\">TypeError</a></code>.</p>"
            },
            {
              "html": "<p>If <var>parsed</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-origin\" id=\"ref-for-concept-url-origin②\">origin</a> and <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-origin\" id=\"ref-for-concept-url-origin③\">origin</a> are not the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#same-origin\" id=\"ref-for-same-origin①\">same origin</a>,\nthen return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑧\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑦\">TypeError</a></code>.</p>"
            },
            {
              "html": "<p>Set <var>url</var> to <var>parsed</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise③\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel③\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>list</var> be the results of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#query-cookies\" id=\"ref-for-query-cookies③\">query cookies</a> with <var>url</var> and <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-name\" id=\"ref-for-dom-cookiestoregetoptions-name①\">name</a></code>\"] (if present).</p>"
            },
            {
              "html": "<p>If <var>list</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑧\">TypeError</a></code>.</p>"
            },
            {
              "html": "<p>Otherwise, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑤\">resolve</a> <var>p</var> with <var>list</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/set(name, value)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-set",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestore-set\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>set(<var>name</var>, <var>value</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object④\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin④\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque④\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑨\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror④\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException④\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url④\">creation URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>domain</var> be null.</p>"
        },
        {
          "html": "<p>Let <var>path</var> be \"/\".</p>"
        },
        {
          "html": "<p>Let <var>sameSite</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiesamesite-strict\" id=\"ref-for-dom-cookiesamesite-strict\">strict</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>partitioned</var> be false.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise④\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel④\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>r</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#set-a-cookie\" id=\"ref-for-set-a-cookie\">set a cookie</a> with <var>url</var>, <var>name</var>, <var>value</var>, <var>domain</var>, <var>path</var>, <var>sameSite</var>, and <var>partitioned</var>.</p>"
            },
            {
              "html": "<p>If <var>r</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject④\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑨\">TypeError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑥\">Resolve</a> <var>p</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/set(options)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-set-options",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestore-set-options\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>set(<var>options</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object⑤\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin⑤\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque⑤\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with①⓪\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror⑤\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑤\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url⑤\">creation URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise⑤\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑤\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>r</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#set-a-cookie\" id=\"ref-for-set-a-cookie①\">set a cookie</a> with <var>url</var>, <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-name\" id=\"ref-for-dom-cookieinit-name\">name</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-value\" id=\"ref-for-dom-cookieinit-value\">value</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-expires\" id=\"ref-for-dom-cookieinit-expires\">expires</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-domain\" id=\"ref-for-dom-cookieinit-domain\">domain</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-path\" id=\"ref-for-dom-cookieinit-path\">path</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-samesite\" id=\"ref-for-dom-cookieinit-samesite\">sameSite</a></code>\"], and <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookieinit-partitioned\" id=\"ref-for-dom-cookieinit-partitioned\">partitioned</a></code>\"].</p>"
            },
            {
              "html": "<p>If <var>r</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑤\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①⓪\">TypeError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑦\">Resolve</a> <var>p</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/delete(name)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-delete",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestore-delete\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>delete(<var>name</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object⑥\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin⑥\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque⑥\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with①①\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror⑥\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑥\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url⑥\">creation URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise⑥\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑥\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>r</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#delete-a-cookie\" id=\"ref-for-delete-a-cookie\">delete a cookie</a> with <var>url</var>, <var>name</var>,\nnull,\n\"<code>/</code>\",\ntrue, and\n\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiesamesite-strict\" id=\"ref-for-dom-cookiesamesite-strict①\">strict</a></code>\".</p>"
            },
            {
              "html": "<p>If <var>r</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑥\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①①\">TypeError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑧\">Resolve</a> <var>p</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStore/delete(options)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestore-delete-options",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStore\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestore-delete-options\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>delete(<var>options</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑨\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object⑦\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin⑦\">origin</a>.</p>"
        },
        {
          "html": "<p>If <var>origin</var> is an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque\" id=\"ref-for-concept-origin-opaque⑦\">opaque origin</a>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with①②\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror⑦\">SecurityError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑦\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>url</var> be <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url⑦\">creation URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise⑦\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑦\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>r</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#delete-a-cookie\" id=\"ref-for-delete-a-cookie①\">delete a cookie</a> with <var>url</var>, <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoredeleteoptions-name\" id=\"ref-for-dom-cookiestoredeleteoptions-name\">name</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoredeleteoptions-domain\" id=\"ref-for-dom-cookiestoredeleteoptions-domain\">domain</a></code>\"], <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoredeleteoptions-path\" id=\"ref-for-dom-cookiestoredeleteoptions-path\">path</a></code>\"], and <var>options</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoredeleteoptions-partitioned\" id=\"ref-for-dom-cookiestoredeleteoptions-partitioned\">partitioned</a></code>\"].</p>"
            },
            {
              "html": "<p>If <var>r</var> is failure, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑦\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①②\">TypeError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑨\">Resolve</a> <var>p</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStoreManager/subscribe(subscriptions)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestoremanager-subscribe",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStoreManager\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestoremanager-subscribe\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>subscribe(<var>subscriptions</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⓪\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object⑧\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>registration</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①①\">this</a>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookiestoremanager-registration\" id=\"ref-for-cookiestoremanager-registration\">registration</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise⑧\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑧\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>subscription list</var> be <var>registration</var>’s associated <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-list\" id=\"ref-for-cookie-change-subscription-list\">cookie change subscription list</a>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate\">For each</a> <var>entry</var> in <var>subscriptions</var>, run these steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>name</var> be <var>entry</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-name\" id=\"ref-for-dom-cookiestoregetoptions-name③\">name</a></code>\"].</p>"
                },
                {
                  "html": "<p>Let <var>url</var> be the result of <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-basic-url-parser\" id=\"ref-for-concept-basic-url-parser②\">parsing</a> <var>entry</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-url\" id=\"ref-for-dom-cookiestoregetoptions-url⑥\">url</a></code>\"] with <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url\" id=\"ref-for-api-base-url②\">API base URL</a>.</p>"
                },
                {
                  "html": "<p>If <var>url</var> does not start with <var>registration</var>’s <a data-link-type=\"dfn\" href=\"https://w3c.github.io/ServiceWorker/#dfn-scope-url\" id=\"ref-for-dfn-scope-url①\">scope url</a>,\nthen <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑧\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①③\">TypeError</a></code> and abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>subscription</var> be the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription\" id=\"ref-for-cookie-change-subscription①\">cookie change subscription</a> (<var>name</var>, <var>url</var>).</p>"
                },
                {
                  "html": "<p>If <var>subscription list</var> does not already <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain\">contain</a> <var>subscription</var>, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append\">append</a> <var>subscription</var> to <var>subscription list</var>.</p>"
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⓪\">Resolve</a> <var>p</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStoreManager/getSubscriptions()",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestoremanager-getsubscriptions",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStoreManager\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestoremanager-getsubscriptions\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>getSubscriptions()</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>registration</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①②\">this</a>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookiestoremanager-registration\" id=\"ref-for-cookiestoremanager-registration①\">registration</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise⑨\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑨\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>subscriptions</var> be <var>registration</var>’s associated <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-list\" id=\"ref-for-cookie-change-subscription-list①\">cookie change subscription list</a>.</p>"
            },
            {
              "html": "<p>Let <var>result</var> be a new <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list①\">list</a>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①\">For each</a> <var>subscription</var> in <var>subscriptions</var>, run these steps:",
              "rationale": "append",
              "steps": [
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append①\">Append</a> «[ \"name\" → <var>subscription</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-name\" id=\"ref-for-cookie-change-subscription-name\">name</a>, \"url\" → <var>subscription</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-url\" id=\"ref-for-cookie-change-subscription-url\">url</a>]» to <var>result</var>.</p>"
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①①\">Resolve</a> <var>p</var> with <var>result</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "CookieStoreManager/unsubscribe(subscriptions)",
      "href": "https://wicg.github.io/cookie-store/#dom-cookiestoremanager-unsubscribe",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"CookieStoreManager\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-cookiestoremanager-unsubscribe\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>unsubscribe(<var>subscriptions</var>)</code></dfn> method steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>settings</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①③\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object⑨\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>registration</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①④\">this</a>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookiestoremanager-registration\" id=\"ref-for-cookiestoremanager-registration②\">registration</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise①⓪\">a new promise</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⓪\">in parallel</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>subscription list</var> be <var>registration</var>’s associated <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-list\" id=\"ref-for-cookie-change-subscription-list②\">cookie change subscription list</a>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②\">For each</a> <var>entry</var> in <var>subscriptions</var>, run these steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>name</var> be <var>entry</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-name\" id=\"ref-for-dom-cookiestoregetoptions-name④\">name</a></code>\"].</p>"
                },
                {
                  "html": "<p>Let <var>url</var> be the result of <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-basic-url-parser\" id=\"ref-for-concept-basic-url-parser③\">parsing</a> <var>entry</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiestoregetoptions-url\" id=\"ref-for-dom-cookiestoregetoptions-url⑦\">url</a></code>\"] with <var>settings</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url\" id=\"ref-for-api-base-url③\">API base URL</a>.</p>"
                },
                {
                  "html": "<p>If <var>url</var> does not start with <var>registration</var>’s <a data-link-type=\"dfn\" href=\"https://w3c.github.io/ServiceWorker/#dfn-scope-url\" id=\"ref-for-dfn-scope-url②\">scope url</a>,\nthen <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑨\">reject</a> <var>p</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①④\">TypeError</a></code> and abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>subscription</var> be the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription\" id=\"ref-for-cookie-change-subscription②\">cookie change subscription</a> (<var>name</var>, <var>url</var>).</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove\">Remove</a> any <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-item\" id=\"ref-for-list-item\">item</a> from <var>subscription list</var> equal to <var>subscription</var>.</p>"
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①②\">Resolve</a> <var>p</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "query cookies",
      "href": "https://wicg.github.io/cookie-store/#query-cookies",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"query-cookies\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">query cookies</dfn> with <var>url</var> and\noptional <var>name</var>,\nrun the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Perform the steps defined in <a href=\"https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-14#name-retrieval-model\">Cookies § Retrieval Model</a> to compute the \"cookie-string from a given cookie store\"\nwith <var>url</var> as <var>request-uri</var>.\nThe <var>cookie-string</var> itself is ignored, but the intermediate <var>cookie-list</var> is used in subsequent steps.</p>\n      <p>For the purposes of the steps, the <var>cookie-string</var> is being generated for a \"non-HTTP\" API.</p>"
        },
        {
          "html": "<p>Let <var>list</var> be a new <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list②\">list</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③\">For each</a> <var>cookie</var> in <var>cookie-list</var>, run these steps:",
          "rationale": "assert",
          "steps": [
            {
              "html": "<p class=\"assertion\">Assert: <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-http-only-flag\" id=\"ref-for-cookie-http-only-flag\">http-only-flag</a> is false.</p>"
            },
            {
              "html": "If <var>name</var> is given, then run these steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>cookieName</var> be the result of running <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode-without-bom\" id=\"ref-for-utf-8-decode-without-bom\">UTF-8 decode without BOM</a> on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-name\" id=\"ref-for-cookie-name①\">name</a>.</p>"
                },
                {
                  "html": "<p>If <var>cookieName</var> does not equal <var>name</var>,\n then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue\">continue</a>.</p>"
                }
              ]
            },
            {
              "html": "<p>Let <var>item</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#create-a-cookielistitem\" id=\"ref-for-create-a-cookielistitem\">create a CookieListItem</a> from <var>cookie</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append②\">Append</a> <var>item</var> to <var>list</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>list</var>.</p>"
        }
      ]
    },
    {
      "name": "create a CookieListItem",
      "href": "https://wicg.github.io/cookie-store/#create-a-cookielistitem",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-a-cookielistitem\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dictdef-cookielistitem\" id=\"ref-for-dictdef-cookielistitem⑦\">CookieListItem</a></code></dfn> from <var>cookie</var>, run the following steps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of running <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode-without-bom\" id=\"ref-for-utf-8-decode-without-bom①\">UTF-8 decode without BOM</a> on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-name\" id=\"ref-for-cookie-name②\">name</a>.</p>"
        },
        {
          "html": "<p>Let <var>value</var> be the result of running <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode-without-bom\" id=\"ref-for-utf-8-decode-without-bom②\">UTF-8 decode without BOM</a> on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-value\" id=\"ref-for-cookie-value①\">value</a>.</p>"
        },
        {
          "html": "<p>Let <var>domain</var> be the result of running <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode-without-bom\" id=\"ref-for-utf-8-decode-without-bom③\">UTF-8 decode without BOM</a> on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-domain\" id=\"ref-for-cookie-domain\">domain</a>.</p>"
        },
        {
          "html": "<p>Let <var>path</var> be the result of running <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode-without-bom\" id=\"ref-for-utf-8-decode-without-bom④\">UTF-8 decode without BOM</a> on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-path\" id=\"ref-for-cookie-path\">path</a>.</p>"
        },
        {
          "html": "<p>Let <var>expires</var> be <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-expiry-time\" id=\"ref-for-cookie-expiry-time\">expiry-time</a> (<a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#as-a-timestamp\" id=\"ref-for-as-a-timestamp\">as a timestamp</a>).</p>"
        },
        {
          "html": "<p>Let <var>secure</var> be <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-secure-only-flag\" id=\"ref-for-cookie-secure-only-flag\">secure-only-flag</a>.</p>"
        },
        {
          "html": "Switch on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-same-site-flag\" id=\"ref-for-cookie-same-site-flag\">same-site-flag</a>:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "`None`",
                  "html": "<p>Let <var>sameSite</var> be \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiesamesite-none\" id=\"ref-for-dom-cookiesamesite-none\">none</a></code>\".</p>"
                },
                {
                  "case": "`Strict`",
                  "html": "<p>Let <var>sameSite</var> be \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiesamesite-strict\" id=\"ref-for-dom-cookiesamesite-strict②\">strict</a></code>\".</p>"
                },
                {
                  "case": "`Lax`",
                  "html": "<p>Let <var>sameSite</var> be \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiesamesite-lax\" id=\"ref-for-dom-cookiesamesite-lax\">lax</a></code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Let <var>partitioned</var> be a boolean indicating that the user agent supports <a href=\"https://github.com/privacycg/CHIPS\">cookie partitioning</a> and that that <var>cookie</var> has a partition key.</p>"
        },
        {
          "html": "<p>Return «[\n\"name\" → <var>name</var>,\n\"value\" → <var>value</var>,\n\"domain\" → <var>domain</var>,\n\"path\" → <var>path</var>,\n\"expires\" → <var>expires</var>,\n\"secure\" → <var>secure</var>,\n\"sameSite\" → <var>sameSite</var>,\n\"partitioned\" → <var>partitioned</var> ]»</p>"
        }
      ]
    },
    {
      "name": "set a cookie",
      "href": "https://wicg.github.io/cookie-store/#set-a-cookie",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"set-a-cookie\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">set a cookie</dfn> with <var>url</var>, <var>name</var>, <var>value</var>,\noptional <var>expires</var>, <var>domain</var>, <var>path</var>, <var>sameSite</var>, and <var>partitioned</var> run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>name</var> or <var>value</var> contain U+003B (<code>;</code>), any <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#c0-control\" id=\"ref-for-c0-control\">C0 control</a> character except U+0009 (the horizontal tab character), or U+007F, then return failure.</p>"
        },
        {
          "html": "<p>If <var>name</var>’s <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-length\" id=\"ref-for-string-length\">length</a> is 0 and <var>value</var> contains U+003D (<code>=</code>), then return failure.</p>"
        },
        {
          "html": "<p>If <var>name</var>’s <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-length\" id=\"ref-for-string-length①\">length</a> is 0 and <var>value</var>’s <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-length\" id=\"ref-for-string-length②\">length</a> is 0, then return failure.</p>"
        },
        {
          "html": "<p>Let <var>encodedName</var> be the result of <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode\">UTF-8 encoding</a> <var>name</var>.</p>"
        },
        {
          "html": "<p>Let <var>encodedValue</var> be the result of <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode①\">UTF-8 encoding</a> <var>value</var>.</p>"
        },
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence②\">byte sequence</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\" id=\"ref-for-byte-sequence-length\">length</a> of <var>encodedName</var> plus the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence③\">byte sequence</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\" id=\"ref-for-byte-sequence-length①\">length</a> of <var>encodedValue</var> is greater than the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-maximum-name-value-pair-size\" id=\"ref-for-cookie-maximum-name-value-pair-size\">maximum name/value pair size</a>, then return failure.</p>"
        },
        {
          "html": "<p>Let <var>host</var> be <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-host\" id=\"ref-for-concept-url-host\">host</a></p>"
        },
        {
          "html": "<p>Let <var>attributes</var> be a new <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list③\">list</a>.</p>"
        },
        {
          "html": "If <var>domain</var> is not null, then run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>domain</var> starts with U+002E (<code>.</code>), then return failure.</p>"
            },
            {
              "html": "<p>If <var>host</var> does not equal <var>domain</var> and <var>host</var> does not end with U+002E (<code>.</code>) followed by <var>domain</var>,\nthen return failure.</p>"
            },
            {
              "html": "<p>Let <var>encodedDomain</var> be the result of <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode②\">UTF-8 encoding</a> <var>domain</var>.</p>"
            },
            {
              "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence④\">byte sequence</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\" id=\"ref-for-byte-sequence-length②\">length</a> of <var>encodedDomain</var> is greater than the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-maximum-attribute-value-size\" id=\"ref-for-cookie-maximum-attribute-value-size\">maximum attribute value size</a>, then return failure.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append③\">Append</a> `<code>Domain</code>`/<var>encodedDomain</var> to <var>attributes</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>expires</var> is given, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append④\">append</a> `<code>Expires</code>`/<var>expires</var> (<a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#date-serialize\" id=\"ref-for-date-serialize\">date serialized</a>) to <var>attributes</var>.</p>"
        },
        {
          "html": "<p>If <var>path</var> does not start with U+002F (<code>/</code>), then return failure.</p>"
        },
        {
          "html": "<p>If <var>path</var> does not end with U+002F (<code>/</code>), then append U+002F (<code>/</code>) to <var>path</var>.</p>"
        },
        {
          "html": "<p>Let <var>encodedPath</var> be the result of <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode③\">UTF-8 encoding</a> <var>path</var>.</p>"
        },
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence⑤\">byte sequence</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\" id=\"ref-for-byte-sequence-length③\">length</a> of <var>encodedPath</var> is greater than the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-maximum-attribute-value-size\" id=\"ref-for-cookie-maximum-attribute-value-size①\">maximum attribute value size</a>, then return failure.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑤\">Append</a> `<code>Path</code>`/<var>encodedPath</var> to <var>attributes</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑥\">Append</a> `<code>Secure</code>`/`` to <var>attributes</var>.</p>"
        },
        {
          "html": "Switch on <var>sameSite</var>:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "\"none\"",
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑦\">Append</a> `<code>SameSite</code>`/`<code>None</code>` to <var>attributes</var>.</p>"
                },
                {
                  "case": "\"strict\"",
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑧\">Append</a> `<code>SameSite</code>`/`<code>Strict</code>` to <var>attributes</var>.</p>"
                },
                {
                  "case": "\"lax\"",
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑨\">Append</a> `<code>SameSite</code>`/`<code>Lax</code>` to <var>attributes</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>partitioned</var> is true, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append①⓪\">Append</a> `<code>Partitioned</code>`/`` to <var>attributes</var>.</p>"
        },
        {
          "html": "<p>Perform the steps defined in <a href=\"https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-14#name-storage-model\">Cookies § Storage Model</a> for when the user agent \"receives a cookie\" with <var>url</var> as <var>request-uri</var>, <var>encodedName</var> as <var>cookie-name</var>, <var>encodedValue</var> as <var>cookie-value</var>, and <var>attributes</var> as <var>cookie-attribute-list</var>.</p>\n      <p>For the purposes of the steps, the newly-created cookie was received from a \"non-HTTP\" API.</p>"
        },
        {
          "html": "<p>Return success.</p>"
        }
      ]
    },
    {
      "name": "delete a cookie",
      "href": "https://wicg.github.io/cookie-store/#delete-a-cookie",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"delete-a-cookie\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">delete a cookie</dfn> with <var>url</var>, <var>name</var>, <var>domain</var>, <var>path</var>, and <var>partitioned</var> run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>path</var> is not null, then run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>path</var> does not start with U+002F (<code>/</code>), then return failure.</p>"
            },
            {
              "html": "<p>If <var>path</var> does not end with U+002F (<code>/</code>), then append U+002F (<code>/</code>) to <var>path</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>expires</var> be the earliest representable date represented <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#as-a-timestamp\" id=\"ref-for-as-a-timestamp①\">as a timestamp</a>.</p>"
        },
        {
          "html": "<p>Let <var>value</var> be the empty string.</p>"
        },
        {
          "html": "<p>Let <var>sameSite</var> be \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiesamesite-strict\" id=\"ref-for-dom-cookiesamesite-strict④\">strict</a></code>\".</p>"
        },
        {
          "html": "<p>Return the results of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#set-a-cookie\" id=\"ref-for-set-a-cookie②\">set a cookie</a> with <var>url</var>, <var>name</var>, <var>value</var>, <var>expires</var>, <var>domain</var>, <var>path</var>, <var>sameSite</var>, and <var>partitioned</var>.</p>"
        }
      ]
    },
    {
      "name": "process cookie changes",
      "href": "https://wicg.github.io/cookie-store/#process-cookie-changes",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"process-cookie-changes\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">process cookie changes</dfn>, run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "For every <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window⑧\">Window</a></code> <var>window</var>, run the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>url</var> be <var>window</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object①⓪\">relevant settings object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-environment-creation-url\" id=\"ref-for-concept-environment-creation-url⑧\">creation URL</a>.</p>"
            },
            {
              "html": "<p>Let <var>changes</var> be the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#observable-changes\" id=\"ref-for-observable-changes\">observable changes</a> for <var>url</var>.</p>"
            },
            {
              "html": "<p>If <var>changes</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-list-is-empty②\">is empty</a>, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue①\">continue</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\" id=\"ref-for-queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source\" id=\"ref-for-dom-manipulation-task-source\">DOM manipulation task source</a> given <var>window</var> to <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#fire-a-change-event\" id=\"ref-for-fire-a-change-event\">fire a change event</a> named \"<code>change</code>\" with <var>changes</var> at <var>window</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#cookiestore\" id=\"ref-for-cookiestore⑧\">CookieStore</a></code>.</p>"
            }
          ]
        },
        {
          "html": "For every <a data-link-type=\"dfn\" href=\"https://w3c.github.io/ServiceWorker/#dfn-service-worker-registration\" id=\"ref-for-dfn-service-worker-registration⑥\">service worker registration</a> <var>registration</var>, run the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>changes</var> be a new <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set\">set</a>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate④\">For each</a> <var>change</var> in the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#observable-changes\" id=\"ref-for-observable-changes①\">observable changes</a> for <var>registration</var>’s <a data-link-type=\"dfn\" href=\"https://w3c.github.io/ServiceWorker/#dfn-scope-url\" id=\"ref-for-dfn-scope-url③\">scope url</a>, run these steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>cookie</var> be <var>change</var>’s cookie.</p>"
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑤\">For each</a> <var>subscription</var> in <var>registration</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-list\" id=\"ref-for-cookie-change-subscription-list④\">cookie change subscription list</a>, run these steps:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>If <var>change</var> is not <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain①\">in</a> the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#observable-changes\" id=\"ref-for-observable-changes②\">observable changes</a> for <var>subscription</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-url\" id=\"ref-for-cookie-change-subscription-url①\">url</a>,\nthen <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue②\">continue</a>.</p>"
                    },
                    {
                      "html": "<p>Let <var>cookieName</var> be the result of running <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode-without-bom\" id=\"ref-for-utf-8-decode-without-bom⑤\">UTF-8 decode without BOM</a> on <var>cookie</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-name\" id=\"ref-for-cookie-name③\">name</a>.</p>"
                    },
                    {
                      "html": "<p>If <var>cookieName</var> equals <var>subscription</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#cookie-change-subscription-name\" id=\"ref-for-cookie-change-subscription-name①\">name</a>,\nthen <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#set-append\" id=\"ref-for-set-append\">append</a> <var>change</var> to <var>changes</var> and <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-break\" id=\"ref-for-iteration-break\">break</a>.</p>"
                    }
                  ]
                }
              ]
            },
            {
              "html": "<p>If <var>changes</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-list-is-empty③\">is empty</a>, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue③\">continue</a>.</p>"
            },
            {
              "html": "<p>Let <var>changedList</var> and <var>deletedList</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#prepare-lists\" id=\"ref-for-prepare-lists\">prepare lists</a> from <var>changes</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://w3c.github.io/ServiceWorker/#fire-functional-event\" id=\"ref-for-fire-functional-event\">Fire a functional event</a> named \"<code>cookiechange</code>\"\nusing <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#extendablecookiechangeevent\" id=\"ref-for-extendablecookiechangeevent②\">ExtendableCookieChangeEvent</a></code> on <var>registration</var> with these properties:</p>\n        <dl>\n         <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-extendablecookiechangeevent-changed\" id=\"ref-for-dom-extendablecookiechangeevent-changed①\">changed</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>changedList</var></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-extendablecookiechangeevent-deleted\" id=\"ref-for-dom-extendablecookiechangeevent-deleted①\">deleted</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>deletedList</var></p>\n        </dd></dl>"
            }
          ]
        }
      ]
    },
    {
      "name": "fire a change event",
      "href": "https://wicg.github.io/cookie-store/#fire-a-change-event",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"fire-a-change-event\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">fire a change event</dfn> named <var>type</var> with <var>changes</var> at <var>target</var>, run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>event</var> be the result of <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-create\" id=\"ref-for-concept-event-create\">creating an Event</a> using <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#cookiechangeevent\" id=\"ref-for-cookiechangeevent②\">CookieChangeEvent</a></code>.</p>"
        },
        {
          "html": "<p>Set <var>event</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-type\" id=\"ref-for-dom-event-type\">type</a></code> attribute to <var>type</var>.</p>"
        },
        {
          "html": "<p>Set <var>event</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\" id=\"ref-for-dom-event-bubbles\">bubbles</a></code> and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-cancelable\" id=\"ref-for-dom-event-cancelable\">cancelable</a></code> attributes to false.</p>"
        },
        {
          "html": "<p>Let <var>changedList</var> and <var>deletedList</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#prepare-lists\" id=\"ref-for-prepare-lists①\">prepare lists</a> from <var>changes</var>.</p>"
        },
        {
          "html": "<p>Set <var>event</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiechangeevent-changed\" id=\"ref-for-dom-cookiechangeevent-changed①\">changed</a></code> attribute to <var>changedList</var>.</p>"
        },
        {
          "html": "<p>Set <var>event</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookiechangeevent-deleted\" id=\"ref-for-dom-cookiechangeevent-deleted①\">deleted</a></code> attribute to <var>deletedList</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-dispatch\" id=\"ref-for-concept-event-dispatch②\">Dispatch</a> <var>event</var> at <var>target</var>.</p>"
        }
      ]
    },
    {
      "name": "prepare lists",
      "href": "https://wicg.github.io/cookie-store/#prepare-lists",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"prepare-lists\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">prepare lists</dfn> from <var>changes</var>, run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>changedList</var> be a new <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list④\">list</a>.</p>"
        },
        {
          "html": "<p>Let <var>deletedList</var> be a new <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list⑤\">list</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑥\">For each</a> <var>change</var> in <var>changes</var>, run these steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>item</var> be the result of running <a data-link-type=\"dfn\" href=\"https://wicg.github.io/cookie-store/#create-a-cookielistitem\" id=\"ref-for-create-a-cookielistitem①\">create a CookieListItem</a> from <var>change</var>’s cookie.</p>"
            },
            {
              "html": "<p>If <var>change</var>’s type is <em>changed</em>, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append①①\">append</a> <var>item</var> to <var>changedList</var>.</p>"
            },
            {
              "html": "Otherwise, run these steps:",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set <var>item</var>[\"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/cookie-store/#dom-cookielistitem-value\" id=\"ref-for-dom-cookielistitem-value\">value</a></code>\"] to undefined.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append①②\">Append</a> <var>item</var> to <var>deletedList</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>changedList</var> and <var>deletedList</var>.</p>"
        }
      ]
    }
  ]
}