{
  "spec": {
    "title": "Modern Algorithms in the Web Cryptography API",
    "url": "https://wicg.github.io/webcrypto-modern-algos/"
  },
  "algorithms": [
    {
      "name": "SubtleCrypto/encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-encapsulateKey",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-encapsulateKey\" data-dfn-for=\"SubtleCrypto\" data-lt=\"encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages)|encapsulateKey()|encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, keyUsages)\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"encapsulateKey(encapsulationAlgorithm, encapsulationKey, sharedKeyAlgorithm, extractable, usages)\" data-type=\"Promise\" data-local-lt=\"SubtleCrypto.encapsulateKey|SubtleCrypto.encapsulateKey()|encapsulateKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>encapsulateKey(<var>encapsulationAlgorithm</var>, <var>encapsulationKey</var>, <var>sharedKeyAlgorithm</var>, <var>extractable</var>, <var>usages</var>)</code></dfn>\n          method encapsulates a key and returns an <a data-link-type=\"idl\" data-lt=\"EncapsulatedKey\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedKey\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedKey-2\"><code>EncapsulatedKey</code></a> object.\n          It behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>encapsulationAlgorithm</var>, <var>encapsulationKey</var>, <var>sharedKeyAlgorithm</var>,\n              <var>extractable</var> and <var>usages</var> be the <code>encapsulationAlgorithm</code>, <code>encapsulationKey</code>,\n              <code>sharedKeyAlgorithm</code>, <code>extractable</code> and <code>keyUsages</code> parameters passed to the\n              <a data-link-type=\"idl\" data-lt=\"encapsulateKey()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-encapsulateKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-encapsulateKey-4\"><code>encapsulateKey</code></a><code>()</code> method,\n              respectively.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>normalizedEncapsulationAlgorithm</var> be the result of\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n              <code>alg</code> set to <var>encapsulationAlgorithm</var> and <code>op</code> set to\n              \"<code>encapsulate</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, return a Promise rejected with\n              <var>normalizedEncapsulationAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>normalizedSharedKeyAlgorithm</var> be the result of\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n              <code>alg</code> set to <var>sharedKeyAlgorithm</var> and <code>op</code> set to\n              \"<code>importKey</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, return a Promise rejected with\n              <var>normalizedSharedKeyAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>promise</var> be a new Promise.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the following steps or referenced procedures say to\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object,\n              to reject <var>promise</var> with the returned error;\n              and then <a href=\"https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm\">terminate the algorithm</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n              <var>normalizedEncapsulationAlgorithm</var> is not equal to the\n              <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of the\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n              <var>encapsulationKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>encapsulationKey</var> does not contain an entry that is \"<code>encapsulateKey</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>encapsulatedBits</var> be the result of performing the encapsulate operation specified by\n              the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n              <var>encapsulationKey</var> using <var>encapsulationKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>sharedKey</var> be the result of performing the import key operation specified by\n              <var>normalizedSharedKeyAlgorithm</var> using \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-4\"><code>raw-secret</code></a>\" as\n              <var>format</var>, the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedBits-sharedKey\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedBits-sharedKey-1\"><code>sharedKey</code></a> field of\n              <var>encapsulatedBits</var> as <var>keyData</var>, <var>sharedKeyAlgorithm</var> as\n              <var>algorithm</var> and using\n              <var>extractable</var> and <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>sharedKey</var> to <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>sharedKey</var> to the <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-normalized-usages\">normalized value</a>\n              of <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>encapsulatedKey</var> be a new <a data-link-type=\"idl\" data-lt=\"EncapsulatedKey\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedKey\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedKey-3\"><code>EncapsulatedKey</code></a> dictionary\n              with <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedKey-sharedKey\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedKey-sharedKey-1\"><code>sharedKey</code></a> set to <var>sharedKey</var>\n              and <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedKey-ciphertext\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedKey-ciphertext-1\"><code>ciphertext</code></a> set to the\n              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedBits-ciphertext\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedBits-ciphertext-1\"><code>ciphertext</code></a> field of <var>encapsulatedBits</var>.\n            </p>"
        },
        {
          "html": "<p>\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object, to perform the remaining steps.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of converting <var>encapsulatedKey</var> to an ECMAScript Object in <var>realm</var>,\n              as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n            </p>"
        },
        {
          "html": "<p>\n              Resolve <var>promise</var> with\n              <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/encapsulateBits(encapsulationAlgorithm, encapsulationKey)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-encapsulateBits",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-encapsulateBits\" data-dfn-for=\"SubtleCrypto\" data-lt=\"encapsulateBits(encapsulationAlgorithm, encapsulationKey)|encapsulateBits()\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"encapsulateBits(encapsulationAlgorithm, encapsulationKey)\" data-type=\"Promise\" data-local-lt=\"SubtleCrypto.encapsulateBits|SubtleCrypto.encapsulateBits()|encapsulateBits\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>encapsulateBits(<var>encapsulationAlgorithm</var>, <var>encapsulationKey</var>)</code></dfn>\n          method encapsulates a key and returns an <a data-link-type=\"idl\" data-lt=\"EncapsulatedBits\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedBits\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedBits-2\"><code>EncapsulatedBits</code></a> object.\n          It behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>encapsulationAlgorithm</var> and <var>encapsulationKey</var> be the <code>encapsulationAlgorithm</code>\n              and <code>encapsulationKey</code> parameters passed to the\n              <a data-link-type=\"idl\" data-lt=\"encapsulateBits()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-encapsulateBits\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-encapsulateBits-4\"><code>encapsulateBits</code></a><code>()</code> method,\n              respectively.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>normalizedEncapsulationAlgorithm</var> be the result of\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n              <code>alg</code> set to <var>encapsulationAlgorithm</var> and <code>op</code> set to\n              \"<code>encapsulate</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, return a Promise rejected with\n              <var>normalizedEncapsulationAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>promise</var> be a new Promise.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the following steps or referenced procedures say to\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object,\n              to reject <var>promise</var> with the returned error;\n              and then <a href=\"https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm\">terminate the algorithm</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n              <var>normalizedEncapsulationAlgorithm</var> is not equal to the\n              <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of the\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n              <var>encapsulationKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>encapsulationKey</var> does not contain an entry that is \"<code>encapsulateBits</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>encapsulatedBits</var> be the result of performing the encapsulate operation specified by\n              the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n              <var>encapsulationKey</var> using <var>encapsulationKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object, to perform the remaining steps.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of converting <var>encapsulatedBits</var> to an ECMAScript Object in <var>realm</var>,\n              as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n            </p>"
        },
        {
          "html": "<p>\n              Resolve <var>promise</var> with\n              <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-decapsulateKey",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-decapsulateKey\" data-dfn-for=\"SubtleCrypto\" data-lt=\"decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages)|decapsulateKey()|decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, keyUsages)\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"decapsulateKey(decapsulationAlgorithm, decapsulationKey, ciphertext, sharedKeyAlgorithm, extractable, usages)\" data-type=\"Promise\" data-local-lt=\"SubtleCrypto.decapsulateKey|SubtleCrypto.decapsulateKey()|decapsulateKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>decapsulateKey(<var>decapsulationAlgorithm</var>, <var>decapsulationKey</var>, <var>ciphertext</var>, <var>sharedKeyAlgorithm</var>, <var>extractable</var>, <var>usages</var>)</code></dfn>\n          method decapsulates a key and returns an <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object.\n          It behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>decapsulationAlgorithm</var>, <var>decapsulationKey</var>, <var>sharedKeyAlgorithm</var>,\n              <var>extractable</var> and <var>usages</var> be the <code>decapsulationAlgorithm</code>, <code>decapsulationKey</code>, <code>sharedKeyAlgorithm</code>, <code>extractable</code> and <code>keyUsages</code> parameters passed to the\n              <a data-link-type=\"idl\" data-lt=\"decapsulateKey()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-decapsulateKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-decapsulateKey-4\"><code>decapsulateKey</code></a><code>()</code> method,\n              respectively.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>ciphertext</var> be the result of\n              <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>ciphertext</code> parameter passed to the\n              <a data-link-type=\"idl\" data-lt=\"decapsulateKey()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-decapsulateKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-decapsulateKey-5\"><code>decapsulateKey</code></a><code>()</code> method.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>normalizedDecapsulationAlgorithm</var> be the result of\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n              <code>alg</code> set to <var>decapsulationAlgorithm</var> and <code>op</code> set to\n              \"<code>decapsulate</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, return a Promise rejected with\n              <var>normalizedDecapsulationAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>normalizedSharedKeyAlgorithm</var> be the result of\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n              <code>alg</code> set to <var>sharedKeyAlgorithm</var> and <code>op</code> set to\n              \"<code>importKey</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, return a Promise rejected with\n              <var>normalizedSharedKeyAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>promise</var> be a new Promise.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the following steps or referenced procedures say to\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object,\n              to reject <var>promise</var> with the returned error;\n              and then <a href=\"https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm\">terminate the algorithm</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n              <var>normalizedDecapsulationAlgorithm</var> is not equal to the\n              <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of the\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n              <var>decapsulationKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>decapsulationKey</var> does not contain an entry that is \"<code>decapsulateKey</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>decapsulatedBits</var> be the result of performing the decapsulate operation specified by\n              the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of <var>decapsulationKey</var> using <var>decapsulationKey</var> and <var>ciphertext</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>sharedKey</var> be the result of performing the import key operation specified by\n              <var>normalizedSharedKeyAlgorithm</var> using \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-5\"><code>raw-secret</code></a>\" as\n              <var>format</var>, the <var>decapsulatedBits</var> as <var>keyData</var>, <var>sharedKeyAlgorithm</var> as\n              <var>algorithm</var> and using\n              <var>extractable</var> and <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>sharedKey</var> to <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>sharedKey</var> to the <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-normalized-usages\">normalized value</a>\n              of <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object, to perform the remaining steps.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of converting <var>sharedKey</var> to an ECMAScript Object in <var>realm</var>, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n            </p>"
        },
        {
          "html": "<p>\n              Resolve <var>promise</var> with\n              <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-decapsulateBits",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-decapsulateBits\" data-dfn-for=\"SubtleCrypto\" data-lt=\"decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext)|decapsulateBits()\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"decapsulateBits(decapsulationAlgorithm, decapsulationKey, ciphertext)\" data-type=\"Promise\" data-local-lt=\"SubtleCrypto.decapsulateBits|SubtleCrypto.decapsulateBits()|decapsulateBits\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>decapsulateBits(<var>decapsulationAlgorithm</var>, <var>decapsulationKey</var>, <var>ciphertext</var>)</code></dfn>\n          method decapsulates a key and returns an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> object.\n          It behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>decapsulationAlgorithm</var> and <var>decapsulationKey</var> be the <code>decapsulationAlgorithm</code> and <code>decapsulationKey</code> parameters passed to the\n              <a data-link-type=\"idl\" data-lt=\"decapsulateBits()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-decapsulateBits\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-decapsulateBits-4\"><code>decapsulateBits</code></a><code>()</code> method,\n              respectively.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>ciphertext</var> be the result of\n              <a data-link-type=\"dfn\" data-lt=\"get a copy of the buffer source\" href=\"https://webidl.spec.whatwg.org/#dfn-get-buffer-source-copy\">getting a copy of the bytes held by</a> the <code>ciphertext</code> parameter passed to the\n              <a data-link-type=\"idl\" data-lt=\"decapsulateBits()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-decapsulateBits\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-decapsulateBits-5\"><code>decapsulateBits</code></a><code>()</code> method.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>normalizedDecapsulationAlgorithm</var> be the result of\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n              <code>alg</code> set to <var>decapsulationAlgorithm</var> and <code>op</code> set to\n              \"<code>decapsulate</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, return a Promise rejected with\n              <var>normalizedDecapsulationAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>promise</var> be a new Promise.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the following steps or referenced procedures say to\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object,\n              to reject <var>promise</var> with the returned error;\n              and then <a href=\"https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm\">terminate the algorithm</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n              <var>normalizedDecapsulationAlgorithm</var> is not equal to the\n              <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of the\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n              <var>decapsulationKey</var> then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>decapsulationKey</var> does not contain an entry that is \"<code>decapsulateBits</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>decapsulatedBits</var> be the result of performing the decapsulate operation specified by\n              the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of <var>decapsulationKey</var> using <var>decapsulationKey</var> and <var>ciphertext</var>.\n            </p>"
        },
        {
          "html": "<p>\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object, to perform the remaining steps.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a> an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a>\n              in <var>realm</var>, containing <var>decapsulatedBits</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Resolve <var>promise</var> with\n              <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/getPublicKey(key, usages)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-getPublicKey",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-getPublicKey\" data-dfn-for=\"SubtleCrypto\" data-lt=\"getPublicKey(key, usages)|getPublicKey()|getPublicKey(key, keyUsages)\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"getPublicKey(key, usages)\" data-type=\"Promise\" data-local-lt=\"SubtleCrypto.getPublicKey|SubtleCrypto.getPublicKey()|getPublicKey\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>getPublicKey(<var>key</var>, <var>usages</var>)</code></dfn>\n          method returns the public key corresponding to a given private key.\n          It behaves as follows:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>key</var> and <var>usages</var> be the <code>key</code> and <code>keyUsages</code> parameters passed to the\n              <a data-link-type=\"idl\" data-lt=\"getPublicKey()\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-getPublicKey\" class=\"internalDFN\" id=\"ref-for-dfn-SubtleCrypto-method-getPublicKey-3\"><code>getPublicKey</code></a><code>()</code> method,\n              respectively.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of <var>key</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the cryptographic algorithm identified by <var>algorithm</var>\n              does not support deriving a public key from a private key,\n              then return a Promise rejected with a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>realm</var> be the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\">relevant realm</a> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\">this</a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>promise</var> be a new Promise.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>promise</var> and perform the remaining steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\">in parallel</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the following steps or referenced procedures say to\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an error,\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object,\n              to reject <var>promise</var> with the returned error;\n              and then <a href=\"https://www.w3.org/TR/webcrypto-2/#terminate-the-algorithm\">terminate the algorithm</a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If <var>usages</var> contains an entry which is not supported for a public key\n              by the algorithm identified by <var>algorithm</var>,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> representing the public key corresponding to\n              the private key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If an error occurred, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>publicKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>publicKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>publicKey</var> to true.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>publicKey</var> to <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\">Queue a global task</a> on the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-crypto-task-source\">crypto task source</a>,\n              given <var>realm</var>'s global object, to perform the remaining steps.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of converting <var>publicKey</var> to an ECMAScript Object in <var>realm</var>, as defined by [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-webidl\" title=\"Web IDL Standard\">WebIDL</a></cite>].\n            </p>"
        },
        {
          "html": "<p>\n              Resolve <var>promise</var> with\n              <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/supports(operation, algorithm, length)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-supports",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-supports\" data-dfn-for=\"SubtleCrypto\" data-lt=\"supports(operation, algorithm, length)|supports()|supports(operation, algorithm)\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"supports(operation, algorithm, length)\" data-type=\"boolean\" data-local-lt=\"SubtleCrypto.supports|SubtleCrypto.supports()|supports\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>supports(<var>operation</var>, <var>algorithm</var>, <var>length</var>)</code></dfn>\n          method returns a boolean indicating whether the implementation\n          supports the given operation using the specified <a data-link-type=\"typedef\" data-lt=\"AlgorithmIdentifier\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier\"><code>AlgorithmIdentifier</code></a>,\n          with an optional <code>length</code> parameter to indicate the number of bits to be derived when <code>operation</code> is \"<code>deriveBits</code>\".\n          It behaves as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>operation</var> is not one of\n              \"<code>encrypt</code>\", \"<code>decrypt</code>\", \"<code>sign</code>\", \"<code>verify</code>\",\n              \"<code>digest</code>\", \"<code>generateKey</code>\", \"<code>deriveKey</code>\", \"<code>deriveBits</code>\",\n              \"<code>importKey</code>\", \"<code>exportKey</code>\", \"<code>wrapKey</code>\", \"<code>unwrapKey</code>\",\n              \"<code>encapsulateKey</code>\", \"<code>encapsulateBits</code>\",\n              \"<code>decapsulateKey</code>\", \"<code>decapsulateBits</code>\" or \"<code>getPublicKey</code>\",\n              return false.\n            </p>"
        },
        {
          "html": "<p>\n              Return the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-1\">checking support for an algorithm</a>,\n              with <code>op</code> set to <var>operation</var>, <code>alg</code> set to <var>algorithm</var>,\n              and <code>length</code> set to <var>length</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "SubtleCrypto/supports(operation, algorithm, additionalAlgorithm)",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-SubtleCrypto-method-supports-additionalAlgorithm",
      "html": "The <dfn id=\"dfn-SubtleCrypto-method-supports-additionalAlgorithm\" data-dfn-for=\"SubtleCrypto\" data-lt=\"supports(operation, algorithm, additionalAlgorithm)|supports!overload-1()|supports!overload-1(operation, algorithm, additionalAlgorithm)\" data-export=\"\" data-dfn-type=\"method\" data-idl=\"operation\" data-title=\"supports(operation, algorithm, additionalAlgorithm)\" data-type=\"boolean\" data-local-lt=\"SubtleCrypto.supports!overload-1|SubtleCrypto.supports!overload-1()|supports!overload-1\" tabindex=\"0\" aria-haspopup=\"dialog\"><code>supports(<var>operation</var>, <var>algorithm</var>, <var>additionalAlgorithm</var>)</code></dfn>\n          method returns a boolean indicating whether the implementation\n          supports the given operation using the specified <a data-link-type=\"typedef\" data-lt=\"AlgorithmIdentifier\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier\"><code>AlgorithmIdentifier</code></a>.\n          The additional algorithm indicates the type of key to be derived when <code>operation</code> is \"<code>deriveKey</code>\",\n          the type of key to be exported before wrapping when <code>operation</code> is \"<code>wrapKey</code>\",\n          and the type of key to be imported after unwrapping when <code>operation</code> is \"<code>unwrapKey</code>\".\n          It behaves as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>operation</var> is not one of\n              \"<code>encrypt</code>\", \"<code>decrypt</code>\", \"<code>sign</code>\", \"<code>verify</code>\",\n              \"<code>digest</code>\", \"<code>generateKey</code>\", \"<code>deriveKey</code>\", \"<code>deriveBits</code>\",\n              \"<code>importKey</code>\", \"<code>exportKey</code>\", \"<code>wrapKey</code>\", \"<code>unwrapKey</code>\",\n              \"<code>encapsulateKey</code>\", \"<code>encapsulateBits</code>\",\n              \"<code>decapsulateKey</code>\", \"<code>decapsulateBits</code>\" or \"<code>getPublicKey</code>\",\n              return false.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>operation</var> is \"<code>deriveKey</code>\", \"<code>unwrapKey</code>\", \"<code>encapsulateKey</code>\" or \"<code>decapsulateKey</code>\":</dt>\n              <dd>\n                <p>\n                  If the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-2\">checking support for an algorithm</a>\n                  with <code>op</code> set to \"<code>importKey</code>\"\n                  and <code>alg</code> set to <var>additionalAlgorithm</var>\n                  is false,\n                  return false.\n                </p>\n              </dd>\n              <dt>If <var>operation</var> is \"<code>wrapKey</code>\":</dt>\n              <dd>\n                <p>\n                  If the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-3\">checking support for an algorithm</a>\n                  with <code>op</code> set to \"<code>exportKey</code>\"\n                  and <code>alg</code> set to <var>additionalAlgorithm</var>\n                  is false,\n                  return false.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If operation is \"deriveKey\", \"unwrapKey\", \"encapsulateKey\" or \"decapsulateKey\":",
                  "html": "<p>\n                  If the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-2\">checking support for an algorithm</a>\n                  with <code>op</code> set to \"<code>importKey</code>\"\n                  and <code>alg</code> set to <var>additionalAlgorithm</var>\n                  is false,\n                  return false.\n                </p>"
                },
                {
                  "case": "If operation is \"wrapKey\":",
                  "html": "<p>\n                  If the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-3\">checking support for an algorithm</a>\n                  with <code>op</code> set to \"<code>exportKey</code>\"\n                  and <code>alg</code> set to <var>additionalAlgorithm</var>\n                  is false,\n                  return false.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>length</var> be null.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>operation</var> is \"<code>deriveKey</code>\":</dt>\n              <dd>\n                \n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If operation is \"deriveKey\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-4\">checking support for an algorithm</a>\n                      with <code>op</code> set to \"<code>get key length</code>\"\n                      and <code>alg</code> set to <var>additionalAlgorithm</var>\n                      is false,\n                      return false.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>normalizedAdditionalAlgorithm</var> be the result of\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                      <code>alg</code> set to <var>additionalAlgorithm</var> and <code>op</code> set to\n                      \"<code>get key length</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>length</var> be the result of performing the get key length\n                      algorithm specified by <var>additionalAlgorithm</var> using\n                      <var>normalizedAdditionalAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set <var>operation</var> to \"<code>deriveBits</code>\".\n                    </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-5\">checking support for an algorithm</a>,\n              with <code>op</code> set to <var>operation</var>, <code>alg</code> set to <var>algorithm</var>,\n              and <code>length</code> set to <var>length</var>.\n            </p>"
        }
      ]
    },
    {
      "name": "check support for an algorithm",
      "href": "https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm",
      "html": "The <dfn id=\"dfn-check-support-for-algorithm\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\">check support for an algorithm</dfn> algorithm\n        defines a process for checking whether the given algorithm is supported for the given operation.\n        Its input is an operation name <var>op</var>, an <a data-link-type=\"typedef\" data-lt=\"AlgorithmIdentifier\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithmidentifier\"><code>AlgorithmIdentifier</code></a> <var>alg</var>,\n        and a <var>length</var> parameter. Its output is a boolean.\n        It behaves as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n            If <var>op</var> is \"<code>encapsulateKey</code>\" or \"<code>encapsulateBits</code>\", set <var>op</var> to \"<code>encapsulate</code>\".\n          </p>"
        },
        {
          "html": "<p>\n            If <var>op</var> is \"<code>decapsulateKey</code>\" or \"<code>decapsulateBits</code>\", set <var>op</var> to \"<code>decapsulate</code>\".\n          </p>"
        },
        {
          "html": "<dl class=\"switch\">\n            <dt>If <var>op</var> is \"<code>getPublicKey</code>\":</dt>\n            <dd>\n              \n            </dd>\n          </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If op is \"getPublicKey\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                    Let <var>normalizedAlgorithm</var> be the result of\n                    <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n                    <code>alg</code> set to <var>alg</var> and <code>op</code> set to \"<code>exportKey</code>\".\n                  </p>"
                    },
                    {
                      "html": "<p>\n                    If an error occurred, return false.\n                  </p>"
                    },
                    {
                      "html": "<p>\n                    If the cryptographic algorithm identified by <var>normalizedAlgorithm</var>\n                    does not support deriving a public key from a private key,\n                    then return false.\n                  </p>"
                    },
                    {
                      "html": "<p>\n                    Otherwise, return true.\n                  </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n            Let <var>normalizedAlgorithm</var> be the result of\n            <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-normalize-an-algorithm\">normalizing an algorithm</a>, with\n            <code>alg</code> set to <var>alg</var> and <code>op</code> set to <var>op</var>.\n          </p>"
        },
        {
          "html": "<dl class=\"switch\">\n            <dt>If an error occurred:</dt>\n            <dd>\n              \n            </dd>\n          </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If an error occurred:",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                    If <var>op</var> is \"<code>wrapKey</code>\",\n                    return the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-6\">checking support for an algorithm</a>\n                    with <code>op</code> set to \"<code>encrypt</code>\"\n                    and <code>alg</code> set to <var>alg</var>.\n                  </p>"
                    },
                    {
                      "html": "<p>\n                    If <var>op</var> is \"<code>unwrapKey</code>\",\n                    return the result of <a data-link-type=\"dfn|abstract-op\" data-lt=\"check support for an algorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-check-support-for-algorithm\" class=\"internalDFN\" id=\"ref-for-dfn-check-support-for-algorithm-7\">checking support for an algorithm</a>\n                    with <code>op</code> set to \"<code>decrypt</code>\"\n                    and <code>alg</code> set to <var>alg</var>.\n                  </p>"
                    },
                    {
                      "html": "<p>\n                    Otherwise, return false.\n                  </p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n            If the specified operation or algorithm (or one of its parameter values)\n            is expected to fail (for any key and/or data) for an implementation-specific reason\n            (e.g. known nonconformance to the specification), return false.\n          </p>"
        },
        {
          "html": "<p>\n            If <var>op</var> is \"<code>generateKey</code>\" or \"<code>importKey</code>\", let <var>usages</var> be the empty list.\n          </p>"
        },
        {
          "html": "For each of the steps of the operation specified by <var>op</var>\n            of the algorithm specified by <var>normalizedAlgorithm</var>:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the step says to throw an error:",
                  "html": "Return false."
                },
                {
                  "case": "If the step says to generate a key:",
                  "html": "Return true."
                },
                {
                  "case": "If the step relies on an unavailable parameter, such as key, plaintext or ciphertext:",
                  "html": "Return true."
                },
                {
                  "case": "If the step says to return a value:",
                  "html": "Return true."
                },
                {
                  "case": "Otherwise:",
                  "html": "Execute the step."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n            <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\">Assert</a>: this step is never reached,\n            because one of the steps of the operation will have said\n            to return a value or throw an error, causing us to return\n            true or false, respectively.\n          </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Perform the encapsulation key check described in\n              Section 7.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-203\" title=\"Module-Lattice-Based Key-Encapsulation Mechanism Standard\">FIPS-203</a></cite>] with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>algorithm</var>,\n              using the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the <var class=\"overline\">ek</var> input parameter.\n            </p>"
        },
        {
          "html": "<p>\n              If the encapsulation key check failed, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>sharedKey</var> and <var>ciphertext</var> be the outputs that result\n              from performing the ML-KEM.Encaps function described in\n              Section 7.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-203\" title=\"Module-Lattice-Based Key-Encapsulation Mechanism Standard\">FIPS-203</a></cite>] with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>algorithm</var>,\n              using the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the <var>ek</var> input parameter.\n            </p>"
        },
        {
          "html": "<p>\n              If the ML-KEM.Encaps function returned an error, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be a new <a data-link-type=\"idl\" data-lt=\"EncapsulatedBits\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedBits\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedBits-5\"><code>EncapsulatedBits</code></a>\n              dictionary.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedBits-sharedKey\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedBits-sharedKey-3\"><code>sharedKey</code></a> attribute\n              of <var>result</var> to the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a>\n              an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> containing <var>sharedKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-EncapsulatedBits-ciphertext\" class=\"internalDFN\" id=\"ref-for-dfn-EncapsulatedBits-ciphertext-3\"><code>ciphertext</code></a> attribute\n              of <var>result</var> to the result of <a data-link-type=\"dfn\" data-lt=\"create\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-create\">creating</a>\n              an <a data-link-type=\"interface\" data-lt=\"ArrayBuffer\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\"><code>ArrayBuffer</code></a> containing <var>ciphertext</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Perform the decapsulation input check described in\n              Section 7.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-203\" title=\"Module-Lattice-Based Key-Encapsulation Mechanism Standard\">FIPS-203</a></cite>] with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>algorithm</var>,\n              using the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the <var class=\"overline\">dk</var> input parameter, and\n              <var>ciphertext</var> as the <var class=\"overline\">c</var> input parameter.\n            </p>"
        },
        {
          "html": "<p>\n              If the decapsulation key check failed, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>sharedKey</var> be the output that results\n              from performing the ML-KEM.Decaps function described in\n              Section 7.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-203\" title=\"Module-Lattice-Based Key-Encapsulation Mechanism Standard\">FIPS-203</a></cite>] with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>algorithm</var>,\n              using the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the <var>dk</var> input parameter, and\n              <var>ciphertext</var> as the <var>c</var> input parameter.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>sharedKey</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>usages</var> contains any entry which is not\n              one of \"<code>encapsulateKey</code>\", \"<code>encapsulateBits</code>\",\n              \"<code>decapsulateKey</code>\" or \"<code>decapsulateBits</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Generate an ML-KEM key pair, as described in\n              Section 7.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-203\" title=\"Module-Lattice-Based Key-Encapsulation Mechanism Standard\">FIPS-203</a></cite>], with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the key generation step fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing the encapsulation key of the generated key pair.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>publicKey</var> to \"<code>public</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>publicKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>publicKey</var> to true.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>publicKey</var> to be the\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection\">usage intersection</a> of\n              <var>usages</var> and <code>[ \"encapsulateKey\", \"encapsulateBits\" ]</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing the decapsulation key of the generated key pair.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>privateKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>privateKey</var> to <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>privateKey</var> to be the\n              <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection\">usage intersection</a> of\n              <var>usages</var> and <code>[ \"decapsulateKey\", \"decapsulateBits\" ]</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n              dictionary.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n              of <var>result</var> to be <var>publicKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n              of <var>result</var> to be <var>privateKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-1\"><code>spki</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-1\"><code>pkcs8</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-public\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-public-3\"><code>raw-public</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-seed\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-seed-2\"><code>raw-seed</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-1\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains an entry which is not\n                      \"<code>encapsulateKey</code>\" or \"<code>encapsulateBits</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>spki</var> be the result of running the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                      algorithm over <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurred while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-512</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-768</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-1024</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3).\n                        </p>\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-512\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-768\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-1024\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3).\n                        </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <code>algorithm</code> object identifier field of the\n                      <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                      not equal to <var>expectedOid</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <code>parameters</code> field of the <code>algorithm</code>\n                      AlgorithmIdentifier field of <var>spki</var> is present,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>publicKey</var> be the ML-KEM public key identified by\n                      the <code>subjectPublicKey</code> field of <var>spki</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents <var>publicKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<code>public</code>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains an entry which is not\n                      \"<code>decapsulateKey</code>\" or \"<code>decapsulateBits</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>privateKeyInfo</var> be the result of running the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                      algorithm over <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurs while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-512</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-512-PrivateKey</code> structure.\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-768</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-768-PrivateKey</code> structure.\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-1024</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-1024-PrivateKey</code> structure.\n                        </p>\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-512\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-512-PrivateKey</code> structure.\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-768\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-768-PrivateKey</code> structure.\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-1024\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-KEM-1024-PrivateKey</code> structure.\n                        </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <code>algorithm</code> object identifier field of the\n                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                      <var>privateKeyInfo</var> is not equal to <var>expectedOid</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <code>parameters</code> field of the\n                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                      of <var>privateKeyInfo</var> is present,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>mlKemPrivateKey</var> be the result of performing the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                      algorithm, with <var>data</var> as the <code>privateKey</code> field\n                      of <var>privateKeyInfo</var>, <var>structure</var> as <var>asn1Structure</var>, and <var>exactData</var> set to true.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurred while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents the ML-KEM private key identified by <var>mlKemPrivateKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-public\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains an entry which is not\n                      \"<code>encapsulateKey</code>\" or \"<code>encapsulateBits</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents the ML-KEM public key data in <var>data</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-seed\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains an entry which is not\n                      \"<code>decapsulateKey</code>\" or \"<code>decapsulateBits</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the length in bits of <var>data</var> is not 512\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>privateKey</var> be the result of performing the\n                      ML-KEM.KeyGen_internal function described in\n                      Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-203\" title=\"Module-Lattice-Based Key-Encapsulation Mechanism Standard\">FIPS-203</a></cite>] with the parameter set\n                      indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n                      using the first 256 bits of <var>data</var> as <var>d</var> and\n                      the last 256 bits of <var>data</var> as <var>z</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents the ML-KEM private key identified by <var>privateKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                      <dt>Otherwise:</dt>\n                      <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-1\"><code>priv</code></a> field of <var>jwk</var> is present\n                      and if <var>usages</var> contains an entry which is not\n                      \"<code>decapsulateKey</code>\" or \"<code>decapsulateBits</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-2\"><code>priv</code></a> field of <var>jwk</var> is not present\n                      and if <var>usages</var> contains an entry which is not\n                      \"<code>encapsulateKey</code>\" or \"<code>encapsulateBits</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                      \"<code>AKP</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is not\n                      one of the <code>alg</code> values corresponding to the\n                      <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>\n                      indicated in Section 8 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-draft-ietf-jose-pqc-kem-01\" title=\"Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE\">draft-ietf-jose-pqc-kem-01</a></cite>]\n                      (Figure 1 or 2), then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present\n                      and is not equal to \"<code>enc</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                      is invalid according to the requirements of JSON Web\n                      Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                      values,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                      has the value false and <var>extractable</var> is true,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-3\"><code>priv</code></a> field of <var>jwk</var> is present:</dt>\n                      <dd>\n                        \n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        \n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the priv field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-4\"><code>priv</code></a> attribute of <var>jwk</var>\n                              does not contain a valid base64url encoded seed\n                              representing an ML-KEM private key,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                              ML-KEM private key identified by interpreting the\n                              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-5\"><code>priv</code></a> attribute of <var>jwk</var>\n                              as a base64url encoded seed.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a>\n                              internal slot of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-1\"><code>pub</code></a> attribute of <var>jwk</var>\n                              does not contain the base64url encoded public key\n                              representing the ML-KEM public key\n                              corresponding to <var>key</var>,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-2\"><code>pub</code></a> attribute of <var>jwk</var>\n                              does not contain a valid base64url encoded public key\n                              representing an ML-KEM public key,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                              ML-KEM public key identified by interpreting the\n                              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-3\"><code>pub</code></a> attribute of <var>jwk</var>\n                              as a base64url encoded public key.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a>\n                              internal slot of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                            </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-2\"><code>spki</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-2\"><code>pkcs8</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-public\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-public-4\"><code>raw-public</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-seed\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-seed-3\"><code>raw-seed</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-2\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                      ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                      with the following properties:\n                    </p>\n                    <ul>\n                      <li>\n                        <p>\n                          Set the <var>algorithm</var> field to an\n                          <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                          properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-512</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-768</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-1024</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3) OID.\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                        </p>\n                      </li>\n                    </ul>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-512\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-768\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-1024\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3) OID.\n                                </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                      ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                      with the following properties:\n                    </p>\n                    <ul>\n                      <li>\n                        <p>\n                          Set the <var>version</var> field to <code>0</code>.\n                        </p>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>privateKeyAlgorithm</var> field to a\n                          <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                          following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-512</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-768</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-1024</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3) OID.\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>privateKey</var> field as follows:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-512</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-KEM-512-PrivateKey</code> ASN.1 type that represents the ML-KEM\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-768</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-KEM-768-PrivateKey</code> ASN.1 type that represents the ML-KEM\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-KEM-1024</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-KEM-1024-PrivateKey</code> ASN.1 type that represents the ML-KEM\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                    </ul>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-512\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-512</code> (2.16.840.1.101.3.4.4.1) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-768\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-768</code> (2.16.840.1.101.3.4.4.2) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-KEM-1024\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-alg-ml-kem-1024</code> (2.16.840.1.101.3.4.4.3) OID.\n                                </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                            }
                          ]
                        }
                      ],
                      "additional": [
                        {
                          "html": "",
                          "rationale": ".switch",
                          "steps": [
                            {
                              "operation": "switch",
                              "steps": [
                                {
                                  "case": "If the name member of normalizedAlgorithm is \"ML-KEM-512\":",
                                  "html": "<p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-KEM-512-PrivateKey</code> ASN.1 type that represents the ML-KEM\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>"
                                },
                                {
                                  "case": "If the name member of normalizedAlgorithm is \"ML-KEM-768\":",
                                  "html": "<p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-KEM-768-PrivateKey</code> ASN.1 type that represents the ML-KEM\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>"
                                },
                                {
                                  "case": "If the name member of normalizedAlgorithm is \"ML-KEM-1024\":",
                                  "html": "<p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-KEM-1024-PrivateKey</code> ASN.1 type that represents the ML-KEM\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>"
                                },
                                {
                                  "case": "Otherwise:",
                                  "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-public\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                      the raw octets of the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-seed\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>private</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing the concatenation of the <var>d</var> and <var>z</var>\n                      seed variables of the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                      internal slot of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                      dictionary.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>kty</code> attribute of <var>jwk</var> to\n                      \"<code>AKP</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the <code>alg</code> value corresponding to the\n                      <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>\n                      indicated in Section 8 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-draft-ietf-jose-pqc-kem-01\" title=\"Post-Quantum Key Encapsulation Mechanisms (PQ KEMs) for JOSE and COSE\">draft-ietf-jose-pqc-kem-01</a></cite>]\n                      (Figure 1).\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-4\"><code>pub</code></a> attribute of <var>jwk</var>\n                      to the base64url encoded public key corresponding\n                      to the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                      internal slot of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                        of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\":\n                      </dt>\n                      <dd>\n                        Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-6\"><code>priv</code></a> attribute of <var>jwk</var>\n                        to the base64url encoded seed represented by\n                        the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                        internal slot of <var>key</var>.\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-6\"><code>priv</code></a> attribute of <var>jwk</var>\n                        to the base64url encoded seed represented by\n                        the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                        internal slot of <var>key</var>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal slot\n                      of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>jwk</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>context</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-2\"><code>context</code></a> member of <var>normalizedAlgorithm</var>\n              or the empty octet string if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-3\"><code>context</code></a> member of\n              <var>normalizedAlgorithm</var> is not present.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of performing the ML-DSA.Sign\n              signing algorithm, as specified in Section 5.2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-204\" title=\"Module-Lattice-Based Digital Signature Standard\">FIPS-204</a></cite>],\n              with the parameter set indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n              using the ML-DSA private key associated with <var>key</var> as <var>sk</var>,\n              <var>message</var> as <var>M</var> and <var>context</var> as <var>ctx</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the ML-DSA.Sign algorithm returned an error, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>context</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-4\"><code>context</code></a> member of <var>normalizedAlgorithm</var>\n              or the empty octet string if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-5\"><code>context</code></a> member of\n              <var>normalizedAlgorithm</var> is not present.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of performing the ML-DSA.Verify\n              verification algorithm, as specified in Section 5.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-204\" title=\"Module-Lattice-Based Digital Signature Standard\">FIPS-204</a></cite>],\n              with the parameter set indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n              using the ML-DSA public key associated with <var>key</var> as <var>pk</var>,\n              <var>message</var> as <var>M</var>, <var>signature</var> as <var></var> and <var>context</var> as <var>ctx</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the ML-DSA.Verify algorithm returned an error, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>usages</var> contains a value which is not\n              one of \"<code>sign</code>\" or \"<code>verify</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Generate an ML-DSA key pair, as described in\n              Section 5.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-204\" title=\"Module-Lattice-Based Digital Signature Standard\">FIPS-204</a></cite>], with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the key generation step fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing the public key of the generated key pair.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>publicKey</var> to \"<code>public</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>publicKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>publicKey</var> to true.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection\">usage intersection</a>\n              of <var>usages</var> and <code>[ \"verify\" ]</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing the private key of the generated key pair.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>privateKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>privateKey</var> to <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection\">usage intersection</a>\n              of <var>usages</var> and <code>[ \"sign\" ]</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n              dictionary.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n              of <var>result</var> to be <var>publicKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n              of <var>result</var> to be <var>privateKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-3\"><code>spki</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-3\"><code>pkcs8</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-public\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-public-5\"><code>raw-public</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-seed\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-seed-4\"><code>raw-seed</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-3\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains a value which is not\n                      \"<code>verify</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>spki</var> be the result of running the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                      algorithm over <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurred while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-44</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-65</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-87</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19).\n                        </p>\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-44\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-65\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-87\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19).\n                        </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <code>algorithm</code> object identifier field of the\n                      <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                      not equal to <var>expectedOid</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <code>parameters</code> field of the <code>algorithm</code>\n                      AlgorithmIdentifier field of <var>spki</var> is present,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>publicKey</var> be the ML-DSA public key identified by\n                      the <code>subjectPublicKey</code> field of <var>spki</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents <var>publicKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<code>public</code>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains a value which is not\n                      \"<code>sign</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>privateKeyInfo</var> be the result of running the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                      algorithm over <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurs while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-44</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-44-PrivateKey</code> structure.\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-65</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-65-PrivateKey</code> structure.\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-87</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-87-PrivateKey</code> structure.\n                        </p>\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-44\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-44-PrivateKey</code> structure.\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-65\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-65-PrivateKey</code> structure.\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-87\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19).\n                        </p>\n                        <p>\n                          Let <var>asn1Structure</var> be the ASN.1 <code>ML-DSA-87-PrivateKey</code> structure.\n                        </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <code>algorithm</code> object identifier field of the\n                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                      <var>privateKeyInfo</var> is not equal to <var>expectedOid</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <code>parameters</code> field of the\n                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                      of <var>privateKeyInfo</var> is present,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>mlDsaPrivateKey</var> be the result of performing the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                      algorithm, with <var>data</var> as the <code>privateKey</code> field\n                      of <var>privateKeyInfo</var>, <var>structure</var> as <var>asn1Structure</var>, and <var>exactData</var> set to true.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurred while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents the ML-DSA private key identified by <var>mlDsaPrivateKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-public\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains a value which is not\n                      \"<code>verify</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      representing the key data provided in <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<code>public</code>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-seed\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains an entry which is not\n                      \"<code>sign</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the length in bits of <var>data</var> is not 256\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>privateKey</var> be the result of performing the\n                      ML-DSA.KeyGen_internal function described in\n                      Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-204\" title=\"Module-Lattice-Based Digital Signature Standard\">FIPS-204</a></cite>] with the parameter set\n                      indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n                      using <var>data</var> as <var></var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents the ML-DSA private key identified by <var>privateKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                      <dt>Otherwise:</dt>\n                      <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-7\"><code>priv</code></a> field is present\n                      and <var>usages</var> contains a value which is not\n                      \"<code>sign</code>\", or,\n                      if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-8\"><code>priv</code></a> field is not present\n                      and <var>usages</var> contains a value which is not\n                      \"<code>verify</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                      \"<code>AKP</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is not equal to\n                      the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present\n                      and is not equal to \"<code>sig</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                      is invalid according to the requirements of JSON Web\n                      Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                      values,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                      has the value false and <var>extractable</var> is true,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-9\"><code>priv</code></a> field of <var>jwk</var> is present:</dt>\n                      <dd>\n                        \n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        \n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the priv field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-10\"><code>priv</code></a> attribute of <var>jwk</var>\n                              does not contain a valid base64url encoded seed\n                              representing an ML-DSA private key,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                              ML-DSA private key identified by interpreting the\n                              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-11\"><code>priv</code></a> attribute of <var>jwk</var>\n                              as a base64url encoded seed.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a>\n                              internal slot of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-5\"><code>pub</code></a> attribute of <var>jwk</var>\n                              does not contain the base64url encoded public key\n                              representing the ML-DSA public key\n                              corresponding to <var>key</var>,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-6\"><code>pub</code></a> attribute of <var>jwk</var>\n                              does not contain a valid base64url encoded public key\n                              representing an ML-DSA public key,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                              ML-DSA public key identified by interpreting the\n                              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-7\"><code>pub</code></a> attribute of <var>jwk</var>\n                              as a base64url encoded public key.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a>\n                              internal slot of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                            </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>key</var>\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>key</var> be the <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> to be\n              exported.\n            </p>"
        },
        {
          "html": "<p>\n              If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-4\"><code>spki</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-4\"><code>pkcs8</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>\n                If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-public\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-public-6\"><code>raw-public</code></a>\":\n              </dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-seed\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-seed-5\"><code>raw-seed</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-4\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                      ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                      with the following properties:\n                    </p>\n                    <ul>\n                      <li>\n                        <p>\n                          Set the <var>algorithm</var> field to an\n                          <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                          properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-44</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-65</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-87</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19) OID.\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                        </p>\n                      </li>\n                    </ul>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-44\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-65\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-87\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19) OID.\n                                </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                      ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                      with the following properties:\n                    </p>\n                    <ul>\n                      <li>\n                        <p>\n                          Set the <var>version</var> field to <code>0</code>.\n                        </p>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>privateKeyAlgorithm</var> field to a\n                          <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                          following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-44</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-65</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-87</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19) OID.\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>privateKey</var> field as follows:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-44</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-DSA-44-PrivateKey</code> ASN.1 type that represents the ML-DSA\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-65</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-DSA-65-PrivateKey</code> ASN.1 type that represents the ML-DSA\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>ML-DSA-87</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-DSA-87-PrivateKey</code> ASN.1 type that represents the ML-DSA\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                    </ul>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-44\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-44</code> (2.16.840.1.101.3.4.3.17) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-65\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-65</code> (2.16.840.1.101.3.4.3.18) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"ML-DSA-87\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-ml-dsa-87</code> (2.16.840.1.101.3.4.3.19) OID.\n                                </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                            }
                          ]
                        }
                      ],
                      "additional": [
                        {
                          "html": "",
                          "rationale": ".switch",
                          "steps": [
                            {
                              "operation": "switch",
                              "steps": [
                                {
                                  "case": "If the name member of normalizedAlgorithm is \"ML-DSA-44\":",
                                  "html": "<p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-DSA-44-PrivateKey</code> ASN.1 type that represents the ML-DSA\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>"
                                },
                                {
                                  "case": "If the name member of normalizedAlgorithm is \"ML-DSA-65\":",
                                  "html": "<p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-DSA-65-PrivateKey</code> ASN.1 type that represents the ML-DSA\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>"
                                },
                                {
                                  "case": "If the name member of normalizedAlgorithm is \"ML-DSA-87\":",
                                  "html": "<p>\n                                  Set the <var>privateKey</var> field to the result of DER-encoding\n                                  a <code>ML-DSA-87-PrivateKey</code> ASN.1 type that represents the ML-DSA\n                                  private key seed represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                                  internal slot of <var>key</var> using the seed-only format (using a context-specific [0] primitive tag\n                                  with an implicit encoding of OCTET STRING).\n                                </p>"
                                },
                                {
                                  "case": "Otherwise:",
                                  "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-public\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing the ML-DSA\n                      public key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-seed\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>private</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing the <var></var> seed variable\n                      of the key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                      internal slot of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                      dictionary.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>kty</code> attribute of <var>jwk</var> to\n                      \"<code>AKP</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-8\"><code>pub</code></a> attribute of <var>jwk</var>\n                      to the base64url encoded public key corresponding\n                      to the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                      internal slot of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                        of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\":\n                      </dt>\n                      <dd>\n                        Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-12\"><code>priv</code></a> attribute of <var>jwk</var>\n                        to the base64url encoded seed represented by\n                        the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                        internal slot of <var>key</var>.\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-12\"><code>priv</code></a> attribute of <var>jwk</var>\n                        to the base64url encoded seed represented by\n                        the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                        internal slot of <var>key</var>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal slot\n                      of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>jwk</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>context</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-6\"><code>context</code></a> member of <var>normalizedAlgorithm</var>\n              or the empty octet string if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-7\"><code>context</code></a> member of\n              <var>normalizedAlgorithm</var> is not present.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of performing the <code>slh_sign</code>\n              signing algorithm, as specified in Section 10.2.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-205\" title=\"Stateless Hash-Based Digital Signature Standard\">FIPS-205</a></cite>],\n              with the parameter set indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n              using the SLH-DSA private key associated with <var>key</var> as <var>SK</var>,\n              <var>message</var> as <var>M</var> and <var>context</var> as <var>ctx</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <code>slh_sign</code> algorithm returned an error, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>context</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-8\"><code>context</code></a> member of <var>normalizedAlgorithm</var>\n              or the empty octet string if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-ContextParams-context\" class=\"internalDFN\" id=\"ref-for-dfn-ContextParams-context-9\"><code>context</code></a> member of\n              <var>normalizedAlgorithm</var> is not present.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of performing the <code>slh_verify</code>\n              verification algorithm, as specified in Section 10.3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-205\" title=\"Stateless Hash-Based Digital Signature Standard\">FIPS-205</a></cite>],\n              with the parameter set indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n              using the SLH-DSA public key associated with <var>key</var> as <var>PK</var>,\n              <var>message</var> as <var>M</var>, <var>signature</var> as <var>SIG</var> and <var>context</var> as <var>ctx</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <code>slh_verify</code> algorithm returned an error, return an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>usages</var> contains a value which is not\n              one of \"<code>sign</code>\" or \"<code>verify</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Generate an SLH-DSA key pair, as described in\n              Section 10.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-205\" title=\"Stateless Hash-Based Digital Signature Standard\">FIPS-205</a></cite>], with the parameter set\n              indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the key generation step fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>publicKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing the public key of the generated key pair.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>publicKey</var> to \"<code>public</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>publicKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>publicKey</var> to true.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>publicKey</var> to be the <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection\">usage intersection</a>\n              of <var>usages</var> and <code>[ \"verify\" ]</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>privateKey</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing the private key of the generated key pair.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>privateKey</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>privateKey</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>privateKey</var> to <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>privateKey</var> to be the <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-usage-intersection\">usage intersection</a>\n              of <var>usages</var> and <code>[ \"sign\" ]</code>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be a new <a data-link-type=\"dictionary\" data-lt=\"CryptoKeyPair\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair\"><code>CryptoKeyPair</code></a>\n              dictionary.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-publicKey\"><code>publicKey</code></a> attribute\n              of <var>result</var> to be <var>publicKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKeyPair-privateKey\"><code>privateKey</code></a> attribute\n              of <var>result</var> to be <var>privateKey</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-5\"><code>spki</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-5\"><code>pkcs8</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-public\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-public-7\"><code>raw-public</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-private\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-private-2\"><code>raw-private</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-5\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains a value which is not\n                      \"<code>verify</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>spki</var> be the result of running the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-a-spki\">parse a subjectPublicKeyInfo</a>\n                      algorithm over <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurred while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31).\n                        </p>\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31).\n                        </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <code>algorithm</code> object identifier field of the\n                      <code>algorithm</code> AlgorithmIdentifier field of <var>spki</var> is\n                      not equal to <var>expectedOid</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <code>parameters</code> field of the <code>algorithm</code>\n                      AlgorithmIdentifier field of <var>spki</var> is present,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>publicKey</var> be the SLH-DSA public key identified by\n                      the <code>subjectPublicKey</code> field of <var>spki</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents <var>publicKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<code>public</code>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains a value which is not\n                      \"<code>sign</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>privateKeyInfo</var> be the result of running the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-a-privateKeyInfo\">parse a privateKeyInfo</a>\n                      algorithm over <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurs while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256s</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30).\n                        </p>\n                      </dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256f</code>\":</dt>\n                      <dd>\n                        <p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31).\n                        </p>\n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256s\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30).\n                        </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256f\":",
                              "html": "<p>\n                          Let <var>expectedOid</var> be <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31).\n                        </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                          <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                        </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <code>algorithm</code> object identifier field of the\n                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithm field of\n                      <var>privateKeyInfo</var> is not equal to <var>expectedOid</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <code>parameters</code> field of the\n                      <code>privateKeyAlgorithm</code> PrivateKeyAlgorithmIdentifier field\n                      of <var>privateKeyInfo</var> is present,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>slhDsaPrivateKey</var> be the result of performing the\n                      <a href=\"https://www.w3.org/TR/webcrypto-2/#concept-parse-an-asn1-structure\">parse an ASN.1 structure</a>\n                      algorithm, with <var>data</var> as the <code>privateKey</code> field\n                      of <var>privateKeyInfo</var>, <var>structure</var> as OCTET STRING, and <var>exactData</var> set to true.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If an error occurred while parsing,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      that represents the SLH-DSA private key identified by <var>slhDsaPrivateKey</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-public\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains a value which is not\n                      \"<code>verify</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of <var>keyData</var> is not the <code>pk length</code>\n                      specified by Table 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-205\" title=\"Stateless Hash-Based Digital Signature Standard\">FIPS-205</a></cite>]\n                      for the parameter set indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      representing the key data provided in <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<code>public</code>\"\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-private\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If <var>usages</var> contains an entry which is not\n                      \"<code>sign</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\">length</a> of <var>keyData</var> is not 2 * the <code>pk length</code>\n                      specified by Table 2 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-205\" title=\"Stateless Hash-Based Digital Signature Standard\">FIPS-205</a></cite>]\n                      for the parameter set indicated by the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n                      representing the key data provided in <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> attribute of\n                      <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                      <dt>Otherwise:</dt>\n                      <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-13\"><code>priv</code></a> field is present\n                      and <var>usages</var> contains a value which is not\n                      \"<code>sign</code>\", or,\n                      if the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-14\"><code>priv</code></a> field is not present\n                      and <var>usages</var> contains a value which is not\n                      \"<code>verify</code>\"\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                      \"<code>AKP</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is not equal to\n                      the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present\n                      and is not equal to \"<code>sig</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                      is invalid according to the requirements of JSON Web\n                      Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>], or it does not contain all of the specified <var>usages</var>\n                      values,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                      has the value false and <var>extractable</var> is true,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-15\"><code>priv</code></a> field of <var>jwk</var> is present:</dt>\n                      <dd>\n                        \n                      </dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        \n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the priv field of jwk is present:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-16\"><code>priv</code></a> attribute of <var>jwk</var>\n                              does not contain a valid base64url encoded value\n                              representing an SLH-DSA private key,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                              SLH-DSA private key identified by interpreting the\n                              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-17\"><code>priv</code></a> attribute of <var>jwk</var>\n                              as a base64url encoded private key.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a>\n                              internal slot of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\".\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-9\"><code>pub</code></a> attribute of <var>jwk</var>\n                              does not contain the base64url encoded public key\n                              representing the SLH-DSA public key\n                              corresponding to <var>key</var>,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                }
                              ]
                            },
                            {
                              "case": "Otherwise:",
                              "html": "",
                              "rationale": "if",
                              "steps": [
                                {
                                  "html": "<p>\n                              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-10\"><code>pub</code></a> attribute of <var>jwk</var>\n                              does not contain a valid base64url encoded public key\n                              representing an SLH-DSA public key,\n                              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object that represents the\n                              SLH-DSA public key identified by interpreting the\n                              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-11\"><code>pub</code></a> attribute of <var>jwk</var>\n                              as a base64url encoded public key.\n                            </p>"
                                },
                                {
                                  "html": "<p>\n                              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a>\n                              internal slot of <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-public\"><code>public</code></a>\".\n                            </p>"
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be a new instance of a <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a> object.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n                      <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a>\n                      internal slot of <var>key</var> to <var>algorithm</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>key</var>\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>key</var> be the <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> to be\n              exported.\n            </p>"
        },
        {
          "html": "<p>\n              If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-spki\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-spki-6\"><code>spki</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-pkcs8\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-pkcs8-6\"><code>pkcs8</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>\n                If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-public\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-public-8\"><code>raw-public</code></a>\":\n              </dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-private\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-private-3\"><code>raw-private</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-6\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"spki\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be an instance of the <code>SubjectPublicKeyInfo</code>\n                      ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">RFC5280</a></cite>]\n                      with the following properties:\n                    </p>\n                    <ul>\n                      <li>\n                        <p>\n                          Set the <var>algorithm</var> field to an\n                          <code>AlgorithmIdentifier</code> ASN.1 type with the following\n                          properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31) OID.\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>subjectPublicKey</var> field to <var>keyData</var>.\n                        </p>\n                      </li>\n                    </ul>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31) OID.\n                                </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"pkcs8\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be an instance of the <code>PrivateKeyInfo</code>\n                      ASN.1 structure defined in [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc5208\" title=\"Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2\">RFC5208</a></cite>]\n                      with the following properties:\n                    </p>\n                    <ul>\n                      <li>\n                        <p>\n                          Set the <var>version</var> field to <code>0</code>.\n                        </p>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>privateKeyAlgorithm</var> field to a\n                          <code>PrivateKeyAlgorithmIdentifier</code> ASN.1 type with the\n                          following properties:\n                        </p>\n                        <ul>\n                          <li>\n                            <dl class=\"switch\">\n\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-128f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-192f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHA2-256f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-128f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-192f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256s</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30) OID.\n                                </p>\n                              </dd>\n                              <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var> is \"<code>SLH-DSA-SHAKE-256f</code>\":</dt>\n                              <dd>\n                                <p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31) OID.\n                                </p>\n                              </dd>\n                              <dt>Otherwise:</dt>\n                              <dd>\n                                <p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>\n                              </dd>\n                            </dl>\n                          </li>\n                        </ul>\n                      </li>\n                      <li>\n                        <p>\n                          Set the <var>privateKey</var> field to the result of DER-encoding\n                          a <code>OCTET STRING</code> ASN.1 type that represents the SLH-DSA private key represented\n                          by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                          internal slot of <var>key</var>\n                        </p>\n                      </li>\n                    </ul>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128s</code> (2.16.840.1.101.3.4.3.20) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-128f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-128f</code> (2.16.840.1.101.3.4.3.21) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192s</code> (2.16.840.1.101.3.4.3.22) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-192f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-192f</code> (2.16.840.1.101.3.4.3.23) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256s</code> (2.16.840.1.101.3.4.3.24) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHA2-256f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-sha2-256f</code> (2.16.840.1.101.3.4.3.25) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128s</code> (2.16.840.1.101.3.4.3.26) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-128f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-128f</code> (2.16.840.1.101.3.4.3.27) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192s</code> (2.16.840.1.101.3.4.3.28) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-192f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-192f</code> (2.16.840.1.101.3.4.3.29) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256s\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256s</code> (2.16.840.1.101.3.4.3.30) OID.\n                                </p>"
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is \"SLH-DSA-SHAKE-256f\":",
                              "html": "<p>\n                                  Set the <var>algorithm</var> object identifier to the <code>id-slh-dsa-shake-256f</code> (2.16.840.1.101.3.4.3.31) OID.\n                                </p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p>\n                                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                                </p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be the result of DER-encoding <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-public\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>public</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing the SLH-DSA\n                      public key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"raw-private\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>\n                      If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                      of <var>key</var> is not \"<code>private</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"InvalidAccessError\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\"><code>InvalidAccessError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing the SLH-DSA\n                      private key represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                      dictionary.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>kty</code> attribute of <var>jwk</var> to\n                      \"<code>AKP</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-pub\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-pub-12\"><code>pub</code></a> attribute of <var>jwk</var>\n                      to the base64url encoded public key corresponding\n                      to the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                      internal slot of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot\n                        of <var>key</var> is \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-private\"><code>private</code></a>\":\n                      </dt>\n                      <dd>\n                        Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-18\"><code>priv</code></a> attribute of <var>jwk</var>\n                        to the base64url encoded private key represented by\n                        the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                        internal slot of <var>key</var>.\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the [[type]] internal slot of key is \"private\":",
                              "html": "Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-jsonwebkey-priv\" class=\"internalDFN\" id=\"ref-for-dom-jsonwebkey-priv-18\"><code>priv</code></a> attribute of <var>jwk</var>\n                        to the base64url encoded private key represented by\n                        the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                        internal slot of <var>key</var>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Set the <code>key_ops</code> attribute of <var>jwk</var> to the <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>ext</code> attribute of <var>jwk</var> to the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal slot\n                      of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>jwk</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-2\"><code>iv</code></a> member of\n              <var>normalizedAlgorithm</var> has a length greater than 15\n              bytes,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-2\"><code>tagLength</code></a> member of\n              <var>normalizedAlgorithm</var> is not present:</dt>\n              <dd>Let <var>tagLength</var> be 128.</dd>\n              <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-3\"><code>tagLength</code></a> member of\n              <var>normalizedAlgorithm</var> is one of 64, 96 or 128:</dt>\n              <dd>Let <var>tagLength</var> be equal to the\n              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-4\"><code>tagLength</code></a> member of\n               <var>normalizedAlgorithm</var></dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the tagLength member of normalizedAlgorithm is not present:",
                  "html": "Let <var>tagLength</var> be 128."
                },
                {
                  "case": "If the tagLength member of normalizedAlgorithm is one of 64, 96 or 128:",
                  "html": "Let <var>tagLength</var> be equal to the\n              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-4\"><code>tagLength</code></a> member of\n               <var>normalizedAlgorithm</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>additionalData</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-additionalData-2\"><code>additionalData</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>C</var> be the output that results from performing\n              the OCB-ENCRYPT function described in Section 4.2 of\n              [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc7253\" title=\"The OCB Authenticated-Encryption Algorithm\">RFC7253</a></cite>] using AES as the block cipher, using\n              the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the <var>K</var> input parameter,\n              the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-3\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n              the <var>N</var> input parameter,\n              <var>additionalData</var> as the <var>A</var> input parameter,\n              <var>plaintext</var> as the <var>P</var> input parameter, and\n              <var>tagLength</var> as the <var>TAGLEN</var> global parameter.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>C</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-4\"><code>iv</code></a> member of\n              <var>normalizedAlgorithm</var> has a length greater than 15\n              bytes,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-5\"><code>tagLength</code></a> member of\n              <var>normalizedAlgorithm</var> is not present:</dt>\n              <dd>Let <var>tagLength</var> be 128.</dd>\n              <dt>If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-6\"><code>tagLength</code></a> member of\n              <var>normalizedAlgorithm</var> is one of 64, 96 or 128:</dt>\n              <dd>Let <var>tagLength</var> be equal to the\n              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-7\"><code>tagLength</code></a> member of\n               <var>normalizedAlgorithm</var></dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the tagLength member of normalizedAlgorithm is not present:",
                  "html": "Let <var>tagLength</var> be 128."
                },
                {
                  "case": "If the tagLength member of normalizedAlgorithm is one of 64, 96 or 128:",
                  "html": "Let <var>tagLength</var> be equal to the\n              <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-7\"><code>tagLength</code></a> member of\n               <var>normalizedAlgorithm</var>"
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              If <var>ciphertext</var> has a length less than <var>tagLength</var> bits,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>additionalData</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-additionalData-3\"><code>additionalData</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "Perform the OCB-DECRYPT function described in Section 4.3 of\n              [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc7253\" title=\"The OCB Authenticated-Encryption Algorithm\">RFC7253</a></cite>] using AES as the block cipher, using\n              the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the <var>K</var> input parameter,\n              the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-5\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n              the <var>N</var> input parameter,\n              <var>additionalData</var> as the <var>A</var> input parameter,\n              <var>ciphertext</var> as the <var>C</var> input parameter, and\n              <var>tagLength</var> as the <var>TAGLEN</var> global parameter.",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the result of the algorithm is the indication of authentication failure, \"INVALID\":",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>"
                },
                {
                  "case": "Otherwise:",
                  "html": "Let <var>plaintext</var> be the output <var>P</var> of OCB-DECRYPT."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>plaintext</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>usages</var> contains any entry which is not\n              one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n              \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams-length\"><code>length</code></a> member of\n              <var>normalizedAlgorithm</var> is not equal to one of\n              128, 192 or 256,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Generate an AES key of length\n              equal to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams-length\"><code>length</code></a> member of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the key generation step fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new\n              <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object representing the\n              generated AES key.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret\"><code>secret</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new\n              <a data-link-type=\"dictionary\" data-lt=\"AesKeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm\"><code>AesKeyAlgorithm</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to \"<code>AES-OCB</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length\"><code>length</code></a> attribute of\n              <var>algorithm</var> to equal the\n              <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyGenParams-length\"><code>length</code></a> member of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>key</var> to be <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>key</var> to be <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<p>\n              If <var>usages</var> contains an entry which is not\n              one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n              \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-6\"><code>raw-secret</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-7\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw-secret\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>data</var> be <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the length in bits of <var>data</var> is not 128, 192 or 256\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                      <dt>Otherwise:</dt>\n                      <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                      \"<code>oct</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>jwk</var> does not meet the requirements of\n                      Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                      <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k\"><code>k</code></a> field of <var>jwk</var>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>data</var> has length 128 bits:</dt>\n                      <dd>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>A128OCB</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                      <dt>If <var>data</var> has length 192 bits:</dt>\n                      <dd>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>A192OCB</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                      <dt>If <var>data</var> has length 256 bits:</dt>\n                      <dd>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>A256OCB</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</dd>\n                      <dt>Otherwise:</dt>\n                      <dd>\n                        <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If data has length 128 bits:",
                              "html": "If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>A128OCB</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 192 bits:",
                              "html": "If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>A192OCB</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If data has length 256 bits:",
                              "html": "If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>A256OCB</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present and is\n                      not \"<code>enc</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                      is invalid according to the requirements of\n                      JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                      does not contain all of the specified <var>usages</var> values,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                      has the value false and <var>extractable</var> is true,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              object representing an AES key with value <var>data</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new\n              <a data-link-type=\"dictionary\" data-lt=\"AesKeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm\"><code>AesKeyAlgorithm</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to \"<code>AES-OCB</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length\"><code>length</code></a> attribute of\n              <var>algorithm</var> to the length, in bits, of <var>data</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-7\"><code>raw-secret</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-8\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw-secret\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                      the raw octets of the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                      dictionary.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>kty</code> attribute of <var>jwk</var> to the\n                      string \"<code>oct</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                      containing the raw octets of the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length\"><code>length</code></a> attribute of\n                      <var>key</var> is 128:</dt>\n                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>A128OCB</code>\".</dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length\"><code>length</code></a> attribute of\n                      <var>key</var> is 192:</dt>\n                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>A192OCB</code>\".</dd>\n                      <dt>If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesKeyAlgorithm-length\"><code>length</code></a> attribute of\n                      <var>key</var> is 256:</dt>\n                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>A256OCB</code>\".</dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the length attribute of key is 128:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>A128OCB</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 192:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>A192OCB</code>\"."
                            },
                            {
                              "case": "If the length attribute of key is 256:",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>A256OCB</code>\"."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                      <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal slot\n                      of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>jwk</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesDerivedKeyParams-length\"><code>length</code></a> member of\n              <var>normalizedDerivedKeyAlgorithm</var> is not 128, 192 or 256, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-AesDerivedKeyParams-length\"><code>length</code></a> member of\n              <var>normalizedDerivedKeyAlgorithm</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-6\"><code>iv</code></a> member of\n              <var>normalizedAlgorithm</var> does not have a length of 12 bytes,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-8\"><code>tagLength</code></a> member\n              of <var>normalizedAlgorithm</var> is present and is not 128,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>additionalData</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-additionalData-4\"><code>additionalData</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>ciphertext</var> be the output that results from\n              performing the AEAD_CHACHA20_POLY1305 encryption algorithm\n              described in Section 2.8 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc8439\" title=\"ChaCha20 and Poly1305 for IETF Protocols\">RFC8439</a></cite>], using\n              the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the key input parameter,\n              the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-7\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n              the nonce input parameter,\n              <var>plaintext</var> as the plaintext input parameter, and\n              <var>additionalData</var> as the additional authenticated data (AAD) input parameter.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>ciphertext</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-8\"><code>iv</code></a> member of\n              <var>normalizedAlgorithm</var> does not have a length of 12 bytes,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-tagLength\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-tagLength-9\"><code>tagLength</code></a> member\n              of <var>normalizedAlgorithm</var> is present and is not 128,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If <var>ciphertext</var> has a length less than 128 bits,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>additionalData</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-additionalData\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-additionalData-5\"><code>additionalData</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "Perform the AEAD_CHACHA20_POLY1305 decryption algorithm\n              described in Section 2.8 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc8439\" title=\"ChaCha20 and Poly1305 for IETF Protocols\">RFC8439</a></cite>], using\n              the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n              internal slot of <var>key</var> as the key input parameter,\n              the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-AeadParams-iv\" class=\"internalDFN\" id=\"ref-for-dfn-AeadParams-iv-9\"><code>iv</code></a> member of <var>normalizedAlgorithm</var> as\n              the nonce input parameter,\n              <var>ciphertext</var> as the ciphertext input parameter, and\n              <var>additionalData</var> as the additional authenticated data (AAD) input parameter.",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the result of the algorithm is the indication of authentication failure:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>"
                },
                {
                  "case": "Otherwise:",
                  "html": "Let <var>plaintext</var> be the resulting plaintext."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>plaintext</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>usages</var> contains any entry which is not\n              one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n              \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Generate a 256-bit key.\n            </p>"
        },
        {
          "html": "<p>\n              If the key generation step fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new\n              <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object representing the\n              generated key.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret\"><code>secret</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new\n              <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to \"<code>ChaCha20-Poly1305</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>key</var> to be <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>key</var> to be <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<p>\n              If <var>usages</var> contains an entry which is not\n              one of \"<code>encrypt</code>\", \"<code>decrypt</code>\",\n              \"<code>wrapKey</code>\" or \"<code>unwrapKey</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-8\"><code>raw-secret</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-9\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw-secret\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>data</var> be <var>keyData</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the length in bits of <var>data</var> is not 256\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                      <dt>Otherwise:</dt>\n                      <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                      \"<code>oct</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>jwk</var> does not meet the requirements of\n                      Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                      <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k\"><code>k</code></a> field of <var>jwk</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present, and is\n                      not \"<code>C20P</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present and is\n                      not \"<code>enc</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                      is invalid according to the requirements of\n                      JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                      does not contain all of the specified <var>usages</var> values,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                      has the value false and <var>extractable</var> is true,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              object representing a key with value <var>data</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret\"><code>secret</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new\n              <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to \"<code>ChaCha20-Poly1305</code>\".\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-9\"><code>raw-secret</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-10\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw-secret\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>data</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> containing\n                      the raw octets of the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                      dictionary.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>kty</code> attribute of <var>jwk</var> to the\n                      string \"<code>oct</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                      containing the raw octets of the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n                      <var>key</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>alg</code> attribute of <var>jwk</var> to\n                      the string \"<code>C20P</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                      <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal slot\n                      of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>jwk</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "return",
      "steps": [
        {
          "html": "<p>\n              Return 256.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>SHA3-256</code>\":\n              </dt>\n              <dd>\n                Let <var>result</var> be the result of performing the SHA3-256 hash function\n                defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-202\" title=\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions\">FIPS-202</a></cite>] using\n                <var>message</var> as the input message, <var>M</var>.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>SHA3-384</code>\":\n              </dt>\n              <dd>\n                Let <var>result</var> be the result of performing the SHA3-384 hash function\n                defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-202\" title=\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions\">FIPS-202</a></cite>] using\n                <var>message</var> as the input message, <var>M</var>.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>SHA3-512</code>\":\n              </dt>\n              <dd>\n                Let <var>result</var> be the result of performing the SHA3-512 hash function\n                defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-202\" title=\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions\">FIPS-202</a></cite>] using\n                <var>message</var> as the input message, <var>M</var>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"SHA3-256\":",
                  "html": "Let <var>result</var> be the result of performing the SHA3-256 hash function\n                defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-202\" title=\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions\">FIPS-202</a></cite>] using\n                <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"SHA3-384\":",
                  "html": "Let <var>result</var> be the result of performing the SHA3-384 hash function\n                defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-202\" title=\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions\">FIPS-202</a></cite>] using\n                <var>message</var> as the input message, <var>M</var>."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"SHA3-512\":",
                  "html": "Let <var>result</var> be the result of performing the SHA3-512 hash function\n                defined in Section 6.1 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-fips-202\" title=\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions\">FIPS-202</a></cite>] using\n                <var>message</var> as the input message, <var>M</var>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              If performing the operation results in an error, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>length</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-CShakeParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-CShakeParams-length-2\"><code>length</code></a> member of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>functionName</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-CShakeParams-functionName\" class=\"internalDFN\" id=\"ref-for-dfn-CShakeParams-functionName-3\"><code>functionName</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>customization</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-CShakeParams-customization\" class=\"internalDFN\" id=\"ref-for-dfn-CShakeParams-customization-3\"><code>customization</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>cSHAKE128</code>\":\n              </dt>\n              <dd>\n                Let <var>result</var> be the result of performing the cSHAKE128 function\n                defined in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                <var>message</var> as the <var>X</var> input parameter,\n                <var>length</var> as the <var>L</var> input parameter,\n                <var>functionName</var> as the <var>N</var> input parameter, and\n                <var>customization</var> as the <var>S</var> input parameter.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>cSHAKE256</code>\":\n              </dt>\n              <dd>\n                Let <var>result</var> be the result of performing the cSHAKE256 function\n                defined in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                <var>message</var> as the <var>X</var> input parameter,\n                <var>length</var> as the <var>L</var> input parameter,\n                <var>functionName</var> as the <var>N</var> input parameter, and\n                <var>customization</var> as the <var>S</var> input parameter.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"cSHAKE128\":",
                  "html": "Let <var>result</var> be the result of performing the cSHAKE128 function\n                defined in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                <var>message</var> as the <var>X</var> input parameter,\n                <var>length</var> as the <var>L</var> input parameter,\n                <var>functionName</var> as the <var>N</var> input parameter, and\n                <var>customization</var> as the <var>S</var> input parameter."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"cSHAKE256\":",
                  "html": "Let <var>result</var> be the result of performing the cSHAKE256 function\n                defined in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                <var>message</var> as the <var>X</var> input parameter,\n                <var>length</var> as the <var>L</var> input parameter,\n                <var>functionName</var> as the <var>N</var> input parameter, and\n                <var>customization</var> as the <var>S</var> input parameter."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              If performing the operation results in an error, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>customization</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-customization\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-customization-2\"><code>customization</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC128</code>\":\n              </dt>\n              <dd>\n                Let <var>mac</var> be the result of performing the KMAC128 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-2\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC256</code>\":\n              </dt>\n              <dd>\n                Let <var>mac</var> be the result of performing the KMAC256 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-3\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC128\":",
                  "html": "Let <var>mac</var> be the result of performing the KMAC128 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-2\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC256\":",
                  "html": "Let <var>mac</var> be the result of performing the KMAC256 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-3\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>mac</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>\n              Let <var>customization</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-customization\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-customization-3\"><code>customization</code></a> member of\n              <var>normalizedAlgorithm</var> if present or the empty octet\n              string otherwise.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC128</code>\":\n              </dt>\n              <dd>\n                Let <var>mac</var> be the result of performing the KMAC128 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-4\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC256</code>\":\n              </dt>\n              <dd>\n                Let <var>mac</var> be the result of performing the KMAC256 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-5\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC128\":",
                  "html": "Let <var>mac</var> be the result of performing the KMAC128 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-4\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC256\":",
                  "html": "Let <var>mac</var> be the result of performing the KMAC256 function\n                defined in Section 4 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-nist-sp800-185\" title=\"NIST Special Publication 800-185: SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash\">NIST-SP800-185</a></cite>] using\n                the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a>\n                internal slot of <var>key</var> as the <var>K</var> input parameter,\n                <var>message</var> as the <var>X</var> input parameter,\n                the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacParams-length-5\"><code>length</code></a> member of <var>normalizedAlgorithm</var> as\n                the <var>L</var> input parameter, and\n                <var>customization</var> as\n                the <var>S</var> input parameter."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return true if <var>mac</var> is equal to <var>signature</var> and false\n              otherwise.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>usages</var> contains any entry which is not \"<code>sign</code>\" or\n              \"<code>verify</code>\", then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacKeyGenParams-length-2\"><code>length</code></a> member of\n                <var>normalizedAlgorithm</var> is present:\n              </dt>\n              <dd>\n                \n              </dd>\n              <dt>\n                Otherwise, if the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC128</code>\":\n              </dt>\n              <dd>\n                Let <var>length</var> be 128.\n              </dd>\n              <dt>\n                Otherwise, if the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC256</code>\":\n              </dt>\n              <dd>\n                Let <var>length</var> be 256.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is present:",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "Let <var>length</var> be equal to the\n                    <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacKeyGenParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacKeyGenParams-length-3\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var>."
                    },
                    {
                      "html": "If <var>length</var> is zero, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n                    <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>."
                    }
                  ]
                },
                {
                  "case": "Otherwise, if the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC128\":",
                  "html": "Let <var>length</var> be 128."
                },
                {
                  "case": "Otherwise, if the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC256\":",
                  "html": "Let <var>length</var> be 256."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Generate a key of length <var>length</var> bits.\n            </p>"
        },
        {
          "html": "<p>\n              If the key generation step fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new\n              <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a> object representing the\n              generated key.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret\"><code>secret</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new\n              <a data-link-type=\"idl\" data-lt=\"KmacKeyAlgorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KmacKeyAlgorithm-2\"><code>KmacKeyAlgorithm</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal\n              slot of <var>key</var> to be <var>extractable</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-usages\"><code>[[usages]]</code></a> internal slot of\n              <var>key</var> to be <var>usages</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<p>\n              If <var>usages</var> contains an entry which is not\n              \"<code>sign</code>\" or \"<code>verify</code>\",\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-10\"><code>raw-secret</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-11\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw-secret\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>data</var> be <var>keyData</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>If <var>keyData</var> is a <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a> dictionary:</dt>\n                      <dd><p>Let <var>jwk</var> equal <var>keyData</var>.</p></dd>\n                      <dt>Otherwise:</dt>\n                      <dd><p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p></dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If keyData is a JsonWebKey dictionary:",
                              "html": "<p>Let <var>jwk</var> equal <var>keyData</var>.</p>"
                            },
                            {
                              "case": "Otherwise:",
                              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">Throw</a> a <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.</p>"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-kty\"><code>kty</code></a> field of <var>jwk</var> is not\n                      \"<code>oct</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If <var>jwk</var> does not meet the requirements of\n                      Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>],\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>data</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\">byte sequence</a> obtained by decoding the\n                      <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k\"><code>k</code></a> field of <var>jwk</var>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                        <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                        \"<code>KMAC128</code>\":\n                      </dt>\n                      <dd>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present\n                        and is not \"<code>K128</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                      <dt>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                        <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                        \"<code>KMAC256</code>\":\n                      </dt>\n                      <dd>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present\n                        and is not \"<code>K256</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                      </dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC128\":",
                              "html": "If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present\n                        and is not \"<code>K128</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC256\":",
                              "html": "If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-alg\"><code>alg</code></a> field of <var>jwk</var> is present\n                        and is not \"<code>K256</code>\",\n                        then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                        <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      If <var>usages</var> is non-empty and the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-use\"><code>use</code></a> field of <var>jwk</var> is present and is\n                      not \"<code>sign</code>\",\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-key_ops\"><code>key_ops</code></a> field of <var>jwk</var> is present, and\n                      is invalid according to the requirements of\n                      JSON Web Key [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwk\" title=\"JSON Web Key (JWK)\">JWK</a></cite>] or\n                      does not contain all of the specified <var>usages</var> values,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-ext\"><code>ext</code></a> field of <var>jwk</var> is present and\n                      has the value false and <var>extractable</var> is true,\n                      then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                      <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>length</var> be the length in bits of <var>data</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If <var>length</var> is zero\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-2\"><code>length</code></a> member of\n                <var>normalizedAlgorithm</var> is present:\n              </dt>\n              <dd>\n                <dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-3\"><code>length</code></a> member of\n                    <var>normalizedAlgorithm</var> is greater than <var>length</var>:\n                  </dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-4\"><code>length</code></a> member of\n                    <var>normalizedAlgorithm</var>, is less than or equal to\n                    <var>length</var> minus eight:\n                  </dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                  </dd>\n                  <dt>\n                    Otherwise:\n                  </dt>\n                  <dd>\n                    Set <var>length</var> equal to the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-5\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </dd>\n                </dl>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is present:",
                  "html": "<dl class=\"switch\">\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-3\"><code>length</code></a> member of\n                    <var>normalizedAlgorithm</var> is greater than <var>length</var>:\n                  </dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                  </dd>\n                  <dt>\n                    If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-4\"><code>length</code></a> member of\n                    <var>normalizedAlgorithm</var>, is less than or equal to\n                    <var>length</var> minus eight:\n                  </dt>\n                  <dd>\n                    <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>.\n                  </dd>\n                  <dt>\n                    Otherwise:\n                  </dt>\n                  <dd>\n                    Set <var>length</var> equal to the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-5\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var>.\n                  </dd>\n                </dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If the length member of normalizedAlgorithm is greater than length:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                        },
                        {
                          "case": "If the length member of normalizedAlgorithm, is less than or equal to length minus eight:",
                          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                    <a data-link-type=\"exception\" data-lt=\"DataError\" href=\"https://webidl.spec.whatwg.org/#dataerror\"><code>DataError</code></a>."
                        },
                        {
                          "case": "Otherwise:",
                          "html": "Set <var>length</var> equal to the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-5\"><code>length</code></a>\n                    member of <var>normalizedAlgorithm</var>."
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              object representing an KMAC key with the first <var>length</var>\n              bits of <var>data</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret\"><code>secret</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new\n              <a data-link-type=\"idl\" data-lt=\"KmacKeyAlgorithm\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacKeyAlgorithm\" class=\"internalDFN\" id=\"ref-for-dfn-KmacKeyAlgorithm-3\"><code>KmacKeyAlgorithm</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacKeyAlgorithm-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacKeyAlgorithm-length-2\"><code>length</code></a> attribute of\n              <var>algorithm</var> to <var>length</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If the underlying cryptographic key material represented by the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              cannot be accessed, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>bits</var> be the raw bits of the key represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of\n              <var>key</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>data</var> be an <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-byte-sequence-containing\">byte sequence containing</a> <var>bits</var>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-11\"><code>raw-secret</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>If <var>format</var> is \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-jwk\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-jwk-12\"><code>jwk</code></a>\":</dt>\n              <dd>\n                \n              </dd>\n              <dt>Otherwise:</dt>\n              <dd>\n                <p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If format is \"raw-secret\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>data</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "If format is \"jwk\":",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>\n                      Let <var>jwk</var> be a new <a data-link-type=\"dictionary\" data-lt=\"JsonWebKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-JsonWebKey\"><code>JsonWebKey</code></a>\n                      dictionary.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>kty</code> attribute of <var>jwk</var> to the\n                      string \"<code>oct</code>\".\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-jsonwebkey-k\"><code>k</code></a> attribute of <var>jwk</var> to be a string\n                      containing <var>data</var>, encoded according to Section 6.4 of JSON Web Algorithms [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-jwa\" title=\"JSON Web Algorithms (JWA)\">JWA</a></cite>].\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>algorithm</var> be the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal slot of\n                      <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<dl class=\"switch\">\n                      <dt>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                        <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                        \"<code>KMAC128</code>\":\n                      </dt>\n                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                        the string \"<code>K128</code>\".</dd>\n                      <dt>\n                        If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                        <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                        \"<code>KMAC256</code>\":\n                      </dt>\n                      <dd>Set the <code>alg</code> attribute of <var>jwk</var> to\n                        the string \"<code>K256</code>\".</dd>\n                    </dl>",
                      "rationale": ".switch",
                      "steps": [
                        {
                          "operation": "switch",
                          "steps": [
                            {
                              "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC128\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                        the string \"<code>K128</code>\"."
                            },
                            {
                              "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC256\":",
                              "html": "Set the <code>alg</code> attribute of <var>jwk</var> to\n                        the string \"<code>K256</code>\"."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "html": "<p>\n                      Set the <code>key_ops</code> attribute of <var>jwk</var> to equal the\n                      <a data-link-type=\"attribute\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-cryptokey-usages\"><code>usages</code></a> attribute of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Set the <code>ext</code> attribute of <var>jwk</var> to equal the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-extractable\"><code>[[extractable]]</code></a> internal slot\n                      of <var>key</var>.\n                    </p>"
                    },
                    {
                      "html": "<p>\n                      Let <var>result</var> be <var>jwk</var>.\n                    </p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise:",
                  "html": "<p>\n                  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n                  <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>.\n                </p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-6\"><code>length</code></a> member of\n                <var>normalizedAlgorithm</var> is present:\n              </dt>\n              <dd>\n                Let <var>length</var> be equal to the\n                <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-7\"><code>length</code></a>\n                member of <var>normalizedAlgorithm</var>.\n              </dd>\n              <dt>\n                Otherwise, if the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC128</code>\":\n              </dt>\n              <dd>\n                Let <var>length</var> be 128.\n              </dd>\n              <dt>\n                Otherwise, if the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>KMAC256</code>\":\n              </dt>\n              <dd>\n                Let <var>length</var> be 256.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the length member of normalizedAlgorithm is present:",
                  "html": "Let <var>length</var> be equal to the\n                <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-KmacImportParams-length\" class=\"internalDFN\" id=\"ref-for-dfn-KmacImportParams-length-7\"><code>length</code></a>\n                member of <var>normalizedAlgorithm</var>."
                },
                {
                  "case": "Otherwise, if the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC128\":",
                  "html": "Let <var>length</var> be 128."
                },
                {
                  "case": "Otherwise, if the name member of normalizedAlgorithm is a case-sensitive string match for \"KMAC256\":",
                  "html": "Let <var>length</var> be 256."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Return <var>length</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "if",
      "steps": [
        {
          "html": "<p>\n              If <var>length</var> is null, or is less than 32 (4*8), then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-version\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-version-2\"><code>version</code></a> member\n              of <var>normalizedAlgorithm</var> is present and is not 19 (0x13),\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-parallelism\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-parallelism-2\"><code>parallelism</code></a> member of <var>normalizedAlgorithm</var> is zero,\n              or greater than 16777215 (2^24-1),\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-memory\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-memory-2\"><code>memory</code></a> member of <var>normalizedAlgorithm</var> is less than\n              8 times the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-parallelism\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-parallelism-3\"><code>parallelism</code></a> member of <var>normalizedAlgorithm</var>,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-passes\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-passes-2\"><code>passes</code></a> member of <var>normalizedAlgorithm</var> is zero,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<dl class=\"switch\">\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>Argon2d</code>\":\n              </dt>\n              <dd>\n                Let <var>type</var> be 0.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>Argon2i</code>\":\n              </dt>\n              <dd>\n                Let <var>type</var> be 1.\n              </dd>\n              <dt>\n                If the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n                <var>normalizedAlgorithm</var> is a case-sensitive string match for\n                \"<code>Argon2id</code>\":\n              </dt>\n              <dd>\n                Let <var>type</var> be 2.\n              </dd>\n            </dl>",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"Argon2d\":",
                  "html": "Let <var>type</var> be 0."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"Argon2i\":",
                  "html": "Let <var>type</var> be 1."
                },
                {
                  "case": "If the name member of normalizedAlgorithm is a case-sensitive string match for \"Argon2id\":",
                  "html": "Let <var>type</var> be 2."
                }
              ]
            }
          ]
        },
        {
          "html": "<p>\n              Let <var>secretValue</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-secretValue\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-secretValue-2\"><code>secretValue</code></a> member of\n              <var>normalizedAlgorithm</var>, if present.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>associatedData</var> be the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-associatedData\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-associatedData-2\"><code>associatedData</code></a> member of\n              <var>normalizedAlgorithm</var>, if present.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>result</var> be the result of performing the Argon2 function defined\n              in Section 3 of [<cite><a class=\"bibref\" data-link-type=\"biblio\" href=\"https://wicg.github.io/webcrypto-modern-algos/#bib-rfc9106\" title=\"Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications\">RFC9106</a></cite>] using\n              the password represented by <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-handle\"><code>[[handle]]</code></a> internal slot of <var>key</var>\n              as the message, <var>P</var>,\n              the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-nonce\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-nonce-2\"><code>nonce</code></a> attribute of\n              <var>normalizedAlgorithm</var> as the nonce, <var>S</var>,\n              the value of the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-parallelism\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-parallelism-4\"><code>parallelism</code></a> attribute\n              of <var>normalizedAlgorithm</var> as the degree of parallelism, <var>p</var>,\n              the value of the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-memory\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-memory-3\"><code>memory</code></a> attribute\n              of <var>normalizedAlgorithm</var> as the memory size, <var>m</var>,\n              the value of the <a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dfn-Argon2Params-passes\" class=\"internalDFN\" id=\"ref-for-dfn-Argon2Params-passes-3\"><code>passes</code></a> attribute\n              of <var>normalizedAlgorithm</var> as the number of passes, <var>t</var>,\n              0x13 as the version number, <var>v</var>,\n              <var>secretValue</var> (if present) as the secret value, <var>K</var>,\n              <var>associatedData</var> (if present) as the associated data, <var>X</var>,\n              <var>type</var> as the type, <var>y</var>, and\n              <var>length</var> divided by 8 as the tag length, <var>T</var>.\n            </p>"
        },
        {
          "html": "<p>\n              If the key derivation operation fails,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> an\n              <a data-link-type=\"exception\" data-lt=\"OperationError\" href=\"https://webidl.spec.whatwg.org/#operationerror\"><code>OperationError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>result</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>keyData</var> be the key data to be imported.</p>"
        },
        {
          "html": "<p>\n              If <var>format</var> is not \"<a data-link-type=\"idl\" href=\"https://wicg.github.io/webcrypto-modern-algos/#dom-keyformat-raw-secret\" class=\"internalDFN\" id=\"ref-for-dom-keyformat-raw-secret-12\"><code>raw-secret</code></a>\", <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"NotSupportedError\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\"><code>NotSupportedError</code></a>\n            </p>"
        },
        {
          "html": "<p>\n              If <var>usages</var> contains a value that is not\n              \"<code>deriveKey</code>\"  or \"<code>deriveBits</code>\", then\n              <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              If <var>extractable</var> is not <code>false</code>,\n              then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\">throw</a> a\n              <a data-link-type=\"exception\" data-lt=\"SyntaxError\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\"><code>SyntaxError</code></a>.\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>key</var> be a new <a data-link-type=\"interface\" data-lt=\"CryptoKey\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey\"><code>CryptoKey</code></a>\n              representing <var>keyData</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-type\"><code>[[type]]</code></a> internal slot of\n              <var>key</var> to \"<a data-link-type=\"enum-value\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keytype-secret\"><code>secret</code></a>\".\n            </p>"
        },
        {
          "html": "<p>\n              Let <var>algorithm</var> be a new <a data-link-type=\"dictionary\" data-lt=\"KeyAlgorithm\" href=\"https://www.w3.org/TR/webcrypto-2/#dfn-KeyAlgorithm\"><code>KeyAlgorithm</code></a>\n              object.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-keyalgorithm-name\"><code>name</code></a> attribute of\n              <var>algorithm</var> to the <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/webcrypto-2/#dom-algorithm-name\"><code>name</code></a> member of\n              <var>normalizedAlgorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Set the <a href=\"https://www.w3.org/TR/webcrypto-2/#dfn-CryptoKey-slot-algorithm\"><code>[[algorithm]]</code></a> internal\n              slot of <var>key</var> to <var>algorithm</var>.\n            </p>"
        },
        {
          "html": "<p>\n              Return <var>key</var>.\n            </p>"
        }
      ]
    },
    {
      "rationale": "return",
      "steps": [
        {
          "html": "<p>\n              Return null.\n            </p>"
        }
      ]
    }
  ]
}