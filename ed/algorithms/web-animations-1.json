{
  "spec": {
    "title": "Web Animations Module Level 1",
    "url": "https://drafts.csswg.org/web-animations-1/"
  },
  "algorithms": [
    {
      "name": "update animations and send events",
      "href": "https://drafts.csswg.org/web-animations-1/#update-animations-and-send-events",
      "html": "When asked to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" id=\"update-animations-and-send-events\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update animations and send events</dfn>\n    for a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/#document\" id=\"ref-for-document②\">Document</a></code> <var>doc</var> at timestamp <var>now</var>,\n    run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Update the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-current-time\" id=\"ref-for-timeline-current-time⑦\">current time</a> of all timelines\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-associated-with-a-document\" id=\"ref-for-timeline-associated-with-a-document①\">associated with <var>doc</var></a>\npassing <var>now</var> as the timestamp.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#remove-replaced-animations\" id=\"ref-for-remove-replaced-animations\">Remove replaced animations</a> for <var>doc</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#perform-a-microtask-checkpoint\" id=\"ref-for-perform-a-microtask-checkpoint\">Perform a microtask checkpoint</a>.</p>"
        },
        {
          "html": "<p>Let <var>events to dispatch</var> be a copy of <var>doc</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-animation-event-queue\" id=\"ref-for-pending-animation-event-queue\">pending animation event queue</a>.</p>"
        },
        {
          "html": "<p>Clear <var>doc</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-animation-event-queue\" id=\"ref-for-pending-animation-event-queue①\">pending animation event queue</a>.</p>"
        },
        {
          "html": "Perform a stable sort of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-events\" id=\"ref-for-animation-events①\">animation events</a> in <var>events to dispatch</var>\nas follows:",
          "rationale": "sort",
          "steps": [
            {
              "html": "<p>Sort the events by their <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#scheduled-event-time\" id=\"ref-for-scheduled-event-time\">scheduled event time</a>\nsuch that events that were scheduled to occur earlier\nsort before events scheduled to occur later,\nand events whose scheduled event time is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④\">unresolved</a>\nsort before events with a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve\">resolved</a>\nscheduled event time.</p>"
            },
            {
              "html": "<p>Within events with equal <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#scheduled-event-time\" id=\"ref-for-scheduled-event-time①\">scheduled event times</a>,\nsort by their <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-composite-order\" id=\"ref-for-animation-composite-order\">composite order</a>.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-dispatch\" id=\"ref-for-concept-event-dispatch\">Dispatch</a> each of the events in <var>events to dispatch</var> at their\ncorresponding target using the order established in the previous step.</p>"
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time④\">current time</a> of an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation①②\">animation</a> is calculated from\n  the first matching condition below:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "If the animation’s hold time is resolved,",
              "html": "<p>The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time⑤\">current time</a> is the animation’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②\">hold time</a>.</p>"
            },
            {
              "case": "If any of the following are true: the animation has no associated timeline, or the associated timeline is inactive, or the animation’s start time is unresolved,",
              "html": "<p>The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time⑥\">current time</a> is an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑨\">unresolved</a> time value.</p>"
            },
            {
              "case": "Otherwise,",
              "html": "<blockquote>\n    <code><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time⑦\">current time</a> =\n      (<var>timeline time</var> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②\">start time</a>)\n      × <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate①\">playback rate</a></code>\n  </blockquote>\n     <p>Where <var>timeline time</var> is the current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②⓪\">time value</a>\n  of the associated <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline①⑧\">timeline</a>.\n  The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate②\">playback rate</a> value is defined in <a href=\"https://drafts.csswg.org/web-animations-1/#speed-control\">§ 4.5.15 Speed control</a>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "animation/set the timeline of an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-set-the-timeline-of-an-animation",
      "html": "The procedure to\n    <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"animation\" data-dfn-type=\"dfn\" data-export=\"\" id=\"animation-set-the-timeline-of-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">set the timeline of an animation</dfn>,\n    <var>animation</var>,\n    to <var>new timeline</var> which may be null,\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>old timeline</var> be\nthe current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline①⑨\">timeline</a> of <var>animation</var>, if any.</p>"
        },
        {
          "html": "<p>If <var>new timeline</var> is the same object as <var>old timeline</var>,\nabort this procedure.</p>"
        },
        {
          "html": "<p>Let the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline②⓪\">timeline</a> of <var>animation</var> be\n<var>new timeline</var>.</p>"
        },
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③\">start time</a> of <var>animation</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⓪\">resolved</a>,\nmake <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③\">hold time</a> <span id=\"ref-for-unresolved①①\">unresolved</span>.</p>"
        },
        {
          "html": "<p>Run the procedure to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state①\">update an animation’s finished state</a> for <var>animation</var>\nwith the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
        }
      ]
    },
    {
      "name": "animation/set the associated effect of an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-set-the-associated-effect-of-an-animation",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"animation\" data-dfn-type=\"dfn\" data-export=\"\" id=\"animation-set-the-associated-effect-of-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">set the associated effect of an animation</dfn>,\n    <var>animation</var>,\n    to <var>new effect</var> which may be null, is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>old effect</var> be\nthe current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-associated-effect\" id=\"ref-for-animation-associated-effect⑥\">associated effect</a> of <var>animation</var>, if any.</p>"
        },
        {
          "html": "<p>If <var>new effect</var> is the same object as <var>old effect</var>,\nabort this procedure.</p>"
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task\">pending pause task</a>,\nreschedule that task to run as soon as <var>animation</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#ready\" id=\"ref-for-ready\">ready</a>.</p>"
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task\">pending play task</a>,\nreschedule that task to run as soon as\n<var>animation</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#ready\" id=\"ref-for-ready①\">ready</a> to play <var>new effect</var>.</p>"
        },
        {
          "html": "<p>If <var>new effect</var> is not <code>null</code>\nand if <var>new effect</var> is the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-associated-effect\" id=\"ref-for-animation-associated-effect⑦\">associated effect</a>\nof another <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation①③\">animation</a>, <var>previous animation</var>,\nrun the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-set-the-associated-effect-of-an-animation\" id=\"ref-for-animation-set-the-associated-effect-of-an-animation\">set the associated effect of an animation</a>\n(this procedure)\non <var>previous animation</var>,\npassing null as <var>new effect</var>.</p>"
        },
        {
          "html": "<p>Let the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-associated-effect\" id=\"ref-for-animation-associated-effect⑧\">associated effect</a> of <var>animation</var> be\n<var>new effect</var>.</p>"
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state②\">update an animation’s finished state</a>\nfor <var>animation</var> with the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
        }
      ]
    },
    {
      "name": "animation/silently set the current time",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-silently-set-the-current-time",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"animation\" data-dfn-type=\"dfn\" data-export=\"\" id=\"animation-silently-set-the-current-time\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">silently set the current time</dfn>\n    of an animation, <var>animation</var>,\n    to <var>seek time</var> is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>seek time</var> is an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①②\">unresolved</a> time value,\nthen perform the following steps.",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time①⓪\">current time</a> is <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①\">resolved</a>,\nthen <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw\">throw</a> a <span class=\"exceptionname\">TypeError</span>.</p>"
            },
            {
              "html": "<p>Abort these steps.</p>"
            }
          ]
        },
        {
          "html": "Update either <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time④\">hold time</a> or\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time④\">start time</a> as follows:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If any of the following conditions are true: animation’s hold time is resolved, or animation’s start time is unresolved, or animation has no associated timeline or the associated timeline is inactive, or animation’s playback rate is 0,",
                  "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time⑥\">hold time</a> to <var>seek time</var>.</p>"
                },
                {
                  "case": "Otherwise,",
                  "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time⑥\">start time</a> to the result of evaluating\n<code><var>timeline time</var> − (<var>seek time</var> / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate④\">playback rate</a>)</code>\nwhere <var>timeline time</var> is the current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②①\">time value</a>\nof the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline②③\">timeline</a> associated with <var>animation</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>animation</var> has no associated <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline②④\">timeline</a>\nor the associated <span id=\"ref-for-timeline②⑤\">timeline</span> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#inactive-timeline\" id=\"ref-for-inactive-timeline④\">inactive</a>,\nmake <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time⑦\">start time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⑤\">unresolved</a>.</p>"
        },
        {
          "html": "<p>Make <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#previous-current-time\" id=\"ref-for-previous-current-time\">previous current time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⑥\">unresolved</a>.</p>"
        }
      ]
    },
    {
      "name": "animation/set the current time",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-set-the-current-time",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"animation\" data-dfn-type=\"dfn\" data-export=\"\" id=\"animation-set-the-current-time\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">set the current time</dfn>\n    of an animation, <var>animation</var>,\n    to <var>seek time</var> is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Run the steps to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-silently-set-the-current-time\" id=\"ref-for-animation-silently-set-the-current-time\">silently set the current time</a> of <var>animation</var>\nto <var>seek time</var>.</p>"
        },
        {
          "html": "If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task①\">pending pause task</a>,\nsynchronously complete the pause operation\nby performing the following steps:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time⑦\">hold time</a> to <var>seek time</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate\">Apply any pending playback rate</a> to <var>animation</var>.</p>"
            },
            {
              "html": "<p>Make <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time⑨\">start time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⑦\">unresolved</a>.</p>"
            },
            {
              "html": "<p>Cancel the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task②\">pending pause task</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve②\">Resolve</a>\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise\">current ready promise</a>\nwith <var>animation</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state③\">update an animation’s finished state</a>\n for <var>animation</var>\n with the <var>did seek</var> flag set to true,\n and the <var>synchronously notify</var> flag set to false.</p>"
        }
      ]
    },
    {
      "name": "set the start time",
      "href": "https://drafts.csswg.org/web-animations-1/#set-the-start-time",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"set-the-start-time\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">set the start time</dfn>\n    of an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation①⑤\">animation</a>, <var>animation</var>,\n    to <var>new start time</var>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>timeline time</var> be the current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②②\">time value</a>\nof the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline②⑥\">timeline</a> that <var>animation</var> is associated with.\nIf there is no <span id=\"ref-for-timeline②⑦\">timeline</span> associated with <var>animation</var>\nor the associated timeline is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#inactive-timeline\" id=\"ref-for-inactive-timeline⑤\">inactive</a>,\nlet the <var>timeline time</var> be <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⑧\">unresolved</a>.</p>"
        },
        {
          "html": "<p>If <var>timeline time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⑨\">unresolved</a>\nand <var>new start time</var> is <span id=\"ref-for-unresolved②⓪\">resolved</span>,\nmake <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time⑧\">hold time</a> <span id=\"ref-for-unresolved②①\">unresolved</span>.</p>"
        },
        {
          "html": "<p>Let <var>previous current time</var> be\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time①③\">current time</a>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate①\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
        },
        {
          "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time①①\">start time</a> to <var>new start time</var>.</p>"
        },
        {
          "html": "Update <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time⑨\">hold time</a> based on\nthe first matching condition from the following:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If new start time is resolved,",
                  "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate⑤\">playback rate</a> is not zero,\nmake <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①⓪\">hold time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved②④\">unresolved</a>.</p>"
                },
                {
                  "case": "Otherwise (new start time is unresolved),",
                  "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①①\">hold time</a> to <var>previous current time</var>\neven if <var>previous current time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved②⑥\">unresolved</a>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task①\">pending play task</a> or a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task③\">pending pause task</a>,\ncancel that task and <a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve③\">resolve</a>\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①\">current ready promise</a>\nwith <var>animation</var>.</p>"
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state④\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to true,\nand the <var>synchronously notify</var> flag set to false.</p>"
        }
      ]
    },
    {
      "name": "play an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#play-an-animation",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"play-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">play an animation</dfn>, <var>animation</var>,\n    given a flag <var>auto-rewind</var>,\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>aborted pause</var> be a boolean flag\nthat is true if <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task⑤\">pending pause task</a>,\nand false otherwise.</p>"
        },
        {
          "html": "<p>Let <var>has pending ready promise</var> be a boolean flag\nthat is initially false.</p>"
        },
        {
          "html": "<p>Let <var>seek time</var> be a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②④\">time value</a>\nthat is initially <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved②⑨\">unresolved</a>.</p>"
        },
        {
          "html": "If the <var>auto-rewind</var> flag is true,\nperform the steps corresponding to the <em>first</em> matching condition\nfrom the following, if any:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If animation’s effective playback rate ≥ 0, and animation’s current time is either: unresolved, or less than zero, or greater than or equal to associated effect end,",
                  "html": "<p>Set <var>seek time</var> to zero.</p>"
                },
                {
                  "case": "If animation’s effective playback rate < 0, and animation’s current time is either: unresolved, or less than or equal to zero, or greater than associated effect end,",
                  "html": "<dl class=\"switch\">\n         <dt data-md=\"\">If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end②\">associated effect end</a> is positive infinity,\n         </dt><dd data-md=\"\">\n          <p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException\">DOMException</a></code>\nand abort these steps.</p>\n         </dd><dt data-md=\"\">Otherwise,\n         </dt><dd data-md=\"\">\n          <p>Set <var>seek time</var> to <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end③\">associated effect end</a>.</p>\n        </dd></dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If associated effect end is positive infinity,",
                          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException\">DOMException</a></code>\nand abort these steps.</p>"
                        },
                        {
                          "case": "Otherwise,",
                          "html": "<p>Set <var>seek time</var> to <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end③\">associated effect end</a>.</p>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If the following three conditions are <em>all</em> satisfied:</p>\n      <ul>\n       <li data-md=\"\">\n        <p><var>seek time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③②\">unresolved</a>, and</p>\n       </li><li data-md=\"\">\n        <p><var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time①④\">start time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③③\">unresolved</a>, and</p>\n       </li><li data-md=\"\">\n        <p><var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time①⑦\">current time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③④\">unresolved</a>,</p>\n      </li></ul>\n      <p>set <var>seek time</var> to zero.</p>"
        },
        {
          "html": "<p>Let <var>has finite timeline</var> be true if <var>animation</var>\nhas an associated <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline②⑨\">timeline</a> that is not <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#monotonically-increasing-timeline\" id=\"ref-for-monotonically-increasing-timeline①\">monotonically increasing</a>.</p>"
        },
        {
          "html": "<p>If <var>seek time</var> is <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve④\">resolved</a>,</p>\n      <div class=\"switch\">\n       <dl>\n        <dt data-md=\"\">If <var>has finite timeline</var> is true,\n        </dt><dd data-md=\"\">\n         \n        </dd><dt data-md=\"\">Otherwise,\n        </dt><dd data-md=\"\">\n         <p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①③\">hold time</a> to <var>seek time</var>.</p>\n       </dd></dl>\n      </div>",
          "rationale": ".switch",
          "steps": [
            {
              "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time①⑤\">start time</a> to <var>seek time</var>.</p>"
            },
            {
              "html": "<p>Let <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①②\">hold time</a> be <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③⑤\">unresolved</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate②\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①④\">hold time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③⑥\">resolved</a>,\nlet its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time①⑥\">start time</a> be <span id=\"ref-for-unresolved③⑦\">unresolved</span>.</p>"
        },
        {
          "html": "If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task④\">pending play task</a> or a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task⑥\">pending pause task</a>,",
          "rationale": "cancel",
          "steps": [
            {
              "html": "<p>Cancel that task.</p>"
            },
            {
              "html": "<p>Set <var>has pending ready promise</var> to true.</p>"
            }
          ]
        },
        {
          "html": "<p>If the following four conditions are <em>all</em> satisfied:</p>\n      <ul>\n       <li data-md=\"\">\n        <p><var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①⑤\">hold time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③⑧\">unresolved</a>, and</p>\n       </li><li data-md=\"\">\n        <p><var>seek time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved③⑨\">unresolved</a>, and</p>\n       </li><li data-md=\"\">\n        <p><var>aborted pause</var> is false, and</p>\n       </li><li data-md=\"\">\n        <p><var>animation</var> does <em>not</em> have a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate\">pending playback rate</a>,</p>\n      </li></ul>\n      <p>abort this procedure.</p>"
        },
        {
          "html": "<p>If <var>has pending ready promise</var> is false,\nlet <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise⑤\">current ready promise</a> be\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise\">a new promise</a> in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm①\">relevant Realm</a> of <var>animation</var>.</p>"
        },
        {
          "html": "So long as the above task is scheduled but has yet to run,\n<var>animation</var> is described as having a <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pending-play-task\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pending play task</dfn>.\nWhile the task is running, however,\n<var>animation</var> does <em>not</em> have a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task⑤\">pending play task</a>.",
          "rationale": "assert",
          "steps": [
            {
              "html": "<p>Assert that at least one of <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time①⑦\">start time</a> or <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①⑥\">hold time</a>\nis <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④⓪\">resolved</a>.</p>"
            },
            {
              "html": "<p>Let <var>ready time</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②⑤\">time value</a> of\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline③⓪\">timeline</a> associated with <var>animation</var>\nat the moment when <var>animation</var> became <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#ready\" id=\"ref-for-ready④\">ready</a>.</p>"
            },
            {
              "html": "Perform the steps corresponding to the first matching condition below,\nif any:",
              "rationale": ".switch",
              "steps": [
                {
                  "operation": "switch",
                  "steps": [
                    {
                      "case": "If animation’s hold time is resolved,",
                      "html": "",
                      "rationale": "apply",
                      "steps": [
                        {
                          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate③\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
                        },
                        {
                          "html": "<p>Let <var>new start time</var> be the result of evaluating\n<code><var>ready time</var> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①⑧\">hold time</a>\n      / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate⑥\">playback rate</a></code>\nfor <var>animation</var>.\nIf the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate⑦\">playback rate</a> is zero,\nlet <var>new start time</var> be simply <var>ready time</var>.</p>"
                        },
                        {
                          "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time①⑧\">start time</a> of <var>animation</var> to <var>new start time</var>.</p>"
                        },
                        {
                          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate⑧\">playback rate</a> is not 0,\nmake <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time①⑨\">hold time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④②\">unresolved</a>.</p>"
                        }
                      ]
                    },
                    {
                      "case": "If animation’s start time is resolved and animation has a pending playback rate,",
                      "html": "",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>Let <var>current time to match</var> be the result of evaluating\n<code>(<var>ready time</var> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②⓪\">start time</a>)\n      × <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate⑨\">playback rate</a></code>\nfor <var>animation</var>.</p>"
                        },
                        {
                          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate④\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
                        },
                        {
                          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate①⓪\">playback rate</a> is zero,\nlet <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②⓪\">hold time</a> be <var>current time to match</var>.</p>"
                        },
                        {
                          "html": "<p>Let <var>new start time</var> be the result of evaluating\n<code><var>ready time</var> − <var>current time to match</var>\n      / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate①①\">playback rate</a></code>\nfor <var>animation</var>.\nIf the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate①②\">playback rate</a> is zero,\nlet <var>new start time</var> be simply <var>ready time</var>.</p>"
                        },
                        {
                          "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②①\">start time</a> of <var>animation</var> to <var>new start time</var>.</p>"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑤\">Resolve</a> <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise⑥\">current ready promise</a>\nwith <var>animation</var>.</p>"
            },
            {
              "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state⑤\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
            }
          ]
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state⑥\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
        }
      ]
    },
    {
      "name": "pause an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#pause-an-animation",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pause-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pause an animation</dfn>, <var>animation</var>,\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task⑦\">pending pause task</a>,\nabort these steps.</p>"
        },
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-play-state\" id=\"ref-for-animation-play-state\">play state</a> of <var>animation</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-state-paused\" id=\"ref-for-play-state-paused\">paused</a>,\nabort these steps.</p>"
        },
        {
          "html": "<p>Let <var>seek time</var> be\na <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②⑥\">time value</a> that is initially <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④④\">unresolved</a>.</p>"
        },
        {
          "html": "<p>Let <var>has finite timeline</var> be true\nif <var>animation</var> has an associated <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline③①\">timeline</a>\nthat is not <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#monotonically-increasing-timeline\" id=\"ref-for-monotonically-increasing-timeline②\">monotonically increasing</a>.</p>"
        },
        {
          "html": "If the <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time②⓪\">current time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④⑤\">unresolved</a>,\nperform the steps according to the first matching condition below:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If animation’s playback rate is ≥ 0,",
                  "html": "<p>Set <var>seek time</var> to zero.</p>"
                },
                {
                  "case": "Otherwise,",
                  "html": "<dl class=\"switch\">\n         <dt data-md=\"\">If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end④\">associated effect end</a> for <var>animation</var> is positive infinity,\n         </dt><dd data-md=\"\">\n          <p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw②\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException①\">DOMException</a></code>\nand abort these steps.</p>\n         </dd><dt data-md=\"\">Otherwise,\n         </dt><dd data-md=\"\">\n          <p>Set <var>seek time</var> to <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end⑤\">associated effect end</a>.</p>\n        </dd></dl>",
                  "rationale": ".switch",
                  "steps": [
                    {
                      "operation": "switch",
                      "steps": [
                        {
                          "case": "If associated effect end for animation is positive infinity,",
                          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw②\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException①\">DOMException</a></code>\nand abort these steps.</p>"
                        },
                        {
                          "case": "Otherwise,",
                          "html": "<p>Set <var>seek time</var> to <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end⑤\">associated effect end</a>.</p>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>seek time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④⑥\">resolved</a>,</p>\n      <div class=\"switch\">\n       <dl>\n        <dt data-md=\"\">If <var>has finite timeline</var> is true,\n        </dt><dd data-md=\"\">\n         <p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②③\">start time</a> to <var>seek time</var>.</p>\n        </dd><dt data-md=\"\">Otherwise,\n        </dt><dd data-md=\"\">\n         <p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②①\">hold time</a> to <var>seek time</var>.</p>\n       </dd></dl>\n      </div>"
        },
        {
          "html": "<p>Let <var>has pending ready promise</var> be a boolean flag\n that is initially false.</p>"
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task⑧\">pending play task</a>,\ncancel that task\nand let <var>has pending ready promise</var> be true.</p>"
        },
        {
          "html": "<p>If <var>has pending ready promise</var> is false,\nset <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise⑨\">current ready promise</a> to\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise①\">a new promise</a> in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm②\">relevant Realm</a> of <var>animation</var>.</p>"
        },
        {
          "html": "So long as the above task is scheduled but has yet to run,\n<var>animation</var> is described as having a <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pending-pause-task\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pending pause task</dfn>.\nWhile the task is running, however,\n<var>animation</var> does <em>not</em> have a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task⑧\">pending pause task</a>.",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>ready time</var> be the time value of\nthe timeline associated with <var>animation</var>\nat the moment when the user agent completed processing necessary\nto suspend playback of <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-associated-effect\" id=\"ref-for-animation-associated-effect①②\">associated effect</a>.</p>"
            },
            {
              "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②④\">start time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved④⑦\">resolved</a>\nand its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②②\">hold time</a> is <em>not</em> resolved,\nlet <var>animation</var>’s <span id=\"ref-for-animation-hold-time②③\">hold time</span> be the result of evaluating\n<code>(<var>ready time</var> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②⑤\">start time</a>)\n      × <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate①④\">playback rate</a></code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate⑤\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
            },
            {
              "html": "<p>Make <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②⑥\">start time</a> unresolved.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑥\">Resolve</a> <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①⓪\">current ready promise</a>\nwith <var>animation</var>.</p>"
            },
            {
              "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state⑦\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
            }
          ]
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state⑧\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
        }
      ]
    },
    {
      "name": "update animation finished state",
      "href": "https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"update-an-animations-finished-state\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update an animation’s finished state</dfn>\n    for <var>animation</var>,\n    given a flag <var>did seek</var>\n    (to indicate if the update is being performed\n     after <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-set-the-current-time\" id=\"ref-for-animation-set-the-current-time①\">setting the current time</a>),\n    and a flag <var>synchronously notify</var>\n    (to indicate the update was called\n     in a context where we expect finished event queueing\n     and finished promise resolution to happen immediately,\n     if at all)\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let the <var>unconstrained current time</var> be\nthe result of calculating the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time②⑨\">current time</a>,\nsubstituting an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤⓪\">unresolved</a> time value for the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②⑥\">hold time</a>\nif <var>did seek</var> is false.\nIf <var>did seek</var> is true,\nthe <var>unconstrained current time</var>\nis equal to the <span id=\"ref-for-animation-current-time③⓪\">current time</span>.</p>"
        },
        {
          "html": "then update <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②⑦\">hold time</a> based on\nthe first matching condition for <var>animation</var> from below, if any:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If playback rate > 0 and unconstrained current time is greater than or equal to associated effect end,",
                  "html": "<p>If <var>did seek</var> is true,\nlet the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②⑧\">hold time</a> be the value of <var>unconstrained current time</var>.</p>\n        <p>If <var>did seek</var> is false,\nlet the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time②⑨\">hold time</a> be the maximum value\nof <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#previous-current-time\" id=\"ref-for-previous-current-time①\">previous current time</a> and <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end⑨\">associated effect end</a>.\nIf the <span id=\"ref-for-previous-current-time②\">previous current time</span> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤③\">unresolved</a>,\nlet the <span id=\"ref-for-animation-hold-time③⓪\">hold time</span> be <span id=\"ref-for-associated-effect-end①⓪\">associated effect end</span>.</p>"
                },
                {
                  "case": "If playback rate < 0 and unconstrained current time is less than or equal to 0,",
                  "html": "<p>If <var>did seek</var> is true,\nlet the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③①\">hold time</a> be the value of <var>unconstrained current time</var>.</p>\n        <p>If <var>did seek</var> is false,\nlet the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③②\">hold time</a> be the minimum value\nof <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#previous-current-time\" id=\"ref-for-previous-current-time③\">previous current time</a> and zero.\nIf the <span id=\"ref-for-previous-current-time④\">previous current time</span> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤④\">unresolved</a>,\nlet the <span id=\"ref-for-animation-hold-time③③\">hold time</span> be zero.</p>"
                },
                {
                  "case": "If playback rate ≠ 0, and animation is associated with an active timeline,",
                  "html": "Perform the following steps:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>If <var>did seek</var> is true\nand the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③④\">hold time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤⑤\">resolved</a>,\nlet <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time②⑨\">start time</a> be equal to\nthe result of evaluating\n<code><var>timeline time</var>\n      − (<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③⑤\">hold time</a> / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate②②\">playback rate</a>)</code>\nwhere <var>timeline time</var> is the current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②⑧\">time value</a> of\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline③③\">timeline</a> associated with <var>animation</var>.</p>"
                    },
                    {
                      "html": "<p>Let the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③⑥\">hold time</a> be <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤⑥\">unresolved</a>.</p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#previous-current-time\" id=\"ref-for-previous-current-time⑤\">previous current time</a> of <var>animation</var> to be\nthe result of calculating its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time③①\">current time</a>.</p>"
        },
        {
          "html": "<p>Let <var>current finished state</var> be true\n if the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-play-state\" id=\"ref-for-animation-play-state①\">play state</a> of <var>animation</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-state-finished\" id=\"ref-for-play-state-finished④\">finished</a>.\nOtherwise, let it be false.</p>"
        },
        {
          "html": "If <var>current finished state</var> is true\nand the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-finished-promise\" id=\"ref-for-current-finished-promise②\">current finished promise</a> is not yet resolved,\nperform the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"finish-notification-steps\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">finish notification steps</dfn> refer to\nthe following procedure:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-play-state\" id=\"ref-for-animation-play-state②\">play state</a>\nis not equal to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-state-finished\" id=\"ref-for-play-state-finished⑤\">finished</a>,\nabort these steps.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑦\">Resolve</a>\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-finished-promise\" id=\"ref-for-current-finished-promise③\">current finished promise</a> object\nwith <var>animation</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-create\" id=\"ref-for-concept-event-create\">Create</a>\nan <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#animationplaybackevent\" id=\"ref-for-animationplaybackevent\">AnimationPlaybackEvent</a></code>, <var>finishEvent</var>.</p>"
                },
                {
                  "html": "<p>Set <var>finishEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-type\" id=\"ref-for-dom-event-type\">type</a></code> attribute\nto <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#finish-event\" id=\"ref-for-finish-event\">finish</a>.</p>"
                },
                {
                  "html": "<p>Set <var>finishEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-currenttime\" id=\"ref-for-dom-animationplaybackevent-currenttime\">currentTime</a></code> attribute\nto the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time③②\">current time</a> of <var>animation</var>.</p>"
                },
                {
                  "html": "<p>Set <var>finishEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-timelinetime\" id=\"ref-for-dom-animationplaybackevent-timelinetime\">timelineTime</a></code> attribute\nto the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-current-time\" id=\"ref-for-timeline-current-time⑨\">current time</a>\nof the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline③④\">timeline</a> with which <var>animation</var> is associated.\nIf <var>animation</var> is not associated with a timeline,\nor the timeline is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#inactive-timeline\" id=\"ref-for-inactive-timeline⑧\">inactive</a>,\nlet <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-timelinetime\" id=\"ref-for-dom-animationplaybackevent-timelinetime①\">timelineTime</a></code> be\n<code class=\"esvalue\">null</code>.</p>"
                },
                {
                  "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-document-for-timing\" id=\"ref-for-animation-document-for-timing①\">document for timing</a>,\nthen append <var>finishEvent</var>\nto its <span id=\"ref-for-animation-document-for-timing②\">document for timing</span>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-animation-event-queue\" id=\"ref-for-pending-animation-event-queue②\">pending animation event queue</a>\nalong with its target, <var>animation</var>.\nFor the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#scheduled-event-time\" id=\"ref-for-scheduled-event-time②\">scheduled event time</a>,\nuse the result of\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-time-to-origin-relative-time\" id=\"ref-for-animation-time-to-origin-relative-time\">converting</a>\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end①①\">associated effect end</a>\nto an origin-relative time.</p>\n          <p>Otherwise,\n<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task\">queue a task</a> to <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-dispatch\" id=\"ref-for-concept-event-dispatch①\">dispatch</a> <var>finishEvent</var> at <var>animation</var>.\nThe task source for this task is\nthe <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source\" id=\"ref-for-dom-manipulation-task-source\">DOM manipulation task source</a>.</p>"
                }
              ]
            },
            {
              "html": "<p>If <var>synchronously notify</var> is true,\ncancel any queued microtask to run\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#finish-notification-steps\" id=\"ref-for-finish-notification-steps\">finish notification steps</a> for this <var>animation</var>,\nand run the <span id=\"ref-for-finish-notification-steps①\">finish notification steps</span> immediately.</p>\n        <p>Otherwise,\nif <var>synchronously notify</var> is false,\n<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask\" id=\"ref-for-queue-a-microtask\">queue a microtask</a>\nto run <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#finish-notification-steps\" id=\"ref-for-finish-notification-steps②\">finish notification steps</a> for <var>animation</var>\nunless there is already a microtask queued\nto run those steps for <var>animation</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>current finished state</var> is false\nand <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-finished-promise\" id=\"ref-for-current-finished-promise④\">current finished promise</a> is already resolved,\nset <var>animation</var>’s <span id=\"ref-for-current-finished-promise⑤\">current finished promise</span> to\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise②\">a new promise</a> in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm③\">relevant Realm</a> of <var>animation</var>.</p>"
        }
      ]
    },
    {
      "name": "finish an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#finish-an-animation",
      "html": "An animation can be advanced\n    to the natural end of its current playback direction\n    by using the procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"finish-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">finish an animation</dfn> for <var>animation</var>\n    defined below:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effective-playback-rate\" id=\"ref-for-effective-playback-rate②\">effective playback rate</a> is zero,\nor if <var>animation</var>’s <span id=\"ref-for-effective-playback-rate③\">effective playback rate</span> &gt; 0\nand <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end①②\">associated effect end</a> is infinity,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw③\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror②\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException②\">DOMException</a></code>\nand abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate⑥\">Apply any pending playback rate</a> to <var>animation</var>.</p>"
        },
        {
          "html": "<p>Set <var>limit</var> as follows:</p>\n      <div class=\"switch\">\n       <dl>\n        <dt data-md=\"\">If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate②③\">playback rate</a> &gt; 0,\n        </dt><dd data-md=\"\">\n         <p>Let <var>limit</var> be <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end①③\">associated effect end</a>.</p>\n        </dd><dt data-md=\"\">Otherwise,\n        </dt><dd data-md=\"\">\n         <p>Let <var>limit</var> be zero.</p>\n       </dd></dl>\n      </div>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-silently-set-the-current-time\" id=\"ref-for-animation-silently-set-the-current-time①\">Silently set the current time</a> to <var>limit</var>.</p>"
        },
        {
          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③⓪\">start time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤⑦\">unresolved</a>\nand <var>animation</var> has an associated <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-timeline\" id=\"ref-for-active-timeline②\">active timeline</a>,\nlet the <span id=\"ref-for-animation-start-time③①\">start time</span> be the result of evaluating\n<code><var>timeline time</var>\n      − (<var>limit</var> / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate②④\">playback rate</a>)</code>\nwhere <var>timeline time</var> is the current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value②⑨\">time value</a>\nof the associated <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline③⑤\">timeline</a>.</p>"
        },
        {
          "html": "If there is a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task①①\">pending pause task</a>\n  and <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③②\">start time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤⑧\">resolved</a>,",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③⑦\">hold time</a> be <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑤⑨\">unresolved</a>.</p>"
            },
            {
              "html": "<p>Cancel the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task①②\">pending pause task</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑧\">Resolve</a> the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①②\">current ready promise</a>\nof <var>animation</var> with <var>animation</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If there is a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task①②\">pending play task</a>\nand <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③③\">start time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥⓪\">resolved</a>,\ncancel that task and <a data-link-type=\"dfn\" data-refhint-key=\"d89e99c5\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑨\">resolve</a>\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①③\">current ready promise</a> of <var>animation</var>\nwith <var>animation</var>.</p>"
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state①⓪\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to true,\nand the <var>synchronously notify</var> flag set to true.</p>"
        }
      ]
    },
    {
      "name": "cancel an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#cancel-an-animation",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"cancel-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">cancel an animation</dfn> for <var>animation</var>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-play-state\" id=\"ref-for-animation-play-state③\">play state</a> is <em>not</em> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-state-idle\" id=\"ref-for-play-state-idle①\">idle</a>,\nperform the following steps:",
          "rationale": "run",
          "steps": [
            {
              "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-reset-an-animations-pending-tasks\" id=\"ref-for-animation-reset-an-animations-pending-tasks\">reset an animation’s pending tasks</a>\non <var>animation</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject\">Reject</a> the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-finished-promise\" id=\"ref-for-current-finished-promise⑧\">current finished promise</a>\nwith a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException③\">DOMException</a></code> named \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror\">AbortError</a></code>\".</p>"
            },
            {
              "html": "<p>Set the [[PromiseIsHandled]] internal slot\nof the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-finished-promise\" id=\"ref-for-current-finished-promise⑨\">current finished promise</a>\nto true.</p>"
            },
            {
              "html": "<p>Let <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-finished-promise\" id=\"ref-for-current-finished-promise①⓪\">current finished promise</a> be\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise③\">a new promise</a> in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm④\">relevant Realm</a> of <var>animation</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-create\" id=\"ref-for-concept-event-create①\">Create</a>\nan <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#animationplaybackevent\" id=\"ref-for-animationplaybackevent①\">AnimationPlaybackEvent</a></code>, <var>cancelEvent</var>.</p>"
            },
            {
              "html": "<p>Set <var>cancelEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-type\" id=\"ref-for-dom-event-type①\">type</a></code> attribute\nto <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#cancel-event\" id=\"ref-for-cancel-event①\">cancel</a>.</p>"
            },
            {
              "html": "<p>Set <var>cancelEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-currenttime\" id=\"ref-for-dom-animationplaybackevent-currenttime①\">currentTime</a></code>\nto <code class=\"esvalue\">null</code>.</p>"
            },
            {
              "html": "<p>Let <var>timeline time</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-current-time\" id=\"ref-for-timeline-current-time①⓪\">current time</a>\nof the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline③⑥\">timeline</a> with which <var>animation</var> is associated.\nIf <var>animation</var> is not associated with an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-timeline\" id=\"ref-for-active-timeline③\">active timeline</a>,\nlet <var>timeline time</var> be an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥②\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③⓪\">time value</a>.</p>"
            },
            {
              "html": "<p>Set <var>cancelEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-timelinetime\" id=\"ref-for-dom-animationplaybackevent-timelinetime②\">timelineTime</a></code>\nto <var>timeline time</var>.\nIf <var>timeline time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥③\">unresolved</a>,\nset it to <code class=\"esvalue\">null</code>.</p>"
            },
            {
              "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-document-for-timing\" id=\"ref-for-animation-document-for-timing③\">document for timing</a>,\nthen append <var>cancelEvent</var> to\nits <span id=\"ref-for-animation-document-for-timing④\">document for timing</span>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-animation-event-queue\" id=\"ref-for-pending-animation-event-queue③\">pending animation event queue</a>\nalong with its target, <var>animation</var>.\nIf <var>animation</var> is associated with an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-timeline\" id=\"ref-for-active-timeline④\">active timeline</a>\nthat defines a procedure to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-time-to-origin-relative-time\" id=\"ref-for-timeline-time-to-origin-relative-time①\">convert\ntimeline times to origin-relative time</a>,\nlet the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#scheduled-event-time\" id=\"ref-for-scheduled-event-time③\">scheduled event time</a> be\nthe result of applying that procedure to <var>timeline time</var>.\nOtherwise, the <span id=\"ref-for-scheduled-event-time④\">scheduled event time</span> is\nan <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥④\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③①\">time value</a>.</p>\n        <p>Otherwise,\n<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task①\">queue a task</a> to <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-dispatch\" id=\"ref-for-concept-event-dispatch②\">dispatch</a> <var>cancelEvent</var> at <var>animation</var>.\nThe task source for this task is\nthe <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source\" id=\"ref-for-dom-manipulation-task-source①\">DOM manipulation task source</a>.</p>"
            }
          ]
        },
        {
          "html": "<p>Make <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time③⑨\">hold time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥⑤\">unresolved</a>.</p>"
        },
        {
          "html": "<p>Make <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③④\">start time</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥⑥\">unresolved</a>.</p>"
        }
      ]
    },
    {
      "name": "animation/reset an animation’s pending tasks",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-reset-an-animations-pending-tasks",
      "html": "The procedure to\n    <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"animation\" data-dfn-type=\"dfn\" data-export=\"\" id=\"animation-reset-an-animations-pending-tasks\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">reset an animation’s pending tasks</dfn>\n    for <var>animation</var> is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>animation</var> does not have\na <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task①③\">pending play task</a> or a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task①③\">pending pause task</a>,\nabort this procedure.</p>"
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-play-task\" id=\"ref-for-pending-play-task①④\">pending play task</a>,\ncancel that task.</p>"
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-pause-task\" id=\"ref-for-pending-pause-task①④\">pending pause task</a>,\ncancel that task.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate⑦\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①\">Reject</a>\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①④\">current ready promise</a>\nwith a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException④\">DOMException</a></code> named \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror①\">AbortError</a></code>\".</p>"
        },
        {
          "html": "<p>Set the [[PromiseIsHandled]] internal slot of <var>animation</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①⑤\">current ready promise</a> to true.</p>"
        },
        {
          "html": "<p>Let <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-ready-promise\" id=\"ref-for-current-ready-promise①⑥\">current ready promise</a> be the result of\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\" id=\"ref-for-a-promise-resolved-with①\">creating a new resolved Promise object</a>\nwith value <var>animation</var>\nin the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm⑤\">relevant Realm</a> of <var>animation</var>.</p>"
        }
      ]
    },
    {
      "name": "set the playback rate",
      "href": "https://drafts.csswg.org/web-animations-1/#set-the-playback-rate",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"set-the-playback-rate\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">set the playback rate</dfn>\n    of an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation②④\">animation</a>, <var>animation</var>,\n    to <var>new playback rate</var>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Clear any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate②\">pending playback rate</a> on <var>animation</var>.</p>"
        },
        {
          "html": "<p>Let <var>previous time</var> be\nthe value of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time③⑦\">current time</a> of <var>animation</var>\nbefore changing the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate②⑧\">playback rate</a>.</p>"
        },
        {
          "html": "<p>Let <var>previous playback rate</var> be\nthe current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effective-playback-rate\" id=\"ref-for-effective-playback-rate④\">effective playback rate</a> of <var>animation</var>.</p>"
        },
        {
          "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate②⑨\">playback rate</a> to <var>new playback rate</var>.</p>"
        },
        {
          "html": "Perform the steps corresponding to\nthe <em>first</em> matching condition from the following, if any:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If animation is associated with a monotonically increasing timeline and the previous time is resolved,",
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-set-the-current-time\" id=\"ref-for-animation-set-the-current-time②\">Set the current time</a> of <var>animation</var> to <var>previous time</var>.</p>"
                },
                {
                  "case": "If animation is associated with a non-null timeline that is not monotonically increasing, the start time of animation is resolved, associated effect end is not infinity, and either: the previous playback rate < 0 and the new playback rate ≥ 0, or the previous playback rate ≥ 0 and the new playback rate < 0,",
                  "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③⑥\">start time</a> to the result of evaluating\n<code><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#associated-effect-end\" id=\"ref-for-associated-effect-end①⑤\">associated effect end</a> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③⑦\">start time</a></code>\nfor <var>animation</var>.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "apply any pending playback rate",
      "href": "https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate",
      "html": "When an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation②⑧\">animation</a>, <var>animation</var>, is to\n    <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"apply-any-pending-playback-rate\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">apply any pending playback rate</dfn>\n    the following steps are performed:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>animation</var> does not have a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate⑤\">pending playback rate</a>,\nabort these steps.</p>"
        },
        {
          "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate③②\">playback rate</a> to its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate⑥\">pending playback rate</a>.</p>"
        },
        {
          "html": "<p>Clear <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate⑦\">pending playback rate</a>.</p>"
        }
      ]
    },
    {
      "name": "seamlessly update the playback rate",
      "href": "https://drafts.csswg.org/web-animations-1/#seamlessly-update-the-playback-rate",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"seamlessly-update-the-playback-rate\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">seamlessly update the playback rate</dfn>\n    of an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation②⑨\">animation</a>, <var>animation</var>,\n    to <var>new playback rate</var>\n    preserving its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time③⑧\">current time</a>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>previous play state</var> be <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-play-state\" id=\"ref-for-animation-play-state⑤\">play state</a>.</p>"
        },
        {
          "html": "<p>Let <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate①⓪\">pending playback rate</a> be <var>new playback rate</var>.</p>"
        },
        {
          "html": "Perform the steps corresponding to\nthe first matching condition below:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If animation has a pending play task or a pending pause task,",
                  "html": "<p>Abort these steps.</p>"
                },
                {
                  "case": "If previous play state is idle or paused, or animation’s current time is unresolved,",
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate⑧\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
                },
                {
                  "case": "If previous play state is finished,",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let the <var>unconstrained current time</var> be\nthe result of calculating\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time④⓪\">current time</a> of <var>animation</var>\nsubstituting an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑥⑨\">unresolved</a> time value\nfor the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-hold-time\" id=\"ref-for-animation-hold-time④⓪\">hold time</a>.</p>"
                    },
                    {
                      "html": "<p>Let <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③⑧\">start time</a> be\nthe result of evaluating the following expression:</p>\n          <blockquote>\n   <code><var>timeline time</var>\n         − (<var>unconstrained current time</var>\n            / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate①②\">pending playback rate</a>)</code>\n  </blockquote>\n          <p>Where <var>timeline time</var> is the current <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③④\">time value</a> of\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline④②\">timeline</a> associated with <var>animation</var>.</p>\n          <p>If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate①③\">pending playback rate</a> is zero,\nlet <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time③⑨\">start time</a> be <var>timeline time</var>.</p>"
                    },
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#apply-any-pending-playback-rate\" id=\"ref-for-apply-any-pending-playback-rate⑨\">Apply any pending playback rate</a> on <var>animation</var>.</p>"
                    },
                    {
                      "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-an-animations-finished-state\" id=\"ref-for-update-an-animations-finished-state①①\">update an animation’s finished state</a>\nfor <var>animation</var>\nwith the <var>did seek</var> flag set to false,\nand the <var>synchronously notify</var> flag set to false.</p>"
                    }
                  ]
                },
                {
                  "case": "Otherwise,",
                  "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-an-animation\" id=\"ref-for-play-an-animation①\">play an animation</a> for <var>animation</var>\nwith the <var>auto-rewind</var> flag set to false.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "reverse an animation",
      "href": "https://drafts.csswg.org/web-animations-1/#reverse-an-animation",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"reverse-an-animation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">reverse an animation</dfn>\n    of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation③⓪\">animation</a> <var>animation</var>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If there is no <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline④③\">timeline</a> associated with <var>animation</var>,\nor the associated <span id=\"ref-for-timeline④④\">timeline</span> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#inactive-timeline\" id=\"ref-for-inactive-timeline⑨\">inactive</a>\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw④\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror③\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑤\">DOMException</a></code>\nand abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>original pending playback rate</var> be\n<var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate①④\">pending playback rate</a>.</p>"
        },
        {
          "html": "<p>Let <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate①⑤\">pending playback rate</a> be\nthe additive inverse of its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effective-playback-rate\" id=\"ref-for-effective-playback-rate⑥\">effective playback rate</a>\n(i.e. <code>-<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effective-playback-rate\" id=\"ref-for-effective-playback-rate⑦\">effective playback rate</a></code>).</p>"
        },
        {
          "html": "<p>Run the steps to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-an-animation\" id=\"ref-for-play-an-animation②\">play an animation</a> for <var>animation</var>\nwith the <var>auto-rewind</var> flag set to true.</p>\n      <p>If the steps to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-an-animation\" id=\"ref-for-play-an-animation③\">play an animation</a> throw an exception,\nset <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-playback-rate\" id=\"ref-for-pending-playback-rate①⑥\">pending playback rate</a>\nto <var>original pending playback rate</var>\nand propagate the exception.</p>"
        }
      ]
    },
    {
      "name": "animation time to timeline time",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-time-to-timeline-time",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"animation time to timeline time\" data-noexport=\"\" id=\"animation-time-to-timeline-time\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">convert\n    an animation time to timeline time</dfn>\n    a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③⑥\">time value</a>, <var>time</var>, that is relative to\n    the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time④④\">start time</a> of an animation, <var>animation</var>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑦⑥\">unresolved</a>,\n return <var>time</var>.</p>"
        },
        {
          "html": "<p>If <var>time</var> is infinity,\n return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑦⑦\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③⑦\">time value</a>.</p>"
        },
        {
          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate③④\">playback rate</a> is zero,\n return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑦⑧\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③⑧\">time value</a>.</p>"
        },
        {
          "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time④⑤\">start time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑦⑨\">unresolved</a>,\n return an <span id=\"ref-for-unresolved⑧⓪\">unresolved</span> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value③⑨\">time value</a>.</p>"
        },
        {
          "html": "<p>Return the result of calculating\n <code><var>time</var> × (1 / <var>playback rate</var>) +\n       <var>start time</var></code>,\n where <var>playback rate</var> and <var>start time</var> are\n the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-rate\" id=\"ref-for-playback-rate③⑤\">playback rate</a> and <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-start-time\" id=\"ref-for-animation-start-time④⑥\">start time</a> of <var>animation</var>,\n respectively.</p>"
        }
      ]
    },
    {
      "name": "animation time to origin-relative time",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-time-to-origin-relative-time",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"animation time to origin-relative time\" data-noexport=\"\" id=\"animation-time-to-origin-relative-time\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">convert\n    a timeline time to an origin-relative time</dfn>\n    a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value④⓪\">time value</a>, <var>time</var>, that is expressed in the same scale\n    as the <span id=\"ref-for-time-value④①\">time values</span> of a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline④⑧\">timeline</a>, <var>timeline</var>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>timeline time</var> be the result of\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-time-to-timeline-time\" id=\"ref-for-animation-time-to-timeline-time\">converting</a> <var>time</var>\nfrom an animation time to a timeline time.</p>"
        },
        {
          "html": "<p>If <var>timeline time</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑧①\">unresolved</a>,\n return <var>time</var>.</p>"
        },
        {
          "html": "<p>If <var>animation</var> is not associated with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline④⑨\">timeline</a>,\n return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑧②\">unresolved</a> time value.</p>"
        },
        {
          "html": "<p>If <var>animation</var> is associated with an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#inactive-timeline\" id=\"ref-for-inactive-timeline①①\">inactive timeline</a>,\n return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑧③\">unresolved</a> time value.</p>"
        },
        {
          "html": "<p>If there is no procedure\n to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-time-to-origin-relative-time\" id=\"ref-for-timeline-time-to-origin-relative-time②\">convert\n a timeline time to an origin-relative time</a>\n for the timeline associated with <var>animation</var>,\n return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑧④\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value④②\">time value</a>.</p>"
        },
        {
          "html": "<p>Return the result of\n <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-time-to-origin-relative-time\" id=\"ref-for-timeline-time-to-origin-relative-time③\">converting</a>\n <var>timeline time</var> to an origin-relative time\n using the procedure defined for\n the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline⑤⓪\">timeline</a> associated with <var>animation</var>.</p>"
        }
      ]
    },
    {
      "name": "active time",
      "href": "https://drafts.csswg.org/web-animations-1/#active-time",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"active-time\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">active time</dfn> is based on the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#local-time\" id=\"ref-for-local-time②①\">local time</a> and <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#start-delay\" id=\"ref-for-start-delay①②\">start delay</a>.\n  However, it is only defined\n  when the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect\" id=\"ref-for-animation-effect⑥④\">animation effect</a> should produce an output\n  and hence depends on its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode⑧\">fill mode</a> and phase as follows:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "If the animation effect is in the before phase,",
              "html": "The result depends on the first matching condition from the following:",
              "rationale": ".switch",
              "steps": [
                {
                  "operation": "switch",
                  "steps": [
                    {
                      "case": "If the fill mode is backwards or both,",
                      "html": "<p>Return the result of evaluating\n  <code>max(<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#local-time\" id=\"ref-for-local-time②②\">local time</a> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#start-delay\" id=\"ref-for-start-delay①③\">start delay</a>, 0)</code>.</p>"
                    },
                    {
                      "case": "Otherwise,",
                      "html": "<p>Return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑨②\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value④④\">time value</a>.</p>"
                    }
                  ]
                }
              ]
            },
            {
              "case": "If the animation effect is in the active phase,",
              "html": "<p>Return the result of evaluating\n  <code><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#local-time\" id=\"ref-for-local-time②③\">local time</a> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#start-delay\" id=\"ref-for-start-delay①④\">start delay</a></code>.</p>"
            },
            {
              "case": "If the animation effect is in the after phase,",
              "html": "<p>The result depends on the first matching condition from the following:</p>\n     <div class=\"switch\">\n      <dl>\n       <dt data-md=\"\">If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode①⓪\">fill mode</a> is\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode-forwards\" id=\"ref-for-fill-mode-forwards②\">forwards</a> or <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode-both\" id=\"ref-for-fill-mode-both②\">both</a>,\n       </dt><dd data-md=\"\">\n        <p>Return the result of evaluating\n  <code>max(min(<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#local-time\" id=\"ref-for-local-time②④\">local time</a> − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#start-delay\" id=\"ref-for-start-delay①⑤\">start delay</a>,\n                <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-duration\" id=\"ref-for-active-duration①⑤\">active duration</a>),\n            0)</code>.</p>\n       </dd><dt data-md=\"\">Otherwise,\n       </dt><dd data-md=\"\">\n        <p>Return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑨③\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value④⑤\">time value</a>.</p>\n      </dd></dl>\n     </div>"
            },
            {
              "case": "Otherwise (the local time is unresolved),",
              "html": "<p>Return an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑨⑤\">unresolved</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#time-value\" id=\"ref-for-time-value④⑥\">time value</a>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "overall progress",
      "href": "https://drafts.csswg.org/web-animations-1/#overall-progress",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"overall-progress\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">overall progress</dfn> describes\n  the number of iterations that have completed (including partial iterations)\n  and is defined as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-time\" id=\"ref-for-active-time①③\">active time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑨⑥\">unresolved</a>,\n  return <span id=\"ref-for-unresolved⑨⑦\">unresolved</span>.</p>"
        },
        {
          "html": "<p>Calculate an initial value for <var>overall progress</var>\n  based on the first matching condition below:</p>\n     <div class=\"switch\">\n      <dl>\n       <dt data-md=\"\">If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-duration\" id=\"ref-for-iteration-duration①④\">iteration duration</a> is zero,\n       </dt><dd data-md=\"\">\n        <p>If the animation effect is in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-before-phase\" id=\"ref-for-animation-effect-before-phase⑦\">before phase</a>,\n  let <var>overall progress</var> be zero;\n  otherwise, let it be equal to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-count\" id=\"ref-for-iteration-count①④\">iteration count</a>.</p>\n       </dd><dt data-md=\"\">Otherwise,\n       </dt><dd data-md=\"\">\n        <p>Let <var>overall progress</var> be the result of calculating\n  <code><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-time\" id=\"ref-for-active-time①④\">active time</a> / <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-duration\" id=\"ref-for-iteration-duration①⑤\">iteration duration</a></code>.</p>\n      </dd></dl>\n     </div>"
        },
        {
          "html": "<p>Return the result of calculating\n  <code><var>overall progress</var> + <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-start\" id=\"ref-for-iteration-start⑧\">iteration start</a></code>.</p>"
        }
      ]
    },
    {
      "name": "simple iteration progress",
      "href": "https://drafts.csswg.org/web-animations-1/#simple-iteration-progress",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"simple-iteration-progress\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">simple iteration progress</dfn>\n  is a fraction of the progress through the current iteration\n  that ignores transformations to the time introduced by\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-direction\" id=\"ref-for-playback-direction②\">playback direction</a> or <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function\" id=\"ref-for-easing-function④\">easing functions</a> applied to the effect,\n  and is calculated as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#overall-progress\" id=\"ref-for-overall-progress②\">overall progress</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved⑨⑧\">unresolved</a>,\n  return <span id=\"ref-for-unresolved⑨⑨\">unresolved</span>.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#overall-progress\" id=\"ref-for-overall-progress③\">overall progress</a> is infinity,\n  let the <var>simple iteration progress</var> be\n  <code><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-start\" id=\"ref-for-iteration-start⑨\">iteration start</a> % 1.0</code>;\n  otherwise,\n  let the <var>simple iteration progress</var> be\n  <code><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#overall-progress\" id=\"ref-for-overall-progress④\">overall progress</a> % 1.0</code>.</p>"
        },
        {
          "html": "<p>If <em>all</em> of the following conditions are true:</p>\n     <ul>\n      <li data-md=\"\">\n       <p>the <var>simple iteration progress</var> calculated above is zero,\n  <em>and</em></p>\n      </li><li data-md=\"\">\n       <p>the animation effect is in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-active-phase\" id=\"ref-for-animation-effect-active-phase⑥\">active phase</a>\n  <em>or</em> the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-after-phase\" id=\"ref-for-animation-effect-after-phase⑦\">after phase</a>,\n  <em>and</em></p>\n      </li><li data-md=\"\">\n       <p>the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-time\" id=\"ref-for-active-time①⑤\">active time</a> is equal to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-duration\" id=\"ref-for-active-duration①⑥\">active duration</a>,\n  <em>and</em></p>\n      </li><li data-md=\"\">\n       <p>the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-count\" id=\"ref-for-iteration-count①⑤\">iteration count</a> is <em>not</em> equal to zero.</p>\n     </li></ul>\n     <p>Let the <var>simple iteration progress</var> be 1.0.</p>"
        },
        {
          "html": "<p>Return <var>simple iteration progress</var>.</p>"
        }
      ]
    },
    {
      "name": "current iteration index",
      "href": "https://drafts.csswg.org/web-animations-1/#current-iteration-index",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"current iteration index | iteration index\" data-noexport=\"\" id=\"current-iteration-index\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">current iteration index</dfn>\n  can be calculated\n  using the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#active-time\" id=\"ref-for-active-time①⑥\">active time</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⓪⓪\">unresolved</a>,\n  return <span id=\"ref-for-unresolved①⓪①\">unresolved</span>.</p>"
        },
        {
          "html": "<p>If the animation effect is in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-after-phase\" id=\"ref-for-animation-effect-after-phase⑧\">after phase</a> <em>and</em>\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-count\" id=\"ref-for-iteration-count①⑦\">iteration count</a> is infinity,\n  return infinity.</p>"
        },
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#simple-iteration-progress\" id=\"ref-for-simple-iteration-progress②\">simple iteration progress</a> is 1.0,\n  return <code>floor(<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#overall-progress\" id=\"ref-for-overall-progress⑤\">overall progress</a>) − 1</code>.</p>"
        },
        {
          "html": "<p>Otherwise, return <code>floor(<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#overall-progress\" id=\"ref-for-overall-progress⑥\">overall progress</a>)</code>.</p>"
        }
      ]
    },
    {
      "name": "directed progress",
      "href": "https://drafts.csswg.org/web-animations-1/#directed-progress",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"directed-progress\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">directed progress</dfn> is calculated\n  from the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#simple-iteration-progress\" id=\"ref-for-simple-iteration-progress③\">simple iteration progress</a>\n  using the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#simple-iteration-progress\" id=\"ref-for-simple-iteration-progress④\">simple iteration progress</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⓪②\">unresolved</a>,\n  return <span id=\"ref-for-unresolved①⓪③\">unresolved</span>.</p>"
        },
        {
          "html": "Calculate the <var>current direction</var>\n  using the first matching condition from the following list:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If playback direction is normal,",
                  "html": "<p>Let the <var>current direction</var> be forwards.</p>"
                },
                {
                  "case": "If playback direction is reverse,",
                  "html": "<p>Let the <var>current direction</var> be reverse.</p>"
                },
                {
                  "case": "Otherwise (the playback direction is alternate or alternate-reverse)p,",
                  "html": "",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>d</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#current-iteration-index\" id=\"ref-for-current-iteration-index⑤\">current iteration index</a>.</p>"
                    },
                    {
                      "html": "<p>If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-direction\" id=\"ref-for-playback-direction⑥\">playback direction</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-direction-alternate-reverse\" id=\"ref-for-playback-direction-alternate-reverse①\">alternate-reverse</a>\n  increment <var>d</var> by 1.</p>"
                    },
                    {
                      "html": "<p>If <code><var>d</var> % 2 == 0</code>,\n  let the <var>current direction</var> be forwards;\n  otherwise let the <var>current direction</var> be reverse.\n  If <var>d</var> is infinity,\n  let the <var>current direction</var> be forwards.</p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If the <var>current direction</var> is forwards\n  then return the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#simple-iteration-progress\" id=\"ref-for-simple-iteration-progress⑤\">simple iteration progress</a>.</p>\n     <p>Otherwise, return\n  <code>1.0 − <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#simple-iteration-progress\" id=\"ref-for-simple-iteration-progress⑥\">simple iteration progress</a></code>.</p>"
        }
      ]
    },
    {
      "name": "transformed progress",
      "href": "https://drafts.csswg.org/web-animations-1/#transformed-progress",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" id=\"transformed-progress\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">transformed progress</dfn> is calculated\n  from the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#directed-progress\" id=\"ref-for-directed-progress③\">directed progress</a> using the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#directed-progress\" id=\"ref-for-directed-progress④\">directed progress</a> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⓪④\">unresolved</a>,\n  return <span id=\"ref-for-unresolved①⓪⑤\">unresolved</span>.</p>"
        },
        {
          "html": "Calculate the value of the <var>before flag</var> as follows:",
          "rationale": "determine",
          "steps": [
            {
              "html": "<p>Determine the <var>current direction</var> using\n  the procedure defined in <a href=\"https://drafts.csswg.org/web-animations-1/#calculating-the-directed-progress\">§ 4.7.6 Calculating the directed progress</a>.</p>"
            },
            {
              "html": "<p>If the <var>current direction</var> is <span class=\"prop-value\">forwards</span>,\n  let <var>going forwards</var> be true; otherwise it is false.</p>"
            },
            {
              "html": "<p>The <var>before flag</var> is set\n  if the animation effect is in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-before-phase\" id=\"ref-for-animation-effect-before-phase⑧\">before phase</a>\n  and <var>going forwards</var> is true;\n  or if the animation effect is in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-after-phase\" id=\"ref-for-animation-effect-after-phase⑨\">after phase</a>\n  and <var>going forwards</var> is false.</p>"
            }
          ]
        },
        {
          "html": "<p>Return the result of evaluating\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-effect-easing-function\" id=\"ref-for-animation-effect-effect-easing-function①\">effect easing function</a>\n  passing <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#directed-progress\" id=\"ref-for-directed-progress⑤\">directed progress</a> as the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function-input-progress-value\" id=\"ref-for-easing-function-input-progress-value\">input progress value</a>\n  and <var>before flag</var> as the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function-before-flag\" id=\"ref-for-easing-function-before-flag\">before flag</a>.</p>"
        }
      ]
    },
    {
      "name": "compute missing keyframe offsets",
      "href": "https://drafts.csswg.org/web-animations-1/#compute-missing-keyframe-offsets",
      "html": "To produce <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets\">computed keyframe offsets</a>,\n    we define a procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"compute-missing-keyframe-offsets\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">compute missing keyframe offsets</dfn>\n    that takes a sequence of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑨\">keyframes</a>, <var>keyframes</var>,\n    and has the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>For each <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe①⓪\">keyframe</a> in <var>keyframes</var>,\nlet the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets①\">computed keyframe offset</a> of the <span id=\"ref-for-keyframe①①\">keyframe</span>\nbe equal to its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-offset\" id=\"ref-for-keyframe-offset⑤\">keyframe offset</a> value.</p>"
        },
        {
          "html": "<p>If <var>keyframes</var> contains more than one <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe①②\">keyframe</a>\nand the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets②\">computed keyframe offset</a>\nof the first <span id=\"ref-for-keyframe①③\">keyframe</span> in <var>keyframes</var>\nis null,\nset the <span id=\"ref-for-computed-keyframe-offsets③\">computed keyframe offset</span> of the first <span id=\"ref-for-keyframe①④\">keyframe</span>\nto 0.</p>"
        },
        {
          "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets④\">computed keyframe offset</a>\nof the last <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe①⑤\">keyframe</a> in <var>keyframes</var>\nis null,\nset its <span id=\"ref-for-computed-keyframe-offsets⑤\">computed keyframe offset</span> to 1.</p>"
        },
        {
          "html": "calculate the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets⑧\">computed keyframe offset</a>\nof each <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe①⑧\">keyframe</a> between <var>A</var> and <var>B</var>\nas follows:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"offsetk\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">offset<sub><var>k</var></sub></dfn> be\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets⑨\">computed keyframe offset</a> of a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe①⑨\">keyframe</a> <var>k</var>.</p>"
            },
            {
              "html": "<p>Let <var>n</var> be\nthe number of keyframes <em>between</em> and including\n<var>A</var> and <var>B</var> minus 1.</p>"
            },
            {
              "html": "<p>Let <var>index</var> refer to the position\nof <var>keyframe</var> in the sequence of keyframes between <var>A</var> and <var>B</var>\nsuch that the first keyframe after <var>A</var> has an <var>index</var> of 1.</p>"
            },
            {
              "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets①⓪\">computed keyframe offset</a> of <var>keyframe</var> to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#offsetk\" id=\"ref-for-offsetk\">offset</a><sub><var>A</var></sub> +\n(<span id=\"ref-for-offsetk①\">offset</span><sub><var>B</var></sub> −\n<span id=\"ref-for-offsetk②\">offset</span><sub><var>A</var></sub>)\n× <var>index</var> / <var>n</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "html": "<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframes\" id=\"ref-for-computed-keyframes\">Computed keyframes</a> are produced using the following procedure.\n  Note that this procedure is only performed\n  on a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect⑧\">keyframe effect</a> having an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect-effect-target\" id=\"ref-for-keyframe-effect-effect-target⑥\">effect target</a>\n  for which computed property values can be calculated.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>computed keyframes</var> be an empty list of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②⓪\">keyframes</a>.</p>"
        },
        {
          "html": "For each <var>keyframe</var> in the list of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②①\">keyframes</a>\n  specified on this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect⑨\">keyframe effect</a>,\n  perform the following steps:",
          "rationale": "add",
          "steps": [
            {
              "html": "<p>Add a new empty <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②②\">keyframe</a>, <var>computed keyframe</var>,\n  to <var>computed keyframes</var>.</p>"
            },
            {
              "html": "If conflicts arise when expanding shorthand properties\n  or replacing logical properties with physical properties,\n  apply the following rules in order until the conflict is resolved:",
              "rationale": "for",
              "steps": [
                {
                  "html": "<p>Longhand properties override shorthand properties\n  (e.g. <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-backgrounds-3/#propdef-border-top-color\" id=\"ref-for-propdef-border-top-color\">border-top-color</a> overrides <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-backgrounds-3/#propdef-border-top\" id=\"ref-for-propdef-border-top\">border-top</a>).</p>"
                },
                {
                  "html": "<p>Shorthand properties with fewer longhand components\n  override those with more longhand components\n  (e.g. <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-backgrounds-3/#propdef-border-top\" id=\"ref-for-propdef-border-top①\">border-top</a> overrides <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-backgrounds-3/#propdef-border-color\" id=\"ref-for-propdef-border-color\">border-color</a>).</p>"
                },
                {
                  "html": "<p>Physical properties override logical properties.</p>"
                },
                {
                  "html": "<p>For shorthand properties with an equal number of longhand components,\n  properties whose IDL name\n  (see the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom/#css-property-to-idl-attribute\" id=\"ref-for-css-property-to-idl-attribute\">CSS property to IDL attribute</a> algorithm <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-cssom\" title=\"CSS Object Model (CSSOM)\">[CSSOM]</a>)\n  appears earlier when sorted in ascending order\n  by the Unicode codepoints that make up each IDL name,\n  override those who appear later.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Apply the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#compute-missing-keyframe-offsets\" id=\"ref-for-compute-missing-keyframe-offsets\">compute missing keyframe offsets</a>\n  to <var>computed keyframes</var>.</p>"
        },
        {
          "html": "<p>Return <var>computed keyframes</var>.</p>"
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-value\" id=\"ref-for-effect-value③\">effect value</a> of a single property referenced by a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect①⓪\">keyframe effect</a>\n  as one of its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#target-property\" id=\"ref-for-target-property④\">target properties</a>,\n  for a given <var>iteration progress</var>,\n  <var>iteration index</var>\n  and <var>underlying value</var>\n  is calculated as follows.",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>iteration progress</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#unresolved\" id=\"ref-for-unresolved①⓪⑥\">unresolved</a>\n  abort this procedure.</p>"
        },
        {
          "html": "<p>Let <var>target property</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#longhand\" id=\"ref-for-longhand①\">longhand property</a>\n  for which the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-value\" id=\"ref-for-effect-value④\">effect value</a> is to be calculated.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-type\" id=\"ref-for-animation-type⑤\">animation type</a> of the <var>target property</var> is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#not-animatable\" id=\"ref-for-not-animatable②\">not animatable</a>\n  abort this procedure since the effect cannot be applied.</p>"
        },
        {
          "html": "<p>If the  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect①①\">keyframe effect</a> does not have an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect-effect-target\" id=\"ref-for-keyframe-effect-effect-target⑧\">effect target</a>,\n  or if the <span id=\"ref-for-keyframe-effect-effect-target⑨\">effect target</span> cannot have computed property values calculated,\n  abort this procedure.</p>"
        },
        {
          "html": "<p>Define the <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"neutral-value-for-composition\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">neutral value for composition</dfn>\n  as a value which, when combined with an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#underlying-value\" id=\"ref-for-underlying-value①\">underlying value</a>\n  using the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation-add\" id=\"ref-for-composite-operation-add\">add</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation\" id=\"ref-for-composite-operation②\">composite operation</a>,\n  produces the <span id=\"ref-for-underlying-value②\">underlying value</span>.</p>"
        },
        {
          "html": "<p>Let <var>property-specific keyframes</var> be\n  the result of getting the set of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframes\" id=\"ref-for-computed-keyframes①\">computed keyframes</a>\n  for this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect①②\">keyframe effect</a>.</p>"
        },
        {
          "html": "<p>Remove any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②③\">keyframes</a> from <var>property-specific keyframes</var>\n  that do not have a property value for <var>target property</var>.</p>"
        },
        {
          "html": "<p>If <var>property-specific keyframes</var> is empty,\n  return <var>underlying value</var>.</p>"
        },
        {
          "html": "<p>If there is no <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②④\">keyframe</a> in <var>property-specific keyframes</var>\n  with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets①①\">computed keyframe offset</a> of 0,\n  create a new <span id=\"ref-for-keyframe②⑤\">keyframe</span>\n  with a <span id=\"ref-for-computed-keyframe-offsets①②\">computed keyframe offset</span> of 0,\n  a property value set to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#neutral-value-for-composition\" id=\"ref-for-neutral-value-for-composition\">neutral value for composition</a>,\n  and a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation\" id=\"ref-for-composite-operation③\">composite operation</a> of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation-add\" id=\"ref-for-composite-operation-add①\">add</a>,\n  and prepend it to the beginning of <var>property-specific keyframes</var>.</p>"
        },
        {
          "html": "<p>Similarly, if there is no <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②⑥\">keyframe</a> in <var>property-specific keyframes</var>\n  with a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets①③\">computed keyframe offset</a> of 1,\n  create a new <span id=\"ref-for-keyframe②⑦\">keyframe</span>\n  with a <span id=\"ref-for-computed-keyframe-offsets①④\">computed keyframe offset</span> of 1,\n  a property value set to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#neutral-value-for-composition\" id=\"ref-for-neutral-value-for-composition①\">neutral value for composition</a>,\n  and a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation\" id=\"ref-for-composite-operation④\">composite operation</a> of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation-add\" id=\"ref-for-composite-operation-add②\">add</a>,\n  and append it to the end of <var>property-specific keyframes</var>.</p>"
        },
        {
          "html": "<p>Let <var>interval endpoints</var> be an empty sequence of keyframes.</p>"
        },
        {
          "html": "Populate <var>interval endpoints</var> by following the steps\n  from the first matching condition below:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If iteration progress < 0 and there is more than one keyframe in property-specific keyframes with a computed keyframe offset of 0,",
                  "html": "<p>Add the first <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe②⑨\">keyframe</a> in <var>property-specific keyframes</var>\n  to <var>interval endpoints</var>.</p>"
                },
                {
                  "case": "If iteration progress ≥ 1 and there is more than one keyframe in property-specific keyframes with a computed keyframe offset of 1,",
                  "html": "<p>Add the last <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe③①\">keyframe</a> in <var>property-specific keyframes</var>\n  to <var>interval endpoints</var>.</p>"
                },
                {
                  "case": "Otherwise,",
                  "html": "",
                  "rationale": "append",
                  "steps": [
                    {
                      "html": "<p>Append to <var>interval endpoints</var>\n  the last <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe③②\">keyframe</a> in <var>property-specific keyframes</var>\n  whose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets①⑦\">computed keyframe offset</a> is\n  less than or equal to <var>iteration progress</var> and less than 1.\n  If there is no such <span id=\"ref-for-keyframe③③\">keyframe</span>\n  (because, for example, the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-progress\" id=\"ref-for-iteration-progress①⑤\">iteration progress</a> is negative),\n  add the last <span id=\"ref-for-keyframe③④\">keyframe</span>\n  whose <span id=\"ref-for-computed-keyframe-offsets①⑧\">computed keyframe offset</span> is 0.</p>"
                    },
                    {
                      "html": "<p>Append to <var>interval endpoints</var>\n  the next <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe③⑤\">keyframe</a> in <var>property-specific keyframes</var>\n  after the one added in the previous step.</p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "For each <var>keyframe</var> in <var>interval endpoints</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var>keyframe</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation\" id=\"ref-for-composite-operation⑤\">composite operation</a>\n  that is <em>not</em> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation-replace\" id=\"ref-for-composite-operation-replace\">replace</a>,\n  or <var>keyframe</var> has no <span id=\"ref-for-composite-operation⑥\">composite operation</span>\n  and the <span id=\"ref-for-composite-operation⑦\">composite operation</span> of this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect①③\">keyframe effect</a>\n  is <em>not</em> <span id=\"ref-for-composite-operation-replace①\">replace</span>,\n  then perform the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>composite operation to use</var> be\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation\" id=\"ref-for-composite-operation⑧\">composite operation</a> of <var>keyframe</var>,\n  or if it has none,\n  the <span id=\"ref-for-composite-operation⑨\">composite operation</span> of this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect①④\">keyframe effect</a>.</p>"
                },
                {
                  "html": "<p>Let <var>value to combine</var> be\n  the property value of <var>target property</var> specified on <var>keyframe</var>.</p>"
                },
                {
                  "html": "<p>Replace the property value of <var>target property</var> on <var>keyframe</var>\n  with the result of combining\n  <var>underlying value</var> (<var>V</var><sub>a</sub>) and\n  <var>value to combine</var> (<var>V</var><sub>b</sub>)\n  using the procedure for the <var>composite operation to use</var>\n  corresponding to the <var>target property</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-type\" id=\"ref-for-animation-type⑥\">animation type</a>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If there is only one keyframe in <var>interval endpoints</var>\n  return the property value of <var>target property</var> on that keyframe.</p>"
        },
        {
          "html": "<p>Let <var>start offset</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets①⑨\">computed keyframe offset</a>\n  of the first keyframe in <var>interval endpoints</var>.</p>"
        },
        {
          "html": "<p>Let <var>end offset</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets②⓪\">computed keyframe offset</a>\n  of last keyframe in <var>interval endpoints</var>.</p>"
        },
        {
          "html": "<p>Let <var>interval distance</var> be the result of evaluating\n  <code>(<var>iteration progress</var> − <var>start offset</var>)\n        / (<var>end offset</var> − <var>start offset</var>)</code>.</p>"
        },
        {
          "html": "<p>Let <var>transformed distance</var> be the result of evaluating\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function\" id=\"ref-for-easing-function⑦\">easing function</a> associated with\n  the first keyframe in <var>interval endpoints</var>\n  passing <var>interval distance</var> as the input progress.</p>"
        },
        {
          "html": "<p>Return the result of applying\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-values-4/#interpolation\" id=\"ref-for-interpolation①\">interpolation procedure</a> defined\n  by the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-type\" id=\"ref-for-animation-type⑦\">animation type</a> of the <var>target property</var>\n  to the values of the <var>target property</var>\n  specified on the two keyframes in <var>interval endpoints</var>,\n  taking the first such value as <var>V</var><sub>start</sub>\n  and the second as <var>V</var><sub>end</sub>\n  and using <var>transformed distance</var>\n  as the interpolation parameter <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "animation composite order",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-composite-order",
      "html": "The relative\n  <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" data-local-lt=\"composite order\" data-lt=\"animation composite order\" id=\"animation-composite-order\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">composite order</dfn>\n  of any two <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect②④\">keyframe effects</a> <var>A</var> and <var>B</var> within an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-stack\" id=\"ref-for-effect-stack⑤\">effect stack</a>\n  is established by comparing their properties as follows:",
      "rationale": "sort",
      "steps": [
        {
          "html": "Sort <var>A</var> and <var>B</var>\n  by applying the following conditions in turn\n  until the order is resolved,",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>A</var> and <var>B</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation①③\">associated animations</a> differ\n  by <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-class\" id=\"ref-for-animation-class②\">class</a>,\n  sort by any inter-class composite order\n  as defined for the corresponding classes.</p>"
            },
            {
              "html": "<p>If <var>A</var> and <var>B</var> are still not sorted,\n  sort by any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-class\" id=\"ref-for-animation-class③\">class</a>-specific composite order\n  defined by the common class of <var>A</var> and <var>B</var>’s\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation①④\">associated animations</a>.</p>"
            },
            {
              "html": "<p>If <var>A</var> and <var>B</var> are still not sorted,\n  sort by the position of their <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation①⑤\">associated animations</a>\n  in the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#global-animation-list\" id=\"ref-for-global-animation-list\">global animation list</a>.</p>"
            }
          ]
        }
      ]
    },
    {
      "html": "The <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composited-value\" id=\"ref-for-composited-value②\">composited value</a> calculated for a CSS <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#target-property\" id=\"ref-for-target-property①①\">target property</a>\n  is applied using the following process:",
      "rationale": "establish",
      "steps": [
        {
          "html": "<p>Calculate the <var>base value</var> of the property\n  as the value generated for that property\n  by finding the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-cascade-5/#computed-value\" id=\"ref-for-computed-value⑦\">computed value</a> for that property\n  in the absence of animations.</p>"
        },
        {
          "html": "<p>Establish the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-stack\" id=\"ref-for-effect-stack①⓪\">effect stack</a> for the property\n  (see <a href=\"https://drafts.csswg.org/web-animations-1/#the-effect-stack\">§ 5.4.2 The effect stack</a>).</p>"
        },
        {
          "html": "<p>Calculate the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composited-value\" id=\"ref-for-composited-value③\">composited value</a> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-stack\" id=\"ref-for-effect-stack①①\">effect stack</a>\n  passing in the <var>base value</var> of the property\n  as the initial <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#underlying-value\" id=\"ref-for-underlying-value①②\">underlying value</a>\n  (see <a href=\"https://drafts.csswg.org/web-animations-1/#calculating-the-result-of-an-effect-stack\">§ 5.4.3 Calculating the result of an effect stack</a>).</p>"
        },
        {
          "html": "<p>Insert the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composited-value\" id=\"ref-for-composited-value④\">composited value</a> into the CSS cascade\n  at the level defined for the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-class\" id=\"ref-for-animation-class⑤\">class</a> of\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation⑤①\">animation</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation①⑦\">associated with</a>\n  the effect at the top of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-stack\" id=\"ref-for-effect-stack①②\">effect stack</a>\n  established for the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#target-property\" id=\"ref-for-target-property①②\">target property</a>.</p>"
        }
      ]
    },
    {
      "html": "perform the following steps:",
      "rationale": "set",
      "steps": [
        {
          "html": "<p>Set <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#replace-state\" id=\"ref-for-replace-state⑤\">replace state</a> to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#removed-replace-state\" id=\"ref-for-removed-replace-state③\">removed</a>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-create\" id=\"ref-for-concept-event-create②\">Create</a> an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#animationplaybackevent\" id=\"ref-for-animationplaybackevent②\">AnimationPlaybackEvent</a></code>, <var>removeEvent</var>.</p>"
        },
        {
          "html": "<p>Set <var>removeEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-type\" id=\"ref-for-dom-event-type②\">type</a></code> attribute to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#remove-event\" id=\"ref-for-remove-event\">remove</a>.</p>"
        },
        {
          "html": "<p>Set <var>removeEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-currenttime\" id=\"ref-for-dom-animationplaybackevent-currenttime②\">currentTime</a></code> attribute\n   to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-current-time\" id=\"ref-for-animation-current-time⑤②\">current time</a> of <var>animation</var>.</p>"
        },
        {
          "html": "<p>Set <var>removeEvent</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animationplaybackevent-timelinetime\" id=\"ref-for-dom-animationplaybackevent-timelinetime③\">timelineTime</a></code> attribute\n   to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-current-time\" id=\"ref-for-timeline-current-time①①\">current time</a>\n   of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline⑤③\">timeline</a> with which <var>animation</var> is associated.</p>"
        },
        {
          "html": "<p>If <var>animation</var> has a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-document-for-timing\" id=\"ref-for-animation-document-for-timing⑤\">document for timing</a>,\n   then append <var>removeEvent</var>\n   to its <span id=\"ref-for-animation-document-for-timing⑥\">document for timing</span>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#pending-animation-event-queue\" id=\"ref-for-pending-animation-event-queue④\">pending animation event queue</a>\n   along with its target, <var>animation</var>.\n   For the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#scheduled-event-time\" id=\"ref-for-scheduled-event-time⑥\">scheduled event time</a>,\n   use the result of applying the procedure to convert\n   <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-time-to-origin-relative-time\" id=\"ref-for-timeline-time-to-origin-relative-time④\">timeline time to origin-relative time</a>\n   to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline-current-time\" id=\"ref-for-timeline-current-time①②\">current time</a> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#timeline\" id=\"ref-for-timeline⑤④\">timeline</a>\n   with which <var>animation</var> is associated.</p>\n     <p>Otherwise,\n   <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task②\">queue a task</a> to <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-dispatch\" id=\"ref-for-concept-event-dispatch③\">dispatch</a> <var>removeEvent</var> at <var>animation</var>.\n   The task source for this task is\n   the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source\" id=\"ref-for-dom-manipulation-task-source②\">DOM manipulation task source</a>.</p>"
        }
      ]
    },
    {
      "name": "Animation/Animation(effect, timeline)",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-animation-animation",
      "html": "Creates a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#animation\" id=\"ref-for-animation⑤\">Animation</a></code> object using the following procedure:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>animation</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#animation\" id=\"ref-for-animation⑥\">Animation</a></code> object.</p>"
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-set-the-timeline-of-an-animation\" id=\"ref-for-animation-set-the-timeline-of-an-animation\">set the timeline of an animation</a>\n  on <var>animation</var>\n  passing <var>timeline</var> as the <var>new timeline</var>;\n  or, if the <var>timeline</var> argument is missing,\n  passing the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#document-default-document-timeline\" id=\"ref-for-document-default-document-timeline⑥\">default document timeline</a>\n  of the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/#document\" id=\"ref-for-document⑨\">Document</a></code> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-document-window\" id=\"ref-for-concept-document-window①\">associated</a>\n  with the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window①\">Window</a></code> that is the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#current-global-object\" id=\"ref-for-current-global-object③\">current global object</a>.</p>"
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-set-the-associated-effect-of-an-animation\" id=\"ref-for-animation-set-the-associated-effect-of-an-animation①\">set the associated effect of an animation</a>\n  on <var>animation</var>\n  passing <var>source</var> as the <var>new effect</var>.</p>"
        }
      ]
    },
    {
      "name": "commit computed styles",
      "href": "https://drafts.csswg.org/web-animations-1/#commit-computed-styles",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"commit-computed-styles\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">commit computed styles</dfn> for an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation⑦⓪\">animation</a>, <var>animation</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>targets</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set\">set</a>\nof all <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect-effect-target\" id=\"ref-for-keyframe-effect-effect-target①⑤\">effect targets</a> for <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect\" id=\"ref-for-animation-effect⑧②\">animation effects</a>\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation②⓪\">associated</a> with <var>animation</var>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate\">For each</a> <var>target</var> in <var>targets</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>target</var> is not an element capable of having\na <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-style-attr/#style-attribute\" id=\"ref-for-style-attribute\">style attribute</a> <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-css-style-attr\" title=\"CSS Style Attributes\">[CSS-STYLE-ATTR]</a>\n(for example, it is a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/selectors-4/#pseudo-element\" id=\"ref-for-pseudo-element⑤\">pseudo-element</a>\n or is an element in a document format\n for which style attributes are not defined)\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑤\">throw</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#nomodificationallowederror\" id=\"ref-for-nomodificationallowederror\">NoModificationAllowedError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑦\">DOMException</a></code>\nand abort these steps.</p>"
            },
            {
              "html": "<p>If, after applying any pending style changes,\n<var>target</var> is not <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#being-rendered\" id=\"ref-for-being-rendered\">being rendered</a>,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑥\">throw</a> an \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑤\">InvalidStateError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑧\">DOMException</a></code>\nand abort these steps.</p>"
            },
            {
              "html": "<p>Let <var>inline style</var> be the result\nof getting the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-1/#css-declaration-block\" id=\"ref-for-css-declaration-block\">CSS declaration block</a>\ncorresponding to <var>target</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-style-attr/#style-attribute\" id=\"ref-for-style-attribute①\">style attribute</a>.\nIf <var>target</var> does not <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-element-attribute-has\" id=\"ref-for-concept-element-attribute-has\">have</a>\na <span id=\"ref-for-style-attribute②\">style attribute</span>,\nlet <var>inline style</var> be a new empty <span id=\"ref-for-css-declaration-block①\">CSS declaration block</span>\nwith the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-owner-node\" id=\"ref-for-cssstyledeclaration-owner-node\">owner node</a> set to <var>target</var>.</p>"
            },
            {
              "html": "<p>Let <var>targeted properties</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set①\">set</a>\nof physical longhand properties\nthat are a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#target-property\" id=\"ref-for-target-property①⑥\">target property</a>\nfor at least one <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect\" id=\"ref-for-animation-effect⑧③\">animation effect</a>\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation②①\">associated</a> with <var>animation</var>\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect-effect-target\" id=\"ref-for-keyframe-effect-effect-target①⑥\">effect target</a> is <var>target</var>.</p>"
            },
            {
              "html": "For each property, <var>property</var>, in <var>targeted properties</var>:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>partialEffectStack</var> be a copy of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-stack\" id=\"ref-for-effect-stack①④\">effect stack</a>\nfor <var>property</var> on <var>target</var>.</p>"
                },
                {
                  "html": "<p>If <var>animation</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#replace-state\" id=\"ref-for-replace-state⑨\">replace state</a>\nis <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#removed-replace-state\" id=\"ref-for-removed-replace-state⑥\">removed</a>,\nadd all <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect\" id=\"ref-for-animation-effect⑧④\">animation effects</a>\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation②②\">associated</a> with <var>animation</var>\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect-effect-target\" id=\"ref-for-keyframe-effect-effect-target①⑦\">effect target</a> is <var>target</var>\nand that include <var>property</var>\nas a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#target-property\" id=\"ref-for-target-property①⑦\">target property</a> to <var>partialEffectStack</var>.</p>"
                },
                {
                  "html": "<p>Remove from <var>partialEffectStack</var> any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect\" id=\"ref-for-animation-effect⑧⑤\">animation effects</a>\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-associated-animation\" id=\"ref-for-animation-effect-associated-animation②③\">associated</a> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#concept-animation\" id=\"ref-for-concept-animation⑦①\">animation</a>\nhas a higher <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-composite-order\" id=\"ref-for-animation-composite-order②\">composite order</a> than <var>animation</var>.</p>"
                },
                {
                  "html": "<p>Let <var>effect value</var> be the result of calculating\nthe result of <var>partialEffectStack</var> for <var>property</var>\nusing <var>target</var>’s computed style\n(see <a href=\"https://drafts.csswg.org/web-animations-1/#calculating-the-result-of-an-effect-stack\">§ 5.4.3 Calculating the result of an effect stack</a>) and\nsetting the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#endpoint-inclusive-active-interval\" id=\"ref-for-endpoint-inclusive-active-interval②\">endpoint-inclusive active interval</a> flag\nto true\nwhen calculating the animation effect phase\n(see <a href=\"https://drafts.csswg.org/web-animations-1/#animation-effect-phases-and-states\">§ 4.6.6 Animation effect phases and states</a>).</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-1/#set-a-css-declaration\" id=\"ref-for-set-a-css-declaration\">Set a CSS declaration</a> of <var>property</var> for <var>effect value</var>\nin <var>inline style</var>.</p>"
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-1/#update-style-attribute-for\" id=\"ref-for-update-style-attribute-for\">Update style attribute for</a> <var>inline style</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "EffectTiming/fill",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-effecttiming-fill",
      "html": "When performing timing calculations\n  the special string value <code>auto</code> is expanded\n  to one of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode①④\">fill modes</a> recognized by the timing model\n  as follows:",
      "rationale": ".switch",
      "steps": [
        {
          "operation": "switch",
          "steps": [
            {
              "case": "If the animation effect to which the fill mode is being applied is a keyframe effect,",
              "html": "<p>Use <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode-none\" id=\"ref-for-fill-mode-none①\">none</a> as the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode①⑤\">fill mode</a>.</p>"
            },
            {
              "case": "Otherwise,",
              "html": "<p>Use <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode-both\" id=\"ref-for-fill-mode-both⑤\">both</a> as the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode①⑥\">fill mode</a>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "update the timing properties of an animation effect",
      "href": "https://drafts.csswg.org/web-animations-1/#update-the-timing-properties-of-an-animation-effect",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"update-the-timing-properties-of-an-animation-effect\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update the timing properties of an animation effect</dfn>, <var>effect</var>,\n  from an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-effecttiming\" id=\"ref-for-dictdef-effecttiming⑧\">EffectTiming</a></code> or <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-optionaleffecttiming\" id=\"ref-for-dictdef-optionaleffecttiming④\">OptionalEffectTiming</a></code> object, <var>input</var>,\n  perform the following steps:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-iterationstart\" id=\"ref-for-dom-effecttiming-iterationstart④\">iterationStart</a></code> member of <var>input</var>\n  <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#map-exists\" id=\"ref-for-map-exists②\">exists</a> and is less than zero,\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑦\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror\">TypeError</a></code> and abort this procedure.</p>"
        },
        {
          "html": "<p>If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-iterations\" id=\"ref-for-dom-effecttiming-iterations③\">iterations</a></code> member of <var>input</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#map-exists\" id=\"ref-for-map-exists③\">exists</a>,\n  and is less than zero or is the value <code class=\"esvalue\">NaN</code>,\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑧\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror②\">TypeError</a></code> and abort this procedure.</p>"
        },
        {
          "html": "<p>If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-duration\" id=\"ref-for-dom-effecttiming-duration⑤\">duration</a></code> member of <var>input</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#map-exists\" id=\"ref-for-map-exists④\">exists</a>,\n  and is less than zero or is the value <code class=\"esvalue\">NaN</code>,\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑨\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror③\">TypeError</a></code> and abort this procedure.</p>"
        },
        {
          "html": "<p>If the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-easing\" id=\"ref-for-dom-effecttiming-easing①\">easing</a></code> member of <var>input</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#map-exists\" id=\"ref-for-map-exists⑤\">exists</a>\n  but cannot be parsed using the <a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/css-easing-2/#typedef-easing-function\" id=\"ref-for-typedef-easing-function①\" title=\"Expands to: linear\">&lt;easing-function&gt;</a> production\n  <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-css-easing-1\" title=\"CSS Easing Functions Level 1\">[CSS-EASING-1]</a>,\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①⓪\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror④\">TypeError</a></code> and abort this procedure.</p>"
        },
        {
          "html": "<p>Assign each member that <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#map-exists\" id=\"ref-for-map-exists⑥\">exists</a> in <var>input</var>\n  to the corresponding timing property of <var>effect</var> as follows:</p>\n     <ul>\n      <li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-delay\" id=\"ref-for-dom-effecttiming-delay①\">delay</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#start-delay\" id=\"ref-for-start-delay①⑦\">start delay</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-enddelay\" id=\"ref-for-dom-effecttiming-enddelay①\">endDelay</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#end-delay\" id=\"ref-for-end-delay⑤\">end delay</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-fill\" id=\"ref-for-dom-effecttiming-fill③\">fill</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode①⑨\">fill mode</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-iterationstart\" id=\"ref-for-dom-effecttiming-iterationstart⑤\">iterationStart</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-start\" id=\"ref-for-iteration-start①①\">iteration start</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-iterations\" id=\"ref-for-dom-effecttiming-iterations④\">iterations</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-count\" id=\"ref-for-iteration-count①⑨\">iteration count</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-duration\" id=\"ref-for-dom-effecttiming-duration⑥\">duration</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-duration\" id=\"ref-for-iteration-duration①⑧\">iteration duration</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-direction\" id=\"ref-for-dom-effecttiming-direction①\">direction</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-direction\" id=\"ref-for-playback-direction⑧\">playback direction</a></p>\n      </li><li data-md=\"\">\n       <p><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-easing\" id=\"ref-for-dom-effecttiming-easing②\">easing</a></code> → <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function\" id=\"ref-for-easing-function⑨\">easing function</a></p>\n     </li></ul>"
        }
      ]
    },
    {
      "name": "KeyframeEffect/KeyframeEffect(target, keyframes, options)",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-keyframeeffect",
      "html": "Creates a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#keyframeeffect\" id=\"ref-for-keyframeeffect③\">KeyframeEffect</a></code> object using the following procedure:",
      "rationale": "create",
      "steps": [
        {
          "html": "<p>Create a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#keyframeeffect\" id=\"ref-for-keyframeeffect④\">KeyframeEffect</a></code> object, <var>effect</var>.</p>"
        },
        {
          "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-target-target-element\" id=\"ref-for-effect-target-target-element④\">target element</a> of <var>effect</var> to <var>target</var>.</p>"
        },
        {
          "html": "Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-target-target-pseudo-selector\" id=\"ref-for-effect-target-target-pseudo-selector②\">target pseudo-selector</a> to the result\n  corresponding to the first matching condition below:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "If options is a KeyframeEffectOptions object with a pseudoElement property,",
                  "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-target-target-pseudo-selector\" id=\"ref-for-effect-target-target-pseudo-selector③\">target pseudo-selector</a> to the value of\n  the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffectoptions-pseudoelement\" id=\"ref-for-dom-keyframeeffectoptions-pseudoelement①\">pseudoElement</a></code> property.</p>\n          <p>When assigning this property,\n  the error-handling defined for\n  the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-pseudoelement\" id=\"ref-for-dom-keyframeeffect-pseudoelement①\">pseudoElement</a></code> setter on the interface\n  is applied.\n  If the setter requires an exception to be thrown,\n  this procedure must throw the same exception\n  and abort all further steps.</p>"
                },
                {
                  "case": "Otherwise,",
                  "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-target-target-pseudo-selector\" id=\"ref-for-effect-target-target-pseudo-selector④\">target pseudo-selector</a> to <code>null</code>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Let <var>timing input</var> be the result\n  corresponding to the first matching condition below:</p>\n        <dl>\n         <dt data-md=\"\">If <var>options</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-keyframeeffectoptions\" id=\"ref-for-dictdef-keyframeeffectoptions②\">KeyframeEffectOptions</a></code> object,\n         </dt><dd data-md=\"\">\n          <p>Let <var>timing input</var> be <var>options</var>.</p>\n         </dd><dt data-md=\"\">Otherwise (if <var>options</var> is a <code>double</code>),\n         </dt><dd data-md=\"\">\n          <p>Let <var>timing input</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-effecttiming\" id=\"ref-for-dictdef-effecttiming①⓪\">EffectTiming</a></code> object\n  with all members set to their default values\n  and <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-duration\" id=\"ref-for-dom-effecttiming-duration⑦\">duration</a></code> set to <var>options</var>.</p>\n        </dd></dl>"
        },
        {
          "html": "<p>Call the procedure to\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#update-the-timing-properties-of-an-animation-effect\" id=\"ref-for-update-the-timing-properties-of-an-animation-effect①\">update the timing properties of an animation effect</a> of <var>effect</var>\n  from <var>timing input</var>.</p>\n        <p>If that procedure causes an exception to be thrown,\n  propagate the exception and abort this procedure.</p>"
        },
        {
          "html": "<p>If <var>options</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-keyframeeffectoptions\" id=\"ref-for-dictdef-keyframeeffectoptions③\">KeyframeEffectOptions</a></code> object,\n  assign the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-composite\" id=\"ref-for-dom-keyframeeffect-composite①\">composite</a></code> property of <var>effect</var>\n  to the corresponding value from <var>options</var>.</p>\n        <p>When assigning this property,\n  the error-handling defined for\n  the corresponding setter on the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#keyframeeffect\" id=\"ref-for-keyframeeffect⑤\">KeyframeEffect</a></code> interface\n  is applied.\n  If the setter requires an exception to be thrown\n  for the value specified by <var>options</var>,\n  this procedure must <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①①\">throw</a> the same exception\n  and abort all further steps.</p>"
        },
        {
          "html": "<p>Initialize the set of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe④④\">keyframes</a>\n  by performing the procedure\n  defined for <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-setkeyframes\" id=\"ref-for-dom-keyframeeffect-setkeyframes①\">setKeyframes()</a></code>\n  passing <var>keyframes</var> as the input.</p>"
        }
      ]
    },
    {
      "name": "KeyframeEffect/KeyframeEffect(source)",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-keyframeeffect-source",
      "html": "Creates a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#keyframeeffect\" id=\"ref-for-keyframeeffect⑥\">KeyframeEffect</a></code> object\n  with the same properties as <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-keyframeeffect-source-source\" id=\"ref-for-dom-keyframeeffect-keyframeeffect-source-source①\">source</a></code>\n  using the following procedure:",
      "rationale": "create",
      "steps": [
        {
          "html": "<p>Create a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#keyframeeffect\" id=\"ref-for-keyframeeffect⑦\">KeyframeEffect</a></code> object, <var>effect</var>.</p>"
        },
        {
          "html": "<p>Set the following properties of <var>effect</var>\n  using the corresponding values of <var>source</var>:</p>\n        <ul>\n         <li data-md=\"\">\n          <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect-effect-target\" id=\"ref-for-keyframe-effect-effect-target①⑧\">effect target</a>,</p>\n         </li><li data-md=\"\">\n          <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe④⑥\">keyframes</a>,</p>\n         </li><li data-md=\"\">\n          <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#composite-operation\" id=\"ref-for-composite-operation①②\">composite operation</a>,\nand</p>\n         </li><li data-md=\"\">\n          <p>all specified timing properties:</p>\n          <ul>\n           <li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#start-delay\" id=\"ref-for-start-delay①⑧\">start delay</a>,</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#end-delay\" id=\"ref-for-end-delay⑦\">end delay</a>,</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#fill-mode\" id=\"ref-for-fill-mode②⓪\">fill mode</a>,</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-start\" id=\"ref-for-iteration-start①②\">iteration start</a>,</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-count\" id=\"ref-for-iteration-count②⓪\">iteration count</a>,</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#iteration-duration\" id=\"ref-for-iteration-duration②⓪\">iteration duration</a>,</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#playback-direction\" id=\"ref-for-playback-direction⑨\">playback direction</a>,\nand</p>\n           </li><li data-md=\"\">\n            <p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function\" id=\"ref-for-easing-function①⓪\">easing function</a>.</p>\n          </li></ul>\n        </li></ul>"
        }
      ]
    },
    {
      "name": "KeyframeEffect/pseudo-element parsing",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-pseudo-element-parsing",
      "html": "On setting,\n  sets the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#effect-target-target-pseudo-selector\" id=\"ref-for-effect-target-target-pseudo-selector⑥\">target pseudo-selector</a> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-effect\" id=\"ref-for-animation-effect①⓪⑨\">animation effect</a>\n  to the result of <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"KeyframeEffect\" data-dfn-type=\"attribute\" data-export=\"\" id=\"dom-keyframeeffect-pseudo-element-parsing\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>pseudo-element parsing</code></dfn> on the provided value,\n  defined as the following:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>Given the value <var>value</var>, perform the following steps:</p>"
        },
        {
          "html": "If <var>value</var> is not <code>null</code>\n   and is an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/selectors-4/#invalid-selector\" id=\"ref-for-invalid-selector\">invalid</a> <a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/selectors-4/#typedef-pseudo-element-selector\" id=\"ref-for-typedef-pseudo-element-selector\">&lt;pseudo-element-selector&gt;</a>,",
          "rationale": "throw",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①②\">Throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException⑨\">DOMException</a></code>\n  with error name \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\" id=\"ref-for-syntaxerror\">SyntaxError</a></code>\".</p>"
            },
            {
              "html": "<p>Abort.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>value</var> is one of the legacy Selectors Level 2 single-colon selectors\n  (':before', ':after', ':first-letter', or ':first-line'), then\n  return the equivalent two-colon selector (e.g. '::before').</p>"
        },
        {
          "html": "<p>Otherwise, return <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "KeyframeEffect/getKeyframes()",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-getkeyframes",
      "html": "Since <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑤⓪\">keyframes</a> are represented\n  by a partially open-ended dictionary type\n  that is not currently able to be expressed with WebIDL,\n  the procedure used to prepare the result of this method\n  is defined in prose below:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be an empty sequence of objects.</p>"
        },
        {
          "html": "<p>Let <var>keyframes</var> be one of the following:</p>\n        <dl>\n         <dt data-md=\"\">If this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect③⑦\">keyframe effect</a> is associated with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-animations-2/#cssanimation\" id=\"ref-for-cssanimation\">CSSAnimation</a></code>,\n  and its <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑤①\">keyframes</a> have not been replaced\n  by a successful call to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-setkeyframes\" id=\"ref-for-dom-keyframeeffect-setkeyframes②\">setKeyframes()</a></code>,\n         </dt><dd data-md=\"\">\n          <p>the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframes\" id=\"ref-for-computed-keyframes④\">computed keyframes</a> for this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect③⑧\">keyframe effect</a>.</p>\n         </dd><dt data-md=\"\">Otherwise,\n         </dt><dd data-md=\"\">\n          <p>the result of applying the procedure\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#compute-missing-keyframe-offsets\" id=\"ref-for-compute-missing-keyframe-offsets②\">compute missing keyframe offsets</a>\n  to the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑤②\">keyframes</a> for this <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-effect\" id=\"ref-for-keyframe-effect③⑨\">keyframe effect</a>.</p>\n        </dd></dl>"
        },
        {
          "html": "For each <var>keyframe</var> in <var>keyframes</var>\n  perform the following steps:",
          "rationale": "initialize",
          "steps": [
            {
              "html": "<p>Initialize a dictionary object, <var>output keyframe</var>,\n  using the following definition:</p>\n<pre class=\"idl highlight def\"><c- b=\"\">dictionary</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"dictionary\" data-export=\"\" id=\"dictdef-basecomputedkeyframe\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">BaseComputedKeyframe</c-></code></dfn> {\n     <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-double\" id=\"ref-for-idl-double②②\"><c- b=\"\">double</c-></a>?                  <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"null\" data-dfn-for=\"BaseComputedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"double?\" id=\"dom-basecomputedkeyframe-offset\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">offset</c-></code></dfn> = <c- b=\"\">null</c->;\n     <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-double\" id=\"ref-for-idl-double②③\"><c- b=\"\">double</c-></a>                   <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"BaseComputedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"double\" id=\"dom-basecomputedkeyframe-computedoffset\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">computedOffset</c-></code></dfn>;\n     <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-DOMString\" id=\"ref-for-idl-DOMString⑦\"><c- b=\"\">DOMString</c-></a>                <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"&quot;linear&quot;\" data-dfn-for=\"BaseComputedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"DOMString\" id=\"dom-basecomputedkeyframe-easing\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">easing</c-></code></dfn> = \"linear\";\n     <a data-link-type=\"idl-name\" href=\"https://drafts.csswg.org/web-animations-1/#enumdef-compositeoperationorauto\" id=\"ref-for-enumdef-compositeoperationorauto\"><c- n=\"\">CompositeOperationOrAuto</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"&quot;auto&quot;\" data-dfn-for=\"BaseComputedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"CompositeOperationOrAuto\" id=\"dom-basecomputedkeyframe-composite\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">composite</c-></code></dfn> = \"auto\";\n};\n</pre>"
            },
            {
              "html": "<p>Set the\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-basecomputedkeyframe-offset\" id=\"ref-for-dom-basecomputedkeyframe-offset\">offset</a></code>,\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-basecomputedkeyframe-computedoffset\" id=\"ref-for-dom-basecomputedkeyframe-computedoffset\">computedOffset</a></code>,\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-basecomputedkeyframe-easing\" id=\"ref-for-dom-basecomputedkeyframe-easing\">easing</a></code>,\n  and\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-basecomputedkeyframe-composite\" id=\"ref-for-dom-basecomputedkeyframe-composite\">composite</a></code>\n  members of <var>output keyframe</var>\n  to the respective\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-offset\" id=\"ref-for-keyframe-offset⑦\">keyframe offset</a>,\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets②⑤\">computed keyframe offset</a>,\n  keyframe-specific <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function\" id=\"ref-for-easing-function①②\">easing function</a>,\n  and <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-specific-composite-operation\" id=\"ref-for-keyframe-specific-composite-operation②\">keyframe-specific composite operation</a>\n  values of <var>keyframe</var>.</p>"
            },
            {
              "html": "For each animation property-value pair <var>declaration</var> in <var>keyframe</var>,\n  perform the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>property name</var> be the result of applying the\n  <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-property-name-to-idl-attribute-name\" id=\"ref-for-animation-property-name-to-idl-attribute-name\">animation property name to IDL attribute name</a> algorithm\n  to the property name of <var>declaration</var>.</p>"
                },
                {
                  "html": "<p>Let <var>IDL value</var> be the result\n  of serializing the property value of <var>declaration</var>\n  by passing <var>declaration</var> to\n  the algorithm to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom/#serialize-a-css-value\" id=\"ref-for-serialize-a-css-value\">serialize a CSS value</a> <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-cssom\" title=\"CSS Object Model (CSSOM)\">[CSSOM]</a>.</p>"
                },
                {
                  "html": "<p>Let <var>value</var> be the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#DOMString-to-es\" id=\"ref-for-DOMString-to-es\">converting</a>\n  <var>IDL value</var> to an ECMAScript String value.</p>"
                },
                {
                  "html": "<p>Call the <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-ordinary-object-internal-methods-and-internal-slots-defineownproperty-p-desc\" id=\"ref-for-sec-ordinary-object-internal-methods-and-internal-slots-defineownproperty-p-desc\">[[DefineOwnProperty]]</a> internal method\n  on <var>output keyframe</var>\n  with property name <var>property name</var>,\n  Property Descriptor {\n    [[Writable]]: <span class=\"esvalue\">true</span>,\n    [[Enumerable]]: <span class=\"esvalue\">true</span>,\n    [[Configurable]]: <span class=\"esvalue\">true</span>,\n    [[Value]]: <var>value</var>\n  }\n  and Boolean flag <span class=\"esvalue\">false</span>.</p>"
                }
              ]
            },
            {
              "html": "<p>Append <var>output keyframe</var> to <var>result</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "animation property name to IDL attribute name",
      "href": "https://drafts.csswg.org/web-animations-1/#animation-property-name-to-idl-attribute-name",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"animation-property-name-to-idl-attribute-name\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">animation property name to IDL attribute name</dfn> algorithm\n    for <var>property</var>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>property</var> follows the <a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/css-variables-2/#typedef-custom-property-name\" id=\"ref-for-typedef-custom-property-name\">&lt;custom-property-name&gt;</a> production,\nreturn <var>property</var>.</p>"
        },
        {
          "html": "<p>If <var>property</var> refers to the CSS <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css2/#propdef-float\" id=\"ref-for-propdef-float\">float</a> property,\nreturn the string \"cssFloat\".</p>"
        },
        {
          "html": "<p>If <var>property</var> refers to the CSS <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.fxtf.org/motion-1/#propdef-offset\" id=\"ref-for-propdef-offset\">offset</a> property,\nreturn the string \"cssOffset\".</p>"
        },
        {
          "html": "<p>Otherwise, return the result of applying\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom/#css-property-to-idl-attribute\" id=\"ref-for-css-property-to-idl-attribute①\">CSS property to IDL attribute</a> algorithm <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-cssom\" title=\"CSS Object Model (CSSOM)\">[CSSOM]</a>\nto <var>property</var>.</p>"
        }
      ]
    },
    {
      "name": "IDL attribute name to animation property name",
      "href": "https://drafts.csswg.org/web-animations-1/#idl-attribute-name-to-animation-property-name",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"idl-attribute-name-to-animation-property-name\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">IDL attribute name to animation property name</dfn> algorithm\n    for <var>attribute</var>\n    is as follows:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>attribute</var> conforms to the <a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/css-variables-2/#typedef-custom-property-name\" id=\"ref-for-typedef-custom-property-name①\">&lt;custom-property-name&gt;</a> production,\nreturn <var>attribute</var>.</p>"
        },
        {
          "html": "<p>If <var>attribute</var> is the string \"cssFloat\", then return\nan animation property representing the CSS <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css2/#propdef-float\" id=\"ref-for-propdef-float①\">float</a> property.</p>"
        },
        {
          "html": "<p>If <var>attribute</var> is the string \"cssOffset\", then return\nan animation property representing the CSS <a class=\"property css\" data-link-type=\"property\" href=\"https://drafts.fxtf.org/motion-1/#propdef-offset\" id=\"ref-for-propdef-offset①\">offset</a> property.</p>"
        },
        {
          "html": "<p>Otherwise, return the result of applying\nthe <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom/#idl-attribute-to-css-property\" id=\"ref-for-idl-attribute-to-css-property\">IDL attribute to CSS property</a> algorithm <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-cssom\" title=\"CSS Object Model (CSSOM)\">[CSSOM]</a>\nto <var>attribute</var>.</p>"
        }
      ]
    },
    {
      "name": "check the completion record",
      "href": "https://drafts.csswg.org/web-animations-1/#check-the-completion-record",
      "html": "The instruction <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"check-the-completion-record\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">check the completion record</dfn> of <var>result</var>,\n    where <var>result</var> is a <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-completion-record-specification-type\" id=\"ref-for-sec-completion-record-specification-type\">completion record</a>\n    from calling an ECMAScript operation,\n    is equivalent to the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>result</var> is\nan <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-completion-record-specification-type\" id=\"ref-for-sec-completion-record-specification-type①\">abrupt completion</a>,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①③\">throw</a> the exception contained in the [[value]] field of <var>result</var>\nand abort the procedure.</p>"
        },
        {
          "html": "<p>Replace <var>result</var> with\nthe value contained in the [[value]] field of <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "process a keyframe-like object",
      "href": "https://drafts.csswg.org/web-animations-1/#process-a-keyframe-like-object",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"process-a-keyframe-like-object\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">process a keyframe-like object</dfn>\n    takes two arguments:\n\n\n    <ul>\n     <li data-md=\"\">\n      <p>an ECMAScript object, <var>keyframe input</var>, and</p>\n     </li><li data-md=\"\">\n      <p>an <var>allow lists</var> boolean flag</p>\n    </li></ul>\n    <p>and returns a map from either property names to DOMString values\n    if <var>allow lists</var> is false,\n    or from property names to sequences of DOMString values otherwise,\n    using the following procedure:</p>",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Run the procedure to\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#es-to-dictionary\" id=\"ref-for-es-to-dictionary\">convert an ECMAScript value to a dictionary type</a> <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-webidl\" title=\"Web IDL Standard\">[WEBIDL]</a>\nwith <var>keyframe input</var> as the ECMAScript value,\nand the dictionary type depending on the value of the <var>allow lists</var> flag\nas follows:</p>\n      <div class=\"switch\">\n       <dl>\n        <dt data-md=\"\">If <var>allow lists</var> is true,\n        </dt><dd data-md=\"\">\n         <p>Use the following dictionary type:</p>\n<pre class=\"idl highlight def\"><c- b=\"\">dictionary</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"dictionary\" data-export=\"\" id=\"dictdef-basepropertyindexedkeyframe\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">BasePropertyIndexedKeyframe</c-></code></dfn> {\n  (<a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-double\" id=\"ref-for-idl-double②④\"><c- b=\"\">double</c-></a>? <c- b=\"\">or</c-> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence①\"><c- b=\"\">sequence</c-></a>&lt;<a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-double\" id=\"ref-for-idl-double②⑤\"><c- b=\"\">double</c-></a>?&gt;)                         <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"[]\" data-dfn-for=\"BasePropertyIndexedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"(double? or sequence&lt;double?&gt;)\" id=\"dom-basepropertyindexedkeyframe-offset\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">offset</c-></code></dfn> = [];\n  (<a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-DOMString\" id=\"ref-for-idl-DOMString⑧\"><c- b=\"\">DOMString</c-></a> <c- b=\"\">or</c-> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence②\"><c- b=\"\">sequence</c-></a>&lt;<a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-DOMString\" id=\"ref-for-idl-DOMString⑨\"><c- b=\"\">DOMString</c-></a>&gt;)                     <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"[]\" data-dfn-for=\"BasePropertyIndexedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"(DOMString or sequence&lt;DOMString&gt;)\" id=\"dom-basepropertyindexedkeyframe-easing\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">easing</c-></code></dfn> = [];\n  (<a data-link-type=\"idl-name\" href=\"https://drafts.csswg.org/web-animations-1/#enumdef-compositeoperationorauto\" id=\"ref-for-enumdef-compositeoperationorauto①\"><c- n=\"\">CompositeOperationOrAuto</c-></a> <c- b=\"\">or</c-> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence③\"><c- b=\"\">sequence</c-></a>&lt;<a data-link-type=\"idl-name\" href=\"https://drafts.csswg.org/web-animations-1/#enumdef-compositeoperationorauto\" id=\"ref-for-enumdef-compositeoperationorauto②\"><c- n=\"\">CompositeOperationOrAuto</c-></a>&gt;) <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"[]\" data-dfn-for=\"BasePropertyIndexedKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"(CompositeOperationOrAuto or sequence&lt;CompositeOperationOrAuto&gt;)\" id=\"dom-basepropertyindexedkeyframe-composite\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">composite</c-></code></dfn> = [];\n};\n</pre>\n        </dd><dt data-md=\"\">Otherwise,\n        </dt><dd data-md=\"\">\n         <p>Use the following dictionary type:</p>\n<pre class=\"idl highlight def\"><c- b=\"\">dictionary</c-> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-type=\"dictionary\" data-export=\"\" id=\"dictdef-basekeyframe\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">BaseKeyframe</c-></code></dfn> {\n  <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-double\" id=\"ref-for-idl-double②⑥\"><c- b=\"\">double</c-></a>?                  <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"null\" data-dfn-for=\"BaseKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"double?\" id=\"dom-basekeyframe-offset\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">offset</c-></code></dfn> = <c- b=\"\">null</c->;\n  <a class=\"idl-code\" data-link-type=\"interface\" href=\"https://webidl.spec.whatwg.org/#idl-DOMString\" id=\"ref-for-idl-DOMString①⓪\"><c- b=\"\">DOMString</c-></a>                <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"&quot;linear&quot;\" data-dfn-for=\"BaseKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"DOMString\" id=\"dom-basekeyframe-easing\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">easing</c-></code></dfn> = \"linear\";\n  <a data-link-type=\"idl-name\" href=\"https://drafts.csswg.org/web-animations-1/#enumdef-compositeoperationorauto\" id=\"ref-for-enumdef-compositeoperationorauto③\"><c- n=\"\">CompositeOperationOrAuto</c-></a> <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-default=\"&quot;auto&quot;\" data-dfn-for=\"BaseKeyframe\" data-dfn-type=\"dict-member\" data-export=\"\" data-type=\"CompositeOperationOrAuto\" id=\"dom-basekeyframe-composite\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code><c- g=\"\">composite</c-></code></dfn> = \"auto\";\n};\n</pre>\n       </dd></dl>\n      </div>\n      <p>Store the result of this procedure as <var>keyframe output</var>.</p>"
        },
        {
          "html": "Build up a list of <var>animatable properties</var> as follows:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>animatable properties</var> be a list of property names\n(including shorthand properties\n that have longhand sub-properties that are animatable)\nthat can be animated by the UA.</p>"
            },
            {
              "html": "<p>Convert each property name in <var>animatable properties</var>\nto the equivalent IDL attribute by applying the\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#animation-property-name-to-idl-attribute-name\" id=\"ref-for-animation-property-name-to-idl-attribute-name①\">animation property name to IDL attribute name</a> algorithm.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>input properties</var> be\nthe result of calling the <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-enumerableownnames\" id=\"ref-for-sec-enumerableownnames\">EnumerableOwnNames</a> operation\nwith <var>keyframe input</var> as the object.</p>"
        },
        {
          "html": "<p>Make up a new list <var>animation properties</var>\nthat consists of all of the properties that are in <em>both</em>\n<var>input properties</var> and <var>animatable properties</var>, <em>or</em>\nwhich are in <var>input properties</var> and\nconform to the <a class=\"production css\" data-link-type=\"type\" href=\"https://drafts.csswg.org/css-variables-2/#typedef-custom-property-name\" id=\"ref-for-typedef-custom-property-name②\">&lt;custom-property-name&gt;</a> production.</p>"
        },
        {
          "html": "<p>Sort <var>animation properties</var> in ascending order\nby the Unicode codepoints that define each property name.</p>"
        },
        {
          "html": "For each <var>property name</var> in <var>animation properties</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>raw value</var> be the result of calling\nthe <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-ordinary-object-internal-methods-and-internal-slots-get-p-receiver\" id=\"ref-for-sec-ordinary-object-internal-methods-and-internal-slots-get-p-receiver\">[[Get]]</a> internal method on <var>keyframe input</var>,\nwith <var>property name</var> as the property key\nand <var>keyframe input</var> as the receiver.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#check-the-completion-record\" id=\"ref-for-check-the-completion-record\">Check the completion record</a> of <var>raw value</var>.</p>"
            },
            {
              "html": "<p>Convert <var>raw value</var>\nto a DOMString or to a sequence of DOMStrings <var>property values</var>\nas follows:</p>\n        <div class=\"switch\">\n         <dl>\n          <dt data-md=\"\">If <var>allow lists</var> is true,\n          </dt><dd data-md=\"\">\n           <p>Let <var>property values</var> be the result of converting\n<var>raw value</var> to IDL type\n<code>(DOMString or sequence&lt;DOMString&gt;)</code>\nusing the\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-convert-ecmascript-to-idl-value\" id=\"ref-for-dfn-convert-ecmascript-to-idl-value\">procedures defined for converting\nan ECMAScript value to an IDL value</a>\n<a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-webidl\" title=\"Web IDL Standard\">[WEBIDL]</a>.</p>\n           <p>If <var>property values</var> is a single DOMString,\nreplace <var>property values</var>\nwith a sequence of DOMStrings\nwith the original value of <var>property values</var>\nas the only element.</p>\n          </dd><dt data-md=\"\">Otherwise,\n          </dt><dd data-md=\"\">\n           <p>Let <var>property values</var> be the result of converting\n<var>raw value</var> to a DOMString\nusing the\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#es-to-DOMString\" id=\"ref-for-es-to-DOMString\">procedure for converting\nan ECMAScript value to a DOMString</a> <a data-link-type=\"biblio\" href=\"https://drafts.csswg.org/web-animations-1/#biblio-webidl\" title=\"Web IDL Standard\">[WEBIDL]</a>.</p>\n         </dd></dl>\n        </div>"
            },
            {
              "html": "<p>Calculate the <var>normalized property name</var>\nas the result of applying the\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#idl-attribute-name-to-animation-property-name\" id=\"ref-for-idl-attribute-name-to-animation-property-name\">IDL attribute name to animation property name</a> algorithm\nto <var>property name</var>.</p>"
            },
            {
              "html": "<p>Add a property to <var>keyframe output</var>\nwith <var>normalized property name</var> as the property name,\nand <var>property values</var> as the property value.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>keyframe output</var>.</p>"
        }
      ]
    },
    {
      "name": "process a keyframes argument",
      "href": "https://drafts.csswg.org/web-animations-1/#process-a-keyframes-argument",
      "html": "The procedure to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"process-a-keyframes-argument\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">process a keyframes argument</dfn>\n    takes a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-nullable-type\" id=\"ref-for-dfn-nullable-type\">nullable</a> ECMAScript object, <var>object</var>, as input,\n    and returns a sequence of keyframes using the following procedure:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>object</var> is <code>null</code>,\nreturn an empty sequence of keyframes.</p>"
        },
        {
          "html": "<p>Let <var>processed keyframes</var> be\nan empty sequence of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑤⑨\">keyframes</a>.</p>"
        },
        {
          "html": "<p>Let <var>method</var> be the result of\n<a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-getmethod\" id=\"ref-for-sec-getmethod\">GetMethod</a>(<var>object</var>, <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-well-known-symbols\" id=\"ref-for-sec-well-known-symbols\">@@iterator</a>).</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#check-the-completion-record\" id=\"ref-for-check-the-completion-record①\">Check the completion record</a> of <var>method</var>.</p>"
        },
        {
          "html": "<p>Perform the steps corresponding to the first matching condition below:</p>\n      <div class=\"switch\">\n       <dl>\n        <dt data-md=\"\">If <var>method</var> is not <span class=\"esvalue\">undefined</span>,\n        </dt><dd data-md=\"\">\n         \n        </dd><dt data-md=\"\">Otherwise,\n        </dt><dd data-md=\"\">\n         \n       </dd></dl>\n      </div>",
          "rationale": ".switch",
          "steps": [
            {
              "html": "<p>Let <var>iter</var> be <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-getiterator\" id=\"ref-for-sec-getiterator\">GetIterator</a>(<var>object</var>, <var>method</var>).</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#check-the-completion-record\" id=\"ref-for-check-the-completion-record②\">Check the completion record</a> of <var>iter</var>.</p>"
            },
            {
              "html": "Repeat:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>next</var> be <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-iteratorstep\" id=\"ref-for-sec-iteratorstep\">IteratorStep</a>(<var>iter</var>).</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#check-the-completion-record\" id=\"ref-for-check-the-completion-record③\">Check the completion record</a> of <var>next</var>.</p>"
                },
                {
                  "html": "<p>If <var>next</var> is false abort this loop.</p>"
                },
                {
                  "html": "<p>Let <var>nextItem</var> be <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-iteratorvalue\" id=\"ref-for-sec-iteratorvalue\">IteratorValue</a>(next).</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#check-the-completion-record\" id=\"ref-for-check-the-completion-record④\">Check the completion record</a> of <var>nextItem</var>.</p>"
                },
                {
                  "html": "<p>If <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-data-types-and-values\" id=\"ref-for-sec-ecmascript-data-types-and-values\">Type</a>(<var>nextItem</var>) is not <code>Undefined</code>, <code>Null</code> or <code>Object</code>,\nthen throw a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑥\">TypeError</a></code> and abort these steps.</p>"
                },
                {
                  "html": "<p>Append to <var>processed keyframes</var>\nthe result of running the procedure to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#process-a-keyframe-like-object\" id=\"ref-for-process-a-keyframe-like-object\">process a keyframe-like object</a>\npassing <var>nextItem</var> as the <var>keyframe input</var>\nwith the <var>allow lists</var> flag set to false.</p>"
                }
              ]
            }
          ],
          "additional": [
            {
              "html": "",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>property-indexed keyframe</var> be\nthe result of running the procedure to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#process-a-keyframe-like-object\" id=\"ref-for-process-a-keyframe-like-object①\">process a keyframe-like object</a>\npassing <var>object</var> as the <var>keyframe input</var>\nwith the <var>allow lists</var> flag set to true.</p>"
                },
                {
                  "html": "For each member, <var>m</var>, in <var>property-indexed keyframe</var>,\nperform the following steps:",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>property name</var> be the key for <var>m</var>.</p>"
                    },
                    {
                      "html": "<p>If <var>property name</var> is\n\"composite\", \"easing\", or \"offset\",\nskip the remaining steps in this loop\nand continue from the next member\nin <var>property-indexed keyframe</var>\nafter <var>m</var>.</p>"
                    },
                    {
                      "html": "<p>Let <var>property values</var> be\nthe value for <var>m</var>.</p>"
                    },
                    {
                      "html": "<p>Let <var>property keyframes</var> be\nan empty sequence of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥⓪\">keyframes</a>.</p>"
                    },
                    {
                      "html": "For each value, <var>v</var>, in <var>property values</var>,\nperform the following steps:",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>Let <var>k</var> be a new <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥①\">keyframe</a>\nwith a <code>null</code> <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-offset\" id=\"ref-for-keyframe-offset①⓪\">keyframe offset</a>.</p>"
                        },
                        {
                          "html": "<p>Add the property-value pair,\n<var>property name</var> → <var>v</var>,\nto <var>k</var>.</p>"
                        },
                        {
                          "html": "<p>Append <var>k</var> to <var>property keyframes</var>.</p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>Apply the procedure to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#compute-missing-keyframe-offsets\" id=\"ref-for-compute-missing-keyframe-offsets③\">compute missing keyframe offsets</a>\nto <var>property keyframes</var>.</p>"
                    },
                    {
                      "html": "<p>Add <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥②\">keyframes</a> in <var>property keyframes</var>\nto <var>processed keyframes</var>.</p>"
                    }
                  ]
                },
                {
                  "html": "<p>Sort <var>processed keyframes</var>\nby the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets②⑥\">computed keyframe offset</a> of each <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥③\">keyframe</a>\nin increasing order.</p>"
                },
                {
                  "html": "<p>Merge adjacent <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥④\">keyframes</a> in <var>processed keyframes</var>\nwhen they have equal <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#computed-keyframe-offsets\" id=\"ref-for-computed-keyframe-offsets②⑦\">computed keyframe offsets</a>.</p>"
                },
                {
                  "html": "<p>Let <var>offsets</var> be\n a sequence of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-nullable-type\" id=\"ref-for-dfn-nullable-type①\">nullable</a> <code>double</code> values\n assigned based on the type of the <code>offset</code> member\n of the <var>property-indexed keyframe</var>\n as follows:</p>\n           <div class=\"switch\">\n            <dl>\n             <dt data-md=\"\"><code>sequence&lt;double?&gt;</code>,\n             </dt><dd data-md=\"\">\n              <p>The value of <code>offset</code> as-is.</p>\n             </dd><dt data-md=\"\"><code>double?</code>,\n             </dt><dd data-md=\"\">\n              <p>A sequence of length one\nwith the value of <code>offset</code> as its single item,\ni.e. «&nbsp;<code>offset</code>&nbsp;»,</p>\n            </dd></dl>\n           </div>"
                },
                {
                  "html": "<p>Assign each value in <var>offsets</var>\nto the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-offset\" id=\"ref-for-keyframe-offset①①\">keyframe offset</a> of the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥⑤\">keyframe</a>\nwith the corresponding position in <var>processed keyframes</var>\nuntil the end of either sequence is reached.</p>"
                },
                {
                  "html": "<p>Let <var>easings</var> be a sequence of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMString\" id=\"ref-for-idl-DOMString①①\">DOMString</a></code> values\nassigned based on the type of the <code>easing</code> member\nof the <var>property-indexed keyframe</var>\nas follows:</p>\n           <div class=\"switch\">\n            <dl>\n             <dt data-md=\"\"><code>sequence&lt;DOMString&gt;</code>,\n             </dt><dd data-md=\"\">\n              <p>The value of <code>easing</code> as-is.</p>\n             </dd><dt data-md=\"\"><code>DOMString</code>,\n             </dt><dd data-md=\"\">\n              <p>A sequence of length one\nwith the value of <code>easing</code> as its single item,\ni.e. «&nbsp;<code>easing</code>&nbsp;»,</p>\n            </dd></dl>\n           </div>"
                },
                {
                  "html": "<p>If <var>easings</var> is an empty sequence,\nlet it be a sequence of length one\ncontaining the single value \"linear\",\ni.e. «&nbsp;\"linear\"&nbsp;».</p>"
                },
                {
                  "html": "<p>If <var>easings</var> has fewer items than <var>processed keyframes</var>,\nrepeat the elements in <var>easings</var> successively\nstarting from the beginning of the list\nuntil <var>easings</var> has as many items as <var>processed keyframes</var>.</p>"
                },
                {
                  "html": "<p>If <var>easings</var> has more items than <var>processed keyframes</var>,\nstore the excess items as <var>unused easings</var>.</p>"
                },
                {
                  "html": "<p>Assign each value in <var>easings</var>\nto a property named <code>easing</code>\non the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥⑥\">keyframe</a>\nwith the corresponding position in <var>processed keyframes</var>\nuntil the end of <var>processed keyframes</var> is reached.</p>"
                },
                {
                  "html": "If the <code>composite</code> member\nof the <var>property-indexed keyframe</var>\nis <em>not</em> an empty sequence:",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>composite modes</var> be\na sequence of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#enumdef-compositeoperationorauto\" id=\"ref-for-enumdef-compositeoperationorauto④\">CompositeOperationOrAuto</a></code> values\nassigned from the <code>composite</code> member\nof <var>property-indexed keyframe</var>.\nIf that member is\na single <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#enumdef-compositeoperationorauto\" id=\"ref-for-enumdef-compositeoperationorauto⑤\">CompositeOperationOrAuto</a></code> value operation,\nlet <var>composite modes</var> be\na sequence of length one,\nwith the value of the <code>composite</code>\nas its single item.</p>"
                    },
                    {
                      "html": "<p>As with <var>easings</var>,\nif <var>composite modes</var> has fewer items than <var>processed keyframes</var>,\nrepeat the elements in <var>composite modes</var> successively\nstarting from the beginning of the list\nuntil <var>composite modes</var> has as many items\nas <var>processed keyframes</var>.</p>"
                    },
                    {
                      "html": "<p>Assign each value in <var>composite modes</var>\nthat is not <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-compositeoperationorauto-auto\" id=\"ref-for-dom-compositeoperationorauto-auto②\">auto</a></code>\nto the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-specific-composite-operation\" id=\"ref-for-keyframe-specific-composite-operation⑤\">keyframe-specific composite operation</a>\non the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥⑦\">keyframe</a>\nwith the corresponding position in <var>processed keyframes</var>\nuntil the end of <var>processed keyframes</var> is reached.</p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>processed keyframes</var> is not <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#loosely-sorted-by-offset\" id=\"ref-for-loosely-sorted-by-offset\">loosely sorted by offset</a>,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①④\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑦\">TypeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If there exist any <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe\" id=\"ref-for-keyframe⑥⑧\">keyframe</a> in <var>processed keyframes</var>\nwhose <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#keyframe-offset\" id=\"ref-for-keyframe-offset①②\">keyframe offset</a> is non-null\nand less than zero or greater than one,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①⑤\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑧\">TypeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "For each <var>frame</var> in <var>processed keyframes</var>,\nperform the following steps:",
          "rationale": "for",
          "steps": [
            {
              "html": "<p>For each property-value pair in <var>frame</var>,\nparse the property value\nusing the syntax specified for that property.</p>\n        <p>If the property value is invalid\naccording to the syntax for the property,\ndiscard the property-value pair.\nUser agents that provide support for diagnosing errors in content\nSHOULD produce an appropriate warning\nhighlighting the invalid property value.</p>"
            },
            {
              "html": "<p>Let the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-easing-2/#easing-function\" id=\"ref-for-easing-function①⑦\">easing function</a> of <var>frame</var> be\nthe result of parsing the <code>easing</code> property on <var>frame</var>\nusing the CSS syntax defined for\nthe <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-easing\" id=\"ref-for-dom-effecttiming-easing④\">easing</a></code> member of the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-effecttiming\" id=\"ref-for-dictdef-effecttiming①③\">EffectTiming</a></code> dictionary.</p>\n        <p>If parsing the <code>easing</code> property fails,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①⑥\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror⑨\">TypeError</a></code> and abort this procedure.</p>"
            }
          ]
        },
        {
          "html": "<p>Parse each of the values in <var>unused easings</var>\nusing the CSS syntax defined for\nthe <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-effecttiming-easing\" id=\"ref-for-dom-effecttiming-easing⑤\">easing</a></code> member of the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-effecttiming\" id=\"ref-for-dictdef-effecttiming①④\">EffectTiming</a></code> dictionary,\nand if any of the values fail to parse,\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①⑦\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①①\">TypeError</a></code> and abort this procedure.</p>"
        }
      ]
    },
    {
      "name": "Animatable/animate(keyframes, options)",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-animatable-animate",
      "html": "Performs the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>target</var> be the object on which this method was called.</p>"
        },
        {
          "html": "<p>Construct a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#keyframeeffect\" id=\"ref-for-keyframeeffect①④\">KeyframeEffect</a></code> object <var>effect</var>\n  in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm⑥\">relevant Realm</a> of <var>target</var>\n  by using the same procedure as the\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-keyframeeffect\" id=\"ref-for-dom-keyframeeffect-keyframeeffect⑤\">KeyframeEffect(target, keyframes, options)</a></code> constructor,\n  passing <var>target</var> as the <var>target</var> argument,\n  and the <var>keyframes</var> and <var>options</var> arguments as supplied.</p>\n        <p>If the above procedure causes an exception to be thrown,\n  propagate the exception and abort this procedure.</p>"
        },
        {
          "html": "<p>If <var>options</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-keyframeanimationoptions\" id=\"ref-for-dictdef-keyframeanimationoptions②\">KeyframeAnimationOptions</a></code> object,\n  let <var>timeline</var> be the <code>timeline</code> member of <var>options</var>\n  or, if <code>timeline</code> member of <var>options</var> is missing,\n  the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#document-default-document-timeline\" id=\"ref-for-document-default-document-timeline⑧\">default document timeline</a> of the <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-node-document\" id=\"ref-for-concept-node-document\">node document</a>\n  of the element on which this method was called.</p>"
        },
        {
          "html": "<p>Construct a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#animation\" id=\"ref-for-animation①②\">Animation</a></code> object, <var>animation</var>,\n  in the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-concept-relevant-realm⑦\">relevant Realm</a> of <var>target</var>\n  by using the same procedure as the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animation-animation\" id=\"ref-for-dom-animation-animation①\">Animation()</a></code> constructor,\n  passing <var>effect</var> and <var>timeline</var> as arguments of the same name.</p>"
        },
        {
          "html": "<p>If <var>options</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dictdef-keyframeanimationoptions\" id=\"ref-for-dictdef-keyframeanimationoptions③\">KeyframeAnimationOptions</a></code> object,\n  assign the value of the <code>id</code> member of <var>options</var>\n  to <var>animation</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animation-id\" id=\"ref-for-dom-animation-id①\">id</a></code> attribute.</p>"
        },
        {
          "html": "<p>Run the procedure to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#play-an-animation\" id=\"ref-for-play-an-animation⑤\">play an animation</a> for <var>animation</var>\n  with the <var>auto-rewind</var> flag set to true.</p>"
        },
        {
          "html": "<p>Return <var>animation</var>.</p>"
        }
      ]
    },
    {
      "name": "Animatable/getAnimations(options)",
      "href": "https://drafts.csswg.org/web-animations-1/#dom-animatable-getanimations",
      "html": "",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>object</var> be the object on which this method was called.</p>"
        },
        {
          "html": "<p>Let <var>pseudoElement</var> be the result of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-keyframeeffect-pseudo-element-parsing\" id=\"ref-for-dom-keyframeeffect-pseudo-element-parsing\">pseudo-element parsing</a></code>\n  applied to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-getanimationsoptions-pseudoelement\" id=\"ref-for-dom-getanimationsoptions-pseudoelement①\">pseudoElement</a></code> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animatable-getanimations-options-options\" id=\"ref-for-dom-animatable-getanimations-options-options①\">options</a></code>,\n  or <code>null</code> if <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animatable-getanimations-options-options\" id=\"ref-for-dom-animatable-getanimations-options-options②\">options</a></code> is not passed.</p>"
        },
        {
          "html": "<p>If <var>pseudoElement</var> is not <code>null</code>,\n  then let <var>target</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/selectors-4/#pseudo-element\" id=\"ref-for-pseudo-element⑦\">pseudo-element</a>\n  identified by <var>pseudoElement</var>\n  with <var>object</var> as the originating element.\n  Otherwise, let <var>target</var> be <var>object</var>.</p>"
        },
        {
          "html": "<p>If <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-animatable-getanimations-options-options\" id=\"ref-for-dom-animatable-getanimations-options-options③\">options</a></code> is passed\n  with <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/web-animations-1/#dom-getanimationsoptions-subtree\" id=\"ref-for-dom-getanimationsoptions-subtree①\">subtree</a></code> set to true,\n  then return the set of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#relevant-animations-for-a-subtree\" id=\"ref-for-relevant-animations-for-a-subtree\">relevant animations for a subtree</a> of <var>target</var>.\n  Otherwise, return the set of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/web-animations-1/#relevant-animations\" id=\"ref-for-relevant-animations\">relevant animations</a> for <var>target</var>.</p>"
        }
      ]
    }
  ]
}