{
  "spec": {
    "title": "CSS Scroll Snap Module Level 2",
    "url": "https://drafts.csswg.org/css-scroll-snap-2/"
  },
  "algorithms": [
    {
      "name": "determine the initial scroll position from an initial scroll target",
      "html": "If the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#initial-scroll-target\" id=\"ref-for-initial-scroll-target②\">initial scroll target</a> of a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-overflow-3/#scroll-container\" id=\"ref-for-scroll-container②\">scroll container</a> is not null,\n\t\tit  should be used to determine the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-overflow-3/#initial-scroll-position\" id=\"ref-for-initial-scroll-position\">initial scroll position</a> of <var>scrollcontainer</var>\n\t\tby running the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>target</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#initial-scroll-target\" id=\"ref-for-initial-scroll-target③\">initial scroll target</a> for <var>scrollcontainer</var>.</p>"
        },
        {
          "html": "<p>Let <var>position</var> be the result of running the steps to\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#determine-the-scroll-into-view-position\" id=\"ref-for-determine-the-scroll-into-view-position\">determine the scroll-into-view position</a> of <var>target</var>\nwith <var>behavior</var> set to \"auto\",\n<var>block</var> set to \"start\",\n<var>inline</var> set to \"nearest\",\nand <var>scrolling box</var> set to <var>scrollcontainer</var>.</p>"
        },
        {
          "html": "<p>Set <var>scrollcontainer</var>’s <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-overflow-3/#initial-scroll-position\" id=\"ref-for-initial-scroll-position①\">initial scroll position</a> to <var>position</var>.</p>"
        }
      ]
    },
    {
      "html": "<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#eventdef-snapevent-scrollsnapchange\" id=\"ref-for-eventdef-snapevent-scrollsnapchange②\">scrollsnapchange</a></code> indicates that the snap area to which a snap container is snapped along either axis has changed.\n\t<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#eventdef-snapevent-scrollsnapchange\" id=\"ref-for-eventdef-snapevent-scrollsnapchange③\">scrollsnapchange</a></code> is dispatched:",
      "rationale": "if",
      "steps": [
        {
          "html": "when a scrolling operation is <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#scroll-completed\" id=\"ref-for-scroll-completed\">completed</a>\n\t\tif, for either the block or inline axis, the\n\t\t<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target③\">snap target</a> which the snap container is snapped to is different from the <span id=\"ref-for-snap-target④\">snap target</span>\n\t\tit most recently snapped to in that axis. For snap containers with\n\t\t<a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#valdef-scroll-snap-type-proximity\" id=\"ref-for-valdef-scroll-snap-type-proximity\">proximity</a> strictness, the scroll may result in the snap\n\t\tcontainer no longer being snapped to any <span id=\"ref-for-snap-target⑤\">snap target</span>. <a href=\"https://drafts.csswg.org/css-scroll-snap-1/#choosing\"><cite>CSS Scroll Snap 1</cite> § 6.2 Choosing Snap Positions</a>\n\t\tdescribes the method a UA follows when choosing\tbetween elements or pseudo-elements which are\n\t\t<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#scroll-snap-area\" id=\"ref-for-scroll-snap-area\">snap areas</a>."
        },
        {
          "html": "if there is a change to a snap container’s style such that it goes from\n\t\thaving a non-<a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#valdef-scroll-snap-type-none\" id=\"ref-for-valdef-scroll-snap-type-none\">none</a> value for <a class=\"css property\" data-link-type=\"property\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#propdef-scroll-snap-type\" id=\"ref-for-propdef-scroll-snap-type\">scroll-snap-type</a>\n\t\tto having a <span class=\"css\" id=\"ref-for-valdef-scroll-snap-type-none①\">none</span> value or vice versa."
        },
        {
          "html": "if, after a <a href=\"https://drafts.csswg.org/css-scroll-snap-1/#re-snap\">layout change</a>, the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target⑥\">snap target</a> to\n\t\twhich a snap container is snapped to changes, regardless of whether there is\n\t\ta change in scroll position after the layout change."
        }
      ]
    },
    {
      "name": "Document/update scrollsnapchange targets",
      "href": "https://drafts.csswg.org/css-scroll-snap-2/#document-update-scrollsnapchange-targets",
      "html": "When asked to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"Document\" data-dfn-type=\"dfn\" data-export=\"\" id=\"document-update-scrollsnapchange-targets\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update scrollsnapchange targets</dfn>\n\tfor a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#scroll-snap-container\" id=\"ref-for-scroll-snap-container②\">snap container</a>,\n\t<var>snapcontainer</var>, run these steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>doc</var> be <var>snapcontainer</var>’s associated <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②\">Document</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>blockTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchangetargetblock\" id=\"ref-for-scrollsnapchangetargetblock\">scrollsnapchangeTargetBlock</a> associated\nwith <var>snapcontainer</var>.</p>"
        },
        {
          "html": "<p>Let <var>inlineTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchangetargetinline\" id=\"ref-for-scrollsnapchangetargetinline\">scrollsnapchangeTargetInline</a> associated\nwith <var>snapcontainer</var>.</p>"
        },
        {
          "html": "<p>Let <var>blockScrollSnapchangingTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchanging-block-axis-target\" id=\"ref-for-scrollsnapchanging-block-axis-target\">scrollsnapchanging block-axis target</a>\nassociated with <var>snapcontainer</var>.</p>"
        },
        {
          "html": "<p>Let <var>inlineScrollSnapchangingTarget</var> be the\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchanging-inline-axis-target\" id=\"ref-for-scrollsnapchanging-inline-axis-target\">scrollsnapchanging inline-axis target</a> associated with <var>snapcontainer</var>.</p>"
        },
        {
          "html": "<p>Let <var>snap targets changed</var> be a boolean flag that is initially false.</p>"
        },
        {
          "html": "If <var>blockTarget</var> is not the same <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target⑧\">snap target</a> as <var>blockScrollSnapchangingTarget</var> or",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchangetargetblock\" id=\"ref-for-scrollsnapchangetargetblock①\">scrollsnapchangeTargetBlock</a> associated with <var>snapcontainer</var> to\n<var>blockScrollSnapchangingTarget</var>.</p>"
            },
            {
              "html": "<p>Set <var>snap targets changed</var> to true.</p>"
            }
          ]
        },
        {
          "html": "If <var>inlineTarget</var> is not the same <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target⑨\">snap target</a> as <var>inlineScrollSnapchangingTarget</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchangetargetinline\" id=\"ref-for-scrollsnapchangetargetinline①\">scrollsnapchangeTargetInline</a> associated with <var>snapcontainer</var> to\n<var>inlineScrollSnapchangingTarget</var>.</p>"
            },
            {
              "html": "<p>Set <var>snap targets changed</var> to true.</p>"
            }
          ]
        },
        {
          "html": "If <var>snap targets changed</var> is true:",
          "rationale": "if",
          "steps": [
            {
              "html": "If (<var>snapcontainer</var>, <code>\"scrollsnapchange\"</code>) is not already in <var>doc</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#document-pending-scroll-events\" id=\"ref-for-document-pending-scroll-events\">pending scroll events</a>:",
              "rationale": "append",
              "steps": [
                {
                  "html": "<p>Append (<var>snapcontainer</var>, <code>\"scrollsnapchange\"</code>) to <var>doc</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#document-pending-scroll-events\" id=\"ref-for-document-pending-scroll-events①\">pending scroll events</a>.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Document/update scrollsnapchanging targets",
      "href": "https://drafts.csswg.org/css-scroll-snap-2/#document-update-scrollsnapchanging-targets",
      "html": "When asked to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"Document\" data-dfn-type=\"dfn\" data-export=\"\" id=\"document-update-scrollsnapchanging-targets\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update scrollsnapchanging targets</dfn>\n\tfor a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#scroll-snap-container\" id=\"ref-for-scroll-snap-container⑤\">snap container</a>,\n\t<var>snapcontainer</var>, given an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target①④\">snap target</a> newBlockTarget and an <span id=\"ref-for-snap-target①⑤\">snap target</span>\n\tnewInlineTarget, run these steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>doc</var> be <var>snapcontainer</var>’s associated <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document③\">Document</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>blockTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchanging-block-axis-target\" id=\"ref-for-scrollsnapchanging-block-axis-target②\">scrollsnapchanging block-axis target</a> that is\nassociated with <var>snapcontainer</var>.</p>"
        },
        {
          "html": "<p>Let <var>inlineTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchanging-inline-axis-target\" id=\"ref-for-scrollsnapchanging-inline-axis-target②\">scrollsnapchanging inline-axis target</a> that is\nassociated with <var>snapcontainer</var>.</p>"
        },
        {
          "html": "If <var>newBlockTarget</var> is not the same <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target①⑥\">snap target</a> as <var>blockTarget</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchanging-block-axis-target\" id=\"ref-for-scrollsnapchanging-block-axis-target③\">scrollsnapchanging block-axis target</a> associated with <var>snapcontainer</var> to\n<var>newBlockTarget</var>.</p>"
            },
            {
              "html": "If (<var>snapcontainer</var>, <code>\"scrollsnapchanging\"</code>) is not already in <var>doc</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#document-pending-scroll-events\" id=\"ref-for-document-pending-scroll-events②\">pending scroll events</a>,",
              "rationale": "append",
              "steps": [
                {
                  "html": "<p>Append (<var>snapcontainer</var>, <code>\"scrollsnapchanging\"</code>) to <var>doc</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#document-pending-scroll-events\" id=\"ref-for-document-pending-scroll-events③\">pending scroll events</a></p>"
                }
              ]
            }
          ]
        },
        {
          "html": "If <var>newInlineTarget</var> is not the same <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target①⑦\">snap target</a> as <var>inlineTarget</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#scrollsnapchanging-inline-axis-target\" id=\"ref-for-scrollsnapchanging-inline-axis-target③\">scrollsnapchanging inline-axis target</a> associated with <var>snapcontainer</var> to\n<var>newInlineTarget</var>.</p>"
            },
            {
              "html": "If (<var>snapcontainer</var>, <code>\"scrollsnapchanging\"</code>) is not already in <var>doc</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#document-pending-scroll-events\" id=\"ref-for-document-pending-scroll-events④\">pending scroll events</a>,",
              "rationale": "append",
              "steps": [
                {
                  "html": "<p>Append (<var>snapcontainer</var>, <code>\"scrollsnapchanging\"</code>) to <var>doc</var>’s\n<a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/cssom-view-1/#document-pending-scroll-events\" id=\"ref-for-document-pending-scroll-events⑤\">pending scroll events</a></p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "Document/update scrollsnapchanging targets",
      "href": "https://drafts.csswg.org/css-scroll-snap-2/#document-update-scrollsnapchanging-targets",
      "html": "When asked to <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"Document\" data-dfn-type=\"dfn\" data-export=\"\" id=\"document-update-scrollsnapchanging-targets\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">update scrollsnapchanging targets</dfn>\n\tfor a <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#scroll-snap-container\" id=\"ref-for-scroll-snap-container⑤\">snap container</a>,\n\t<var>snapcontainer</var>, given an <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target①④\">snap target</a> newBlockTarget and an <span id=\"ref-for-snap-target①⑤\">snap target</span>\n\tnewInlineTarget, run these steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>newBlockTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target①⑧\">snap target</a> that <var>snapcontainer</var> has\n <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#scroll-snap\" id=\"ref-for-scroll-snap④\">snapped</a>  to\n in the block axis or null if it did not snap to any element.</p>"
        },
        {
          "html": "<p>Let <var>newInlineTarget</var> be the <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#snap-target\" id=\"ref-for-snap-target①⑨\">snap target</a> that <var>snapcontainer</var> has\n <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-1/#scroll-snap\" id=\"ref-for-scroll-snap⑤\">snapped</a> to\n in the inline axis or null if it did not snap to any element or pseudo-element.</p>"
        },
        {
          "html": "<p>Run the steps to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#document-update-scrollsnapchanging-targets\" id=\"ref-for-document-update-scrollsnapchanging-targets\">update scrollsnapchanging targets</a> with <var>newBlockTarget</var>\n as newBlockTarget and <var>newInlineTarget</var> as newInlineTarget.</p>"
        },
        {
          "html": "<p>Run the steps to <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/css-scroll-snap-2/#document-update-scrollsnapchange-targets\" id=\"ref-for-document-update-scrollsnapchange-targets①\">update scrollsnapchange targets</a> for <var>snapcontainer</var>.</p>"
        }
      ]
    }
  ]
}