{
  "spec": {
    "title": "Media Queries Level 5",
    "url": "https://drafts.csswg.org/mediaqueries-5/"
  },
  "algorithms": [
    {
      "name": "get valid values for colorScheme",
      "href": "https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-colorscheme",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"get-valid-values-for-colorscheme\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">get valid values for colorScheme</dfn> algorithm, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>validValues</var> be a new empty <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence\">sequence</a>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-color-scheme-light\" id=\"ref-for-valdef-media-prefers-color-scheme-light②\">light</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-color-scheme-dark\" id=\"ref-for-valdef-media-prefers-color-scheme-dark③\">dark</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Return <var>validValues</var>.</p>"
        }
      ]
    },
    {
      "name": "get valid values for contrast",
      "href": "https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-contrast",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"get-valid-values-for-contrast\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">get valid values for contrast</dfn> algorithm, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>validValues</var> be a new empty <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence①\">sequence</a>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-more\" id=\"ref-for-valdef-media-prefers-contrast-more③\">more</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-less\" id=\"ref-for-valdef-media-prefers-contrast-less③\">less</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-contrast-no-preference\" id=\"ref-for-valdef-media-prefers-contrast-no-preference\">no-preference</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Return <var>validValues</var>.</p>"
        }
      ]
    },
    {
      "name": "get valid values for reducedMotion",
      "href": "https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reducedmotion",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"get-valid-values-for-reducedmotion\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">get valid values for reducedMotion</dfn> algorithm, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>validValues</var> be a new empty <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence②\">sequence</a>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-motion-reduce\" id=\"ref-for-valdef-media-prefers-reduced-motion-reduce\">reduce</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-motion-no-preference\" id=\"ref-for-valdef-media-prefers-reduced-motion-no-preference\">no-preference</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Return <var>validValues</var>.</p>"
        }
      ]
    },
    {
      "name": "get valid values for reducedTransparency",
      "href": "https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reducedtransparency",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"get-valid-values-for-reducedtransparency\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">get valid values for reducedTransparency</dfn> algorithm, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>validValues</var> be a new empty <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence③\">sequence</a>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-transparency-reduce\" id=\"ref-for-valdef-media-prefers-reduced-transparency-reduce\">reduce</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-transparency-no-preference\" id=\"ref-for-valdef-media-prefers-reduced-transparency-no-preference\">no-preference</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Return <var>validValues</var>.</p>"
        }
      ]
    },
    {
      "name": "get valid values for reducedData",
      "href": "https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reduceddata",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"get-valid-values-for-reduceddata\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">get valid values for reducedData</dfn> algorithm, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>validValues</var> be a new empty <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#idl-sequence\" id=\"ref-for-idl-sequence④\">sequence</a>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-data-reduce\" id=\"ref-for-valdef-media-prefers-reduced-data-reduce①\">reduce</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Add <a class=\"css\" data-link-type=\"maybe\" href=\"https://drafts.csswg.org/mediaqueries-5/#valdef-media-prefers-reduced-data-no-preference\" id=\"ref-for-valdef-media-prefers-reduced-data-no-preference\">no-preference</a> to <var>validValues</var>.</p>"
        },
        {
          "html": "<p>Return <var>validValues</var>.</p>"
        }
      ]
    },
    {
      "name": "get preference override",
      "href": "https://drafts.csswg.org/mediaqueries-5/#dom-preferenceobject-override",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"PreferenceObject\" data-dfn-type=\"attribute\" data-export=\"\" id=\"dom-preferenceobject-override\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>override</code></dfn> attribute, when accessed, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>preference</var> be the preference object’s name.</p>"
        },
        {
          "html": "<p>Let <var>override</var> be null.</p>"
        },
        {
          "html": "<p>If an override for <var>preference</var> exists, set <var>override</var> to the value of that override.</p>"
        },
        {
          "html": "<p>Return <var>override</var>.</p>"
        }
      ]
    },
    {
      "name": "get preference value",
      "href": "https://drafts.csswg.org/mediaqueries-5/#dom-preferenceobject-value",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"PreferenceObject\" data-dfn-type=\"attribute\" data-export=\"\" id=\"dom-preferenceobject-value\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>value</code></dfn> attribute, when accessed, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>preference</var> be the preference object’s name.</p>"
        },
        {
          "html": "<p>Let <var>value</var> be null.</p>"
        },
        {
          "html": "<p>If an override for <var>preference</var> exists, set <var>value</var> to the value of that override.</p>"
        },
        {
          "html": "<p>If <var>value</var> is null, set <var>value</var> to the UA value of the preference.</p>"
        },
        {
          "html": "<p>Return <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "PreferenceObject/validValues",
      "href": "https://drafts.csswg.org/mediaqueries-5/#dom-preferenceobject-validvalues",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"PreferenceObject\" data-dfn-type=\"attribute\" data-export=\"\" id=\"dom-preferenceobject-validvalues\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>validValues</code></dfn> attribute, when accessed, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Let <var>preference</var> be the preference object’s name."
        },
        {
          "html": "Switch on <var>preference</var>:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "\"colorScheme\"",
                  "html": "Return the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-colorscheme\" id=\"ref-for-get-valid-values-for-colorscheme\">get valid values for colorScheme</a>."
                },
                {
                  "case": "\"contrast\"",
                  "html": "Return the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-contrast\" id=\"ref-for-get-valid-values-for-contrast\">get valid values for contrast</a>."
                },
                {
                  "case": "\"reducedMotion\"",
                  "html": "Return the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reducedmotion\" id=\"ref-for-get-valid-values-for-reducedmotion\">get valid values for reducedMotion</a>."
                },
                {
                  "case": "\"reducedTransparency\"",
                  "html": "Return the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reducedtransparency\" id=\"ref-for-get-valid-values-for-reducedtransparency\">get valid values for reducedTransparency</a>."
                },
                {
                  "case": "\"reducedData\"",
                  "html": "Return the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reduceddata\" id=\"ref-for-get-valid-values-for-reduceddata\">get valid values for reducedData</a>."
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "update steps",
      "href": "https://drafts.csswg.org/mediaqueries-5/#preferenceobject-preferenceobject-update-steps",
      "html": "Whenever the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#user-agent\" id=\"ref-for-user-agent\">user agent</a> is aware that the state of a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/mediaqueries-5/#preferenceobject\" id=\"ref-for-preferenceobject①①\">PreferenceObject</a></code>\ninstance <var>value</var> has changed, it runs the <dfn class=\"algorithm dfn-paneled has-dfn-panel\" data-algorithm=\"PreferenceObject update steps\" data-algorithm-for=\"PreferenceObject\" data-dfn-for=\"PreferenceObject\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"PreferenceObject update steps\" id=\"preferenceobject-preferenceobject-update-steps\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/mediaqueries-5/#preferenceobject\" id=\"ref-for-preferenceobject①②\">PreferenceObject</a></code>\nupdate steps</dfn>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>preference</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/mediaqueries-5/#preferenceobject\" id=\"ref-for-preferenceobject①③\">PreferenceObject</a></code> object that <var>value</var> is associated with.</p>"
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global\">relevant global object</a> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window\">Window</a></code> object, then:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>document</var> be <var>preference</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global①\">relevant global object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window\">associated Document</a>.</p>"
            },
            {
              "html": "<p>If <var>document</var> is null or <var>document</var> is not <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#fully-active\" id=\"ref-for-fully-active\">fully active</a>, terminate this algorithm.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\" id=\"ref-for-concept-event-fire\">Fire an event</a> named <code>change</code> at <var>preference</var>.</p>"
        }
      ]
    },
    {
      "name": "request preference override",
      "href": "https://drafts.csswg.org/mediaqueries-5/#dom-preferenceobject-requestoverride",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"PreferenceObject\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-preferenceobject-requestoverride\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>requestOverride(value)</code></dfn> method, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise\">a new promise</a>.</p>"
        },
        {
          "html": "<p>Let <var>allowed</var> be false.</p>"
        },
        {
          "html": "<p>Set <var>allowed</var> to the result of executing a UA defined algorithm for deciding whether the request is allowed.</p>"
        },
        {
          "html": "<p>If <var>allowed</var> is false, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with\">a promise rejected with</a> a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notallowederror\" id=\"ref-for-notallowederror\">NotAllowedError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException\">DOMException</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>value</var> be the method’s argument.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-a-new-promise①\">a new promise</a>.</p>"
        },
        {
          "html": "If <var>value</var> is null or the empty string:",
          "rationale": "run",
          "steps": [
            {
              "html": "<p>Run <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://drafts.csswg.org/mediaqueries-5/#dom-preferenceobject-clearoverride\" id=\"ref-for-dom-preferenceobject-clearoverride①\">clearOverride</a></code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve\">Resolve</a> and return <var>result</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>currentValue</var> be the preference object’s <var>value</var>.</p>"
        },
        {
          "html": "<p>Let <var>validValues</var> be null.</p>"
        },
        {
          "html": "Switch on <var>preference</var>:",
          "rationale": ".switch",
          "steps": [
            {
              "operation": "switch",
              "steps": [
                {
                  "case": "\"colorScheme\"",
                  "html": "Set <var>validValues</var> to the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-colorscheme\" id=\"ref-for-get-valid-values-for-colorscheme①\">get valid values for colorScheme</a>."
                },
                {
                  "case": "\"contrast\"",
                  "html": "Set <var>validValues</var> to the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-contrast\" id=\"ref-for-get-valid-values-for-contrast①\">get valid values for contrast</a>."
                },
                {
                  "case": "\"reducedMotion\"",
                  "html": "Set <var>validValues</var> to the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reducedmotion\" id=\"ref-for-get-valid-values-for-reducedmotion①\">get valid values for reducedMotion</a>."
                },
                {
                  "case": "\"reducedTransparency\"",
                  "html": "Set <var>validValues</var> to the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reducedtransparency\" id=\"ref-for-get-valid-values-for-reducedtransparency①\">get valid values for reducedTransparency</a>."
                },
                {
                  "case": "\"reducedData\"",
                  "html": "Set <var>validValues</var> to the result of <a data-link-type=\"dfn\" href=\"https://drafts.csswg.org/mediaqueries-5/#get-valid-values-for-reduceddata\" id=\"ref-for-get-valid-values-for-reduceddata①\">get valid values for reducedData</a>."
                }
              ]
            }
          ]
        },
        {
          "html": "If <var>value</var> is not in <var>validValues</var>:",
          "rationale": "reject",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject\">Reject</a> <var>result</var> with a \"<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror\">TypeError</a></code>\" <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException①\">DOMException</a></code>.</p>"
            },
            {
              "html": "<p>Return <var>result</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>previousOverride</var> be null.</p>"
        },
        {
          "html": "<p>If an override for <var>preference</var> exists, set <var>previousOverride</var> to the value of that override.</p>"
        },
        {
          "html": "If <var>value</var> is different from <var>previousOverride</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set the preference override for <var>preference</var> to <var>value</var>.</p>"
            }
          ]
        },
        {
          "html": "If <var>previousOverride</var> is null, then:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var>value</var> is the same as <var>currentValue</var>, then:",
              "rationale": "fire",
              "steps": [
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\" id=\"ref-for-concept-event-fire①\">Fire an event</a> named <code>change</code> at <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①\">this</a>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①\">Resolve</a> and return <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "clear preference override",
      "href": "https://drafts.csswg.org/mediaqueries-5/#dom-preferenceobject-clearoverride",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"PreferenceObject\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-preferenceobject-clearoverride\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>clearOverride()</code></dfn> method, when invoked, must run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>preference</var> be the preference object’s name.</p>"
        },
        {
          "html": "<p>Let <var>override</var> be null.</p>"
        },
        {
          "html": "<p>If an override for <var>preference</var> exists, set <var>override</var> to the value of that override.</p>"
        },
        {
          "html": "<p>If <var>override</var> is null, then return.</p>"
        },
        {
          "html": "<p>Clear the override for <var>preference</var>.</p>"
        },
        {
          "html": "<p>Let <var>newValue</var> be the preference object’s value.</p>"
        },
        {
          "html": "<p>If <var>newValue</var> is equal to <var>override</var>, then:</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\" id=\"ref-for-concept-event-fire②\">Fire an event</a> named <code>change</code> at <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②\">this</a>.</p>"
        }
      ]
    }
  ]
}