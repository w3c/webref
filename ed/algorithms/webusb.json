{
  "spec": {
    "title": "WebUSB API",
    "url": "https://wicg.github.io/webusb/"
  },
  "algorithms": [
    {
      "name": "match a device filter",
      "href": "https://wicg.github.io/webusb/#match-a-device-filter",
      "html": "A USB device <var>device</var> <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"match a device filter\" data-noexport=\"\" id=\"match-a-device-filter\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">matches a device\nfilter</dfn> <var>filter</var> if the following steps return <code>match</code>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>deviceDesc</var> be <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#device-descriptor\" id=\"ref-for-device-descriptor\">device descriptor</a>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-vendorid\" id=\"ref-for-dom-usbdevicefilter-vendorid\">vendorId</a></code></code> is present and <code><var>deviceDesc</var>.idVendor</code> does not equal <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-vendorid\" id=\"ref-for-dom-usbdevicefilter-vendorid①\">vendorId</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-productid\" id=\"ref-for-dom-usbdevicefilter-productid\">productId</a></code></code> is present and <code><var>deviceDesc</var>.idProduct</code> does not equal <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-productid\" id=\"ref-for-dom-usbdevicefilter-productid①\">productId</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-serialnumber\" id=\"ref-for-dom-usbdevicefilter-serialnumber\">serialNumber</a></code></code> is present then,\n let <var>serialNumber</var> be the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#string-descriptor\" id=\"ref-for-string-descriptor\">string descriptor</a> with index <code><var>deviceDesc</var>.iSerialNumber</code>. If <var>device</var> returns an error when\n requesting <var>serialNumber</var> or <var>serialNumber</var> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-serialnumber\" id=\"ref-for-dom-usbdevicefilter-serialnumber①\">serialNumber</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-classcode\" id=\"ref-for-dom-usbdevicefilter-classcode\">classCode</a></code></code> is present and,\n for any of <var>device</var>’s interface’s <var>interface</var>, <var>interface</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#matches-the-interface-filter\" id=\"ref-for-matches-the-interface-filter\">matches\n the interface filter</a> <var>filter</var>, return <code>match</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-classcode\" id=\"ref-for-dom-usbdevicefilter-classcode①\">classCode</a></code></code> is present and <code><var>deviceDesc</var>.bDeviceClass</code> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-classcode\" id=\"ref-for-dom-usbdevicefilter-classcode②\">classCode</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-subclasscode\" id=\"ref-for-dom-usbdevicefilter-subclasscode\">subclassCode</a></code></code> is present and <code><var>deviceDesc</var>.bDeviceSubClass</code> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-subclasscode\" id=\"ref-for-dom-usbdevicefilter-subclasscode①\">subclassCode</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-protocolcode\" id=\"ref-for-dom-usbdevicefilter-protocolcode\">protocolCode</a></code></code> is present and <code><var>deviceDesc</var>.bDeviceProtocol</code> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-protocolcode\" id=\"ref-for-dom-usbdevicefilter-protocolcode①\">protocolCode</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>Return <code>match</code>.</p>"
        }
      ]
    },
    {
      "name": "matches the interface filter",
      "href": "https://wicg.github.io/webusb/#matches-the-interface-filter",
      "html": "A USB interface <var>interface</var> <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"matches the interface filter\" data-noexport=\"\" id=\"matches-the-interface-filter\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">matches\nan interface filter</dfn> <var>filter</var> if the following steps return <code>match</code>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>desc</var> be <var>interface</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#interface-descriptor\" id=\"ref-for-interface-descriptor①\">interface descriptor</a>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-classcode\" id=\"ref-for-dom-usbdevicefilter-classcode③\">classCode</a></code></code> is present and <code><var>desc</var>.bInterfaceClass</code> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-classcode\" id=\"ref-for-dom-usbdevicefilter-classcode④\">classCode</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-subclasscode\" id=\"ref-for-dom-usbdevicefilter-subclasscode②\">subclassCode</a></code></code> is present and <code><var>desc</var>.bInterfaceSubClass</code> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-subclasscode\" id=\"ref-for-dom-usbdevicefilter-subclasscode③\">subclassCode</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-protocolcode\" id=\"ref-for-dom-usbdevicefilter-protocolcode②\">protocolCode</a></code></code> is present and <code><var>desc</var>.bInterfaceProtocol</code> is not equal to <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-protocolcode\" id=\"ref-for-dom-usbdevicefilter-protocolcode③\">protocolCode</a></code></code>, return <code>mismatch</code>.</p>"
        },
        {
          "html": "<p>Return <code>match</code>.</p>"
        }
      ]
    },
    {
      "name": "is not a valid filter",
      "href": "https://wicg.github.io/webusb/#is-not-a-valid-filter",
      "html": "A <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbdevicefilter\" id=\"ref-for-dictdef-usbdevicefilter②\">USBDeviceFilter</a></code> <var>filter</var> <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"is not a valid filter\" data-noexport=\"\" id=\"is-not-a-valid-filter\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">is valid</dfn> if the following steps\nreturn <code>valid</code>:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-productid\" id=\"ref-for-dom-usbdevicefilter-productid②\">productId</a></code></code> is present and <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-vendorid\" id=\"ref-for-dom-usbdevicefilter-vendorid②\">vendorId</a></code></code> is not present,\n return <code>invalid</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-subclasscode\" id=\"ref-for-dom-usbdevicefilter-subclasscode④\">subclassCode</a></code></code> is present and <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-classcode\" id=\"ref-for-dom-usbdevicefilter-classcode⑤\">classCode</a></code></code> is not present,\n return <code>invalid</code>.</p>"
        },
        {
          "html": "<p>If <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-protocolcode\" id=\"ref-for-dom-usbdevicefilter-protocolcode④\">protocolCode</a></code></code> is present and <code><var>filter</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicefilter-subclasscode\" id=\"ref-for-dom-usbdevicefilter-subclasscode⑤\">subclassCode</a></code></code> is not present,\n return <code>invalid</code>.</p>"
        },
        {
          "html": "<p>Return <code>valid</code>.</p>"
        }
      ]
    },
    {
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usb-getdevices\" id=\"ref-for-dom-usb-getdevices②\">getDevices()</a></code> method, when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects\">Promise</a></code> and\nrun the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel\">in parallel</a>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>document</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global①\">relevant global object</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window\">associated Document</a>, or <code>null</code> if there is no associated <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document\">Document</a></code>.</p>"
        },
        {
          "html": "Let <var>storage</var> be:",
          "rationale": "/^otherwise(\\,| )/i",
          "steps": [
            {
              "html": "<p>The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage\">USBPermissionStorage</a></code> object in the script execution environment\nof the associated <a data-link-type=\"dfn\" href=\"https://w3c.github.io/ServiceWorker/#dfn-service-worker-client\" id=\"ref-for-dfn-service-worker-client\">service worker client</a>, if <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global②\">relevant\nglobal object</a> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://w3c.github.io/ServiceWorker/#serviceworkerglobalscope\" id=\"ref-for-serviceworkerglobalscope\">ServiceWorkerGlobalScope</a></code>.</p>"
            },
            {
              "html": "<p>Otherwise, the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage①\">USBPermissionStorage</a></code> object in the current script\nexecution environment.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#enumerate-all-devices-attached-to-the-system\" id=\"ref-for-enumerate-all-devices-attached-to-the-system\">Enumerate all devices attached to the system</a>. Let this result be <var>enumerationResult</var>.</p>"
        },
        {
          "html": "<p>Let <var>devices</var> be a new empty <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-array-objects\" id=\"ref-for-sec-array-objects\">Array</a></code>.</p>"
        },
        {
          "html": "For each <var>device</var> in <var>enumerationResult</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>device</var> is <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#blocklisted\" id=\"ref-for-blocklisted\">blocklisted</a> for <var>document</var>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue\">continue</a>.</p>"
            },
            {
              "html": "<p>If this is the first call to this method, <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-permissions-for-device\" id=\"ref-for-check-permissions-for-device\">check permissions for <var>device</var></a> with <var>storage</var>.</p>"
            },
            {
              "html": "<p>Search for an element <var>allowedDevice</var> in <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices\">allowedDevices</a></code></code> where <var>device</var> is in <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot\">[[devices]]</a></code>. If no such element\nexists, continue to the next <var>device</var>.</p>"
            },
            {
              "html": "<p>Add the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice②\">USBDevice</a></code> object representing <var>device</var> to <var>devices</var>.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve\">Resolve</a> <var>promise</var> with <var>devices</var>.</p>"
        }
      ]
    },
    {
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usb-requestdevice\" id=\"ref-for-dom-usb-requestdevice④\">requestDevice()</a></code> method, when invoked, MUST run the following steps:",
      "rationale": "abort these steps",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://w3c.github.io/permissions/#dfn-request-permission-to-use\" id=\"ref-for-dfn-request-permission-to-use\">Request permission to use</a> the following descriptor,</p>\n<pre class=\"highlight\"><c- p=\"\">{</c->\n  name<c- o=\"\">:</c-> <c- u=\"\">\"usb\"</c->\n  filters<c- o=\"\">:</c-> <var>options</var><c- p=\"\">.</c-><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicerequestoptions-filters\" id=\"ref-for-dom-usbdevicerequestoptions-filters\">filters</a>\n  exclusionFilters<c- o=\"\">:</c-> <var>options</var><c- p=\"\">.</c-><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevicerequestoptions-exclusionfilters\" id=\"ref-for-dom-usbdevicerequestoptions-exclusionfilters\">exclusionFilters</a>\n<c- p=\"\">}</c->\n</pre>\n     <p>Let <var>permissionResult</var> be the resulting <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①\">Promise</a></code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#upon-fulfillment\" id=\"ref-for-upon-fulfillment\">Upon fulfillment</a> of <var>permissionResult</var> with <var>result</var> run the\n following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionresult-devices\" id=\"ref-for-dom-usbpermissionresult-devices\">devices</a></code></code> is empty,\n  throw a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror\">NotFoundError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p>Return <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionresult-devices\" id=\"ref-for-dom-usbpermissionresult-devices①\">devices</a></code>[0]</code>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "request the \"usb\" permission",
      "href": "https://wicg.github.io/webusb/#request-the-usb-permission",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"request-the-usb-permission\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">request the \"usb\" permission</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①\">Document</a></code> <var>document</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage②\">USBPermissionStorage</a></code> <var>storage</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissiondescriptor\" id=\"ref-for-dictdef-usbpermissiondescriptor\">USBPermissionDescriptor</a></code> <var>options</var> and\na <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbpermissionresult\" id=\"ref-for-usbpermissionresult\">USBPermissionResult</a></code> <var>status</var>, the UA MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects②\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①\">in parallel</a>:",
      "rationale": "for",
      "steps": [
        {
          "html": "<p>For each <var>filter</var> in <code><var>options</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-filters\" id=\"ref-for-dom-usbpermissiondescriptor-filters\">filters</a></code></code> if <var>filter</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#is-not-a-valid-filter\" id=\"ref-for-is-not-a-valid-filter\">is not a valid filter</a> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror\" id=\"ref-for-sec-native-error-types-used-in-this-standard-typeerror\">TypeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>For each <var>exclusionFilter</var> in <code><var>options</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-exclusionfilters\" id=\"ref-for-dom-usbpermissiondescriptor-exclusionfilters\">exclusionFilters</a></code></code> if <var>exclusionFilter</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#is-not-a-valid-filter\" id=\"ref-for-is-not-a-valid-filter①\">is not a valid filter</a> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror\" id=\"ref-for-sec-native-error-types-used-in-this-standard-typeerror①\">TypeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Check that the algorithm was triggered while the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global③\">relevant global object</a> had a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#transient-activation\" id=\"ref-for-transient-activation①\">transient activation</a>. Otherwise, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②\">reject</a> <var>promise</var> with\n a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror\">SecurityError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Set <code><var>status</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://w3c.github.io/permissions/#dom-permissionstatus-state\" id=\"ref-for-dom-permissionstatus-state\">state</a></code></code> to <code>\"ask\"</code>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#enumerate-all-devices-attached-to-the-system\" id=\"ref-for-enumerate-all-devices-attached-to-the-system①\">Enumerate all devices attached to the system</a>. Let this result be <var>enumerationResult</var>.</p>"
        },
        {
          "html": "<p>Remove devices from <var>enumerationResult</var> if they are <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#blocklisted\" id=\"ref-for-blocklisted①\">blocklisted</a> for <var>document</var>.</p>"
        },
        {
          "html": "<p>Remove devices from <var>enumerationResult</var> if they do not <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#match-a-device-filter\" id=\"ref-for-match-a-device-filter\">match a device\n filter</a> in <code><var>options</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-filters\" id=\"ref-for-dom-usbpermissiondescriptor-filters①\">filters</a></code></code>.</p>"
        },
        {
          "html": "<p>Remove devices from <var>enumerationResult</var> if they <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#match-a-device-filter\" id=\"ref-for-match-a-device-filter①\">match a device filter</a> in <code><var>options</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-exclusionfilters\" id=\"ref-for-dom-usbpermissiondescriptor-exclusionfilters①\">exclusionFilters</a></code></code>.</p>"
        },
        {
          "html": "<p>Display a prompt to the user requesting they select a device from <var>enumerationResult</var>. The UA SHOULD show a human-readable name for each\n device.</p>"
        },
        {
          "html": "<p>Wait for the user to have selected a <var>device</var> or cancelled the\n prompt.</p>"
        },
        {
          "html": "<p>If the user cancels the prompt, set <code><var>status</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionresult-devices\" id=\"ref-for-dom-usbpermissionresult-devices②\">devices</a></code></code> to an empty <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-frozen-array\" id=\"ref-for-idl-frozen-array\">FrozenArray</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①\">resolve</a> <var>promise</var> with <code>undefined</code>,\n and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#add-device-to-storage\" id=\"ref-for-add-device-to-storage\">Add <var>device</var> to <var>storage</var></a>.</p>"
        },
        {
          "html": "<p>Let <var>deviceObj</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice③\">USBDevice</a></code> object representing <var>device</var>.</p>"
        },
        {
          "html": "<p>Set <code><var>status</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionresult-devices\" id=\"ref-for-dom-usbpermissionresult-devices③\">devices</a></code></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-frozen-array\" id=\"ref-for-idl-frozen-array①\">FrozenArray</a></code> containing <var>deviceObj</var> as its only element.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve②\">Resolve</a> <var>promise</var> with <code>undefined</code>.</p>"
        }
      ]
    },
    {
      "name": "add device to storage",
      "href": "https://wicg.github.io/webusb/#add-device-to-storage",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"add device to storage\" data-noexport=\"\" id=\"add-device-to-storage\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">add an allowed <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#usb-device\" id=\"ref-for-usb-device\">USB device</a></dfn> <var>device</var> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage③\">USBPermissionStorage</a></code> <var>storage</var>, the UA MUST run the following\nsteps:",
      "rationale": "abort these steps",
      "steps": [
        {
          "html": "<p>Search for an element <var>allowedDevice</var> in <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices①\">allowedDevices</a></code></code> where <var>device</var> is in <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot①\">[[devices]]</a></code>. If one is found, abort\n these steps.</p>"
        },
        {
          "html": "<p>Let <var>vendorId</var> and <var>productId</var> be <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#vendor-id\" id=\"ref-for-vendor-id\">vendor ID</a> and <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#product-id\" id=\"ref-for-product-id\">product ID</a>.</p>"
        },
        {
          "html": "<p>Let <var>serialNumber</var> be <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#serial-number\" id=\"ref-for-serial-number\">serial number</a> if it has one,\n otherwise <code>undefined</code>.</p>"
        },
        {
          "html": "<p>Append <code>{ vendorId: <var>vendorId</var>, productId: <var>productId</var>, serialNumber: <var>serialNumber</var> }</code>,\n with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot②\">[[devices]]</a></code> internal slot containing a single entry <var>device</var> to <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices②\">allowedDevices</a></code></code>.</p>"
        }
      ]
    },
    {
      "name": "check permissions for device",
      "href": "https://wicg.github.io/webusb/#check-permissions-for-device",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"check permissions for device\" data-noexport=\"\" id=\"check-permissions-for-device\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">check permissions for a new <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#usb-device\" id=\"ref-for-usb-device①\">USB device</a></dfn> <var>device</var>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage④\">USBPermissionStorage</a></code> <var>storage</var>,\nthe UA MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>vendorId</var> and <var>productId</var> be <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#vendor-id\" id=\"ref-for-vendor-id①\">vendor ID</a> and <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#product-id\" id=\"ref-for-product-id①\">product ID</a>.</p>"
        },
        {
          "html": "<p>Let <var>serialNumber</var> be <var>device</var>’s if it has one, otherwise <code>undefined</code>.</p>"
        },
        {
          "html": "<p>Search for an element <var>allowedDevice</var> in <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices③\">allowedDevices</a></code></code> where:</p>\n     <ul>\n      <li data-md=\"\">\n       <p><code><var>allowedDevice</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-vendorid\" id=\"ref-for-dom-allowedusbdevice-vendorid\">vendorId</a></code></code> equals <var>vendorId</var>.</p>\n      </li><li data-md=\"\">\n       <p><code><var>allowedDevice</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-productid\" id=\"ref-for-dom-allowedusbdevice-productid\">productId</a></code></code> equals <var>productId</var>.</p>\n      </li><li data-md=\"\">\n       <p><code><var>allowedDevice</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-serialnumber\" id=\"ref-for-dom-allowedusbdevice-serialnumber\">serialNumber</a></code></code> equals <var>serialNumber</var>.</p>\n     </li></ul>"
        },
        {
          "html": "<p>If no such element exists, return <code>null</code>.</p>"
        },
        {
          "html": "<p>Add <var>device</var> to <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot③\">[[devices]]</a></code>.</p>"
        },
        {
          "html": "<p>Return <var>allowedDevice</var>.</p>"
        }
      ]
    },
    {
      "name": "remove device from storage",
      "href": "https://wicg.github.io/webusb/#remove-device-from-storage",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-lt=\"remove device from storage\" data-noexport=\"\" id=\"remove-device-from-storage\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">remove an allowed <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#usb-device\" id=\"ref-for-usb-device②\">USB\ndevice</a></dfn> <var>device</var>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage⑤\">USBPermissionStorage</a></code> <var>storage</var>,\nthe UA MUST run the following steps:",
      "rationale": "abort these steps",
      "steps": [
        {
          "html": "<p>Search for an element <var>allowedDevice</var> in <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices④\">allowedDevices</a></code></code> where <var>device</var> is in <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot④\">[[devices]]</a></code>, if no such element exists,\n abort these steps.</p>"
        },
        {
          "html": "<p>Remove <var>allowedDevice</var> from <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices⑤\">allowedDevices</a></code></code>.</p>"
        }
      ]
    },
    {
      "html": "When the UA detects a new <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#usb-device\" id=\"ref-for-usb-device③\">USB device</a> <var>device</var> connected to the host it\nMUST perform the following steps for each script execution environment:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>storage</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage⑥\">USBPermissionStorage</a></code> object in the current\n script execution environment.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-permissions-for-device\" id=\"ref-for-check-permissions-for-device①\">Check permissions for <var>device</var></a> with <var>storage</var> and let <var>allowedDevice</var> be the result.</p>"
        },
        {
          "html": "<p>If <var>allowedDevice</var> is <code>null</code>, abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>deviceObj</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice⑥\">USBDevice</a></code> object representing <var>device</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\" id=\"ref-for-concept-event-fire\">Fire an event</a> named <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"connect\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">connect</dfn> on <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global④\">relevant global\n object</a>'s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/system-state.html#navigator\" id=\"ref-for-navigator①\">Navigator</a></code> object’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-navigator-usb\" id=\"ref-for-dom-navigator-usb\">usb</a></code>, using <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbconnectionevent\" id=\"ref-for-usbconnectionevent\">USBConnectionEvent</a></code>, with the <code>device</code> attribute set to <var>deviceObj</var>.</p>"
        }
      ]
    },
    {
      "html": "When the UA detects a <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#usb-device\" id=\"ref-for-usb-device④\">USB device</a> <var>device</var> has been disconnected from the\nhost it MUST perform the following steps for each script execution environment:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>storage</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage⑦\">USBPermissionStorage</a></code> object in the current\n script execution environment.</p>"
        },
        {
          "html": "<p>Search for an element <var>allowedDevice</var> in <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices⑥\">allowedDevices</a></code></code> where <var>device</var> is in <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot⑤\">[[devices]]</a></code>, if no such element exists,\n abort these steps.</p>"
        },
        {
          "html": "<p>Remove <var>device</var> from <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot⑥\">[[devices]]</a></code>.</p>"
        },
        {
          "html": "<p>If <code><var>allowedDevice</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-serialnumber\" id=\"ref-for-dom-allowedusbdevice-serialnumber①\">serialNumber</a></code></code> is <code>undefined</code> and <var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot⑦\">[[devices]]</a></code> is empty remove <var>allowedDevice</var> from <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices⑦\">allowedDevices</a></code></code>.</p>"
        },
        {
          "html": "<p>Let <var>device</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice⑦\">USBDevice</a></code> object representing <var>device</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\" id=\"ref-for-concept-event-fire①\">Fire an event</a> named <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"disconnect\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">disconnect</dfn> on <var>device</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global⑤\">relevant\n global object</a>'s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/system-state.html#navigator\" id=\"ref-for-navigator②\">Navigator</a></code> object’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-navigator-usb\" id=\"ref-for-dom-navigator-usb①\">usb</a></code>, using <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbconnectionevent\" id=\"ref-for-usbconnectionevent①\">USBConnectionEvent</a></code>, with the <code>device</code> attribute set to <var>device</var>.</p>"
        }
      ]
    },
    {
      "name": "find the device descriptor for the connected USB device",
      "href": "https://wicg.github.io/webusb/#find-the-device-descriptor-for-the-connected-usb-device",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-device-descriptor-for-the-connected-usb-device\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the device descriptor for the connected USB device</dfn>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>deviceDescriptor</var> be the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#device-descriptor\" id=\"ref-for-device-descriptor②\">device descriptor</a> of the connected\ndevice by performing <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#get-descriptor\" id=\"ref-for-get-descriptor\">Get Descriptor</a> with <code>DescriptorType</code> set to <code>DEVICE</code>.</p>"
        },
        {
          "html": "<p>Return <var>deviceDescriptor</var>.</p>"
        }
      ]
    },
    {
      "name": "find a list of configuration descriptors for the connected USB device",
      "href": "https://wicg.github.io/webusb/#find-a-list-of-configuration-descriptors-for-the-connected-usb-device",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-a-list-of-configuration-descriptors-for-the-connected-usb-device\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find a list of configuration descriptors for the connected USB device</dfn>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>deviceDescriptor</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-device-descriptor-for-the-connected-usb-device\" id=\"ref-for-find-the-device-descriptor-for-the-connected-usb-device\">finding the device descriptor for the connected USB device</a>.</p>"
        },
        {
          "html": "<p>Let <var>numConfigurations</var> be <code>bNumConfigurations</code> of <var>deviceDescriptor</var>.</p>"
        },
        {
          "html": "<p>Let <var>configurationIndex</var> be 0.</p>"
        },
        {
          "html": "<p>Let <var>configurationDescriptors</var> be an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-empty\" id=\"ref-for-list-empty②\">empty</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list\">list</a>.</p>"
        },
        {
          "html": "While <var>configurationIndex</var> is less than <var>numConfigurations</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>descriptors</var> be the a list of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#descriptors\" id=\"ref-for-descriptors\">descriptors</a> by performing <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#get-descriptor\" id=\"ref-for-get-descriptor①\">Get Descriptor</a> with <code>DescriptorType</code> set to <code>CONFIGURATION</code> and <code>DescriptorIndex</code> set to <var>configurationIndex</var>.</p>"
            },
            {
              "html": "<p>If the <code>bDescriptorType</code> of the <var>descriptors</var>[0] is equal to <code>CONFIGURATION</code>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append\">append</a> <var>descriptors</var>[0] to <var>configurationDescriptors</var>.</p>"
            },
            {
              "html": "<p>Increment <var>configurationIndex</var> by 1.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>configurationDescriptors</var>.</p>"
        }
      ]
    },
    {
      "name": "abort transfers currently scheduled on an interface",
      "href": "https://wicg.github.io/webusb/#abort-transfers-currently-scheduled-on-an-interface",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"abort-transfers-currently-scheduled-on-an-interface\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">abort transfers currently scheduled on an interface</dfn> with the given <var>interface</var> object,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>configuration</var> be <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-configuration-slot\" id=\"ref-for-dom-usbinterface-configuration-slot\">[[configuration]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>device</var> be <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-device-slot\" id=\"ref-for-dom-usbconfiguration-device-slot\">[[device]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>configuration</var> is not the same as the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration\">finding the current configuration</a> with <var>device</var>, return.</p>"
        },
        {
          "html": "<p>If the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-if-the-interface-is-claimed\" id=\"ref-for-find-if-the-interface-is-claimed\">finding if the interface is claimed</a> with <var>interface</var> is not <code>true</code>, return.</p>"
        },
        {
          "html": "<p>Let <var>currAlternateInterface</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-alternate-interface-for-the-current-alternate-setting\" id=\"ref-for-find-the-alternate-interface-for-the-current-alternate-setting\">finding the alternate interface for the current alternate setting</a> with <var>interface</var>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate\">For each</a> <var>endpoint</var> of <var>currAlternateInterface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-endpoints-slot\" id=\"ref-for-dom-usbalternateinterface-endpoints-slot\">[[endpoints]]</a></code>:",
          "rationale": "abort",
          "steps": [
            {
              "html": "<p>Abort all transfers currently scheduled on <var>endpoint</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③\">reject</a> the associated promises with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror\">AbortError</a></code>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "find the interface index",
      "href": "https://wicg.github.io/webusb/#find-the-interface-index",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-interface-index\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the interface index</dfn> with the given <var>interfaceNumber</var> and <var>configuration</var> object,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>interfaceIndex</var> be 0.</p>"
        },
        {
          "html": "While <var>interfaceIndex</var> is less than the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size\">size</a> of <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot\">[[interfaces]]</a></code>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot①\">[[interfaces]]</a></code>[<var>interfaceIndex</var>].<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber-slot\" id=\"ref-for-dom-usbinterface-interfacenumber-slot\">[[interfaceNumber]]</a></code> is equal to <var>interfaceNumber</var>, return <var>interfaceIndex</var>.</p>"
            },
            {
              "html": "<p>Increment <var>interfaceIndex</var> by 1.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <code>-1</code>.</p>"
        }
      ]
    },
    {
      "name": "find the alternate index",
      "href": "https://wicg.github.io/webusb/#find-the-alternate-index",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-alternate-index\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the alternate index</dfn> with the given <var>alternateSetting</var> and <var>interface</var> object,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>alternateIndex</var> be 0.</p>"
        },
        {
          "html": "While <var>alternateIndex</var> is less than the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size①\">size</a> of <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternates-slot\" id=\"ref-for-dom-usbinterface-alternates-slot\">[[alternates]]</a></code>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternates-slot\" id=\"ref-for-dom-usbinterface-alternates-slot①\">[[alternates]]</a></code>[<var>alternateIndex</var>].<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-alternatesetting-slot\" id=\"ref-for-dom-usbalternateinterface-alternatesetting-slot\">[[alternateSetting]]</a></code> is equal to <var>alternateSetting</var>, return <var>alternateIndex</var>.</p>"
            },
            {
              "html": "<p>Increment <var>alternateIndex</var> by 1.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <code>-1</code>.</p>"
        }
      ]
    },
    {
      "name": "find the current configuration",
      "href": "https://wicg.github.io/webusb/#find-the-current-configuration",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-current-configuration\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the current configuration</dfn> with the given <var>device</var> object,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①\">For each</a> <var>configuration</var> of <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurations-slot\" id=\"ref-for-dom-usbdevice-configurations-slot\">[[configurations]]</a></code>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-configurationvalue-slot\" id=\"ref-for-dom-usbconfiguration-configurationvalue-slot\">[[configurationValue]]</a></code> is equal to <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurationvalue-slot\" id=\"ref-for-dom-usbdevice-configurationvalue-slot\">[[configurationValue]]</a></code>, return <var>configuration</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <code>null</code>.</p>"
        }
      ]
    },
    {
      "name": "find the endpoint",
      "href": "https://wicg.github.io/webusb/#find-the-endpoint",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-endpoint\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the endpoint</dfn> with the given <var>endpointAddress</var> and <var>device</var> object,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>configuration</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration①\">finding the current configuration</a> with <var>device</var>.</p>"
        },
        {
          "html": "<p>If <var>configuration</var> is <code>null</code>, return <code>null</code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②\">For each</a> <var>interface</var> of <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot②\">[[interfaces]]</a></code>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-if-the-interface-is-claimed\" id=\"ref-for-find-if-the-interface-is-claimed①\">finding if the interface is claimed</a> with <var>interface</var> is not <code>true</code>, continue.</p>"
            },
            {
              "html": "<p>Let <var>alternate</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-alternate-interface-for-the-current-alternate-setting\" id=\"ref-for-find-the-alternate-interface-for-the-current-alternate-setting①\">finding the alternate interface for the current alternate setting</a> with <var>interface</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③\">For each</a> <var>endpoint</var> of <var>alternate</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-endpoints-slot\" id=\"ref-for-dom-usbalternateinterface-endpoints-slot①\">[[endpoints]]</a></code>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-endpointaddress-slot\" id=\"ref-for-dom-usbendpoint-endpointaddress-slot\">[[endpointAddress]]</a></code> is equal to <var>endpointAddress</var>, return <var>endpoint</var></p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <code>null</code>.</p>"
        }
      ]
    },
    {
      "name": "check if the device is configured",
      "href": "https://wicg.github.io/webusb/#check-if-the-device-is-configured",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"check-if-the-device-is-configured\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">check if the device is configured</dfn> with the given <var>device</var> and <var>promise</var>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If the <var>device</var> is no longer connected to the system, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject④\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <code><var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-opened\" id=\"ref-for-dom-usbdevice-opened①\">opened</a></code></code> is not <code>true</code>, or <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurationvalue-slot\" id=\"ref-for-dom-usbdevice-configurationvalue-slot①\">[[configurationValue]]</a></code> is equal to <code>0</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑤\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror\">InvalidStateError</a></code>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice constructor",
      "html": "When a USB device is connected and detected, a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice⑨\">USBDevice</a></code> object\n    representing a connected USB device is constructed by performing the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurationvalue-slot\" id=\"ref-for-dom-usbdevice-configurationvalue-slot②\">[[configurationValue]]</a></code> to the returned value of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#get-configuration\" id=\"ref-for-get-configuration\">Get Configuration</a>.</p>"
        },
        {
          "html": "<p>Let <var>configurationDescriptors</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-a-list-of-configuration-descriptors-for-the-connected-usb-device\" id=\"ref-for-find-a-list-of-configuration-descriptors-for-the-connected-usb-device\">finding a list of configuration descriptors for the connected USB device</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate④\">For each</a> <var>configurationDescriptor</var> of <var>configurationDescriptors</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>configuration</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbconfiguration\" id=\"ref-for-usbconfiguration③\">USBConfiguration</a></code> object\nusing <a data-link-type=\"functionish\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-usbconfiguration\" id=\"ref-for-dom-usbconfiguration-usbconfiguration\">USBConfiguration(<var>device</var>,<var>configurationValue</var>)</a> with <var>device</var> set to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③\">this</a> and <var>configurationValue</var> set to <code>bConfigurationValue</code> of <var>configurationDescriptor</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append①\">Append</a> <var>configuration</var> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurations-slot\" id=\"ref-for-dom-usbdevice-configurations-slot①\">[[configurations]]</a></code>.</p>"
            },
            {
              "html": "If <code>bConfigurationValue</code> of <var>configurationDescriptor</var> is equal to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurationvalue-slot\" id=\"ref-for-dom-usbdevice-configurationvalue-slot③\">[[configurationValue]]</a></code>:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>numInterfaces</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size②\">size</a> of <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot③\">[[interfaces]]</a></code>.</p>"
                },
                {
                  "html": "<p>Resize <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot\">[[selectedAlternateSetting]]</a></code> to <var>numInterfaces</var>.</p>"
                },
                {
                  "html": "<p>Fill <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot①\">[[selectedAlternateSetting]]</a></code> with 0.</p>"
                },
                {
                  "html": "<p>Resize <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot\">[[claimedInterface]]</a></code> to <var>numInterfaces</var>.</p>"
                },
                {
                  "html": "<p>Fill <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑨\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot①\">[[claimedInterface]]</a></code> with <code>false</code>.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "USBDevice/configuration",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-configuration",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configuration\" id=\"ref-for-dom-usbdevice-configuration③\">configuration</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration②\">finding the current configuration</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⓪\">this</a>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice/configurations",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-configurations",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurations\" id=\"ref-for-dom-usbdevice-configurations③\">configurations</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurations-slot\" id=\"ref-for-dom-usbdevice-configurations-slot②\">[[configurations]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.open()",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-open",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-open\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>open()</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects③\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel②\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①②\">this</a> is no longer connected to the system, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑥\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror②\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <code><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①③\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-opened\" id=\"ref-for-dom-usbdevice-opened③\">opened</a></code></code> is <code>true</code> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve③\">resolve</a> <var>promise</var> and abort these steps.</p>"
        },
        {
          "html": "<p>Perform the necessary platform-specific steps to begin a session with the\ndevice. If these fail for any reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑦\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror\">NetworkError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Set <code><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①④\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-opened\" id=\"ref-for-dom-usbdevice-opened④\">opened</a></code></code> to <code>true</code> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve④\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.close()",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-close",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-close\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>close()</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects④\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel③\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑤\">this</a> is no longer connected to the system, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑧\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror③\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <code><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-opened\" id=\"ref-for-dom-usbdevice-opened⑤\">opened</a></code></code> is <code>false</code> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑤\">resolve</a> <var>promise</var> and abort these steps.</p>"
        },
        {
          "html": "<p>Abort all other algorithms currently running against this device and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject⑨\">reject</a> their associated promises with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror①\">AbortError</a></code>.</p>"
        },
        {
          "html": "<p>Perform the necessary platform-specific steps to release any claimed\ninterfaces as if <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-releaseinterface\" id=\"ref-for-dom-usbdevice-releaseinterface①\">releaseInterface(interfaceNumber)</a></code> had been\ncalled for each claimed interface.</p>"
        },
        {
          "html": "<p>Perform the necessary platform-specific steps to end the session with the\ndevice.</p>"
        },
        {
          "html": "<p>Set <code><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑦\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-opened\" id=\"ref-for-dom-usbdevice-opened⑥\">opened</a></code></code> to <code>false</code> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑥\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.forget()",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-forget",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-forget\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>forget()</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑤\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel④\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>device</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑧\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>storage</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage⑧\">USBPermissionStorage</a></code> object in the current\nscript execution environment.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#remove-device-from-storage\" id=\"ref-for-remove-device-from-storage\">Remove <var>device</var> from storage</a> with <var>storage</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑦\">Resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.selectConfiguration(configurationValue)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-selectconfiguration",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-selectconfiguration\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>selectConfiguration(<var>configurationValue</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑥\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑤\">in\n    parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑨\">this</a> is no longer connected to the system, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①⓪\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror④\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>selectedConfiguration</var> be <code>null</code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑤\">For each</a> <var>configuration</var> of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②⓪\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurations-slot\" id=\"ref-for-dom-usbdevice-configurations-slot③\">[[configurations]]</a></code>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-configurationvalue-slot\" id=\"ref-for-dom-usbconfiguration-configurationvalue-slot①\">[[configurationValue]]</a></code> is equal to <var>configurationValue</var>, set <var>selectedConfiguration</var> to <var>configuration</var> and break.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>selectedConfiguration</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①①\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror⑤\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <code><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-opened\" id=\"ref-for-dom-usbdevice-opened⑦\">opened</a></code></code> is not equal to <code>true</code> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①②\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①\">InvalidStateError</a></code> and\nabort these steps.</p>"
        },
        {
          "html": "<p>Let <var>activeConfiguration</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration③\">finding the current configuration</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②②\">this</a>.</p>"
        },
        {
          "html": "If <var>activeConfiguration</var> is not <code>null</code>.",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑥\">For each</a> <var>interface</var> of <var>activeConfiguration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot④\">[[interfaces]]</a></code>:",
              "rationale": "abort",
              "steps": [
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#abort-transfers-currently-scheduled-on-an-interface\" id=\"ref-for-abort-transfers-currently-scheduled-on-an-interface\">Abort transfers currently scheduled on an interface</a> with <var>interface</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Issue a <code>SET_CONFIGURATION</code> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#control-transfer\" id=\"ref-for-control-transfer③\">control transfer</a> with <code>configurationValue</code> set to the <var>configurationValue</var>.\nIf this step fails <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①③\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror①\">NetworkError</a></code> and\nabort these steps.</p>"
        },
        {
          "html": "<p>Let <var>numInterfaces</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size③\">size</a> of <var>selectedConfiguration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot⑤\">[[interfaces]]</a></code>.</p>"
        },
        {
          "html": "<p>Resize <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②③\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot②\">[[selectedAlternateSetting]]</a></code> to <var>numInterfaces</var>.</p>"
        },
        {
          "html": "<p>Fill <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②④\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot③\">[[selectedAlternateSetting]]</a></code> with 0.</p>"
        },
        {
          "html": "<p>Resize <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②⑤\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot②\">[[claimedInterface]]</a></code> to <var>numInterfaces</var>.</p>"
        },
        {
          "html": "<p>Fill <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot③\">[[claimedInterface]]</a></code> with <code>false</code>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②⑦\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-configurationvalue-slot\" id=\"ref-for-dom-usbdevice-configurationvalue-slot④\">[[configurationValue]]</a></code> to <var>configurationValue</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑧\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.claimInterface(interfaceNumber)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-claiminterface",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-claiminterface\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>claimInterface(<var>interfaceNumber</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑦\">Promise</a></code> <var>promise</var> and run the following \n    steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑥\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②⑧\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>activeConfiguration</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration④\">finding the current configuration</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②⑨\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>interfaces</var> be <var>activeConfiguration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot⑥\">[[interfaces]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>interfaceIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-interface-index\" id=\"ref-for-find-the-interface-index\">finding the interface index</a> with <var>interfaceNumber</var> and <var>activeConfiguration</var>.</p>"
        },
        {
          "html": "<p>If <var>interfaceIndex</var> is equal to <code>-1</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①④\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror⑥\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⓪\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot④\">[[claimedInterface]]</a></code>[<var>interfaceIndex</var>] is <code>true</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve⑨\">resolve</a> <var>promise</var> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>unrestricted</var> be <code>false</code>.</p>"
        },
        {
          "html": "<p>Let <var>document</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③①\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global⑥\">relevant global object</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window①\">associated Document</a>, or <code>null</code> if there is no associated <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document②\">Document</a></code>.</p>"
        },
        {
          "html": "<p>If <var>document</var> is not <code>null</code> and <var>document</var> is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use\" id=\"ref-for-allowed-to-use\">allowed to use</a> the <a data-link-type=\"dfn\" href=\"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature\" id=\"ref-for-policy-controlled-feature\">policy-controlled feature</a> named <code>\"usb-unrestricted\"</code>, set <var>unrestricted</var> to <code>true</code>.</p>"
        },
        {
          "html": "<p>If <var>interfaces</var>[<var>interfaceIndex</var>].<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-isprotectedclass-slot\" id=\"ref-for-dom-usbinterface-isprotectedclass-slot\">[[isProtectedClass]]</a></code> is <code>true</code> and <var>unrestricted</var> is <code>false</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①⑤\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#securityerror\" id=\"ref-for-securityerror①\">SecurityError</a></code> and\nabort these steps.</p>"
        },
        {
          "html": "<p>Perform the necessary platform-specific steps to request exclusive control\nover <var>interfaces</var>[<var>interfaceIndex</var>] for the current execution context. If this fails, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①⑥\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror②\">NetworkError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot⑤\">[[claimedInterface]]</a></code>[<var>interfaceIndex</var>] to <code>true</code> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⓪\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.releaseInterface(interfaceNumber)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-releaseinterface",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-releaseinterface\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>releaseInterface(<var>interfaceNumber</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑧\">Promise</a></code> <var>promise</var> and run the following\n    steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑦\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured①\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③③\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>activeConfiguration</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration⑤\">finding the current configuration</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③④\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>interfaces</var> be <var>activeConfiguration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot⑦\">[[interfaces]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>interfaceIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-interface-index\" id=\"ref-for-find-the-interface-index①\">finding the interface index</a> with <var>interfaceNumber</var> and <var>activeConfiguration</var>.</p>"
        },
        {
          "html": "<p>If <var>interfaceIndex</var> is equal to <code>-1</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①⑦\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror⑦\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑤\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot⑥\">[[claimedInterface]]</a></code>[<var>interfaceIndex</var>] is <code>false</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①①\">resolve</a> <var>promise</var> and abort these steps.</p>"
        },
        {
          "html": "<p>Perform the necessary platform-specific steps to reliquish exclusive\ncontrol over <var>interfaces</var>[<var>interfaceIndex</var>].</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot④\">[[selectedAlternateSetting]]</a></code>[<var>interfaceIndex</var>] to <code>0</code>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑦\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot⑦\">[[claimedInterface]]</a></code>[<var>interfaceIndex</var>] to <code>false</code> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①②\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.selectAlternateInterface(interfaceNumber, alternateSetting)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-selectalternateinterface",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-selectalternateinterface\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>selectAlternateInterface(<var>interfaceNumber</var>, <var>alternateSetting</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑨\">Promise</a></code> <var>promise</var> and run the\n    following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑧\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured②\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑧\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>activeConfiguration</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration⑥\">finding the current configuration</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑨\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>interfaces</var> be <var>activeConfiguration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot⑧\">[[interfaces]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>interfaceIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-interface-index\" id=\"ref-for-find-the-interface-index②\">finding the interface index</a> with <var>interfaceNumber</var> and <var>activeConfiguration</var>.</p>"
        },
        {
          "html": "<p>If <var>interfaceIndex</var> is equal to <code>-1</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①⑧\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror⑧\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⓪\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot⑧\">[[claimedInterface]]</a></code>[<var>interfaceIndex</var> is not <code>true</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject①⑨\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror②\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>interface</var> be <var>interfaces</var>[<var>interfaceIndex</var>].</p>"
        },
        {
          "html": "<p>Let <var>alternateIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-alternate-index\" id=\"ref-for-find-the-alternate-index\">finding the alternate index</a> with <var>alternateSetting</var> and <var>interface</var>.</p>"
        },
        {
          "html": "<p>If <var>alternateIndex</var> is equal to <code>-1</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②⓪\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror⑨\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#abort-transfers-currently-scheduled-on-an-interface\" id=\"ref-for-abort-transfers-currently-scheduled-on-an-interface①\">Abort transfers currently scheduled on an interface</a> with <var>interface</var>.</p>"
        },
        {
          "html": "<p>Issue a <code>SET_INTERFACE</code> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#control-transfer\" id=\"ref-for-control-transfer④\">control transfer</a> with <code>interfaceNumber</code> set to the <var>interfaceNumber</var> and <code>alternateSetting</code> set to the <var>alternateSetting</var>.\nIf this step fails <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②①\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror③\">NetworkError</a></code> and\nabort these steps.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot⑤\">[[selectedAlternateSetting]]</a></code>[<var>interfaceIndex</var>]\nto <var>alternateSetting</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①③\">Resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.controlTransferIn(setup, length)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-controltransferin",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-controltransferin\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>controlTransferIn(<var>setup</var>, <var>length</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⓪\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑨\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured③\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④②\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-the-validity-of-the-control-transfer-parameters\" id=\"ref-for-check-the-validity-of-the-control-transfer-parameters\">Check the validity of the control transfer parameters</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④③\">this</a> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>If <var>length</var> is greater than 0, let <var>buffer</var> be a host buffer with space\nfor <var>length</var> bytes.</p>"
        },
        {
          "html": "<p>Issue a <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#control-transfer\" id=\"ref-for-control-transfer⑤\">control transfer</a> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④④\">this</a> with the setup packet parameters\nprovided in <var>setup</var>, the data transfer direction in <code>bmRequestType</code> set to \"device to host\" and <code>wLength</code> set to <var>length</var>. If defined also provide <var>buffer</var> as the destination to\nwrite data received in response to this transfer.</p>"
        },
        {
          "html": "<p>Let <var>bytesTransferred</var> be the number of bytes written to <var>buffer</var>.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbintransferresult\" id=\"ref-for-usbintransferresult②\">USBInTransferResult</a></code>.</p>"
        },
        {
          "html": "<p>If data was received from the device create a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer\">ArrayBuffer</a></code> containing\nthe first <var>bytesTransferred</var> bytes of <var>buffer</var> and set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-data\" id=\"ref-for-dom-usbintransferresult-data①\">data</a></code></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DataView\" id=\"ref-for-idl-DataView⑥\">DataView</a></code> constructed over it.</p>"
        },
        {
          "html": "<p>If the device responded by stalling the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#default-endpoint\" id=\"ref-for-default-endpoint①\">default control pipe</a> set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-status\" id=\"ref-for-dom-usbintransferresult-status①\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-stall\" id=\"ref-for-dom-usbtransferstatus-stall\">\"stall\"</a></code>.</p>"
        },
        {
          "html": "<p>If the device responded with more than <var>length</var> bytes of data set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-status\" id=\"ref-for-dom-usbintransferresult-status②\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-babble\" id=\"ref-for-dom-usbtransferstatus-babble\">\"babble\"</a></code> and\notherwise set it to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-ok\" id=\"ref-for-dom-usbtransferstatus-ok\">\"ok\"</a></code>.</p>"
        },
        {
          "html": "<p>If the transfer fails for any other reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②②\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror④\">NetworkError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①④\">Resolve</a> <var>promise</var> with <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.controlTransferOut(setup, data)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-controltransferout",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"controlTransferOut(setup, data)|controlTransferOut(setup)\" id=\"dom-usbdevice-controltransferout\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>controlTransferOut(<var>setup</var>, <var>data</var>)</code></dfn> method,\n    when invoked, must return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①①\">Promise</a></code> <var>promise</var> and run the following\n    steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⓪\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured④\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⑤\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-the-validity-of-the-control-transfer-parameters\" id=\"ref-for-check-the-validity-of-the-control-transfer-parameters①\">Check the validity of the control transfer parameters</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⑥\">this</a> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Issue a <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#control-transfer\" id=\"ref-for-control-transfer⑥\">control transfer</a> with the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#setup-packet\" id=\"ref-for-setup-packet\">setup packet</a> populated by <var>setup</var> and the data transfer direction in <code>bmRequestType</code> set\nto \"host to device\" and <code>wLength</code> set to <code><var>data</var>.length</code>. Transmit <var>data</var> in the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#data-stage\" id=\"ref-for-data-stage\">data stage</a> of\nthe transfer.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbouttransferresult\" id=\"ref-for-usbouttransferresult②\">USBOutTransferResult</a></code>.</p>"
        },
        {
          "html": "<p>If the device responds by stalling the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#default-endpoint\" id=\"ref-for-default-endpoint②\">default control pipe</a> set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbouttransferresult-status\" id=\"ref-for-dom-usbouttransferresult-status\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-stall\" id=\"ref-for-dom-usbtransferstatus-stall①\">\"stall\"</a></code>.</p>"
        },
        {
          "html": "<p>If the device acknowledges the transfer set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbouttransferresult-status\" id=\"ref-for-dom-usbouttransferresult-status①\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-ok\" id=\"ref-for-dom-usbtransferstatus-ok①\">\"ok\"</a></code> and <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbouttransferresult-byteswritten\" id=\"ref-for-dom-usbouttransferresult-byteswritten\">bytesWritten</a></code></code> to <code><var>data</var>.length</code>.</p>"
        },
        {
          "html": "<p>If the transfer fails for any other reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②③\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror⑤\">NetworkError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⑤\">Resolve</a> <var>promise</var> with <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.clearHalt(direction, endpointNumber)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-clearhalt",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-clearhalt\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>clearHalt(<var>direction</var>, <var>endpointNumber</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①②\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①①\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured⑤\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⑦\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>endpointAddress</var> be <code><var>endpointNumber</var> | 0x80</code> if <var>direction</var> is equal to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-in\" id=\"ref-for-dom-usbdirection-in\">\"in\"</a></code>, and <var>endpointNumber</var> otherwise.</p>"
        },
        {
          "html": "<p>Let <var>endpoint</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint\" id=\"ref-for-find-the-endpoint\">finding the endpoint</a> with <var>endpointAddress</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⑧\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②④\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①⓪\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Issue a <code>ClearFeature(ENDPOINT_HALT)</code> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#control-transfer\" id=\"ref-for-control-transfer⑦\">control transfer</a> to\nthe device to clear the halt condition on <var>endpoint</var>.</p>"
        },
        {
          "html": "<p>On failure <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②⑤\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror⑥\">NetworkError</a></code>, otherwise <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⑥\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.transferIn(endpointNumber, length)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-transferin",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-transferin\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>transferIn(<var>endpointNumber</var>, <var>length</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①③\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①②\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured⑥\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⑨\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>endpointAddress</var> be <code><var>endpointNumber</var> | 0x80</code> (i.e <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-in\" id=\"ref-for-dom-usbdirection-in①\">\"in\"</a></code> direction).</p>"
        },
        {
          "html": "<p>Let <var>endpoint</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint\" id=\"ref-for-find-the-endpoint①\">finding the endpoint</a> with <var>endpointAddress</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤⓪\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②⑥\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①①\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-type\" id=\"ref-for-dom-usbendpoint-type\">type</a></code> is not equal to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-bulk\" id=\"ref-for-dom-usbendpointtype-bulk\">\"bulk\"</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②⑦\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\" id=\"ref-for-invalidaccesserror\">InvalidAccessError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>buffer</var> be a host buffer with space for <var>length</var> bytes.</p>"
        },
        {
          "html": "<p>As appropriate for <var>endpoint</var> enqueue a <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#bulk-transfers\" id=\"ref-for-bulk-transfers\">bulk</a> or <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#interrupt-transfers\" id=\"ref-for-interrupt-transfers\">interrupt</a> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#in-transfers\" id=\"ref-for-in-transfers\">IN transfer</a> on <var>endpoint</var> to receive <var>length</var> bytes of data from the device into <var>buffer</var>.</p>"
        },
        {
          "html": "<p>Let <var>bytesTransferred</var> be the number of bytes written to <var>buffer</var>.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbintransferresult\" id=\"ref-for-usbintransferresult③\">USBInTransferResult</a></code>.</p>"
        },
        {
          "html": "<p>If data was received from the device create a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer①\">ArrayBuffer</a></code> containing\nthe first <var>bytesTransferred</var> bytes of <var>buffer</var> and set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-data\" id=\"ref-for-dom-usbintransferresult-data②\">data</a></code></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DataView\" id=\"ref-for-idl-DataView⑦\">DataView</a></code> constructed over it.</p>"
        },
        {
          "html": "<p>If the device responded with more than <var>length</var> bytes of data set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-status\" id=\"ref-for-dom-usbintransferresult-status③\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-babble\" id=\"ref-for-dom-usbtransferstatus-babble①\">\"babble\"</a></code>.</p>"
        },
        {
          "html": "<p>If the transfer ended because <var>endpoint</var> is halted set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-status\" id=\"ref-for-dom-usbintransferresult-status④\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-stall\" id=\"ref-for-dom-usbtransferstatus-stall②\">\"stall\"</a></code>.</p>"
        },
        {
          "html": "<p>If the device acknowledged the complete transfer set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbintransferresult-status\" id=\"ref-for-dom-usbintransferresult-status⑤\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-ok\" id=\"ref-for-dom-usbtransferstatus-ok②\">\"ok\"</a></code>.</p>"
        },
        {
          "html": "<p>If the transfer failed for any other reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②⑧\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror⑦\">NetworkError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⑦\">Resolve</a> <var>promise</var> with <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.transferOut(endpointNumber, data)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-transferout",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-transferout\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>transferOut(<var>endpointNumber</var>, <var>data</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①④\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①③\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured⑦\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤①\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>endpointAddress</var> be <var>endpointNumber</var> (i.e <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-out\" id=\"ref-for-dom-usbdirection-out\">\"out\"</a></code> direction).</p>"
        },
        {
          "html": "<p>Let <var>endpoint</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint\" id=\"ref-for-find-the-endpoint②\">finding the endpoint</a> with <var>endpointAddress</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤②\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject②⑨\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①②\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-type\" id=\"ref-for-dom-usbendpoint-type①\">type</a></code> is not equal to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-bulk\" id=\"ref-for-dom-usbendpointtype-bulk①\">\"bulk\"</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③⓪\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\" id=\"ref-for-invalidaccesserror①\">InvalidAccessError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>As appropriate for <var>endpoint</var> enqueue a <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#bulk-transfers\" id=\"ref-for-bulk-transfers①\">bulk</a> or <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#interrupt-transfers\" id=\"ref-for-interrupt-transfers①\">interrupt</a> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#out-transfers\" id=\"ref-for-out-transfers\">OUT transfer</a> on <var>endpoint</var> to transmit <var>data</var> to the device.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbouttransferresult\" id=\"ref-for-usbouttransferresult③\">USBOutTransferResult</a></code>.</p>"
        },
        {
          "html": "<p>Set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbouttransferresult-byteswritten\" id=\"ref-for-dom-usbouttransferresult-byteswritten①\">bytesWritten</a></code></code> to the\namount of data successfully sent to the device.</p>"
        },
        {
          "html": "<p>If the endpoint is stalled set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbouttransferresult-status\" id=\"ref-for-dom-usbouttransferresult-status②\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-stall\" id=\"ref-for-dom-usbtransferstatus-stall③\">\"stall\"</a></code>.</p>"
        },
        {
          "html": "<p>If the device acknowledges the complete transfer set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbouttransferresult-status\" id=\"ref-for-dom-usbouttransferresult-status③\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-ok\" id=\"ref-for-dom-usbtransferstatus-ok③\">\"ok\"</a></code>.</p>"
        },
        {
          "html": "<p>If the transfer fails for any other reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③①\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror⑧\">NetworkError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⑧\">Resolve</a> <var>promise</var> with <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.isochronousTransferIn(endpointNumber, packetLengths)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-isochronoustransferin",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-isochronoustransferin\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>isochronousTransferIn(<var>endpointNumber</var>, <var>packetLengths</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑤\">Promise</a></code> <var>promise</var> and run the following\n    steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①④\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured⑧\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤③\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>endpointAddress</var> be <code><var>endpointNumber</var> | 0x80</code> (i.e <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-in\" id=\"ref-for-dom-usbdirection-in②\">\"in\"</a></code> direction).</p>"
        },
        {
          "html": "<p>Let <var>endpoint</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint\" id=\"ref-for-find-the-endpoint③\">finding the endpoint</a> with <var>endpointAddress</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤④\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③②\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①③\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-type\" id=\"ref-for-dom-usbendpoint-type②\">type</a></code> is not equal to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-isochronous\" id=\"ref-for-dom-usbendpointtype-isochronous\">\"isochronous\"</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③③\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\" id=\"ref-for-invalidaccesserror②\">InvalidAccessError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>length</var> be the sum of the elements of <var>packetLengths</var>.</p>"
        },
        {
          "html": "<p>Let <var>buffer</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer②\">ArrayBuffer</a></code> of <var>length</var> bytes.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbisochronousintransferresult\" id=\"ref-for-usbisochronousintransferresult①\">USBIsochronousInTransferResult</a></code> and set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousintransferresult-data\" id=\"ref-for-dom-usbisochronousintransferresult-data\">data</a></code></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DataView\" id=\"ref-for-idl-DataView⑧\">DataView</a></code> constructed over <var>buffer</var>.</p>"
        },
        {
          "html": "<p>Enqueue an <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#isochronous-transfers\" id=\"ref-for-isochronous-transfers\">isochronous IN transfer</a> on <var>endpoint</var> that will write up to <var>length</var> bytes of data from the device\ninto <var>buffer</var>.</p>"
        },
        {
          "html": "For each packet <var>i</var> from <code>0</code> to <code><var>packetLengths</var>.length -\n1</code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>packet</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbisochronousintransferpacket\" id=\"ref-for-usbisochronousintransferpacket②\">USBIsochronousInTransferPacket</a></code> and set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousintransferresult-packets\" id=\"ref-for-dom-usbisochronousintransferresult-packets\">packets</a></code>[<var>i</var>]</code> to <var>packet</var>.</p>"
            },
            {
              "html": "<p>Let <var>view</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DataView\" id=\"ref-for-idl-DataView⑨\">DataView</a></code> over the portion of <var>buffer</var> containing the data received from the device for this packet and set <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousintransferpacket-data\" id=\"ref-for-dom-usbisochronousintransferpacket-data\">data</a></code></code> to <var>view</var>.</p>"
            },
            {
              "html": "<p>If the device responds with more than <code><var>packetLengths</var>[i]</code> bytes of data set <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousintransferpacket-status\" id=\"ref-for-dom-usbisochronousintransferpacket-status\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-babble\" id=\"ref-for-dom-usbtransferstatus-babble②\">\"babble\"</a></code>.</p>"
            },
            {
              "html": "<p>If the transfer ends because <var>endpoint</var> is stalled set <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousintransferpacket-status\" id=\"ref-for-dom-usbisochronousintransferpacket-status①\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-stall\" id=\"ref-for-dom-usbtransferstatus-stall④\">\"stall\"</a></code>.</p>"
            },
            {
              "html": "<p>If the device acknowledges the complete transfer set <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousintransferpacket-status\" id=\"ref-for-dom-usbisochronousintransferpacket-status②\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-ok\" id=\"ref-for-dom-usbtransferstatus-ok④\">\"ok\"</a></code>.</p>"
            },
            {
              "html": "<p>If the transfer fails for any other reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③④\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror⑨\">NetworkError</a></code> and abort these steps.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve①⑨\">Resolve</a> <var>promise</var> with <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.isochronousTransferOut(endpointNumber, data, packetLengths)",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-isochronoustransferout",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-isochronoustransferout\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>isochronousTransferOut(<var>endpointNumber</var>, <var>data</var>, <var>packetLengths</var>)</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑥\">Promise</a></code> <var>promise</var> and run the\n    following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑤\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured⑨\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤⑤\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Let <var>endpointAddress</var> be <var>endpointNumber</var> (i.e <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-out\" id=\"ref-for-dom-usbdirection-out①\">\"out\"</a></code> direction).</p>"
        },
        {
          "html": "<p>Let <var>endpoint</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint\" id=\"ref-for-find-the-endpoint④\">finding the endpoint</a> with <var>endpointAddress</var> and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤⑥\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③⑤\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①④\">NotFoundError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>If <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-type\" id=\"ref-for-dom-usbendpoint-type③\">type</a></code> is not equal to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-isochronous\" id=\"ref-for-dom-usbendpointtype-isochronous①\">\"isochronous\"</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③⑥\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidaccesserror\" id=\"ref-for-invalidaccesserror③\">InvalidAccessError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbisochronousouttransferresult\" id=\"ref-for-usbisochronousouttransferresult①\">USBIsochronousOutTransferResult</a></code>.</p>"
        },
        {
          "html": "<p>Enqueue an <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#isochronous-transfers\" id=\"ref-for-isochronous-transfers①\">isochronous OUT transfer</a> on <var>endpoint</var> that will write <var>data</var> to the device, divided into <code><var>packetLength</var>.length</code> packets of <code><var>packetLength</var>[i]</code> bytes (for packets <var>i</var> from <code>0</code> to <code><var>packetLengths</var>.length - 1</code>).</p>"
        },
        {
          "html": "For each packet <var>i</var> from <code>0</code> to <code><var>packetLengths</var>.length -\n1</code> the host attempts to send to the device:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>packet</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbisochronousouttransferpacket\" id=\"ref-for-usbisochronousouttransferpacket②\">USBIsochronousOutTransferPacket</a></code> and set <code><var>result</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousouttransferresult-packets\" id=\"ref-for-dom-usbisochronousouttransferresult-packets\">packets</a></code>[i]</code> to <var>packet</var>.</p>"
            },
            {
              "html": "<p>Let <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousouttransferpacket-byteswritten\" id=\"ref-for-dom-usbisochronousouttransferpacket-byteswritten\">bytesWritten</a></code></code> be the amount of data successfully sent to the device as part of this\npacket.</p>"
            },
            {
              "html": "<p>If the transfer ends because <var>endpoint</var> is stalled set <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousouttransferpacket-status\" id=\"ref-for-dom-usbisochronousouttransferpacket-status\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-stall\" id=\"ref-for-dom-usbtransferstatus-stall⑤\">\"stall\"</a></code>.</p>"
            },
            {
              "html": "<p>If the device acknowledges the complete transfer set <code><var>packet</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbisochronousouttransferpacket-status\" id=\"ref-for-dom-usbisochronousouttransferpacket-status①\">status</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbtransferstatus-ok\" id=\"ref-for-dom-usbtransferstatus-ok⑤\">\"ok\"</a></code>.</p>"
            },
            {
              "html": "<p>If the transfer fails for any other reason <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③⑦\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror①⓪\">NetworkError</a></code> and abort these steps.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve②⓪\">Resolve</a> <var>promise</var> with <var>result</var>.</p>"
        }
      ]
    },
    {
      "name": "USBDevice.reset()",
      "href": "https://wicg.github.io/webusb/#dom-usbdevice-reset",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBDevice\" data-dfn-type=\"method\" data-export=\"\" id=\"dom-usbdevice-reset\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>reset()</code></dfn> method,\n    when invoked, MUST return a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑦\">Promise</a></code> <var>promise</var> and run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑥\">in parallel</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#check-if-the-device-is-configured\" id=\"ref-for-check-if-the-device-is-configured①⓪\">Check if the device is configured</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤⑦\">this</a> and <var>promise</var> and abort these steps if <var>promise</var> is rejected.</p>"
        },
        {
          "html": "<p>Abort all operations on the device and <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③⑧\">reject</a> their associated\npromises with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror②\">AbortError</a></code>.</p>"
        },
        {
          "html": "<p>Perform the necessary platform-specific operation to soft reset the device.</p>"
        },
        {
          "html": "<p>On failure <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject③⑨\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#networkerror\" id=\"ref-for-networkerror①①\">NetworkError</a></code>, otherwise <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#resolve\" id=\"ref-for-resolve②①\">resolve</a> <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "check the validity of the control transfer parameters",
      "href": "https://wicg.github.io/webusb/#check-the-validity-of-the-control-transfer-parameters",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"check-the-validity-of-the-control-transfer-parameters\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">check the validity of the control transfer parameters</dfn> with the given <var>device</var>, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>setup</var> be the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbcontroltransferparameters\" id=\"ref-for-dictdef-usbcontroltransferparameters②\">USBControlTransferParameters</a></code> created for the transfer.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be the promise created for the transfer.</p>"
        },
        {
          "html": "<p>Let <var>configuration</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration⑦\">finding the current configuration</a> with <var>device</var>.</p>"
        },
        {
          "html": "<p>If <var>configuration</var> is <code>null</code>, abort these steps.</p>"
        },
        {
          "html": "If <code><var>setup</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbcontroltransferparameters-recipient\" id=\"ref-for-dom-usbcontroltransferparameters-recipient②\">recipient</a></code></code> is <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbrecipient-interface\" id=\"ref-for-dom-usbrecipient-interface①\">\"interface\"</a></code>, perform the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>interfaceNumber</var> be the lower 8 bits of <code><var>setup</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbcontroltransferparameters-index\" id=\"ref-for-dom-usbcontroltransferparameters-index①\">index</a></code></code>.</p>"
            },
            {
              "html": "<p>Let <var>interfaceIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-interface-index\" id=\"ref-for-find-the-interface-index③\">finding the interface index</a> with <var>interfaceNumber</var> and <var>configuration</var>.</p>"
            },
            {
              "html": "<p>If <var>interfaceIndex</var> is equal to <code>-1</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject④⓪\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①⑤\">NotFoundError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p>Let <var>interface</var> be <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot⑨\">[[interfaces]]</a></code>[<var>interfaceIndex</var>].</p>"
            },
            {
              "html": "<p>If the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-if-the-interface-is-claimed\" id=\"ref-for-find-if-the-interface-is-claimed②\">finding if the interface is claimed</a> with <var>interface</var> is not <code>true</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject④①\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror③\">InvalidStateError</a></code> and abort these steps.</p>"
            }
          ]
        },
        {
          "html": "If <code><var>setup</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbcontroltransferparameters-recipient\" id=\"ref-for-dom-usbcontroltransferparameters-recipient③\">recipient</a></code></code> is <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbrecipient-endpoint\" id=\"ref-for-dom-usbrecipient-endpoint\">\"endpoint\"</a></code>, run the following steps:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>endpointAddress</var> be <var>setup</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbcontroltransferparameters-index\" id=\"ref-for-dom-usbcontroltransferparameters-index②\">index</a></code>.</p>"
            },
            {
              "html": "<p>Let <var>endpoint</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint\" id=\"ref-for-find-the-endpoint⑤\">finding the endpoint</a> with <var>endpointAddress</var> and <var>device</var>.</p>"
            },
            {
              "html": "<p>If <var>endpoint</var> is <code>null</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject④②\">reject</a> <var>promise</var> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notfounderror\" id=\"ref-for-notfounderror①⑥\">NotFoundError</a></code> and abort these steps.</p>"
            },
            {
              "html": "<p>Let <var>alternate</var> be <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-alternateinterface-slot\" id=\"ref-for-dom-usbendpoint-alternateinterface-slot\">[[alternateInterface]]</a></code>.</p>"
            },
            {
              "html": "<p>Let <var>interface</var> be <var>alternate</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-interface-slot\" id=\"ref-for-dom-usbalternateinterface-interface-slot\">[[interface]]</a></code>.</p>"
            },
            {
              "html": "<p>If the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-if-the-interface-is-claimed\" id=\"ref-for-find-if-the-interface-is-claimed③\">finding if the interface is claimed</a> with <var>interface</var> is not <code>true</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-reject④③\">reject</a> <var>promise</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror④\">InvalidStateError</a></code> and abort these steps.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "find a list of descriptors for a configuration",
      "href": "https://wicg.github.io/webusb/#find-a-list-of-descriptors-for-a-configuration",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-a-list-of-descriptors-for-a-configuration\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find a list of descriptors for a configuration</dfn> with the given <var>configurationValue</var>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>deviceDescriptor</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-device-descriptor-for-the-connected-usb-device\" id=\"ref-for-find-the-device-descriptor-for-the-connected-usb-device①\">finding the device descriptor for the connected USB device</a>.</p>"
        },
        {
          "html": "<p>Let <var>numConfigurations</var> be <code>bNumConfigurations</code> of <var>deviceDescriptor</var>.</p>"
        },
        {
          "html": "<p>Let <var>configurationIndex</var> be 0.</p>"
        },
        {
          "html": "While <var>configurationIndex</var> is less than <var>numConfigurations</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>descriptors</var> be the a list of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#descriptors\" id=\"ref-for-descriptors①\">descriptors</a> by performing <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#get-descriptor\" id=\"ref-for-get-descriptor②\">Get Descriptor</a> with <code>DescriptorType</code> set to <code>CONFIGURATION</code> and <code>DescriptorIndex</code> set to <var>configurationIndex</var>.</p>"
            },
            {
              "html": "<p>If <code>bDescriptorType</code> of <var>descriptors</var>[0] is equal to <code>CONFIGURATION</code> and <code>bConfigurationValue</code> of <var>descriptors</var> is equal to <var>configurationValue</var>, return <var>descriptors</var>.</p>"
            },
            {
              "html": "<p>Increment <var>configurationIndex</var> by 1.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-empty\" id=\"ref-for-list-empty③\">empty</a> result.</p>"
        }
      ]
    },
    {
      "name": "USBConfiguration constructor",
      "href": "https://wicg.github.io/webusb/#dom-usbconfiguration-usbconfiguration",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBConfiguration\" data-dfn-type=\"constructor\" data-export=\"\" data-lt=\"USBConfiguration(device, configurationValue)|constructor(device, configurationValue)\" id=\"dom-usbconfiguration-usbconfiguration\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>USBConfiguration(<var>device</var>, <var>configurationValue</var>)</code></dfn> constructor MUST, when called, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤⑨\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-device-slot\" id=\"ref-for-dom-usbconfiguration-device-slot①\">[[device]]</a></code> to <var>device</var>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥⓪\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-configurationvalue-slot\" id=\"ref-for-dom-usbconfiguration-configurationvalue-slot②\">[[configurationValue]]</a></code> to <var>configurationValue</var>.</p>"
        },
        {
          "html": "<p>Let <var>descriptors</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-a-list-of-descriptors-for-a-configuration\" id=\"ref-for-find-a-list-of-descriptors-for-a-configuration\">finding a list of descriptors for a configuration</a> with <code>configurationValue</code> set to <var>configurationValue</var>.</p>"
        },
        {
          "html": "<p>Let <var>seen</var> be an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set\">ordered set</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑦\">For each</a> <var>descriptor</var> of <var>descriptors</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If the <code>bDescriptorType</code> of the <var>descriptor</var> is not equal to <code>INTERFACE</code>, continue.</p>"
            },
            {
              "html": "<p>If the <code>bInterfaceNumber</code> of the <var>descriptor</var> is in <var>seen</var>, continue.</p>"
            },
            {
              "html": "<p>Let <var>interface</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new①\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbinterface\" id=\"ref-for-usbinterface②\">USBInterface</a></code> object using <a data-link-type=\"functionish\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-usbinterface\" id=\"ref-for-dom-usbinterface-usbinterface\">USBInterface(<var>configuration</var>,<var>interfaceNumber</var>)</a> with <var>configuration</var> set to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥①\">this</a> and <var>interfaceNumber</var> set to <code>bInterfaceNumber</code> of <var>descriptor</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append②\">Append</a> <var>interface</var> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot①⓪\">[[interfaces]]</a></code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append③\">Append</a> <code>bInterfaceNumber</code> of <var>descriptor</var> to <var>seen</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "USBConfiguration/interfaces",
      "href": "https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces\" id=\"ref-for-dom-usbconfiguration-interfaces②\">interfaces</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥③\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-interfaces-slot\" id=\"ref-for-dom-usbconfiguration-interfaces-slot①①\">[[interfaces]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "find if the interface is claimed",
      "href": "https://wicg.github.io/webusb/#find-if-the-interface-is-claimed",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-if-the-interface-is-claimed\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find if the interface is claimed</dfn> with the given <var>interface</var>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>configuration</var> be <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-configuration-slot\" id=\"ref-for-dom-usbinterface-configuration-slot①\">[[configuration]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>device</var> be <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-device-slot\" id=\"ref-for-dom-usbconfiguration-device-slot②\">[[device]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>configuration</var> is not the same as the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-current-configuration\" id=\"ref-for-find-the-current-configuration⑧\">finding the current configuration</a> with <var>device</var>, return <code>false</code>.</p>"
        },
        {
          "html": "<p>Let <var>interfaceIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-interface-index\" id=\"ref-for-find-the-interface-index④\">finding the interface index</a> with <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber-slot\" id=\"ref-for-dom-usbinterface-interfacenumber-slot①\">[[interfaceNumber]]</a></code> and <var>configuration</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert\">Assert</a>: <var>interfaceIndex</var> is not equal to <code>-1</code>.</p>"
        },
        {
          "html": "<p>Return <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-claimedinterface-slot\" id=\"ref-for-dom-usbdevice-claimedinterface-slot⑨\">[[claimedInterface]]</a></code>[<var>interfaceIndex</var>].</p>"
        }
      ]
    },
    {
      "name": "find the alternate interface for the current alternate setting",
      "href": "https://wicg.github.io/webusb/#find-the-alternate-interface-for-the-current-alternate-setting",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-alternate-interface-for-the-current-alternate-setting\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the alternate interface for the current alternate setting</dfn> with the given <var>interface</var>,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>configuration</var> be <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-configuration-slot\" id=\"ref-for-dom-usbinterface-configuration-slot②\">[[configuration]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>device</var> be <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-device-slot\" id=\"ref-for-dom-usbconfiguration-device-slot③\">[[device]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>alternateIndex</var> be 0.</p>"
        },
        {
          "html": "If the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-if-the-interface-is-claimed\" id=\"ref-for-find-if-the-interface-is-claimed④\">finding if the interface is claimed</a> with <var>interface</var> is <code>true</code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>interfaceIndex</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-interface-index\" id=\"ref-for-find-the-interface-index⑤\">finding the interface index</a> with <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber-slot\" id=\"ref-for-dom-usbinterface-interfacenumber-slot②\">[[interfaceNumber]]</a></code> and <var>configuration</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert①\">Assert</a>: <var>interfaceIndex</var> is not equal to <code>-1</code>.</p>"
            },
            {
              "html": "<p>Set <var>alternateIndex</var> to be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-alternate-index\" id=\"ref-for-find-the-alternate-index①\">finding the alternate index</a> with <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-selectedalternatesetting-slot\" id=\"ref-for-dom-usbdevice-selectedalternatesetting-slot⑥\">[[selectedAlternateSetting]]</a></code>[<var>interfaceIndex</var>] and <var>interface</var>.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#assert\" id=\"ref-for-assert②\">Assert</a>: <var>alternateIndex</var> is not equal to <code>-1</code>.</p>"
        },
        {
          "html": "<p>Return <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternates\" id=\"ref-for-dom-usbinterface-alternates①\">alternates</a></code>[<var>alternateIndex</var>].</p>"
        }
      ]
    },
    {
      "name": "USBInterface constructor",
      "href": "https://wicg.github.io/webusb/#dom-usbinterface-usbinterface",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBInterface\" data-dfn-type=\"constructor\" data-export=\"\" data-lt=\"USBInterface(configuration, interfaceNumber)|constructor(configuration, interfaceNumber)\" id=\"dom-usbinterface-usbinterface\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>USBInterface(<var>configuration</var>, <var>interfaceNumber</var>)</code></dfn> constructor MUST, when called, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥⑤\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-configuration-slot\" id=\"ref-for-dom-usbinterface-configuration-slot③\">[[configuration]]</a></code> to <var>configuration</var>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber-slot\" id=\"ref-for-dom-usbinterface-interfacenumber-slot③\">[[interfaceNumber]]</a></code> to <var>interfaceNumber</var>.</p>"
        },
        {
          "html": "<p>Let <var>descriptors</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-a-list-of-descriptors-for-a-configuration\" id=\"ref-for-find-a-list-of-descriptors-for-a-configuration①\">finding a list of descriptors for a configuration</a> with <code>configurationValue</code> set to <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-configurationvalue-slot\" id=\"ref-for-dom-usbconfiguration-configurationvalue-slot③\">[[configurationValue]]</a></code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑧\">For each</a> <var>descriptor</var> of <var>descriptors</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <code>bDescriptorType</code> of <var>descriptor</var> is not equal to <code>INTERFACE</code>,\ncontinue.</p>"
            },
            {
              "html": "<p>If <code>bInterfaceNumber</code> of <var>descriptor</var> is not equal to <var>interfaceNumber</var>,\ncontinue.</p>"
            },
            {
              "html": "<p>If <var>descriptor</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#has-a-protected-interface-class\" id=\"ref-for-has-a-protected-interface-class\">has a protected interface class</a>,\nset <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥⑦\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-isprotectedclass-slot\" id=\"ref-for-dom-usbinterface-isprotectedclass-slot①\">[[isProtectedClass]]</a></code> to <code>true</code>.</p>"
            },
            {
              "html": "<p>Let <var>alternate</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new②\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbalternateinterface\" id=\"ref-for-usbalternateinterface③\">USBAlternateInterface</a></code> object\nusing <a data-link-type=\"functionish\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-usbalternateinterface\" id=\"ref-for-dom-usbalternateinterface-usbalternateinterface\">USBAlternateInterface(<var>deviceInterface</var>,<var>alternateSetting</var>)</a> with <var>deviceInterface</var> set to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥⑧\">this</a> and <var>alternateSetting</var> set to the <code>bAlternateSetting</code> of the <var>descriptor</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append④\">Append</a> <var>alternate</var> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥⑨\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternates-slot\" id=\"ref-for-dom-usbinterface-alternates-slot②\">[[alternates]]</a></code>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "USBInterface/interfaceNumber",
      "href": "https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber\" id=\"ref-for-dom-usbinterface-interfacenumber②\">interfaceNumber</a></code> getter steps are:.",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦⓪\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber-slot\" id=\"ref-for-dom-usbinterface-interfacenumber-slot④\">[[interfaceNumber]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "USBInterface/alternate",
      "href": "https://wicg.github.io/webusb/#dom-usbinterface-alternate",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternate\" id=\"ref-for-dom-usbinterface-alternate②\">alternate</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-alternate-interface-for-the-current-alternate-setting\" id=\"ref-for-find-the-alternate-interface-for-the-current-alternate-setting②\">finding the alternate interface for the current alternate setting</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦①\">this</a>.</p>"
        }
      ]
    },
    {
      "name": "USBInterface/alternates",
      "href": "https://wicg.github.io/webusb/#dom-usbinterface-alternates",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternates\" id=\"ref-for-dom-usbinterface-alternates④\">alternates</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-alternates-slot\" id=\"ref-for-dom-usbinterface-alternates-slot③\">[[alternates]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "USBInterface/claimed",
      "href": "https://wicg.github.io/webusb/#dom-usbinterface-claimed",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-claimed\" id=\"ref-for-dom-usbinterface-claimed②\">claimed</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-if-the-interface-is-claimed\" id=\"ref-for-find-if-the-interface-is-claimed⑤\">finding if the interface is claimed</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦③\">this</a>.</p>"
        }
      ]
    },
    {
      "name": "find a list of endpoint descriptors",
      "href": "https://wicg.github.io/webusb/#find-a-list-of-endpoint-descriptors",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-a-list-of-endpoint-descriptors\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find a list of endpoint descriptors</dfn> with the given <var>alternateSetting</var> , <var>interfaceNumber</var>, and <var>configurationValue</var>, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>descriptors</var> as a result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-a-list-of-descriptors-for-a-configuration\" id=\"ref-for-find-a-list-of-descriptors-for-a-configuration②\">finding a list of descriptors for a configuration</a> with <var>configurationValue</var>.</p>"
        },
        {
          "html": "<p>Let <var>endpointDescriptors</var> as an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list①\">list</a>.</p>"
        },
        {
          "html": "<p>Let <var>index</var> be 0.</p>"
        },
        {
          "html": "While <var>index</var> is less than the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size④\">size</a> of <var>descriptors</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>descriptor</var> be <var>descriptors</var>[<var>index</var>].</p>"
            },
            {
              "html": "<p>If <code>bDescriptorType</code> of <var>descriptor</var> is not equal to <code>INTERFACE</code>,\nincrement <var>index</var> by 1 and continue.</p>"
            },
            {
              "html": "<p>if <code>bInterfaceNumber</code> of <var>descriptor</var> is not equal <var>interfaceNumber</var>,\nincrement <var>index</var> by 1 and continue.</p>"
            },
            {
              "html": "<p>if <code>bAlternateSetting</code> of <var>descriptor</var> is not equal <var>alternateSetting</var>,\nincrement <var>index</var> by 1 and continue.</p>"
            },
            {
              "html": "<p>If <code>bNumEndpoints</code> is equal to 0, return <var>endpointDescriptors</var>.</p>"
            },
            {
              "html": "<p>Let <var>numEndpoints</var> be <code>bNumEndpoints</code> of <var>descriptor</var>.</p>"
            },
            {
              "html": "<p>Let <var>indexEndpoints</var> be 0.</p>"
            },
            {
              "html": "<p>Let <var>offset</var> be <var>index</var> + 1</p>"
            },
            {
              "html": "While <var>indexEndpoints</var> is less than <var>numEndpoints</var>:",
              "rationale": "append",
              "steps": [
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑤\">Append</a> <var>descriptors</var>[<var>indexEndpoints</var> + <var>offset</var>] to <var>endpointDescriptors</var>.</p>"
                },
                {
                  "html": "<p>Increment <var>indexEndpoints</var> by 1.</p>"
                }
              ]
            },
            {
              "html": "<p>Return <var>endpointDescriptors</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "USBAlternateInterface constructor",
      "href": "https://wicg.github.io/webusb/#dom-usbalternateinterface-usbalternateinterface",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"USBAlternateInterface\" data-dfn-type=\"constructor\" data-export=\"\" data-lt=\"USBAlternateInterface(deviceInterface, alternateSetting)|constructor(deviceInterface, alternateSetting)\" id=\"dom-usbalternateinterface-usbalternateinterface\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>USBAlternateInterface(<var>deviceInterface</var>, <var>alternateSetting</var>)</code></dfn> constructor MUST, when called, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦⑤\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-interface-slot\" id=\"ref-for-dom-usbalternateinterface-interface-slot①\">[[interface]]</a></code> to <var>deviceInterface</var>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-alternatesetting-slot\" id=\"ref-for-dom-usbalternateinterface-alternatesetting-slot①\">[[alternateSetting]]</a></code> to be <var>alternateSetting</var>.</p>"
        },
        {
          "html": "<p>Let <var>descriptors</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-a-list-of-endpoint-descriptors\" id=\"ref-for-find-a-list-of-endpoint-descriptors\">finding a list of endpoint descriptors</a> with <code>interfaceNumber</code> set to <var>deviceInterface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber\" id=\"ref-for-dom-usbinterface-interfacenumber③\">interfaceNumber</a></code>, <code>alternateSetting</code> set to <var>alternateSetting</var>,\nand <code>configurationValue</code> set to <var>deviceInterface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-configuration-slot\" id=\"ref-for-dom-usbinterface-configuration-slot④\">[[configuration]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-configurationvalue-slot\" id=\"ref-for-dom-usbconfiguration-configurationvalue-slot④\">[[configurationValue]]</a></code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑨\">For each</a> <var>descriptor</var> of <var>descriptors</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <code>bmAttributes</code> of <var>descriptor</var> indicates it is a\nControl Transfer Type (i.e. bits <code>0..1</code> is <code>00</code> according to <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#endpoint-descriptor\" id=\"ref-for-endpoint-descriptor\">endpoint descriptor</a>), continue.</p>"
            },
            {
              "html": "<p>Let <var>endpointAddress</var> be <code>bEndpointAddress</code> of <var>descriptor</var>.</p>"
            },
            {
              "html": "<p>Let <var>dir</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-out\" id=\"ref-for-dom-usbdirection-out②\">\"out\"</a></code> if <code><var>endpointAddress</var> &amp; 0x80</code> is <code>0</code>,\nand <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-in\" id=\"ref-for-dom-usbdirection-in③\">\"in\"</a></code> otherwise.</p>"
            },
            {
              "html": "<p>Let <var>endpoint</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new③\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbendpoint\" id=\"ref-for-usbendpoint②\">USBEndpoint</a></code> object\nusing <a data-link-type=\"functionish\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-usbendpoint\" id=\"ref-for-dom-usbendpoint-usbendpoint\">USBEndpoint(<var>alternate</var>,<var>endpointNumber</var>,<var>direction</var>)</a> with <var>alternate</var> set to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦⑦\">this</a>, <var>endpointNumber</var> set to <code><var>endpointAddress</var> &amp; 0xF</code>, and <var>direction</var> set to <var>dir</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑥\">Append</a> <var>endpoint</var> to <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦⑧\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-endpoints-slot\" id=\"ref-for-dom-usbalternateinterface-endpoints-slot②\">[[endpoints]]</a></code>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "USBAlternateInterface/endpoints",
      "href": "https://wicg.github.io/webusb/#dom-usbalternateinterface-endpoints",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-endpoints\" id=\"ref-for-dom-usbalternateinterface-endpoints②\">endpoints</a></code> getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦⑨\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-endpoints-slot\" id=\"ref-for-dom-usbalternateinterface-endpoints-slot③\">[[endpoints]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "find the endpoint descriptor",
      "href": "https://wicg.github.io/webusb/#find-the-endpoint-descriptor",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"find-the-endpoint-descriptor\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">find the endpoint descriptor</dfn> with the given <var>endpoint</var> object,\n    perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>alternateInterface</var> be <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-alternateinterface-slot\" id=\"ref-for-dom-usbendpoint-alternateinterface-slot①\">[[alternateInterface]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>interface</var> be <var>alternateInterface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-interface-slot\" id=\"ref-for-dom-usbalternateinterface-interface-slot②\">[[interface]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>configuration</var> be <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-configuration-slot\" id=\"ref-for-dom-usbinterface-configuration-slot⑤\">[[configuration]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>endpointDescriptors</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-a-list-of-endpoint-descriptors\" id=\"ref-for-find-a-list-of-endpoint-descriptors①\">finding a list of endpoint descriptors</a> with <code>alternateSetting</code> set to <var>alternateInterface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbalternateinterface-alternatesetting\" id=\"ref-for-dom-usbalternateinterface-alternatesetting②\">alternateSetting</a></code>, <code>interfaceNumber</code> set to <var>interface</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbinterface-interfacenumber\" id=\"ref-for-dom-usbinterface-interfacenumber④\">interfaceNumber</a></code>, and <code>configurationValue</code> set to <var>configuration</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbconfiguration-configurationvalue\" id=\"ref-for-dom-usbconfiguration-configurationvalue②\">configurationValue</a></code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⓪\">For each</a> <var>endpointDescriptor</var> of <var>endpointDescriptors</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>endpoint</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-endpointaddress-slot\" id=\"ref-for-dom-usbendpoint-endpointaddress-slot①\">[[endpointAddress]]</a></code> is equal to <code>bEndpointAddress</code> of <var>endpointDescriptor</var>, return <var>endpointDescriptor</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "endpointNumber constructor",
      "href": "https://wicg.github.io/webusb/#dom-endpointnumber-endpointnumber",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"endpointNumber\" data-dfn-type=\"constructor\" data-export=\"\" id=\"dom-endpointnumber-endpointnumber\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>endpointNumber(<var>alternate</var>, <var>endpointNumber</var>, <var>direction</var>)</code></dfn> constructor MUST, when called, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-alternateinterface-slot\" id=\"ref-for-dom-usbendpoint-alternateinterface-slot②\">[[alternateInterface]]</a></code> to <var>alternate</var>.</p>"
        },
        {
          "html": "<p>Set <var>endpointAddress</var> to <code><var>endpointNumber</var> | 0x80</code> If <var>direction</var> is <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdirection-in\" id=\"ref-for-dom-usbdirection-in④\">\"in\"</a></code>, and <var>endpointNumber</var> otherwise.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-endpointaddress-slot\" id=\"ref-for-dom-usbendpoint-endpointaddress-slot②\">[[endpointAddress]]</a></code> to <var>endpointAddress</var>.</p>"
        }
      ]
    },
    {
      "name": "USBEndpoint/type",
      "href": "https://wicg.github.io/webusb/#dom-usbendpoint-type",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-type\" id=\"ref-for-dom-usbendpoint-type⑥\">type</a></code> getter steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>endpointDescriptor</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint-descriptor\" id=\"ref-for-find-the-endpoint-descriptor\">finding the endpoint descriptor</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧③\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>attr</var> be <code>bmAttributes</code> of <var>endpointDescriptor</var>.</p>"
        },
        {
          "html": "<p>Let <var>typeBits</var> be <code><var>attr</var> &amp; 0x3</code>.</p>"
        },
        {
          "html": "<p>If <var>typeBits</var> is equal to <code>b01</code>, return <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-isochronous\" id=\"ref-for-dom-usbendpointtype-isochronous②\">\"isochronous\"</a></code>.</p>"
        },
        {
          "html": "<p>If <var>typeBits</var> is equal to <code>b10</code>, return <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-bulk\" id=\"ref-for-dom-usbendpointtype-bulk②\">\"bulk\"</a></code>.</p>"
        },
        {
          "html": "<p>If <var>typeBits</var> is equal to <code>b11</code>, return <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpointtype-interrupt\" id=\"ref-for-dom-usbendpointtype-interrupt\">\"interrupt\"</a></code>.</p>"
        }
      ]
    },
    {
      "name": "USBEndpoint/packetSize",
      "href": "https://wicg.github.io/webusb/#dom-usbendpoint-packetsize",
      "html": "The <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbendpoint-packetsize\" id=\"ref-for-dom-usbendpoint-packetsize②\">packetSize</a></code> getter steps are:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>endpointDescriptor</var> be the result of <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#find-the-endpoint-descriptor\" id=\"ref-for-find-the-endpoint-descriptor①\">finding the endpoint descriptor</a> with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧④\">this</a>.</p>"
        },
        {
          "html": "<p>Return <code>wMaxPacketSize</code> of <var>endpointDescriptor</var>.</p>"
        }
      ]
    },
    {
      "name": "parsing the blocklist",
      "href": "https://wicg.github.io/webusb/#parsing-the-blocklist",
      "html": "The result of <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"parsing-the-blocklist\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">parsing the blocklist</dfn> at a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://url.spec.whatwg.org/#url\" id=\"ref-for-url\">URL</a></code> <var>url</var> is a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list②\">list</a> of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbblocklistentry\" id=\"ref-for-dictdef-usbblocklistentry\">USBBlocklistEntry</a></code> objects produced by the following algorithm:",
      "rationale": "fetch",
      "steps": [
        {
          "html": "<p>Fetch <var>url</var> and let <var>contents</var> be its body, decoded as UTF-8.</p>"
        },
        {
          "html": "<p>Let <var>lines</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#strictly-split\" id=\"ref-for-strictly-split\">strictly splitting</a> <var>contents</var> starting\n from the beginning of <var>contents</var> on code point <code>'\\n'</code>.</p>"
        },
        {
          "html": "<p>Let <var>blocklist</var> be an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list③\">list</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①①\">For each</a> <var>line</var> of <var>lines</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>line</var> to the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points\" id=\"ref-for-collect-a-sequence-of-code-points\">collecting a sequence of code points</a> not equal to <code>'#'</code> from <var>line</var> starting from the beginning\n of <var>line</var>.</p>"
            },
            {
              "html": "<p>Set <var>line</var> to the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace\" id=\"ref-for-strip-leading-and-trailing-ascii-whitespace\">stripping leading and trailing ASCII\n whitespace</a> from <var>line</var>.</p>"
            },
            {
              "html": "<p>Let <var>components</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#strictly-split\" id=\"ref-for-strictly-split①\">strictly splitting</a> <var>line</var> starting from the beginning of <var>line</var> on code point <code>':'</code>.</p>"
            },
            {
              "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size⑤\">size</a> of <var>components</var> is not 2 or 3, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue①\">continue</a>.</p>"
            },
            {
              "html": "<p>Let <var>idVendor</var> be the result of interpreting <var>components</var>[0] as a\n hexadecimal number.</p>"
            },
            {
              "html": "<p>Let <var>idProduct</var> be the result of interpreting <var>components</var>[1] as a\n hexadecimal number.</p>"
            },
            {
              "html": "<p>Let <var>bcdDevice</var> be <code>0xFFFF</code>.</p>"
            },
            {
              "html": "<p>If the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size⑥\">size</a> of <var>components</var> is 3, set <var>bcdDevice</var> to the\n result of interpreting <var>components</var>[2] as a hexadecimal number.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-append\" id=\"ref-for-list-append⑦\">Append</a> a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbblocklistentry\" id=\"ref-for-dictdef-usbblocklistentry①\">USBBlocklistEntry</a></code> with <var>idVendor</var>, <var>idProduct</var>, and <var>bcdDevice</var> to <var>blocklist</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>blocklist</var>.</p>"
        }
      ]
    },
    {
      "name": "blocklisted",
      "href": "https://wicg.github.io/webusb/#blocklisted",
      "html": "A <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice①③\">USBDevice</a></code> <var>device</var> is <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"blocklisted\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">blocklisted</dfn> for a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document③\">Document</a></code> <var>document</var> if the following steps return \"blocked\":",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>document</var> is not <code>null</code> and <var>document</var> is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use\" id=\"ref-for-allowed-to-use①\">allowed to use</a> the <a data-link-type=\"dfn\" href=\"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature\" id=\"ref-for-policy-controlled-feature①\">policy-controlled feature</a> named <code>\"usb-unrestricted\"</code>,\n return \"not blocked\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①②\">For each</a> <var>entry</var> of the <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#usb-blocklist\" id=\"ref-for-usb-blocklist\">USB blocklist</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-vendorid\" id=\"ref-for-dom-usbdevice-vendorid②\">vendorId</a></code> is not equal to <var>entry</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbblocklistentry-idvendor\" id=\"ref-for-dom-usbblocklistentry-idvendor\">idVendor</a></code>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue②\">continue</a>.</p>"
            },
            {
              "html": "<p>If <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-productid\" id=\"ref-for-dom-usbdevice-productid②\">productId</a></code> is not equal to <var>entry</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbblocklistentry-idproduct\" id=\"ref-for-dom-usbblocklistentry-idproduct\">idProduct</a></code>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue③\">continue</a>.</p>"
            },
            {
              "html": "<p>Let <var>bcdDevice</var> be <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-deviceversionmajor\" id=\"ref-for-dom-usbdevice-deviceversionmajor②\">deviceVersionMajor</a></code> &lt;&lt; 8 + <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-deviceversionminor\" id=\"ref-for-dom-usbdevice-deviceversionminor②\">deviceVersionMinor</a></code> &lt;&lt; 4 + <var>device</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbdevice-deviceversionsubminor\" id=\"ref-for-dom-usbdevice-deviceversionsubminor②\">deviceVersionSubminor</a></code>.</p>"
            },
            {
              "html": "<p>If <var>bcdDevice</var> is less than or equal to <var>entry</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbblocklistentry-bcddevice\" id=\"ref-for-dom-usbblocklistentry-bcddevice\">bcdDevice</a></code>, return \"blocked\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"not blocked\".</p>"
        }
      ]
    },
    {
      "html": "To <strong><em>query the \"usb\" permission</em></strong> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissiondescriptor\" id=\"ref-for-dictdef-usbpermissiondescriptor①\">USBPermissionDescriptor</a></code> <var>desc</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dictdef-usbpermissionstorage\" id=\"ref-for-dictdef-usbpermissionstorage①⓪\">USBPermissionStorage</a></code> <var>storage</var>,\n    and a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbpermissionresult\" id=\"ref-for-usbpermissionresult①\">USBPermissionResult</a></code> <var>status</var>, the UA must:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-filters\" id=\"ref-for-dom-usbpermissiondescriptor-filters②\">filters</a></code></code> is set then,\n for each <var>filter</var> in <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-filters\" id=\"ref-for-dom-usbpermissiondescriptor-filters③\">filters</a></code></code> if <var>filter</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#is-not-a-valid-filter\" id=\"ref-for-is-not-a-valid-filter②\">is not a valid filter</a> then raise a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror\" id=\"ref-for-sec-native-error-types-used-in-this-standard-typeerror②\">TypeError</a></code> and abort these\n steps.</p>"
        },
        {
          "html": "<p>If <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-exclusionfilters\" id=\"ref-for-dom-usbpermissiondescriptor-exclusionfilters②\">exclusionFilters</a></code></code> is\n set then, for each <var>exclusionFilter</var> in <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-exclusionfilters\" id=\"ref-for-dom-usbpermissiondescriptor-exclusionfilters③\">exclusionFilters</a></code></code> if <var>exclusionFilter</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#is-not-a-valid-filter\" id=\"ref-for-is-not-a-valid-filter③\">is not a valid filter</a> then raise a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror\" id=\"ref-for-sec-native-error-types-used-in-this-standard-typeerror③\">TypeError</a></code> and abort these steps.</p>"
        },
        {
          "html": "<p>Set <code><var>status</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://w3c.github.io/permissions/#dom-permissionstatus-state\" id=\"ref-for-dom-permissionstatus-state①\">state</a></code></code> to <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://w3c.github.io/permissions/#dom-permissionstate-prompt\" id=\"ref-for-dom-permissionstate-prompt\">\"prompt\"</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>matchingDevices</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://tc39.github.io/ecma262/#sec-array-objects\" id=\"ref-for-sec-array-objects①\">Array</a></code>.</p>"
        },
        {
          "html": "For each <var>allowedDevice</var> in <code><var>storage</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionstorage-alloweddevices\" id=\"ref-for-dom-usbpermissionstorage-alloweddevices⑧\">allowedDevices</a></code></code> and\n for each <var>device</var> in <code><var>allowedDevice</var>@<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-allowedusbdevice-devices-slot\" id=\"ref-for-dom-allowedusbdevice-devices-slot⑧\">[[devices]]</a></code></code>, run\n the following substeps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-filters\" id=\"ref-for-dom-usbpermissiondescriptor-filters④\">filters</a></code></code> is set\n  and <var>device</var> does not <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#match-a-device-filter\" id=\"ref-for-match-a-device-filter②\">match a device filter</a> in <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-filters\" id=\"ref-for-dom-usbpermissiondescriptor-filters⑤\">filters</a></code></code>, continue\n  to the next <var>device</var>.</p>"
            },
            {
              "html": "<p>If <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-exclusionfilters\" id=\"ref-for-dom-usbpermissiondescriptor-exclusionfilters④\">exclusionFilters</a></code></code> is set and <var>device</var> <a data-link-type=\"dfn\" href=\"https://wicg.github.io/webusb/#match-a-device-filter\" id=\"ref-for-match-a-device-filter③\">matches a device filter</a> in <code><var>desc</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissiondescriptor-exclusionfilters\" id=\"ref-for-dom-usbpermissiondescriptor-exclusionfilters⑤\">exclusionFilters</a></code></code>,\n  continue to the next <var>device</var>.</p>"
            },
            {
              "html": "<p>Get the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#usbdevice\" id=\"ref-for-usbdevice①⑤\">USBDevice</a></code> representing <var>device</var> and add it to <var>matchingDevices</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Set <code><var>status</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://wicg.github.io/webusb/#dom-usbpermissionresult-devices\" id=\"ref-for-dom-usbpermissionresult-devices④\">devices</a></code></code> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-frozen-array\" id=\"ref-for-idl-frozen-array⑨\">FrozenArray</a></code> whose contents are <var>matchingDevices</var>.</p>"
        }
      ]
    }
  ]
}