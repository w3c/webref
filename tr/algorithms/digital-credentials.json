{
  "spec": {
    "title": "Digital Credentials",
    "url": "https://www.w3.org/TR/digital-credentials/"
  },
  "algorithms": [
    {
      "name": "credential request coordinator/complete credential request with error",
      "href": "https://www.w3.org/TR/digital-credentials/#dfn-complete-credential-request-with-error",
      "html": "To <dfn data-dfn-for=\"credential request coordinator\" data-local-lt=\"complete credential request with\" id=\"dfn-complete-credential-request-with-error\" tabindex=\"0\" aria-haspopup=\"dialog\" data-dfn-type=\"dfn\" class=\"respec-offending-element\" title=\"Found definition for &quot;complete credential request with error&quot;, but nothing links to it. This is usually a spec bug!\">complete credential request with\n      error</dfn> given a <a data-link-type=\"interface\" data-lt=\"Promise\" href=\"https://webidl.spec.whatwg.org/#idl-promise\" id=\"ref-for-index-term-promise-interface-3\"><code>Promise</code></a> <var data-type=\"Promise\">promise</var> and (a JavaScript\n      Value) <var>error</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<a href=\"https://infra.spec.whatwg.org/#assert\">Assert</a>: the <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-credential-request-coordinator\" class=\"internalDFN\" id=\"ref-for-dfn-credential-request-coordinator-6\">credential request coordinator</a>'s <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-active-promise\" class=\"internalDFN\" id=\"ref-for-dfn-active-promise-2\">active promise</a> is <var data-type=\"Promise\">promise</var>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\" id=\"ref-for-index-term-queue-a-global-task-1\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#dom-manipulation-task-source\" id=\"ref-for-index-term-dom-manipulation-task-source-1\">DOM manipulation task source</a> given\n      <var data-type=\"Promise\">promise</var>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-index-term-relevant-global-object-1\">relevant global object</a> to perform the following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "If the <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-credential-request-coordinator\" class=\"internalDFN\" id=\"ref-for-dfn-credential-request-coordinator-7\">credential request coordinator</a>'s <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-active-promise\" class=\"internalDFN\" id=\"ref-for-dfn-active-promise-3\">active promise</a> is not <var data-type=\"Promise\">promise</var>, then return."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#reject\" id=\"ref-for-index-term-rejects-3\">Reject</a> <var data-type=\"Promise\">promise</var> with <var>error</var>."
            },
            {
              "html": "Set the <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-credential-request-coordinator\" class=\"internalDFN\" id=\"ref-for-dfn-credential-request-coordinator-8\">credential request coordinator</a>'s <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-active-promise\" class=\"internalDFN\" id=\"ref-for-dfn-active-promise-4\">active promise</a> to <code>null</code>."
            },
            {
              "html": "Set the <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-credential-request-coordinator\" class=\"internalDFN\" id=\"ref-for-dfn-credential-request-coordinator-9\">credential request coordinator</a> <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-interaction-states\" class=\"internalDFN\" id=\"ref-for-dfn-interaction-states-3\">interaction state</a> to \"<a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-idle\" class=\"internalDFN\" id=\"ref-for-dfn-idle-3\">idle</a>\"."
            }
          ]
        }
      ]
    },
    {
      "html": "When this method is invoked, the user agent <em class=\"rfc2119\">MUST</em> execute the following\n      algorithm:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>protocol</var> is not an <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-enumeration-value\" id=\"ref-for-index-term-enumeration-value-1\">enumeration value</a> of\n      <a data-link-type=\"idl\" data-lt=\"DigitalCredentialProtocol\" href=\"https://www.w3.org/TR/digital-credentials/#dom-digitalcredentialprotocol\" class=\"internalDFN\" id=\"ref-for-dom-digitalcredentialprotocol-2\"><code>DigitalCredentialProtocol</code></a>, return <code>false</code>."
        },
        {
          "html": "Return <code>true</code> if the user agent allows <var>protocol</var>, otherwise return\n      <code>false</code>."
        }
      ]
    },
    {
      "name": "DigitalCredential/[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)",
      "href": "https://www.w3.org/TR/digital-credentials/#dfn-discoverfromexternalsource-origin-options-sameoriginwithancestors",
      "html": "When invoked, the <dfn class=\"export\" data-dfn-for=\"DigitalCredential\" data-idl=\"\" data-dfn-type=\"method\" data-export=\"\" id=\"dfn-discoverfromexternalsource-origin-options-sameoriginwithancestors\" tabindex=\"0\" aria-haspopup=\"dialog\">[[DiscoverFromExternalSource]](origin, options,\n      sameOriginWithAncestors)</dfn> internal method, if the user agent doesn't\n      support <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-presentation-request\" class=\"internalDFN\" id=\"ref-for-dfn-presentation-request-17\">presentation requests</a> (e.g., the platform\n      cannot provide a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/credential-management-1/#credential-chooser\" id=\"ref-for-index-term-credential-chooser-3\">credential chooser</a>), call the default implementation\n      of <a data-link-type=\"interface\" data-lt=\"Credential\" href=\"https://www.w3.org/TR/credential-management-1/#credential\" id=\"ref-for-index-term-credential-interface-2\"><code>Credential</code></a>'s <a data-link-type=\"method\" data-lt=\"[[DiscoverFromExternalSource]](origin, options, sameOriginWithAncestors)\" href=\"https://www.w3.org/TR/credential-management-1/#dom-credential-discoverfromexternalsource-slot\" id=\"ref-for-index-term-discoverfromexternalsource-origin-options-sameoriginwithancestors-for-credential-1\"><code>[[DiscoverFromExternalSource]](<var>origin</var>, <var>options</var>, <var>sameOriginWithAncestors</var>)</code></a> internal method with the same\n      arguments. Otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Let <var>signal</var> be <var>options</var>'s <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/credential-management-1/#dom-credentialrequestoptions-signal\" id=\"ref-for-index-term-signal-for-credentialrequestoptions-1\"><code>signal</code></a>, if\n      present."
        },
        {
          "html": "If <var>signal</var> is <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-aborted\" id=\"ref-for-index-term-aborted-for-abortsignal-1\">aborted</a>,\n      return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-1\">a promise rejected with</a> <var>signal</var>'s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-abort-reason\" id=\"ref-for-index-term-abort-reason-for-abortsignal-1\">abort reason</a>."
        },
        {
          "html": "Let <var>global</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-index-term-this-1\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-index-term-relevant-global-object-2\">relevant global object</a>."
        },
        {
          "html": "Let <var>document</var> be <var>global</var>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-index-term-associated-document-1\">associated <code>Document</code></a>."
        },
        {
          "html": "If <var>document</var> is not a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#fully-active-descendant-of-a-top-level-traversable-with-user-attention\" id=\"ref-for-index-term-fully-active-descendant-of-a-top-level-traversable-with-user-attention-for-document-1\">fully active descendant of a top-level traversable with user attention</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-2\">a promise rejected with</a> a \"<a data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#notallowederror\" id=\"ref-for-index-term-notallowederror-exception-1\"><code>NotAllowedError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-index-term-domexception-interface-1\"><code>DOMException</code></a>."
        },
        {
          "html": "Let <var>requests</var> be <var>options</var>'s <a data-link-type=\"idl\" href=\"https://www.w3.org/TR/digital-credentials/#dom-credentialrequestoptions-digital\" class=\"internalDFN\" id=\"ref-for-dom-credentialrequestoptions-digital-2\"><code>digital</code></a>'s\n      <a data-link-type=\"idl\" href=\"https://www.w3.org/TR/digital-credentials/#dom-digitalcredentialrequestoptions-requests\" class=\"internalDFN\" id=\"ref-for-dom-digitalcredentialrequestoptions-requests-2\"><code>requests</code></a> member."
        },
        {
          "html": "If <var>requests</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-index-term-is-empty-for-list-1\">is empty</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-3\">a promise rejected with</a> a\n      <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-index-term-typeerror-exception-1\"><code>TypeError</code></a>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-index-term-for-each-for-list-1\">For each</a> <var>request</var> of <var>requests</var>:",
          "rationale": "serialize",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" data-lt=\"serialize a JavaScript value to a JSON string\" href=\"https://infra.spec.whatwg.org/#serialize-a-javascript-value-to-a-json-string\" id=\"ref-for-index-term-serialize-a-javascript-value-to-a-json-string-1\">Serialize</a>\n          <var>request</var>'s <a data-link-type=\"idl\" href=\"https://www.w3.org/TR/digital-credentials/#dom-digitalcredentialgetrequest-data\" class=\"internalDFN\" id=\"ref-for-dom-digitalcredentialgetrequest-data-2\"><code>data</code></a> to a JSON string."
            },
            {
              "html": "If serialization results in an <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-exception\" id=\"ref-for-index-term-exception-1\">exception</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-4\">a promise rejected with</a> that <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-exception\" id=\"ref-for-index-term-exception-2\">exception</a>."
            }
          ]
        },
        {
          "html": "If <var>global</var> does not have <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#transient-activation\" id=\"ref-for-index-term-transient-activation-2\">transient activation</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-5\">a promise rejected with</a> a \"<a data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#notallowederror\" id=\"ref-for-index-term-notallowederror-exception-2\"><code>NotAllowedError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-index-term-domexception-interface-2\"><code>DOMException</code></a>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#consume-user-activation\" id=\"ref-for-index-term-consume-user-activation-1\">Consume user activation</a> of <var>global</var>."
        },
        {
          "html": "Let <var>promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-index-term-a-new-promise-1\">a new promise</a> in <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-index-term-this-2\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm\" id=\"ref-for-index-term-relevant-realm-1\">relevant realm</a>."
        },
        {
          "html": "<a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-prepare-credential-requests\" class=\"internalDFN\" id=\"ref-for-dfn-prepare-credential-requests-1\">Prepare credential requests</a> with\n      <var>document</var>, <var>requests</var>, <var>promise</var>, and <var>signal</var>."
        },
        {
          "html": "Return <var>promise</var>."
        }
      ]
    },
    {
      "name": "DigitalCredential/[[Create]](origin, options, sameOriginWithAncestors)",
      "href": "https://www.w3.org/TR/digital-credentials/#dfn-create-origin-options-sameoriginwithancestors",
      "html": "When invoked, the <dfn class=\"export\" data-dfn-for=\"DigitalCredential\" data-idl=\"\" data-dfn-type=\"method\" data-export=\"\" id=\"dfn-create-origin-options-sameoriginwithancestors\" tabindex=\"0\" aria-haspopup=\"dialog\">[[Create]](origin, options,\n      sameOriginWithAncestors)</dfn> internal method, if the user agent doesn't\n      support <a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-issuance-request\" class=\"internalDFN\" id=\"ref-for-dfn-issuance-request-16\">issuance requests</a>, call the default\n      implementation of <a data-link-type=\"interface\" data-lt=\"Credential\" href=\"https://www.w3.org/TR/credential-management-1/#credential\" id=\"ref-for-index-term-credential-interface-4\"><code>Credential</code></a>'s <a data-link-type=\"method\" data-lt=\"[[Create]](origin, options, sameOriginWithAncestors)\" href=\"https://www.w3.org/TR/credential-management-1/#dom-credential-create-slot\" id=\"ref-for-index-term-create-origin-options-sameoriginwithancestors-for-credential-2\"><code>[[Create]](<var>origin</var>, <var>options</var>, <var>sameOriginWithAncestors</var>)</code></a> internal method with the same\n      arguments. Otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Let <var>signal</var> be <var>options</var>'s <a data-link-type=\"dict-member\" href=\"https://www.w3.org/TR/credential-management-1/#dom-credentialcreationoptions-signal\" id=\"ref-for-index-term-signal-for-credentialcreationoptions-1\"><code>signal</code></a>, if\n      present."
        },
        {
          "html": "If <var>signal</var> is <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-aborted\" id=\"ref-for-index-term-aborted-for-abortsignal-2\">aborted</a>,\n      return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-6\">a promise rejected with</a> <var>signal</var>'s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-abort-reason\" id=\"ref-for-index-term-abort-reason-for-abortsignal-2\">abort reason</a>."
        },
        {
          "html": "Let <var>global</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-index-term-this-3\">this</a>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-index-term-relevant-global-object-3\">relevant global object</a>."
        },
        {
          "html": "Let <var>document</var> be <var>global</var>'s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-index-term-associated-document-2\">associated <code>Document</code></a>."
        },
        {
          "html": "If <var>document</var> is not a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#fully-active-descendant-of-a-top-level-traversable-with-user-attention\" id=\"ref-for-index-term-fully-active-descendant-of-a-top-level-traversable-with-user-attention-for-document-2\">fully active descendant of a top-level traversable with user attention</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-7\">a promise rejected with</a> a \"<a data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#notallowederror\" id=\"ref-for-index-term-notallowederror-exception-3\"><code>NotAllowedError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-index-term-domexception-interface-3\"><code>DOMException</code></a>."
        },
        {
          "html": "Let <var>requests</var> be <var>options</var>'s <a data-link-type=\"idl\" href=\"https://www.w3.org/TR/digital-credentials/#dom-credentialcreationoptions-digital\" class=\"internalDFN\" id=\"ref-for-dom-credentialcreationoptions-digital-2\"><code>digital</code></a>'s\n      <a data-link-type=\"idl\" href=\"https://www.w3.org/TR/digital-credentials/#dom-digitalcredentialcreationoptions-requests\" class=\"internalDFN\" id=\"ref-for-dom-digitalcredentialcreationoptions-requests-2\"><code>requests</code></a> member."
        },
        {
          "html": "If <var>requests</var> is <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-index-term-is-empty-for-list-2\">is empty</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-8\">a promise rejected with</a> a <a data-link-type=\"exception\" data-lt=\"TypeError\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-index-term-typeerror-exception-2\"><code>TypeError</code></a>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-index-term-for-each-for-list-2\">For each</a> <var>request</var> of <var>requests</var>:",
          "rationale": "serialize",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" data-lt=\"serialize a JavaScript value to a JSON string\" href=\"https://infra.spec.whatwg.org/#serialize-a-javascript-value-to-a-json-string\" id=\"ref-for-index-term-serialize-a-javascript-value-to-a-json-string-2\">Serialize</a>\n          <var>request</var>'s <a data-link-type=\"idl\" href=\"https://www.w3.org/TR/digital-credentials/#dom-digitalcredentialgetrequest-data\" class=\"internalDFN\" id=\"ref-for-dom-digitalcredentialgetrequest-data-3\"><code>data</code></a> to a JSON string."
            },
            {
              "html": "If serialization results in an <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-exception\" id=\"ref-for-index-term-exception-3\">exception</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-9\">a promise rejected with</a> that <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-exception\" id=\"ref-for-index-term-exception-4\">exception</a>."
            }
          ]
        },
        {
          "html": "If <var>global</var> does not have <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#transient-activation\" id=\"ref-for-index-term-transient-activation-3\">transient activation</a>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-index-term-a-promise-rejected-with-10\">a promise rejected with</a> a \"<a data-link-type=\"exception\" href=\"https://webidl.spec.whatwg.org/#notallowederror\" id=\"ref-for-index-term-notallowederror-exception-4\"><code>NotAllowedError</code></a>\" <a data-link-type=\"interface\" data-lt=\"DOMException\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-index-term-domexception-interface-4\"><code>DOMException</code></a>."
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/interaction.html#consume-user-activation\" id=\"ref-for-index-term-consume-user-activation-2\">Consume user activation</a> of <var>global</var>."
        },
        {
          "html": "Let <var>promise</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-new-promise\" id=\"ref-for-index-term-a-new-promise-2\">a new promise</a>."
        },
        {
          "html": "<a data-link-type=\"dfn|abstract-op\" href=\"https://www.w3.org/TR/digital-credentials/#dfn-prepare-credential-requests\" class=\"internalDFN\" id=\"ref-for-dfn-prepare-credential-requests-2\">Prepare credential requests</a> with\n      <var>document</var>, <var>requests</var>, <var>promise</var>, and <var>signal</var>."
        },
        {
          "html": "Return <var>promise</var>."
        }
      ]
    }
  ]
}