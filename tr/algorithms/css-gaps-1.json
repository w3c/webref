{
  "spec": {
    "title": "CSS Gap Decorations Module Level 1",
    "url": "https://www.w3.org/TR/css-gaps-1/"
  },
  "algorithms": [
    {
      "name": "create segment endpoints",
      "href": "https://www.w3.org/TR/css-gaps-1/#create-segment-endpoints",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"create-segment-endpoints\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create segment endpoints</dfn> for a gap <var>G</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Bounds of a Gap:\n\t\t\t\t\n      <p>Create endpoints at <var>G</var>’s two bounds:\n\t\t\t\t</p>\n      <ul>\n       <li>At the centerpoint of <var>G</var>’s start edge, create a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#start-segment-endpoint\" id=\"ref-for-start-segment-endpoint\">start segment endpoint</a>.\n\t\t\t\t\t\n       </li><li>At the centerpoint of <var>G</var>’s end edge, create an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#end-segment-endpoint\" id=\"ref-for-end-segment-endpoint\">end segment endpoint</a>.\n\t\t\t\t\n      </li></ul>"
        },
        {
          "html": "Within a Gap:\n\t\t\t\t\n      <p>A <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"gap-junction\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">gap junction</dfn> is a region of <var>G</var>\n\t\t\t\twhere one or more <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap\" id=\"ref-for-gap⑨\">gaps</a> abut or overlap <var>G</var>.\n\t\t\t\tTwo <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#segment-endpoint\" id=\"ref-for-segment-endpoint\">segment endpoints</a> are created for each <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap-junction\" id=\"ref-for-gap-junction\">gap junction</a>:\n\t\t\t\t</p>\n      <ul>\n       <li>Entering a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap-junction\" id=\"ref-for-gap-junction①\">gap junction</a>: At the point where a cross gap appears on at least one side of <var>G</var>, create an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#end-segment-endpoint\" id=\"ref-for-end-segment-endpoint①\">end segment endpoint</a>.\n\t\t\t\t\t\n       </li><li>Exiting a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap-junction\" id=\"ref-for-gap-junction②\">gap junction</a>: At the point where no cross gap exists on either side of <var>G</var>, create a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#start-segment-endpoint\" id=\"ref-for-start-segment-endpoint①\">start segment endpoint</a>.\n\t\t\t\t\n      </li></ul>"
        }
      ]
    },
    {
      "name": "determine gap decoration segments",
      "href": "https://www.w3.org/TR/css-gaps-1/#determine-gap-decoration-segments",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"determine-gap-decoration-segments\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">determine gap decoration segments</dfn> for a given <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap\" id=\"ref-for-gap①④\">gap</a> <var>G</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Let <var>S</var> be an empty list."
        },
        {
          "html": "Let <var>endpoints</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#create-segment-endpoints\" id=\"ref-for-create-segment-endpoints\">creating segment endpoints</a> for <var>G</var>,\n\t\t\t\tordered by their position along <var>G</var>’s centerline from start to end."
        },
        {
          "html": "If <var>endpoints</var> is empty, return <var>S</var>."
        },
        {
          "html": "Let <var>break</var> be the used value of either <a class=\"css property\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-gaps-1/#propdef-column-rule-break\" id=\"ref-for-propdef-column-rule-break\">column-rule-break</a> or <a class=\"css property\" data-link-type=\"property\" href=\"https://www.w3.org/TR/css-gaps-1/#propdef-row-rule-break\" id=\"ref-for-propdef-row-rule-break\">row-rule-break</a>, whichever applies to the gap."
        },
        {
          "html": "If <var>break</var> is <a class=\"css\" data-link-type=\"maybe\" href=\"https://www.w3.org/TR/css-gaps-1/#valdef-column-rule-break-none\" id=\"ref-for-valdef-column-rule-break-none\">none</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>first</var> be the first item in <var>endpoints</var>."
            },
            {
              "html": "Let <var>last</var> be the last item in <var>endpoints</var>."
            },
            {
              "html": "Create a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap-decoration-segment\" id=\"ref-for-gap-decoration-segment⑤\">gap decoration segment</a> <var>segment</var> = [<var>first</var>, <var>last</var>]."
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#apply-offsets-to-a-segment\" id=\"ref-for-apply-offsets-to-a-segment\">Apply offsets to</a> <var>segment</var>, then append it to <var>S</var>."
            },
            {
              "html": "Return <var>S</var>."
            }
          ]
        },
        {
          "html": "<em>Empty Check:</em> If <var>endpoints</var> is empty, return <var>S</var>."
        },
        {
          "html": "Create a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap-decoration-segment\" id=\"ref-for-gap-decoration-segment⑥\">gap decoration segment</a> <var>s</var> from the first two items in <var>endpoints</var>. Remove them both from the list."
        },
        {
          "html": "If <var>s</var>’s endpoints are <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#discontiguous\" id=\"ref-for-discontiguous\">discontiguous</a>, go back to <em>Empty Check</em>."
        },
        {
          "html": "While <var>endpoints</var> is not empty:",
          "rationale": "create",
          "steps": [
            {
              "html": "Create a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#gap-decoration-segment\" id=\"ref-for-gap-decoration-segment⑦\">gap decoration segment</a> <var>next</var> from the first two items in <var>endpoints</var>, leaving them both in the list."
            },
            {
              "html": "Let <var>candidate</var> be <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#union\" id=\"ref-for-union\">UNION</a>(<var>s</var>, <var>next</var>)."
            },
            {
              "html": "If <var>candidate</var>’s endpoints are <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#discontiguous\" id=\"ref-for-discontiguous①\">discontiguous</a>, exit this loop."
            },
            {
              "html": "If <var>break</var> is <a class=\"css\" data-link-type=\"maybe\" href=\"https://www.w3.org/TR/css-gaps-1/#valdef-column-rule-break-intersection\" id=\"ref-for-valdef-column-rule-break-intersection\">intersection</a> and <var>candidate</var> is not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#flanked-by-spanning-items\" id=\"ref-for-flanked-by-spanning-items\">flanked by spanning items</a>, exit this loop."
            },
            {
              "html": "Remove the first two items from <var>endpoints</var>."
            },
            {
              "html": "Set <var>s</var> to <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#union\" id=\"ref-for-union①\">UNION</a>(<var>s</var>, <var>next</var>)."
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#apply-offsets-to-a-segment\" id=\"ref-for-apply-offsets-to-a-segment①\">Apply offsets to</a> <var>s</var>, then append it to <var>S</var>."
        },
        {
          "html": "Go back to <em>Empty Check</em>."
        }
      ]
    },
    {
      "name": "apply offsets to a segment",
      "href": "https://www.w3.org/TR/css-gaps-1/#apply-offsets-to-a-segment",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"apply-offsets-to-a-segment\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">apply offsets to a segment</dfn> <var>s</var> = [<var>start</var>, <var>end</var>]:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Offset <var>start</var> by the used value of the applicable <a href=\"https://www.w3.org/TR/css-gaps-1/#inset\">rule-inset</a> property."
        },
        {
          "html": "Offset <var>end</var> by the used value of the applicable <a href=\"https://www.w3.org/TR/css-gaps-1/#inset\">rule-inset</a> property."
        },
        {
          "html": "Update <var>s</var> with the adjusted [<var>start</var>, <var>end</var>]."
        }
      ]
    },
    {
      "html": "Omitted values are filled in as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "If the interior values are omitted, they are copied from the edge values."
        },
        {
          "html": "Any omitted end value is copied from the corresponding start value."
        }
      ]
    },
    {
      "name": "assign gap decoration values",
      "href": "https://www.w3.org/TR/css-gaps-1/#assign-gap-decoration-values",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"assign-gap-decoration-values\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">assign gap decoration values</dfn> to a list of <var>gaps</var> using a list of <var>values</var>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Replace any <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#integer-repeater\" id=\"ref-for-integer-repeater①\">integer repeaters</a> in <var>values</var> with their expanded-out equivalents."
        },
        {
          "html": "If the list contains no <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater②\">auto repeater</a>, then:",
          "rationale": "end",
          "steps": [
            {
              "html": "Beginning from the first item in <var>values</var> and the first item in <var>gaps</var>,\n\t\t\t\t\t\tassign each value to the corresponding gap.\n\t\t\t\t\t\tIf there are fewer values than gaps,\n\t\t\t\t\t\trepeat beginning from the first item in <var>values</var>,\n\t\t\t\t\t\tas many times as needed."
            },
            {
              "html": "End this algorithm."
            }
          ]
        },
        {
          "html": "<var>values</var> contains an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater③\">auto repeater</a>.\n\t\t\t\tLet <var>leading count</var> be the number of items in <var>values</var> before the <span id=\"ref-for-auto-repeater④\">auto repeater</span>.\n\t\t\t\tLet <var>trailing count</var> be the number of items in <var>values</var> after the <span id=\"ref-for-auto-repeater⑤\">auto repeater</span>."
        },
        {
          "html": "Partition <var>gaps</var> as follows:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>leading gaps</var> contain the first <var>leading count</var> items in <var>gaps</var>."
            },
            {
              "html": "Let <var>trailing gaps</var> contain the last <var>trailing count</var> items in <var>gaps</var>,\n\t\t\t\t\t\texcluding any items in <var>leading gaps</var>."
            },
            {
              "html": "Let <var>auto gaps</var> contain any items in <var>gaps</var>\n\t\t\t\t\t\tthat are not in either <var>leading gaps</var> or <var>trailing gaps</var>."
            }
          ]
        },
        {
          "html": "If <var>leading gaps</var> is non-empty,\n\t\t\t\t<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#assign-gap-decoration-values\" id=\"ref-for-assign-gap-decoration-values①\">assign gap decoration values</a> to <var>leading gaps</var>\n\t\t\t\tusing the first <var>leading count</var> items in <var>values</var>."
        },
        {
          "html": "If <var>trailing gaps</var> is non-empty,\n\t\t\t\t<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#assign-gap-decoration-values\" id=\"ref-for-assign-gap-decoration-values②\">assign gap decoration values</a> to <var>trailing gaps</var>\n\t\t\t\tusing the first <var>trailing count</var> items in <var>values</var>."
        },
        {
          "html": "If <var>auto gaps</var> is non-empty,\n\t\t\t\t<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#assign-gap-decoration-values\" id=\"ref-for-assign-gap-decoration-values③\">assign gap decoration values</a> to <var>auto gaps</var>\n\t\t\t\tusing the list of values in the second argument of the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater⑥\">auto repeater</a>."
        }
      ]
    },
    {
      "name": "interpolate with auto repeaters",
      "html": "When either of the lists we are interpolating between (<var>from</var> and <var>to</var>) include an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater⑦\">auto repeater</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "Split each of <var>from</var> and <var>to</var> into segments, similar to how we <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#assign-gap-decoration-values\" id=\"ref-for-assign-gap-decoration-values④\">assign gap decoration values</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "Let <var>leading values</var> be the values before the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater⑧\">auto repeater</a>."
            },
            {
              "html": "Let <var>trailing values</var> be the values after the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater⑨\">auto repeater</a>."
            },
            {
              "html": "Let <var>auto values</var> be the values inside the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater①⓪\">auto repeater</a>."
            }
          ]
        },
        {
          "html": "If only one of <var>from</var> or <var>to</var> contains an auto-repeater, we fall back to <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/web-animations-1/#discrete\" id=\"ref-for-discrete\">discrete</a> interpolation."
        },
        {
          "html": "Expand any integer repeaters on each segment."
        },
        {
          "html": "If the length of <var>leading values</var> in <var>from</var> and <var>leading values</var> in <var>to</var> don’t match, we fall back to <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/web-animations-1/#discrete\" id=\"ref-for-discrete①\">discrete</a> interpolation.\n\t\t\t\t\tIf the length of <var>trailing values</var> in <var>from</var> and <var>trailing values</var> in <var>to</var> don’t match, we fall back to <span id=\"ref-for-discrete②\">discrete</span> interpolation."
        },
        {
          "html": "When both <var>from</var> and <var>to</var> contain auto-repeaters, and the length of their segments match as described above,\n\t\t\t\t\tapply <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/web-animations-1/#repeatable-list\" id=\"ref-for-repeatable-list①\">repeatable list</a> interpolation to the lists of values in each <var>auto values</var>."
        }
      ]
    },
    {
      "name": "repeater aligned",
      "href": "https://www.w3.org/TR/css-gaps-1/#repeater-aligned",
      "html": "Let <var>W</var>, <var>S</var> and <var>C</var> be the values for the width, style, and color\n\t\tlonghand properties respectively. Recall that each is a list of\n\t\titems, where an item is either a single value or a <a class=\"css\" data-link-type=\"maybe\" href=\"https://www.w3.org/TR/css-gaps-1/#funcdef-repeat-line-color-repeat\" id=\"ref-for-funcdef-repeat-line-color-repeat⑦\">repeat()</a> notation.\n\t\tThe longhand properties are <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"repeater-aligned\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">repeater aligned</dfn>\n\t\tif and only if all of the following are true:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<var>W</var>, <var>S</var> and <var>C</var> all have the same number of items."
        },
        {
          "html": "For each item index <var>i</var>, <var>W</var>[<var>i</var>], <var>S</var>[<var>i</var>] and <var>C</var>[<var>i</var>] all have the same shape:",
          "rationale": "if",
          "steps": [
            {
              "html": "they are either all non-repeat values, all <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#integer-repeater\" id=\"ref-for-integer-repeater③\">integer repeaters</a>, or all <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#auto-repeater\" id=\"ref-for-auto-repeater①②\">auto repeaters</a>."
            },
            {
              "html": "If they are <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/css-gaps-1/#integer-repeater\" id=\"ref-for-integer-repeater④\">integer repeaters</a>, the <a class=\"css production\" data-link-type=\"type\" href=\"https://www.w3.org/TR/css-values-4/#integer-value\" id=\"ref-for-integer-value⑥\">&lt;integer&gt;</a> values are equal."
            },
            {
              "html": "Each <a class=\"css\" data-link-type=\"maybe\" href=\"https://www.w3.org/TR/css-gaps-1/#funcdef-repeat-line-color-repeat\" id=\"ref-for-funcdef-repeat-line-color-repeat⑧\">repeat()</a> notation contains the same number of values."
            }
          ]
        }
      ]
    }
  ]
}