{
  "spec": {
    "title": "Content Security Policy Level 3",
    "url": "https://www.w3.org/TR/CSP3/"
  },
  "algorithms": [
    {
      "name": "parse a serialized CSP",
      "href": "https://www.w3.org/TR/CSP3/#abstract-opdef-parse-a-serialized-csp",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"abstract-op\" data-export=\"\" id=\"abstract-opdef-parse-a-serialized-csp\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">parse a serialized CSP</dfn>, given a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence\">byte sequence</a> or <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string\">string</a> <var>serialized</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-source\" id=\"ref-for-policy-source①\">source</a> <var>source</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition\">disposition</a> <var>disposition</var>, execute the following steps.",
      "rationale": "To <dfn>"
    },
    {
      "html": "This algorithm returns a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③\">Content Security Policy object</a>. If <var>serialized</var> could not be\n  parsed, the object’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set\">directive set</a> will be empty.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>serialized</var> is a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence①\">byte sequence</a>, then set <var>serialized</var> to be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#isomorphic-decode\" id=\"ref-for-isomorphic-decode\">isomorphic decoding</a> <var>serialized</var>.</p>"
        },
        {
          "html": "<p>Let <var>policy</var> be a new <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④\">policy</a> with an empty <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set①\">directive set</a>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-source\" id=\"ref-for-policy-source②\">source</a> of <var>source</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①\">disposition</a> of <var>disposition</var>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate\">For each</a> <var>token</var> returned by <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#strictly-split\" id=\"ref-for-strictly-split\">strictly splitting</a> <var>serialized</var> on\n  the U+003B SEMICOLON character (<code>;</code>):",
          "rationale": "strip",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace\" id=\"ref-for-strip-leading-and-trailing-ascii-whitespace\">Strip leading and trailing ASCII whitespace</a> from <var>token</var>.</p>"
            },
            {
              "html": "<p>If <var>token</var> is an empty string, or if <var>token</var> is not an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-string\" id=\"ref-for-ascii-string②\">ASCII string</a>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue\">continue</a>.</p>"
            },
            {
              "html": "<p>Let <var>directive name</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points\" id=\"ref-for-collect-a-sequence-of-code-points\">collecting a sequence of code points</a> from <var>token</var> which are not <a data-link-type=\"dfn\" data-refhint-key=\"https://infra.spec.whatwg.org/#ascii-whitespace\" href=\"https://infra.spec.whatwg.org/#ascii-whitespace\" id=\"ref-for-ascii-whitespace①\">ASCII whitespace</a>.</p>"
            },
            {
              "html": "<p>Set <var>directive name</var> to be the result of running <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-lowercase\" id=\"ref-for-ascii-lowercase\">ASCII lowercase</a> on <var>directive name</var>.</p>"
            },
            {
              "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set②\">directive set</a> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name\">name</a> is <var>directive name</var>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue①\">continue</a>.</p>"
            },
            {
              "html": "<p>Let <var>directive value</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#split-on-ascii-whitespace\" id=\"ref-for-split-on-ascii-whitespace\">splitting <var>token</var> on\n  ASCII whitespace</a>.</p>"
            },
            {
              "html": "<p>Let <var>directive</var> be a new <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①\">name</a> is <var>directive name</var>, and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value\">value</a> is <var>directive value</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#set-append\" id=\"ref-for-set-append\">Append</a> <var>directive</var> to <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set③\">directive set</a>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>policy</var>.</p>"
        }
      ]
    },
    {
      "name": "parse a response’s Content Security Policies",
      "href": "https://www.w3.org/TR/CSP3/#abstract-opdef-parse-a-responses-content-security-policies",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"abstract-op\" data-export=\"\" id=\"abstract-opdef-parse-a-responses-content-security-policies\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">parse a response’s Content Security Policies</dfn> given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response\">response</a> <var>response</var>, execute the following steps.",
      "rationale": "To <dfn>"
    },
    {
      "html": "This algorithm returns a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list①\">list</a> of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤\">Content Security Policy objects</a>. If the policies cannot\n  be parsed, the returned list will be empty.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>policies</var> be an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list\" id=\"ref-for-list②\">list</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①\">For each</a> <var>token</var> returned by <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#extract-header-list-values\" id=\"ref-for-extract-header-list-values\">extracting header list values</a> given <code>Content-Security-Policy</code> and <var>response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-header-list\" id=\"ref-for-concept-response-header-list\">header list</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>policy</var> be the result of <a data-link-type=\"abstract-op\" href=\"https://www.w3.org/TR/CSP3/#abstract-opdef-parse-a-serialized-csp\" id=\"ref-for-abstract-opdef-parse-a-serialized-csp\">parsing</a> <var>token</var>, with a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-source\" id=\"ref-for-policy-source③\">source</a> of \"<code>header</code>\", and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition②\">disposition</a> of \"<code>enforce</code>\".</p>"
            },
            {
              "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set④\">directive set</a> is not empty, append <var>policy</var> to <var>policies</var>.</p>"
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②\">For each</a> <var>token</var> returned by <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#extract-header-list-values\" id=\"ref-for-extract-header-list-values①\">extracting header list values</a> given <code>Content-Security-Policy-Report-Only</code> and <var>response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-header-list\" id=\"ref-for-concept-response-header-list①\">header list</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>policy</var> be the result of <a data-link-type=\"abstract-op\" href=\"https://www.w3.org/TR/CSP3/#abstract-opdef-parse-a-serialized-csp\" id=\"ref-for-abstract-opdef-parse-a-serialized-csp①\">parsing</a> <var>token</var>, with a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-source\" id=\"ref-for-policy-source④\">source</a> of \"<code>header</code>\", and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition③\">disposition</a> of \"<code>report</code>\".</p>"
            },
            {
              "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set⑤\">directive set</a> is not empty, append <var>policy</var> to <var>policies</var>.</p>"
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③\">For each</a> <var>policy</var> of <var>policies</var>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-self-origin\" id=\"ref-for-policy-self-origin\">self-origin</a> to <var>response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-url\" id=\"ref-for-concept-response-url\">url</a>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-origin\" id=\"ref-for-concept-url-origin\">origin</a>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>policies</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object③\">global object</a> <var>global</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object①⑧\">policy</a> <var>policy</var>, and a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string⑤\">string</a> <var>directive</var>, the following algorithm creates a new <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation\" id=\"ref-for-violation①⑧\">violation</a> object, and populates it with an initial set of data:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>violation</var> be a new <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation\" id=\"ref-for-violation①⑨\">violation</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object①\">global\n  object</a> is <var>global</var>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy\">policy</a> is <var>policy</var>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-effective-directive\" id=\"ref-for-violation-effective-directive\">effective directive</a> is <var>directive</var>, and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource③\">resource</a> is null.</p>"
        },
        {
          "html": "<p>If the user agent is currently executing script, and can extract a source\n  file’s URL, line number, and column number from the <var>global</var>, set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file\">source file</a>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-line-number\" id=\"ref-for-violation-line-number\">line\n  number</a>, and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-column-number\" id=\"ref-for-violation-column-number\">column number</a> accordingly.</p>"
        },
        {
          "html": "<p>If <var>global</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window\">Window</a></code> object, set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-referrer\" id=\"ref-for-violation-referrer\">referrer</a> to <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window\">document</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer\" id=\"ref-for-dom-document-referrer\">referrer</a></code>.</p>"
        },
        {
          "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-status\" id=\"ref-for-violation-status\">status</a> to the HTTP status code\n  for the resource associated with <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object②\">global\n  object</a>.</p>"
        },
        {
          "html": "<p>Return <var>violation</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object①⑨\">policy</a> <var>policy</var>,\n  the following algorithm creates a new <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation\" id=\"ref-for-violation②⓪\">violation</a> object,\n  and populates it with an initial set of data:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>directive</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>Let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client\">client</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global\" id=\"ref-for-concept-settings-object-global\">global object</a>, <var>policy</var>, and <var>directive</var>.</p>"
        },
        {
          "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource④\">resource</a> to <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-url\" id=\"ref-for-concept-request-url\">url</a>.</p>"
        },
        {
          "html": "<p>Return <var>violation</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑧\">request</a> <var>request</var>, this algorithm reports violations based\n  on <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list\">CSP list</a> \"report only\" policies.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container①\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list①\">CSP list</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate④\">For each</a> <var>policy</var> of <var>CSP list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition⑤\">disposition</a> is \"<code>enforce</code>\",\n  then skip to the next <var>policy</var>.</p>"
            },
            {
              "html": "<p>Let <var>violates</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#does-request-violate-policy\">§ 6.7.2.1 Does request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>"
            },
            {
              "html": "<p>If <var>violates</var> is not \"<code>Does Not Violate</code>\", then execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-request\">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑨\">request</a> <var>request</var>, this algorithm returns <code>Blocked</code> or <code>Allowed</code> and\n  reports violations based on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container②\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list②\">CSP list</a>.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container③\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list③\">CSP list</a>.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑤\">For each</a> <var>policy</var> of <var>CSP list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition⑥\">disposition</a> is \"<code>report</code>\",\n  then skip to the next <var>policy</var>.</p>"
            },
            {
              "html": "<p>Let <var>violates</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#does-request-violate-policy\">§ 6.7.2.1 Does request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>"
            },
            {
              "html": "If <var>violates</var> is not \"<code>Does Not Violate</code>\", then:",
              "rationale": "execute",
              "steps": [
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-request\">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>"
                },
                {
                  "html": "<p>Set <var>result</var> to \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response⑤\">response</a> <var>response</var> and a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request①⓪\">request</a> <var>request</var>, this algorithm\n  returns <code>Blocked</code> or <code>Allowed</code>, and reports violations based on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container④\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list④\">CSP list</a>.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container⑤\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list⑤\">CSP list</a>.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑥\">For each</a> <var>policy</var> of <var>CSP list</var>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑦\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "If the result of executing <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-post-request-check\" id=\"ref-for-directive-post-request-check①\">post-request check</a> is \"<code>Blocked</code>\", then:",
                  "rationale": "execute",
                  "steps": [
                    {
                      "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-request\">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>"
                    },
                    {
                      "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition⑦\">disposition</a> is \"<code>enforce</code>\",\n  then set <var>result</var> to \"<code>Blocked</code>\".</p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response⑥\">response</a> <var>response</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request①①\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives⑧\">directive</a> <var>directive</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object②②\">content security policy object</a> <var>policy</var>, run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>algorithm</var> be the empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string⑥\">string</a>.</p>"
        },
        {
          "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④\">value</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain①\">contains</a> the\n  expression \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-report-sha256\" id=\"ref-for-grammardef-report-sha256\"><code>'report-sha256'</code></a>\", set <var>algorithm</var> to \"sha256\".</p>"
        },
        {
          "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤\">value</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain②\">contains</a> the\n  expression \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-report-sha384\" id=\"ref-for-grammardef-report-sha384\"><code>'report-sha384'</code></a>\", set <var>algorithm</var> to \"sha384\".</p>"
        },
        {
          "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥\">value</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain③\">contains</a> the\n  expression \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-report-sha512\" id=\"ref-for-grammardef-report-sha512\"><code>'report-sha512'</code></a>\", set <var>algorithm</var> to \"sha512\".</p>"
        },
        {
          "html": "<p>If <var>algorithm</var> is the empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string⑦\">string</a>, return.</p>"
        },
        {
          "html": "<p>Let <var>hash</var> be the empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string⑧\">string</a>.</p>"
        },
        {
          "html": "If <var>response</var> is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-same-origin\" id=\"ref-for-cors-same-origin\">CORS-same-origin</a>, then:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>h</var> be the result of <a data-link-type=\"dfn\" href=\"https://w3c.github.io/webappsec-subresource-integrity#apply-algorithm-to-response\" id=\"ref-for-apply-algorithm-to-response\">applying algorithm to bytes</a> on <var>response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-body\" id=\"ref-for-concept-response-body\">body</a> and <var>algorithm</var>.</p>"
            },
            {
              "html": "<p>Let <var>hash</var> be the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-concatenate\" id=\"ref-for-string-concatenate\">concatenation</a> of <var>algorithm</var>, U+2D (-), and <var>h</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>global</var> be the <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client①\">client</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object④\">global object</a>.</p>"
        },
        {
          "html": "<p>If <var>global</var> is not a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window①\">Window</a></code>, return.</p>"
        },
        {
          "html": "<p>Let <var>stripped document URL</var> to be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window①\">document</a>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-document-url\" id=\"ref-for-concept-document-url\">URL</a>.</p>"
        },
        {
          "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set⑦\">directive set</a> does not contain a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives⑨\">directive</a> named \"report-to\", return.</p>"
        },
        {
          "html": "<p>Let <var>report-to directive</var> be a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①⓪\">directive</a> named \"report-to\" from <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set⑧\">directive set</a>.</p>"
        },
        {
          "html": "<p>Let <var>body</var> be a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-hash-report-body\" id=\"ref-for-csp-hash-report-body\">csp hash report body</a> with <var>stripped document URL</var> as its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-hash-report-body-documenturl\" id=\"ref-for-csp-hash-report-body-documenturl\">documentURL</a>, <var>request</var>’s URL as its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-hash-report-body-subresourceurl\" id=\"ref-for-csp-hash-report-body-subresourceurl\">subresourceURL</a>, <var>hash</var> as its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-hash-report-body-hash\" id=\"ref-for-csp-hash-report-body-hash\">hash</a>, <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination\">destination</a> as its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-hash-report-body-destination\" id=\"ref-for-csp-hash-report-body-destination\">destination</a>, and \"subresource\" as its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-hash-report-body-type\" id=\"ref-for-csp-hash-report-body-type\">type</a>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/reporting-1/#generate-and-queue-a-report\" id=\"ref-for-generate-and-queue-a-report\">Generate and queue a report</a> with the following arguments:</p>\n      <dl>\n       <dt data-md=\"\"><var>context</var>\n       </dt><dd data-md=\"\">\n        <p><var>settings object</var></p>\n       </dd><dt data-md=\"\"><var>type</var>\n       </dt><dd data-md=\"\">\n        <p>\"csp-hash\"</p>\n       </dd><dt data-md=\"\"><var>destination</var>\n       </dt><dd data-md=\"\">\n        <p><var>report-to directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑦\">value</a>.</p>\n       </dd><dt data-md=\"\"><var>data</var>\n       </dt><dd data-md=\"\">\n        <p><var>body</var></p>\n      </dd></dl>"
        }
      ]
    },
    {
      "html": "Given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document④\">Document</a></code> <var>document</var>, the user agent performs the following\n  steps in order to initialize CSP for <var>document</var>:",
      "rationale": "for",
      "steps": [
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑧\">For each</a> <var>policy</var> of <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container\" id=\"ref-for-concept-document-policy-container\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list⑦\">CSP list</a>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate⑨\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "execute",
              "steps": [
                {
                  "html": "<p>Execute <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-initialization\" id=\"ref-for-directive-initialization\">initialization</a> algorithm on <var>document</var>, and assert: its returned value is\n  \"<code>Allowed</code>\".</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "To obtain <var>object</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list②\">CSP list</a>:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>object</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document⑤\">Document</a></code> return <var>object</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/dom.html#concept-document-policy-container\" id=\"ref-for-concept-document-policy-container①\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list⑧\">CSP list</a>.</p>"
        },
        {
          "html": "<p>If <var>object</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window②\">Window</a></code> or a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope\" id=\"ref-for-workerglobalscope①\">WorkerGlobalScope</a></code> or a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope\" id=\"ref-for-workletglobalscope①\">WorkletGlobalScope</a></code>,\n  return <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object\" id=\"ref-for-environment-settings-object①\">environment settings object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container\" id=\"ref-for-concept-settings-object-policy-container\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list⑨\">CSP list</a>.</p>"
        },
        {
          "html": "<p>Return null.</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element①\">Element</a></code> <var>element</var>, a string <var>type</var>, and a string <var>source</var> this algorithm returns \"<code>Allowed</code>\" if the element is allowed to have inline\n  definition of a particular type of behavior (script execution, style\n  application, event handlers, etc.), and \"<code>Blocked</code>\" otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>element</var> is not null.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⓪\">For each</a> <var>policy</var> of <var>element</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document⑥\">Document</a></code>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object⑨\">global object</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list③\">CSP list</a>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①①\">For each</a> <var>directive</var> of <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set⑨\">directive set</a>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-inline-check\" id=\"ref-for-directive-inline-check\">inline check</a> returns\n  \"<code>Allowed</code>\" when executed upon <var>element</var>, <var>type</var>, <var>policy</var> and <var>source</var>,\n  skip to the next <var>directive</var>.</p>"
                },
                {
                  "html": "<p>Let <var>directive-name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
                },
                {
                  "html": "<p>Otherwise, let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object\" id=\"ref-for-current-settings-object\">current settings\n  object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global\" id=\"ref-for-concept-settings-object-global①\">global object</a>, <var>policy</var>,\n  and <var>directive-name</var>.</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource⑤\">resource</a> to \"<code>inline</code>\".</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-element\" id=\"ref-for-violation-element\">element</a> to <var>element</var>.</p>"
                },
                {
                  "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑧\">value</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain④\">contains</a> the\n  expression \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-report-sample\" id=\"ref-for-grammardef-report-sample①\"><code>'report-sample'</code></a>\", then set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-sample\" id=\"ref-for-violation-sample②\">sample</a> to the substring of <var>source</var> containing its first 40\n  characters.</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition⑧\">disposition</a> is \"<code>enforce</code>\", then\n  set <var>result</var> to \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request①③\">request</a> <var>navigation request</var> and a string <var>type</var> (either\n  \"<code>form-submission</code>\" or \"<code>other</code>\"), this algorithm return \"<code>Blocked</code>\" if the active policy blocks\n  the navigation, and \"<code>Allowed</code>\" otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①②\">For each</a> <var>policy</var> of <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container⑥\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list①⓪\">CSP list</a>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①③\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-pre-navigation-check\" id=\"ref-for-directive-pre-navigation-check\">pre-navigation check</a> returns \"<code>Allowed</code>\" when executed upon <var>navigation request</var>, <var>type</var>, and <var>policy</var> skip to the next <var>directive</var>.</p>"
                },
                {
                  "html": "<p>Otherwise, let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client②\">client</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global\" id=\"ref-for-concept-settings-object-global②\">global object</a>, <var>policy</var>, and <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name③\">name</a>.</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource⑥\">resource</a> to <var>navigation\n  request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-url\" id=\"ref-for-concept-request-url②\">URL</a>.</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition⑨\">disposition</a> is \"<code>enforce</code>\", then\n  set <var>result</var> to \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "If <var>result</var> is \"<code>Allowed</code>\", and if <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-current-url\" id=\"ref-for-concept-request-current-url①\">current URL</a>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme\">scheme</a> is <code>javascript</code>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①④\">For each</a> <var>policy</var> of <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container⑦\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list①①\">CSP list</a>:",
              "rationale": "for",
              "steps": [
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⑤\">For each</a> <var>directive</var> of <var>policy</var>:",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>directive-name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on \"<code>navigation</code>\".</p>"
                    },
                    {
                      "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-inline-check\" id=\"ref-for-directive-inline-check①\">inline check</a> returns \"<code>Allowed</code>\" when executed upon null,\n  \"<code>navigation</code>\" and <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-current-url\" id=\"ref-for-concept-request-current-url②\">current URL</a>,\n  skip to the next <var>directive</var>.</p>"
                    },
                    {
                      "html": "<p>Otherwise, let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client③\">client</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global\" id=\"ref-for-concept-settings-object-global③\">global object</a>, <var>policy</var>, and <var>directive-name</var>.</p>"
                    },
                    {
                      "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource⑦\">resource</a> to \"<code>inline</code>\".</p>"
                    },
                    {
                      "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                    },
                    {
                      "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①⓪\">disposition</a> is \"<code>enforce</code>\", then\n  set <var>result</var> to \"<code>Blocked</code>\".</p>"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request①④\">request</a> <var>navigation request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response⑨\">response</a> <var>navigation\n  response</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#csp-list\" id=\"ref-for-csp-list①\">CSP list</a> <var>response CSP list</var>, a string <var>type</var> (either\n  \"<code>form-submission</code>\" or \"<code>other</code>\"), and a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/#navigable\" id=\"ref-for-navigable①\">navigable</a> <var>target</var>, this algorithm\n  returns \"<code>Blocked</code>\" if the active policy blocks the navigation, and \"<code>Allowed</code>\"\n  otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⑥\">For each</a> <var>policy</var> of <var>response CSP list</var>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⑦\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-navigation-response-check\" id=\"ref-for-directive-navigation-response-check\">navigation response check</a> returns \"<code>Allowed</code>\" when executed upon <var>navigation request</var>, <var>type</var>, <var>navigation response</var>, <var>target</var>, \"<code>response</code>\", and <var>policy</var> skip to the next <var>directive</var>.</p>"
                },
                {
                  "html": "<p>Otherwise, let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on null, <var>policy</var>, and <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name④\">name</a>.</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource⑧\">resource</a> to <var>navigation\n  response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-url\" id=\"ref-for-concept-response-url①\">URL</a>.</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①①\">disposition</a> is \"<code>enforce</code>\", then\n  set <var>result</var> to \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⑧\">For each</a> <var>policy</var> of <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container⑧\">policy container</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#policy-container-csp-list\" id=\"ref-for-policy-container-csp-list①②\">CSP list</a>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①⑨\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-navigation-response-check\" id=\"ref-for-directive-navigation-response-check①\">navigation response check</a> returns \"<code>Allowed</code>\" when executed upon <var>navigation request</var>, <var>type</var>, <var>navigation response</var>, <var>target</var>, \"<code>source</code>\", and <var>policy</var> skip to the next <var>directive</var>.</p>"
                },
                {
                  "html": "<p>Otherwise, let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>navigation request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client④\">client</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global\" id=\"ref-for-concept-settings-object-global④\">global object</a>, <var>policy</var>, and <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name⑤\">name</a>.</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource⑨\">resource</a> to <var>navigation\n  request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-url\" id=\"ref-for-concept-request-url③\">URL</a>.</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①②\">disposition</a> is \"<code>enforce</code>\", then\n  set <var>result</var> to \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object①⓪\">global object</a> <var>global</var>, the user agent performs the\n  following steps in order to initialize CSP for <var>global</var>. This algorithm\n  returns \"<code>Allowed</code>\" if <var>global</var> is allowed, and \"<code>Blocked</code>\" otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②⓪\">For each</a> <var>policy</var> of <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list④\">CSP list</a>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②①\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "execute",
              "steps": [
                {
                  "html": "<p>Execute <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-initialization\" id=\"ref-for-directive-initialization①\">initialization</a> algorithm on <var>global</var>. If its returned value is \"<code>Blocked</code>\", then set <var>result</var> to\n \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object①①\">global object</a> <var>global</var>, this algorithm returns \"<code>Blocked</code>\"\n  if the active policy for <var>global</var> blocks RTC connections, and \"<code>Allowed</code>\" otherwise:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②②\">For each</a> <var>policy</var> of <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list⑤\">CSP list</a>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②③\">For each</a> <var>directive</var> of <var>policy</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-webrtc-pre-connect-check\" id=\"ref-for-directive-webrtc-pre-connect-check\">webrtc pre-connect check</a> returns \"<code>Allowed</code>\", <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-continue\" id=\"ref-for-iteration-continue②\">continue</a>.</p>"
                },
                {
                  "html": "<p>Otherwise, let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>global</var>, <var>policy</var>, and <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name⑥\">name</a>.</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①⓪\">resource</a> to null.</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①③\">disposition</a> is \"<code>enforce</code>\", then\n  set <var>result</var> to \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>result</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://tc39.github.io/ecma262#realm\" id=\"ref-for-realm\">realm</a> <var>realm</var>, a list of strings <var>parameterStrings</var>, a string <var>bodyString</var>, a string <var>codeString</var>, an enum (<var>compilationType</var>),\n  a list of ECMAScript language values (<var>parameterArgs</var>), and an ECMAScript language value (<var>bodyArg</var>), this algorithm\n  returns normally if string compilation is allowed, and throws an \"<code>EvalError</code>\"\n  if not:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <var>compilationType</var> is \"<code>TIMER</code>\", then:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>sourceString</var> be <var>codeString</var>.</p>"
            }
          ]
        },
        {
          "html": "Else:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>compilationSink</var> be \"Function\" if <var>compilationType</var> is \"<code>FUNCTION</code>\", and \"eval\" otherwise.</p>"
            },
            {
              "html": "<p>Let <var>isTrusted</var> be <code>true</code> if <var>bodyArg</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#implements\" id=\"ref-for-implements\">implements</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript\" id=\"ref-for-trustedscript\">TrustedScript</a></code>, and <code>false</code> otherwise.</p>"
            },
            {
              "html": "If <var>isTrusted</var> is <code>true</code> then:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>bodyString</var> is not equal to <var>bodyArg</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript-data\" id=\"ref-for-trustedscript-data\">data</a>, set <var>isTrusted</var> to <code>false</code>.</p>"
                }
              ]
            },
            {
              "html": "If <var>isTrusted</var> is <code>true</code>, then:",
              "rationale": "assert",
              "steps": [
                {
                  "html": "<p class=\"assertion\">Assert: <var>parameterArgs</var>’ [list/size=] is equal to [parameterStrings]' <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size\">size</a>.</p>"
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②④\">For each</a> <var>index</var> of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#the-range\" id=\"ref-for-the-range\">the range</a> 0 to |parameterArgs]' [list/size=]:",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>arg</var> be <var>parameterArgs</var>[<var>index</var>].</p>"
                    },
                    {
                      "html": "If <var>arg</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#implements\" id=\"ref-for-implements①\">implements</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript\" id=\"ref-for-trustedscript①\">TrustedScript</a></code>, then:",
                      "rationale": "if",
                      "steps": [
                        {
                          "html": "<p>if <var>parameterStrings</var>[<var>index</var>] is not equal to <var>arg</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript-data\" id=\"ref-for-trustedscript-data①\">data</a>, set <var>isTrusted</var> to <code>false</code>.</p>"
                        }
                      ]
                    },
                    {
                      "html": "<p>Otherwise, set <var>isTrusted</var> to <code>false</code>.</p>"
                    }
                  ]
                }
              ]
            },
            {
              "html": "<p>Let <var>sourceToValidate</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript\" id=\"ref-for-trustedscript②\">TrustedScript</a></code> object created in <var>realm</var> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript-data\" id=\"ref-for-trustedscript-data②\">data</a> is set to <var>codeString</var> if <var>isTrusted</var> is <code>true</code>, and <var>codeString</var> otherwise.</p>"
            },
            {
              "html": "<p>Let <var>sourceString</var> be the result of executing the <a data-link-type=\"abstract-op\" href=\"https://www.w3.org/TR/trusted-types/#abstract-opdef-get-trusted-type-compliant-string\" id=\"ref-for-abstract-opdef-get-trusted-type-compliant-string\">Get Trusted Type compliant string</a> algorithm, with <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/trusted-types/#trustedscript\" id=\"ref-for-trustedscript③\">TrustedScript</a></code>, <var>realm</var>, <var>sourceToValidate</var>, <var>compilationSink</var>, and <code>'script'</code>.</p>"
            },
            {
              "html": "<p>If the algorithm throws an error, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-evalerror\" id=\"ref-for-exceptiondef-evalerror\">EvalError</a></code>.</p>"
            },
            {
              "html": "<p>If <var>sourceString</var> is not equal to <var>codeString</var>, throw an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-evalerror\" id=\"ref-for-exceptiondef-evalerror①\">EvalError</a></code>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Let <var>global</var> be <var>realm</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global\" id=\"ref-for-concept-realm-global\">global object</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②⑤\">For each</a> <var>policy</var> of <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list⑦\">CSP list</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>source-list</var> be null.</p>"
            },
            {
              "html": "<p>If <var>policy</var> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①①\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name⑦\">name</a> is \"<code>script-src</code>\", then\n  set <var>source-list</var> to that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①②\">directive</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑨\">value</a>.</p>\n        <p>Otherwise if <var>policy</var> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①③\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name⑧\">name</a> is\n  \"<code>default-src</code>\", then set <var>source-list</var> to that directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①⓪\">value</a>.</p>"
            },
            {
              "html": "If <var>source-list</var> is not null:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>trustedTypesRequired</var> be the result of executing <a data-link-type=\"abstract-op\" href=\"https://www.w3.org/TR/trusted-types/#abstract-opdef-does-sink-type-require-trusted-types\" id=\"ref-for-abstract-opdef-does-sink-type-require-trusted-types\">Does sink type require trusted types?</a>, with <var>realm</var>, <code>'script'</code>, and <code>false</code>.</p>"
                },
                {
                  "html": "<p>If <var>trustedTypesRequired</var> is <code>true</code> and <var>source-list</var> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression②\">source expression</a> which is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive①\">ASCII case-insensitive</a> match for the string \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-trusted-types-eval\" id=\"ref-for-grammardef-trusted-types-eval\"><code>'trusted-types-eval'</code></a>\", then skip the\n  following steps.</p>"
                },
                {
                  "html": "<p>If <var>source-list</var> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression③\">source expression</a> which is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②\">ASCII case-insensitive</a> match for the\n  string \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-unsafe-eval\" id=\"ref-for-grammardef-unsafe-eval\"><code>'unsafe-eval'</code></a>\", then skip the following steps.</p>"
                },
                {
                  "html": "<p>Let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>global</var>, <var>policy</var>, and \"<code>script-src</code>\".</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①①\">resource</a> to \"<code>eval</code>\".</p>"
                },
                {
                  "html": "<p>If <var>source-list</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain⑤\">contains</a> the expression\n  \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-report-sample\" id=\"ref-for-grammardef-report-sample②\"><code>'report-sample'</code></a>\", then set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-sample\" id=\"ref-for-violation-sample③\">sample</a> to\n  the substring of <var>sourceString</var> containing its first 40 characters.</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①④\">disposition</a> is \"<code>enforce</code>\", then set <var>result</var> to\n  \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>result</var> is \"<code>Blocked</code>\", throw an <code>EvalError</code> exception.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://tc39.github.io/ecma262#realm\" id=\"ref-for-realm①\">realm</a> <var>realm</var>,\nthis algorithm returns normally if compilation is allowed, and throws a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webassembly.github.io/spec/js-api/#exceptiondef-compileerror\" id=\"ref-for-exceptiondef-compileerror\">WebAssembly.CompileError</a></code> if not:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>global</var> be <var>realm</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-realm-global\" id=\"ref-for-concept-realm-global①\">global object</a>.</p>"
        },
        {
          "html": "<p>Let <var>result</var> be \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②⑥\">For each</a> <var>policy</var> of <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list⑨\">CSP list</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>source-list</var> be null.</p>"
            },
            {
              "html": "<p>If <var>policy</var> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①④\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name⑨\">name</a> is \"<code>script-src</code>\", then\n  set <var>source-list</var> to that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①⑤\">directive</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①①\">value</a>.</p>\n        <p>Otherwise if <var>policy</var> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①⑥\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①⓪\">name</a> is\n  \"<code>default-src</code>\", then set <var>source-list</var> to that directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①②\">value</a>.</p>"
            },
            {
              "html": "If <var>source-list</var> is non-null, and does not contain a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression④\">source expression</a> which is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive③\">ASCII case-insensitive</a> match for the\n  string \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-unsafe-eval\" id=\"ref-for-grammardef-unsafe-eval①\"><code>'unsafe-eval'</code></a>\", and does not contain a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression⑤\">source expression</a> which is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive④\">ASCII case-insensitive</a> match\n  for the string \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-wasm-unsafe-eval\" id=\"ref-for-grammardef-wasm-unsafe-eval\"><code>'wasm-unsafe-eval'</code></a>\", then:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>global</var>, <var>policy</var>, and \"<code>script-src</code>\".</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①②\">resource</a> to \"<code>wasm-eval</code>\".</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①⑤\">disposition</a> is \"<code>enforce</code>\", then set <var>result</var> to\n  \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>result</var> is \"<code>Blocked</code>\", throw a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webassembly.github.io/spec/js-api/#exceptiondef-compileerror\" id=\"ref-for-exceptiondef-compileerror①\">WebAssembly.CompileError</a></code> exception.</p>"
        }
      ]
    },
    {
      "html": "Given a violation’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①③\">resource</a> <var>resource</var>, this algorithm returns a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string⑨\">string</a>, to be used as the blocked URI field for violation reports.",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>resource</var> is a <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url\" id=\"ref-for-concept-url\">URL</a> or a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string\" id=\"ref-for-string①⓪\">string</a>.</p>"
        },
        {
          "html": "<p>If <var>resource</var> is a <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url\" id=\"ref-for-concept-url①\">URL</a>, return the result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>resource</var>.</p>"
        },
        {
          "html": "<p>Return <var>resource</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation\" id=\"ref-for-violation②①\">violation</a> <var>violation</var>, this algorithm returns a JSON text\n  string representation of the violation, suitable for submission to a reporting\n  endpoint associated with the deprecated <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#report-uri\" id=\"ref-for-report-uri\"><code>report-uri</code></a> directive.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>body</var> be a <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-map\" id=\"ref-for-ordered-map\">map</a> with its keys initialized as\n  follows:</p>\n      <dl>\n       <dt data-md=\"\">\"<code>document-uri</code>\"\n       </dt><dd data-md=\"\">\n        <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-url\" id=\"ref-for-violation-url\">url</a>.</p>\n       </dd><dt data-md=\"\">\"<code>referrer</code>\"\n       </dt><dd data-md=\"\">\n        <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-referrer\" id=\"ref-for-violation-referrer①\">referrer</a>.</p>\n       </dd><dt data-md=\"\">\"<code>blocked-uri</code>\"\n       </dt><dd data-md=\"\">\n        <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#obtain-violation-blocked-uri\">§ 5.2 Obtain the blockedURI of a violation’s resource</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①④\">resource</a>.</p>\n       </dd><dt data-md=\"\">\"<code>effective-directive</code>\"\n       </dt><dd data-md=\"\">\n        <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-effective-directive\" id=\"ref-for-violation-effective-directive①\">effective directive</a></p>\n       </dd><dt data-md=\"\">\"<code>violated-directive</code>\"\n       </dt><dd data-md=\"\">\n        <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-effective-directive\" id=\"ref-for-violation-effective-directive②\">effective directive</a></p>\n       </dd><dt data-md=\"\">\"<code>original-policy</code>\"\n       </dt><dd data-md=\"\">\n        <p>The <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#serialized-csp\" id=\"ref-for-serialized-csp⑤\">serialization</a> of <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy①\">policy</a></p>\n       </dd><dt data-md=\"\">\"<code>disposition</code>\"\n       </dt><dd data-md=\"\">\n        <p>The <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①⑥\">disposition</a> of <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy②\">policy</a></p>\n       </dd><dt data-md=\"\">\"<code>status-code</code>\"\n       </dt><dd data-md=\"\">\n        <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-status\" id=\"ref-for-violation-status①\">status</a></p>\n       </dd><dt data-md=\"\">\"<code>script-sample</code>\"\n       </dt><dd data-md=\"\">\n        <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-sample\" id=\"ref-for-violation-sample④\">sample</a></p>\n        \n      </dd></dl>"
        },
        {
          "html": "If <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file②\">source file</a> is not null:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>body</var>[\"<code>source-file</code>'] to the result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file③\">source file</a>.</p>"
            },
            {
              "html": "<p>Set <var>body</var>[\"<code>line-number</code>\"] to <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-line-number\" id=\"ref-for-violation-line-number①\">line number</a>.</p>"
            },
            {
              "html": "<p>Set <var>body</var>[\"<code>column-number</code>\"] to <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-column-number\" id=\"ref-for-violation-column-number①\">column number</a>.</p>"
            }
          ]
        },
        {
          "html": "<p class=\"assertion\">Assert: If <var>body</var>[\"<code>blocked-uri</code>\"] is not \"<code>inline</code>\", then <var>body</var>[\"<code>sample</code>\"]\n  is the empty string.</p>"
        },
        {
          "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes\" id=\"ref-for-serialize-an-infra-value-to-json-bytes\">serialize an infra value to JSON bytes</a> given\n  «[ \"csp-report\" → body ]».</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation\" id=\"ref-for-violation②①\">violation</a> <var>violation</var>, this algorithm returns a JSON text\n  string representation of the violation, suitable for submission to a reporting\n  endpoint associated with the deprecated <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#report-uri\" id=\"ref-for-report-uri\"><code>report-uri</code></a> directive.",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme①\">scheme</a> is not an <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#http-scheme\" id=\"ref-for-http-scheme②\">HTTP(S) scheme</a>,\n then return <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme②\">scheme</a>.</p>"
        },
        {
          "html": "<p>Set <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-fragment\" id=\"ref-for-concept-url-fragment\">fragment</a> to the empty string.</p>"
        },
        {
          "html": "<p>Set <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-username\" id=\"ref-for-concept-url-username\">username</a> to the empty string.</p>"
        },
        {
          "html": "<p>Set <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-password\" id=\"ref-for-concept-url-password\">password</a> to the empty string.</p>"
        },
        {
          "html": "<p>Return the result of executing the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-serializer\" id=\"ref-for-concept-url-serializer\">URL serializer</a> on <var>url</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation\" id=\"ref-for-violation②②\">violation</a> <var>violation</var>, this algorithm reports it to the endpoint specified in <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy③\">policy</a>, and fires a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#securitypolicyviolationevent\" id=\"ref-for-securitypolicyviolationevent①\">SecurityPolicyViolationEvent</a></code> at <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-element\" id=\"ref-for-violation-element①\">element</a>, or at <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object③\">global object</a> as described below:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>global</var> be <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object④\">global object</a>.</p>"
        },
        {
          "html": "<p>Let <var>target</var> be <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-element\" id=\"ref-for-violation-element②\">element</a>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task\" id=\"ref-for-queue-a-task\">Queue a task</a> to run the following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>target</var> is not null, and <var>global</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window③\">Window</a></code>, and <var>target</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-shadow-including-root\" id=\"ref-for-concept-shadow-including-root\">shadow-including root</a> is not <var>global</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window②\">associated <code>Document</code></a>, set <var>target</var> to null.</p>"
            },
            {
              "html": "If <var>target</var> is null:",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set <var>target</var> to <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object⑤\">global object</a>.</p>"
                },
                {
                  "html": "<p>If <var>target</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window\" id=\"ref-for-window④\">Window</a></code>, set <var>target</var> to <var>target</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window\" id=\"ref-for-concept-document-window③\">associated <code>Document</code></a>.</p>"
                }
              ]
            },
            {
              "html": "<p>If <var>target</var> <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#implements\" id=\"ref-for-implements②\">implements</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#eventtarget\" id=\"ref-for-eventtarget\">EventTarget</a></code>, <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-event-fire\" id=\"ref-for-concept-event-fire\">fire an event</a> named <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"GlobalEventHandlers,WorkerGlobalScope\" data-dfn-type=\"event\" data-export=\"\" id=\"eventdef-globaleventhandlers-securitypolicyviolation\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>securitypolicyviolation</code></dfn> that uses the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#securitypolicyviolationevent\" id=\"ref-for-securitypolicyviolationevent②\">SecurityPolicyViolationEvent</a></code> interface at <var>target</var> with its attributes initialized as follows:</p>\n        <dl>\n         <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-documenturi\" id=\"ref-for-dom-securitypolicyviolationevent-documenturi\">documentURI</a></code>\n         </dt><dd data-md=\"\">\n          <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-url\" id=\"ref-for-violation-url①\">url</a>.</p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-referrer\" id=\"ref-for-dom-securitypolicyviolationevent-referrer\">referrer</a></code>\n         </dt><dd data-md=\"\">\n          <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-referrer\" id=\"ref-for-violation-referrer②\">referrer</a>.</p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-blockeduri\" id=\"ref-for-dom-securitypolicyviolationevent-blockeduri①\">blockedURI</a></code>\n         </dt><dd data-md=\"\">\n          <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#obtain-violation-blocked-uri\">§ 5.2 Obtain the blockedURI of a violation’s resource</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①⑤\">resource</a>.</p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-effectivedirective\" id=\"ref-for-dom-securitypolicyviolationevent-effectivedirective\">effectiveDirective</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-effective-directive\" id=\"ref-for-violation-effective-directive③\">effective directive</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-violateddirective\" id=\"ref-for-dom-securitypolicyviolationevent-violateddirective\">violatedDirective</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-effective-directive\" id=\"ref-for-violation-effective-directive④\">effective directive</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-originalpolicy\" id=\"ref-for-dom-securitypolicyviolationevent-originalpolicy\">originalPolicy</a></code>\n         </dt><dd data-md=\"\">\n          <p>The <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#serialized-csp\" id=\"ref-for-serialized-csp⑥\">serialization</a> of <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy⑤\">policy</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-disposition\" id=\"ref-for-dom-securitypolicyviolationevent-disposition\">disposition</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-disposition\" id=\"ref-for-violation-disposition\">disposition</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-sourcefile\" id=\"ref-for-dom-securitypolicyviolationevent-sourcefile\">sourceFile</a></code>\n         </dt><dd data-md=\"\">\n          <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file④\">source file</a>, if <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file⑤\">source file</a> is not null, or null otherwise.</p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-statuscode\" id=\"ref-for-dom-securitypolicyviolationevent-statuscode\">statusCode</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-status\" id=\"ref-for-violation-status②\">status</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-linenumber\" id=\"ref-for-dom-securitypolicyviolationevent-linenumber\">lineNumber</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-line-number\" id=\"ref-for-violation-line-number②\">line number</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-columnnumber\" id=\"ref-for-dom-securitypolicyviolationevent-columnnumber\">columnNumber</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-column-number\" id=\"ref-for-violation-column-number②\">column number</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-securitypolicyviolationevent-sample\" id=\"ref-for-dom-securitypolicyviolationevent-sample①\">sample</a></code>\n         </dt><dd data-md=\"\">\n          <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-sample\" id=\"ref-for-violation-sample⑤\">sample</a></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-bubbles\" id=\"ref-for-dom-event-bubbles\">bubbles</a></code>\n         </dt><dd data-md=\"\">\n          <p><code>true</code></p>\n         </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#dom-event-composed\" id=\"ref-for-dom-event-composed\">composed</a></code>\n         </dt><dd data-md=\"\">\n          <p><code>true</code></p>\n        </dd></dl>"
            },
            {
              "html": "If <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy⑥\">policy</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set①⓪\">directive\n  set</a> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①⑦\">directive</a> named \"<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#report-uri\" id=\"ref-for-report-uri①\"><code>report-uri</code></a>\" <var>directive</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy⑦\">policy</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set①①\">directive set</a> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①⑧\">directive</a> named\n  \"<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#report-to\" id=\"ref-for-report-to①\"><code>report-to</code></a>\", skip the remaining substeps.</p>"
                },
                {
                  "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②⑦\">For each</a> <var>token</var> of <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①③\">value</a>:",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>endpoint</var> be the result of executing the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-parser\" id=\"ref-for-concept-url-parser\">URL parser</a> with <var>token</var> as the input, and <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-url\" id=\"ref-for-violation-url②\">url</a> as the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-base-url\" id=\"ref-for-concept-base-url\">base URL</a>.</p>"
                    },
                    {
                      "html": "<p>If <var>endpoint</var> is not a valid URL, skip the remaining substeps.</p>"
                    },
                    {
                      "html": "<p>Let <var>request</var> be a new <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request①⑥\">request</a>, initialized as follows:</p>\n            <dl>\n             <dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-method\" id=\"ref-for-concept-request-method\">method</a>\n             </dt><dd data-md=\"\">\n              <p>\"<code>POST</code>\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-url\" id=\"ref-for-concept-request-url④\">url</a>\n             </dt><dd data-md=\"\">\n              <p><var>endpoint</var></p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-origin\" id=\"ref-for-concept-request-origin\">origin</a>\n             </dt><dd data-md=\"\">\n              <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object⑥\">global object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object\">relevant settings\n  object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin①\">origin</a></p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-window\" id=\"ref-for-concept-request-window\">traversable for user prompts</a>\n             </dt><dd data-md=\"\">\n              <p>\"<code>no-traversable</code>\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client⑤\">client</a>\n             </dt><dd data-md=\"\">\n              <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object⑦\">global object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object①\">relevant\n  settings object</a></p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination③\">destination</a>\n             </dt><dd data-md=\"\">\n              <p>\"<code>report</code>\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-initiator\" id=\"ref-for-concept-request-initiator\">initiator</a>\n             </dt><dd data-md=\"\">\n              <p>\"\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-credentials-mode\" id=\"ref-for-concept-request-credentials-mode\">credentials mode</a>\n             </dt><dd data-md=\"\">\n              <p>\"<code>same-origin</code>\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#request-keepalive-flag\" id=\"ref-for-request-keepalive-flag\">keepalive</a>\n             </dt><dd data-md=\"\">\n              <p>\"<code>true</code>\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-header-list\" id=\"ref-for-concept-request-header-list\">header list</a>\n             </dt><dd data-md=\"\">\n              <p>A header list containing a single header whose name is\n  \"<code>Content-Type</code>\", and value is \"<code>application/csp-report</code>\"</p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-body\" id=\"ref-for-concept-request-body\">body</a>\n             </dt><dd data-md=\"\">\n              <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#deprecated-serialize-violation\">§ 5.3 Obtain the deprecated serialization of violation</a> on <var>violation</var></p>\n             </dd><dt data-md=\"\"><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-redirect-mode\" id=\"ref-for-concept-request-redirect-mode\">redirect mode</a>\n             </dt><dd data-md=\"\">\n              <p>\"<code>error</code>\"</p>\n            </dd></dl>"
                    },
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-fetch\" id=\"ref-for-concept-fetch\">Fetch</a> <var>request</var>. The result will be ignored.</p>"
                    }
                  ]
                }
              ]
            },
            {
              "html": "If <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy⑧\">policy</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set①②\">directive\n  set</a> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives①⑨\">directive</a> named \"<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#report-to\" id=\"ref-for-report-to②\"><code>report-to</code></a>\" <var>directive</var>:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>body</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#cspviolationreportbody\" id=\"ref-for-cspviolationreportbody\">CSPViolationReportBody</a></code>, initialized as\n  follows:</p>\n          <dl>\n           <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-documenturl\" id=\"ref-for-dom-cspviolationreportbody-documenturl\">documentURL</a></code>\n           </dt><dd data-md=\"\">\n            <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-url\" id=\"ref-for-violation-url③\">url</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-referrer\" id=\"ref-for-dom-cspviolationreportbody-referrer\">referrer</a></code>\n           </dt><dd data-md=\"\">\n            <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-referrer\" id=\"ref-for-violation-referrer③\">referrer</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-blockedurl\" id=\"ref-for-dom-cspviolationreportbody-blockedurl\">blockedURL</a></code>\n           </dt><dd data-md=\"\">\n            <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#obtain-violation-blocked-uri\">§ 5.2 Obtain the blockedURI of a violation’s resource</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①⑥\">resource</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-effectivedirective\" id=\"ref-for-dom-cspviolationreportbody-effectivedirective\">effectiveDirective</a></code>\n           </dt><dd data-md=\"\">\n            <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-effective-directive\" id=\"ref-for-violation-effective-directive⑤\">effective directive</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-originalpolicy\" id=\"ref-for-dom-cspviolationreportbody-originalpolicy\">originalPolicy</a></code>\n           </dt><dd data-md=\"\">\n            <p>The <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#serialized-csp\" id=\"ref-for-serialized-csp⑦\">serialization</a> of <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-policy\" id=\"ref-for-violation-policy⑨\">policy</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-sourcefile\" id=\"ref-for-dom-cspviolationreportbody-sourcefile\">sourceFile</a></code>\n           </dt><dd data-md=\"\">\n            <p>The result of executing <a href=\"https://www.w3.org/TR/CSP3/#strip-url-for-use-in-reports\">§ 5.4 Strip URL for use in reports</a> on <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file⑥\">source file</a>, if <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file⑦\">source file</a> is not null, or null otherwise.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-sample\" id=\"ref-for-dom-cspviolationreportbody-sample\">sample</a></code>\n           </dt><dd data-md=\"\">\n            <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-sample\" id=\"ref-for-violation-sample⑥\">sample</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-disposition\" id=\"ref-for-dom-cspviolationreportbody-disposition\">disposition</a></code>\n           </dt><dd data-md=\"\">\n            <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-disposition\" id=\"ref-for-violation-disposition①\">disposition</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-statuscode\" id=\"ref-for-dom-cspviolationreportbody-statuscode\">statusCode</a></code>\n           </dt><dd data-md=\"\">\n            <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-status\" id=\"ref-for-violation-status③\">status</a>.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-linenumber\" id=\"ref-for-dom-cspviolationreportbody-linenumber\">lineNumber</a></code>\n           </dt><dd data-md=\"\">\n            <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-line-number\" id=\"ref-for-violation-line-number③\">line number</a>, if <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file⑧\">source file</a> is not null,\n  or null otherwise.</p>\n           </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/CSP3/#dom-cspviolationreportbody-columnnumber\" id=\"ref-for-dom-cspviolationreportbody-columnnumber\">columnNumber</a></code>\n           </dt><dd data-md=\"\">\n            <p><var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-column-number\" id=\"ref-for-violation-column-number③\">column number</a>, if <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-source-file\" id=\"ref-for-violation-source-file⑨\">source file</a> is not null,\n  or null otherwise.</p>\n          </dd></dl>"
                },
                {
                  "html": "<p>Let <var>settings object</var> be <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-global-object\" id=\"ref-for-violation-global-object⑧\">global\n  object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object②\">relevant settings object</a>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/reporting-1/#generate-and-queue-a-report\" id=\"ref-for-generate-and-queue-a-report①\">Generate and queue a report</a> with the following arguments:</p>\n          <dl>\n           <dt data-md=\"\"><var>context</var>\n           </dt><dd data-md=\"\">\n            <p><var>settings object</var></p>\n           </dd><dt data-md=\"\"><var>type</var>\n           </dt><dd data-md=\"\">\n            <p>\"csp-violation\"</p>\n           </dd><dt data-md=\"\"><var>destination</var>\n           </dt><dd data-md=\"\">\n            <p><var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①④\">value</a>.</p>\n           </dd><dt data-md=\"\"><var>data</var>\n           </dt><dd data-md=\"\">\n            <p><var>body</var></p>\n          </dd></dl>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request①⑨\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object②⑨\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>child-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-pre-request-check\" id=\"ref-for-directive-pre-request-check②\">pre-request\n  check</a> for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②①\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①①\">name</a> is <var>name</var> on <var>request</var> and <var>policy</var>, using this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①⑤\">value</a> for the comparison.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②⓪\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①⓪\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③⓪\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>child-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-post-request-check\" id=\"ref-for-directive-post-request-check③\">post-request\n  check</a> for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②②\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①②\">name</a> is <var>name</var> on <var>request</var>, <var>response</var>, and <var>policy</var>, using this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①⑥\">value</a> for the comparison.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②②\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③①\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>connect-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①⑦\">value</a>, and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②③\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①①\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③②\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>connect-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①⑧\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②④\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③③\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>default-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-pre-request-check\" id=\"ref-for-directive-pre-request-check⑤\">pre-request check</a> for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②③\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①③\">name</a> is <var>name</var> on <var>request</var> and <var>policy</var>, using\n  this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value①⑨\">value</a> for the comparison.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②⑤\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①②\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③④\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>default-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-post-request-check\" id=\"ref-for-directive-post-request-check⑥\">post-request check</a> for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②④\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①④\">name</a> is <var>name</var> on <var>request</var>, <var>response</var>, and <var>policy</var>, using this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②⓪\">value</a> for the\n  comparison.</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element②\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③⑤\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>default-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Otherwise, return the result of executing the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-inline-check\" id=\"ref-for-directive-inline-check③\">inline check</a> for the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②⑤\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①⑤\">name</a> is <var>name</var> on <var>element</var>, <var>type</var>, <var>policy</var> and <var>source</var>, using this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②①\">value</a> for the\n  comparison.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②⑥\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③⑥\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>font-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②②\">value</a>, and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②⑦\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①③\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③⑦\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>font-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②③\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②⑧\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③⑧\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>frame-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②④\">value</a>, and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request②⑨\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①④\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object③⑨\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>frame-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②⑤\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③②\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④⓪\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>img-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②⑥\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③③\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①⑤\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④①\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>img-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②⑦\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③④\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④②\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>manifest-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②⑧\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③⑤\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①⑥\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④③\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>manifest-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value②⑨\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③⑥\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④④\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>media-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③⓪\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③⑦\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①⑦\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④⑤\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>media-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③①\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③⑧\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④⑦\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>object-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③②\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request③⑨\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response①⑧\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④⑧\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>object-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③③\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④①\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object④⑨\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing <a href=\"https://www.w3.org/TR/CSP3/#script-pre-request\">§ 6.7.1.1 Script directives pre-request check</a> on <var>request</var>,\n  this directive, and <var>policy</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④②\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②⓪\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤⓪\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing <a href=\"https://www.w3.org/TR/CSP3/#script-post-request\">§ 6.7.1.2 Script directives post-request check</a> on <var>request</var>, <var>response</var>, this directive, and <var>policy</var>.</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element③\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤①\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>element</var> is not null or <var>type</var> is \"<code>navigation</code>\".</p>"
        },
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-element-to-source-list\">§ 6.7.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③④\">value</a>, <var>type</var>,\n  and <var>source</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④③\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤②\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-elem</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing <a href=\"https://www.w3.org/TR/CSP3/#script-pre-request\">§ 6.7.1.1 Script directives pre-request check</a> on <var>request</var>,\n  this directive, and <var>policy</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④④\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②①\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤③\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-elem</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return the result of executing <a href=\"https://www.w3.org/TR/CSP3/#script-post-request\">§ 6.7.1.2 Script directives post-request check</a> on <var>request</var>, <var>response</var>, this directive, and <var>policy</var>.</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element④\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤④\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>element</var> is not null or <var>type</var> is \"<code>navigation</code>\".</p>"
        },
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-elem</code>, and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-element-to-source-list\">§ 6.7.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③⑥\">value</a>, <var>type</var>,\n  and <var>source</var> is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element⑤\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤⑤\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>element</var> is not null or <var>type</var> is \"<code>navigation</code>\".</p>"
        },
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-attr</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-element-to-source-list\">§ 6.7.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③⑦\">value</a>, <var>type</var>,\n  and <var>source</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "The <code>style-src</code> directive governs several things:",
      "rationale": "insert",
      "steps": [
        {
          "html": "<p>Style <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④⑤\">requests</a> MUST pass through <a href=\"https://www.w3.org/TR/CSP3/#should-block-request\" id=\"ref-for-should-block-request⑤\">§ 4.1.2 Should request be blocked by Content Security Policy?</a>. This\n  includes:</p>",
          "ignored": [
            "Stylesheet requests originating from a link element. Stylesheet requests originating from the @import rule. Stylesheet requests originating from a Link HTTP response header field [RFC8288]."
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②②\">Responses</a> to style requests MUST pass through <a href=\"https://www.w3.org/TR/CSP3/#should-block-response\" id=\"ref-for-should-block-response⑤\">§ 4.1.3 Should response to request be blocked by Content Security Policy?</a>.</p>"
        },
        {
          "html": "<p>Inline <code><a data-link-type=\"element\" href=\"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element\" id=\"ref-for-the-style-element\">style</a></code> blocks MUST pass through <a href=\"https://www.w3.org/TR/CSP3/#should-block-inline\" id=\"ref-for-should-block-inline⑥\">§ 4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a>. The\n  styles will be blocked unless every policy allows inline style, either\n  implicitly by not specifying a <code>style-src</code> (or <code>default-src</code>) directive,\n  or explicitly, by specifying \"<code>unsafe-inline</code>\", a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-nonce-source\" id=\"ref-for-grammardef-nonce-source③\">nonce-source</a> or a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-source\" id=\"ref-for-grammardef-hash-source③\">hash-source</a> that matches\n  the inline block.</p>"
        },
        {
          "html": "The following CSS algorithms are gated on the <code>unsafe-eval</code> source\n  expression:",
          "rationale": "insert",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/cssom-1/#insert-a-css-rule\" id=\"ref-for-insert-a-css-rule\">insert a CSS rule</a></p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/cssom-1/#parse-a-css-rule\" id=\"ref-for-parse-a-css-rule\">parse a CSS rule</a>,</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block\" id=\"ref-for-parse-a-css-declaration-block\">parse a CSS declaration block</a></p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors\" id=\"ref-for-parse-a-group-of-selectors\">parse a group of selectors</a></p>"
            }
          ]
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④⑥\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤⑥\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-nonce-to-source-list\">§ 6.7.2.3 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata①\">cryptographic nonce metadata</a> and this\n  directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③⑧\">value</a> is \"<code>Matches</code>\", return\n  \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value③⑨\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④⑦\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②③\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤⑦\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-nonce-to-source-list\">§ 6.7.2.3 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata②\">cryptographic nonce metadata</a> and this\n  directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④⓪\">value</a> is \"<code>Matches</code>\", return\n  \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④①\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element⑥\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤⑧\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-element-to-source-list\">§ 6.7.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④②\">value</a>, <var>type</var>,\n  and <var>source</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④⑧\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑤⑨\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-elem</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-nonce-to-source-list\">§ 6.7.2.3 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata③\">cryptographic nonce metadata</a> and this\n  directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④③\">value</a> is \"<code>Matches</code>\", return\n  \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④④\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request④⑨\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②④\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥⓪\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-elem</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-nonce-to-source-list\">§ 6.7.2.3 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata④\">cryptographic nonce metadata</a> and this\n  directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④⑤\">value</a> is \"<code>Matches</code>\", return\n  \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④⑥\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element⑦\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥①\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-elem</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-element-to-source-list\">§ 6.7.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④⑦\">value</a>, <var>type</var>,\n  and <var>source</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element⑧\">Element</a></code> <var>element</var>, a string <var>type</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥②\">policy</a> <var>policy</var> and a string <var>source</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-inline-check\">§ 6.8.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-attr</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-element-to-source-list\">§ 6.7.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④⑧\">value</a>, <var>type</var>,\n  and <var>source</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "This directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-webrtc-pre-connect-check\" id=\"ref-for-directive-webrtc-pre-connect-check①\">webrtc pre-connect check</a> is as follows:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value④⑨\">value</a> contains a single item which is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive⑤\">ASCII case-insensitive</a> match for the string \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-allow\" id=\"ref-for-grammardef-allow\"><code>'allow'</code></a>\",\n  return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Blocked</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤⓪\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥③\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>worker-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤⓪\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤①\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②⑤\">response</a> <var>response</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥④\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>name</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#effective-directive-for-a-request\">§ 6.8.1 Get the effective directive for request</a> on <var>request</var>.</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#should-directive-execute\">§ 6.8.4 Should fetch directive execute</a> on <var>name</var>, <code>worker-src</code> and <var>policy</var> is \"<code>No</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤①\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://url.spec.whatwg.org/#url\" id=\"ref-for-url⑥\">URL</a></code> <var>base</var>, and a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①①\">Document</a></code> <var>document</var>, this algorithm\n  returns \"<code>Allowed</code>\" if <var>base</var> may be used as the value of a <code><a data-link-type=\"element\" href=\"https://html.spec.whatwg.org/multipage/semantics.html#the-base-element\" id=\"ref-for-the-base-element②\">base</a></code> element’s <code><a data-link-type=\"element-sub\" href=\"https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href\" id=\"ref-for-attr-base-href①\">href</a></code> attribute, and \"<code>Blocked</code>\" otherwise:",
      "rationale": "for",
      "steps": [
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②⑧\">For each</a> <var>policy</var> of <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object①②\">global object</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#global-object-csp-list\" id=\"ref-for-global-object-csp-list①⓪\">csp list</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>source list</var> be null.</p>"
            },
            {
              "html": "<p>If a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②⑥\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①⑥\">name</a> is\n  \"<code>base-uri</code>\" is present in <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-directive-set\" id=\"ref-for-policy-directive-set①③\">directive\n  set</a>, set <var>source list</var> to that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②⑦\">directive</a>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤②\">value</a>.</p>"
            },
            {
              "html": "<p>If <var>source list</var> is null, skip to the next <var>policy</var>.</p>"
            },
            {
              "html": "If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-url-to-source-list\">§ 6.7.2.7 Does url match source list in origin with redirect count?</a> on <var>base</var>, <var>source list</var>, <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-self-origin\" id=\"ref-for-policy-self-origin①\">self-origin</a>, and <code>0</code> is \"<code>Does Not Match</code>\":",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>violation</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#create-violation-for-global\">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object①③\">global\n  object</a>, <var>policy</var>, and \"<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#base-uri\" id=\"ref-for-base-uri\"><code>base-uri</code></a>\".</p>"
                },
                {
                  "html": "<p>Set <var>violation</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#violation-resource\" id=\"ref-for-violation-resource①⑦\">resource</a> to \"<code>inline</code>\".</p>"
                },
                {
                  "html": "<p>Execute <a href=\"https://www.w3.org/TR/CSP3/#report-violation\">§ 5.5 Report a violation</a> on <var>violation</var>.</p>"
                },
                {
                  "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①⑦\">disposition</a> is \"<code>enforce</code>\",\n  return \"<code>Blocked</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#document\" id=\"ref-for-document①③\">Document</a></code> or <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#global-object\" id=\"ref-for-global-object①④\">global object</a> <var>context</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥⑤\">policy</a> <var>policy</var>:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-disposition\" id=\"ref-for-policy-disposition①⑧\">disposition</a> is not \"<code>enforce</code>\", or <var>context</var> is not a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope\" id=\"ref-for-workerglobalscope②\">WorkerGlobalScope</a></code>, then abort this algorithm.</p>"
        },
        {
          "html": "<p>Let <var>sandboxing flag set</var> be a new <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#sandboxing-flag-set\" id=\"ref-for-sandboxing-flag-set\">sandboxing flag set</a>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive\" id=\"ref-for-parse-a-sandboxing-directive\">Parse a sandboxing directive</a> using this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤③\">value</a> as the input, and <var>sandboxing flag set</var> as the output.</p>"
        },
        {
          "html": "<p>If <var>sandboxing flag set</var> contains either the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag\" id=\"ref-for-sandboxed-scripts-browsing-context-flag\">sandboxed scripts browsing context\n  flag</a> or the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag\" id=\"ref-for-sandboxed-origin-browsing-context-flag\">sandboxed origin browsing context flag</a> flags,\n  return \"<code>Blocked</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤②\">request</a> <var>request</var>, a string <var>navigation type</var> (\"<code>form-submission</code>\" or\n  \"<code>other</code>\"), and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥⑥\">policy</a> <var>policy</var> this algorithm returns \"<code>Blocked</code>\" if a form\n  submission violates the <code>form-action</code> directive’s constraints, and \"<code>Allowed</code>\"\n  otherwise. This constitutes the <code>form-action</code> directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-pre-navigation-check\" id=\"ref-for-directive-pre-navigation-check①\">pre-navigation check</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>policy</var> is unused in this algorithm.</p>"
        },
        {
          "html": "If <var>navigation type</var> is \"<code>form-submission</code>\":",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤④\">value</a>, and a <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤③\">request</a> <var>request</var>, a string <var>navigation type</var> (\"<code>form-submission</code>\" or \"<code>other</code>\"), a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②⑥\">response</a> <var>navigation response</var>, a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/#navigable\" id=\"ref-for-navigable③\">navigable</a> <var>target</var>,\n  a string <var>check type</var> (\"<code>source</code>\" or \"<code>response</code>\"), and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥⑦\">policy</a> <var>policy</var> this algorithm returns \"<code>Blocked</code>\" if one or\n  more of the ancestors of <var>target</var> violate the <code>frame-ancestors</code> directive\n  delivered with the response, and \"<code>Allowed</code>\" otherwise. This constitutes the <code>frame-ancestors</code> directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-navigation-response-check\" id=\"ref-for-directive-navigation-response-check②\">navigation response check</a>:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>navigation response</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response-url\" id=\"ref-for-concept-response-url②\">URL</a> <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#is-local\" id=\"ref-for-is-local\">is local</a>, return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p class=\"assertion\">Assert: <var>request</var>, <var>navigation response</var>, and <var>navigation type</var>, are unused\n  from this point forward in this algorithm, as <code>frame-ancestors</code> is concerned only\n  with <var>navigation response</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#frame-ancestors\" id=\"ref-for-frame-ancestors②\">frame-ancestors</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives②⑧\">directive</a>.</p>"
        },
        {
          "html": "<p>If <var>check type</var> is \"<code>source</code>\", return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>If <var>target</var> is not a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable\" id=\"ref-for-child-navigable③\">child navigable</a>, return \"<code>Allowed</code>\".</p>"
        },
        {
          "html": "<p>Let <var>current</var> be <var>target</var>.</p>"
        },
        {
          "html": "While <var>current</var> is a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#child-navigable\" id=\"ref-for-child-navigable④\">child navigable</a>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>document</var> be <var>current</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#nav-container-document\" id=\"ref-for-nav-container-document\">container document</a>.</p>"
            },
            {
              "html": "<p>Let <var>origin</var> be the result of executing the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-parser\" id=\"ref-for-concept-url-parser①\">URL parser</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin\" id=\"ref-for-ascii-serialisation-of-an-origin\">ASCII serialization</a> of <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-document-origin\" id=\"ref-for-concept-document-origin\">origin</a>.</p>"
            },
            {
              "html": "<p>If <a href=\"https://www.w3.org/TR/CSP3/#match-url-to-source-list\">§ 6.7.2.7 Does url match source list in origin with redirect count?</a> returns <code>Does Not Match</code> when\n  executed upon <var>origin</var>, this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤⑤\">value</a>, <var>policy</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#policy-self-origin\" id=\"ref-for-policy-self-origin②\">self-origin</a>, and <code>0</code>, return \"<code>Blocked</code>\".</p>"
            },
            {
              "html": "<p>Set <var>current</var> to <var>document</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/document-sequences.html#node-navigable\" id=\"ref-for-node-navigable\">node navigable</a>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤④\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives③①\">directive</a> <var>directive</var>,\n  and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑥⑨\">policy</a> <var>policy</var>:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination⑦\">destination</a> is <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#request-destination-script-like\" id=\"ref-for-request-destination-script-like③\">script-like</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-nonce-to-source-list\">§ 6.7.2.3 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata⑤\">cryptographic nonce metadata</a> and this\n  directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤⑥\">value</a> is \"<code>Matches</code>\", return\n  \"<code>Allowed</code>\".</p>"
            },
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-integrity-metadata-to-source-list\">§ 6.7.2.4 Does integrity metadata match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata\" id=\"ref-for-concept-request-integrity-metadata\">integrity metadata</a> and this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤⑦\">value</a> is \"<code>Matches</code>\", return \"<code>Allowed</code>\".</p>"
            },
            {
              "html": "If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤⑧\">value</a> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression⑥\">source\n  expression</a> that is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive⑥\">ASCII case-insensitive</a> match for\n  the \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-strict-dynamic\" id=\"ref-for-grammardef-strict-dynamic\"><code>'strict-dynamic'</code></a>\" <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-keyword-source\" id=\"ref-for-grammardef-keyword-source①\">keyword-source</a>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If the <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-parser-metadata\" id=\"ref-for-concept-request-parser-metadata①\">parser metadata</a> is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/#parser-inserted\" id=\"ref-for-parser-inserted①\">\"parser-inserted\"</a>, return \"<code>Blocked</code>\".</p>\n          <p>Otherwise, return \"<code>Allowed</code>\".</p>"
                }
              ]
            },
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑤⑨\">value</a>, and <var>policy</var>,\n  is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤⑤\">request</a> <var>request</var>, a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-response\" id=\"ref-for-concept-response②⑦\">response</a> <var>response</var>,\n  a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives③②\">directive</a> <var>directive</var>, and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑦⓪\">policy</a> <var>policy</var>:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination⑧\">destination</a> is <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#request-destination-script-like\" id=\"ref-for-request-destination-script-like④\">script-like</a>:",
          "rationale": "call",
          "steps": [
            {
              "html": "<p>Call <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#potentially-report-hash\" id=\"ref-for-potentially-report-hash①\">potentially report hash</a> with <var>response</var>, <var>request</var>, <var>directive</var> and <var>policy</var>.</p>"
            },
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-nonce-to-source-list\">§ 6.7.2.3 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata⑦\">cryptographic nonce metadata</a> and this\n  directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥⓪\">value</a> is \"<code>Matches</code>\", return\n  \"<code>Allowed</code>\".</p>"
            },
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-integrity-metadata-to-source-list\">§ 6.7.2.4 Does integrity metadata match source list?</a> on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata\" id=\"ref-for-concept-request-integrity-metadata②\">integrity metadata</a> and this directive’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥①\">value</a> is \"<code>Matches</code>\", return \"<code>Allowed</code>\".</p>"
            },
            {
              "html": "If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥②\">value</a> contains a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression⑦\">source\n  expression</a> that is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive⑦\">ASCII case-insensitive</a> match for\n  the \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-strict-dynamic\" id=\"ref-for-grammardef-strict-dynamic②\"><code>'strict-dynamic'</code></a>\" <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-keyword-source\" id=\"ref-for-grammardef-keyword-source②\">keyword-source</a>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If the <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-parser-metadata\" id=\"ref-for-concept-request-parser-metadata②\">parser metadata</a> is <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/#parser-inserted\" id=\"ref-for-parser-inserted②\">\"parser-inserted\"</a>, return \"<code>Blocked</code>\".</p>\n          <p>Otherwise, return \"<code>Allowed</code>\".</p>"
                }
              ]
            },
            {
              "html": "<p>If the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-response-to-source-list\">§ 6.7.2.6 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥③\">value</a>,\n  and <var>policy</var>, is \"<code>Does Not Match</code>\", return \"<code>Blocked</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Allowed</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤⑥\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑦①\">policy</a> <var>policy</var>, this\n  algorithm returns the violated <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives③③\">directive</a> if the request violates the\n  policy, and \"<code>Does Not Violate</code>\" otherwise.",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-initiator\" id=\"ref-for-concept-request-initiator①\">initiator</a> is \"<code>prefetch</code>\", then return the result of executing <a href=\"https://www.w3.org/TR/CSP3/#does-resource-hint-violate-policy\">§ 6.7.2.2 Does resource hint request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>"
        },
        {
          "html": "<p>Let <var>violates</var> be \"<code>Does Not Violate</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②⑨\">For each</a> <var>directive</var> of <var>policy</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>result</var> be the result of executing <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-pre-request-check\" id=\"ref-for-directive-pre-request-check①⑧\">pre-request check</a> on <var>request</var> and <var>policy</var>.</p>"
            },
            {
              "html": "<p>If <var>result</var> is \"<code>Blocked</code>\", then let <var>violates</var> be <var>directive</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>violates</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤⑦\">request</a> <var>request</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑦②\">policy</a> <var>policy</var>, this\n  algorithm returns the default <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives③④\">directive</a> if the resource-hint request violates all the\n  policies, and \"<code>Does Not Violate</code>\" otherwise.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>defaultDirective</var> be <var>policy</var>’s first <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directives\" id=\"ref-for-directives③⑤\">directive</a> whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①⑦\">name</a> is\n  \"<code>default-src</code>\".</p>"
        },
        {
          "html": "<p>If <var>defaultDirective</var> does not exist, return \"<code>Does Not Violate</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③⓪\">For each</a> <var>directive</var> of <var>policy</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①⑧\">name</a> is not one of the following:</p>\n        <ul>\n         <li data-md=\"\">\n          <p><code>child-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>connect-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>font-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>frame-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>img-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>manifest-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>media-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>object-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>script-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>script-src-elem</code></p>\n         </li><li data-md=\"\">\n          <p><code>style-src</code></p>\n         </li><li data-md=\"\">\n          <p><code>style-src-elem</code></p>\n         </li><li data-md=\"\">\n          <p><code>worker-src</code></p>\n        </li></ul>\n        <p>then continue.</p>"
            },
            {
              "html": "<p class=\"assertion\">Assert: <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥④\">value</a> is a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists①②\">source list</a>.</p>"
            },
            {
              "html": "<p>Let <var>result</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#match-request-to-source-list\">§ 6.7.2.5 Does request match source list?</a> on <var>request</var>, <var>directive</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-value\" id=\"ref-for-directive-value⑥⑤\">value</a>, and <var>policy</var>.</p>"
            },
            {
              "html": "<p>If <var>result</var> is \"<code>Allowed</code>\", then return \"<code>Does Not Violate</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>defaultDirective</var>.</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤⑧\">request</a>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata\" id=\"ref-for-concept-request-nonce-metadata⑧\">cryptographic nonce metadata</a> <var>nonce</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists①③\">source list</a> <var>source list</var>, this algorithm returns\n  \"<code>Matches</code>\" if the nonce matches one or more source expressions in the list,\n  and \"<code>Does Not Match</code>\" otherwise:",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>source list</var> is not null.</p>"
        },
        {
          "html": "<p>If <var>nonce</var> is the empty string, return \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③①\">For each</a> <var>expression</var> of <var>source list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-nonce-source\" id=\"ref-for-grammardef-nonce-source④\"><code>nonce-source</code></a> grammar,\n  and <var>nonce</var> is <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-is\" id=\"ref-for-string-is\">identical to</a> <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-base64-value\" id=\"ref-for-grammardef-base64-value④\"><code>base64-value</code></a> part, return \"<code>Matches</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑤⑨\">request</a>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata\" id=\"ref-for-concept-request-integrity-metadata③\">integrity metadata</a> <var>integrity metadata</var> and a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists①④\">source list</a> <var>source list</var>, this algorithm\n  returns \"<code>Matches</code>\" if the integrity metadata matches one or more source\n  expressions in the list, and \"<code>Does Not Match</code>\" otherwise:",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>source list</var> is not null.</p>"
        },
        {
          "html": "<p>Let <var>integrity expressions</var> be the set of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression⑧\">source expressions</a> in <var>source list</var> that match the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-source\" id=\"ref-for-grammardef-hash-source④\">hash-source</a> grammar.</p>"
        },
        {
          "html": "<p>If <var>integrity expressions</var> is empty, return \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "<p>Let <var>integrity sources</var> be the result of executing the algorithm defined\n  in <a href=\"https://www.w3.org/TR/sri-2/#parse-metadata\"><cite>SRI</cite> § 3.3.2 Parse metadata</a> on <var>integrity metadata</var>. <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/CSP3/#biblio-sri\" title=\"Subresource Integrity\">[SRI]</a></p>"
        },
        {
          "html": "<p>If <var>integrity sources</var> is \"<code>no metadata</code>\" or an empty set, return \"<code>Does       Not Match</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③②\">For each</a> <var>source</var> of <var>integrity sources</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>integrity expressions</var> does not contain a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression⑨\">source expression</a> whose <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm\" id=\"ref-for-grammardef-hash-algorithm①\">hash-algorithm</a> is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive⑧\">ASCII\n  case-insensitive</a> match for <var>source</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm\" id=\"ref-for-grammardef-hash-algorithm②\">hash-algorithm</a>, and whose <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-base64-value\" id=\"ref-for-grammardef-base64-value⑤\">base64-value</a> is <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-is\" id=\"ref-for-string-is①\">identical to</a> <var>source</var>’s <code>base64-value</code>,\n  return \"<code>Does Not Match</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Matches</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://url.spec.whatwg.org/#url\" id=\"ref-for-url⑨\">URL</a></code> <var>url</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists①⑦\">source list</a> <var>source list</var>, an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/#concept-origin\" id=\"ref-for-concept-origin①\">origin</a> <var>origin</var>, and a number <var>redirect count</var>, this\n  algorithm returns \"<code>Matches</code>\" if the URL matches one or more source\n  expressions in <var>source list</var>, or \"<code>Does Not Match</code>\" otherwise:",
      "rationale": "assert",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>source list</var> is not null.</p>"
        },
        {
          "html": "<p>If <var>source list</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-is-empty\" id=\"ref-for-list-is-empty①\">is empty</a>, return \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "<p>If <var>source list</var>’s <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-size\" id=\"ref-for-list-size①\">size</a> is 1, and <var>source list</var>[0] is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive⑨\">ASCII\n  case-insensitive</a> match for the string \"<code>'none'</code>\", return \"<code>Does Not       Match</code>\".</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③③\">For each</a> <var>expression</var> of <var>source list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <a href=\"https://www.w3.org/TR/CSP3/#match-url-to-source-expression\" id=\"ref-for-match-url-to-source-expression①\">§ 6.7.2.8 Does url match expression in origin with redirect count?</a> returns \"<code>Matches</code>\" when\n  executed upon <var>url</var>, <var>expression</var>, <var>origin</var>, and <var>redirect count</var>, return\n  \"<code>Matches</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://url.spec.whatwg.org/#url\" id=\"ref-for-url①⓪\">URL</a></code> <var>url</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-expression\" id=\"ref-for-source-expression①⓪\">source expression</a> <var>expression</var>, an <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/#concept-origin\" id=\"ref-for-concept-origin②\">origin</a> <var>origin</var>, and a number <var>redirect count</var>, this algorithm\n  returns \"<code>Matches</code>\" if <var>url</var> matches <var>expression</var>, and \"<code>Does Not Match</code>\"\n  otherwise.",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>expression</var> is the string \"*\", return \"<code>Matches</code>\" if one or more of\n  the following conditions is met:</p>",
          "ignored": [
            "url’s scheme is an HTTP(S) scheme. url’s scheme is the same as origin’s scheme."
          ]
        },
        {
          "html": "If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-scheme-source\" id=\"ref-for-grammardef-scheme-source②\"><code>scheme-source</code></a> or <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-host-source\" id=\"ref-for-grammardef-host-source②\"><code>host-source</code></a> grammar:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>expression</var> has a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-scheme-part\" id=\"ref-for-grammardef-scheme-part②\"><code>scheme-part</code></a>, and it does not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#scheme-part-match\" id=\"ref-for-scheme-part-match\"><code>scheme-part</code> match</a> <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme⑤\">scheme</a>, return \"<code>Does Not Match</code>\".</p>"
            },
            {
              "html": "<p>If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-scheme-source\" id=\"ref-for-grammardef-scheme-source③\"><code>scheme-source</code></a> grammar,\n  return \"<code>Matches</code>\".</p>"
            }
          ]
        },
        {
          "html": "If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-host-source\" id=\"ref-for-grammardef-host-source③\"><code>host-source</code></a> grammar:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>url</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://url.spec.whatwg.org/#dom-url-host\" id=\"ref-for-dom-url-host\">host</a></code> is null, return \"<code>Does Not Match</code>\".</p>"
            },
            {
              "html": "<p>If <var>expression</var> does not have a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-scheme-part\" id=\"ref-for-grammardef-scheme-part③\"><code>scheme-part</code></a>, and <var>origin</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme\" id=\"ref-for-concept-origin-scheme①\">scheme</a> does not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#scheme-part-match\" id=\"ref-for-scheme-part-match①\"><code>scheme-part</code> match</a> <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme⑥\">scheme</a>,\n  return \"<code>Does Not Match</code>\".</p>"
            },
            {
              "html": "<p>If <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-host-part\" id=\"ref-for-grammardef-host-part①\"><code>host-part</code></a> does not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#host-part-match\" id=\"ref-for-host-part-match\"><code>host-part</code> match</a> <var>url</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://url.spec.whatwg.org/#dom-url-host\" id=\"ref-for-dom-url-host①\">host</a></code>, return \"<code>Does Not Match</code>\".</p>"
            },
            {
              "html": "<p>Let <var>port-part</var> be <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-port-part\" id=\"ref-for-grammardef-port-part①\"><code>port-part</code></a> if present, and null\n  otherwise.</p>"
            },
            {
              "html": "<p>If <var>port-part</var> does not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#port-part-matches\" id=\"ref-for-port-part-matches\"><code>port-part</code> match</a> <var>url</var>, return \"<code>Does Not Match</code>\".</p>"
            },
            {
              "html": "If <var>expression</var> contains a non-empty <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-path-part\" id=\"ref-for-grammardef-path-part①\"><code>path-part</code></a>, and <var>redirect count</var> is 0, then:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>path</var> be the resulting of joining <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-path\" id=\"ref-for-concept-url-path\">path</a> on the U+002F SOLIDUS character (<code>/</code>).</p>"
                },
                {
                  "html": "<p>If <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-path-part\" id=\"ref-for-grammardef-path-part②\"><code>path-part</code></a> does not <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#path-part-match\" id=\"ref-for-path-part-match\"><code>path-part</code> match</a> <var>path</var>,\n  return \"<code>Does Not Match</code>\".</p>"
                }
              ]
            },
            {
              "html": "<p>Return \"<code>Matches</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>expression</var> is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive①⓪\">ASCII case-insensitive</a> match for \"<code>'self'</code>\",\n  return \"<code>Matches</code>\" if one or more of the following conditions is met:</p>",
          "ignored": [
            "origin is the same as url’s origin origin’s host is the same as url’s host, origin’s port and url’s port are either the same or the default ports for their respective schemes, and one or more of the following conditions is met: url’s scheme is \"https\" or \"wss\" origin’s scheme is \"http\" and url’s scheme is \"http\" or \"ws\""
          ]
        },
        {
          "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
        }
      ]
    },
    {
      "html": "More formally, two <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-string\" id=\"ref-for-ascii-string⑦\">ASCII strings</a> <var>A</var> and <var>B</var> are said to <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#scheme-part-match\" id=\"ref-for-scheme-part-match③\"><code>scheme-part</code> match</a> if the\n  following algorithm returns \"<code>Matches</code>\":",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If one of the following is true, return \"<code>Matches</code>\":</p>",
          "ignored": [
            "A is an ASCII case-insensitive match for B. A is an ASCII case-insensitive match for \"http\", and B is an ASCII case-insensitive match for \"https\". A is an ASCII case-insensitive match for \"ws\", and B is an ASCII case-insensitive match for \"wss\", \"http\", or \"https\". A is an ASCII case-insensitive match for \"wss\", and B is an ASCII case-insensitive match for \"https\"."
          ]
        },
        {
          "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
        }
      ]
    },
    {
      "html": "More formally, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-string\" id=\"ref-for-ascii-string⑨\">ASCII string</a> <var>pattern</var> and <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-host\" id=\"ref-for-concept-host①\">host</a> <var>host</var> are said to <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#host-part-match\" id=\"ref-for-host-part-match②\"><code>host-part</code> match</a> if the\n  following algorithm returns \"<code>Matches</code>\":",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>host</var> is not a <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-domain\" id=\"ref-for-concept-domain\">domain</a>, return \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "<p>If <var>pattern</var> is \"<code>*</code>\", return \"<code>Matches</code>\".</p>"
        },
        {
          "html": "If <var>pattern</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-starts-with\" id=\"ref-for-string-starts-with\">starts with</a> \"<code>*.</code>\":",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>remaining</var> be <var>pattern</var> with the leading U+002A (<code>*</code>) removed and <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-lowercase\" id=\"ref-for-ascii-lowercase①\">ASCII lowercased</a>.</p>"
            },
            {
              "html": "<p>If <var>host</var> to <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-lowercase\" id=\"ref-for-ascii-lowercase②\">ASCII lowercase</a> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-ends-with\" id=\"ref-for-string-ends-with\">ends with</a> <var>remaining</var>, then return \"<code>Matches</code>\".</p>"
            },
            {
              "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>pattern</var> is not an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive①⑧\">ASCII case-insensitive</a> match for <var>host</var>, return\n  \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Matches</code>\".</p>"
        }
      ]
    },
    {
      "name": "port-part matches",
      "href": "https://www.w3.org/TR/CSP3/#port-part-matches",
      "html": "An <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-string\" id=\"ref-for-ascii-string①⓪\">ASCII string</a> or null <var>input</var> <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" id=\"port-part-matches\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>port-part</code> matches</dfn> <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url\" id=\"ref-for-concept-url③\">URL</a> <var>url</var> if a CSP source expression that contained the first as a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-port-part\" id=\"ref-for-grammardef-port-part②\"><code>port-part</code></a> could potentially match a URL containing the latter’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-port\" id=\"ref-for-concept-url-port\">port</a> and <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme①②\">scheme</a>. For example, \"80\" <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#port-part-matches\" id=\"ref-for-port-part-matches①\"><code>port-part</code> matches</a> matches http://example.com.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p class=\"assertion\">Assert: <var>input</var> is null, \"*\", or a sequence of one or more <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-digit\" id=\"ref-for-ascii-digit\">ASCII digits</a>.</p>"
        },
        {
          "html": "<p>If <var>input</var> is equal to \"*\", return \"<code>Matches</code>\".</p>"
        },
        {
          "html": "<p>Let <var>normalizedInput</var> be null if <var>input</var> null; otherwise <var>input</var> interpreted as decimal number.</p>"
        },
        {
          "html": "<p>If <var>normalizedInput</var> equals <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-port\" id=\"ref-for-concept-url-port①\">port</a>, return \"<code>Matches</code>\".</p>"
        },
        {
          "html": "If <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-port\" id=\"ref-for-concept-url-port②\">port</a> is null:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>defaultPort</var> be the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#default-port\" id=\"ref-for-default-port①\">default port</a> for <var>url</var>’s <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme①③\">scheme</a>.</p>"
            },
            {
              "html": "<p>If <var>normalizedInput</var> equals <var>defaultPort</var>, return \"<code>Matches</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
        }
      ]
    },
    {
      "name": "path-part match",
      "href": "https://www.w3.org/TR/CSP3/#path-part-match",
      "html": "An <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-string\" id=\"ref-for-ascii-string①①\">ASCII string</a> <var>path A</var> <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"path-part match\" id=\"path-part-match\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>path-part</code> matches</dfn> another <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-string\" id=\"ref-for-ascii-string①②\">ASCII string</a> <var>path B</var> if a CSP source expression that contained the first as a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-path-part\" id=\"ref-for-grammardef-path-part③\"><code>path-part</code></a> could potentially match a URL containing the latter as a <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-path\" id=\"ref-for-concept-url-path①\">path</a>.\n  For example, we say that \"/subdirectory/\" <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#path-part-match\" id=\"ref-for-path-part-match①\"><code>path-part</code> matches</a> \"/subdirectory/file\".",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>If <var>path A</var> is the empty string, return \"<code>Matches</code>\".</p>"
        },
        {
          "html": "<p>If <var>path A</var> consists of one character that is equal to the U+002F SOLIDUS\n  character (<code>/</code>) and <var>path B</var> is the empty string, return \"<code>Matches</code>\".</p>"
        },
        {
          "html": "<p>Let <var>exact match</var> be <code>false</code> if the final character of <var>path A</var> is the U+002F\n  SOLIDUS character (<code>/</code>), and <code>true</code> otherwise.</p>"
        },
        {
          "html": "<p>Let <var>path list A</var> and <var>path list B</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#strictly-split\" id=\"ref-for-strictly-split①\">strictly splitting</a> <var>path A</var> and <var>path B</var> respectively on the U+002F SOLIDUS character (<code>/</code>).</p>"
        },
        {
          "html": "<p>If <var>path list A</var> has more items than <var>path list B</var>, return\n  \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "<p>If <var>exact match</var> is <code>true</code>, and <var>path list A</var> does not have the same\n  number of items as <var>path list B</var>, return \"<code>Does Not Match</code>\".</p>"
        },
        {
          "html": "If <var>exact match</var> is <code>false</code>:",
          "rationale": "assert",
          "steps": [
            {
              "html": "<p class=\"assertion\">Assert: the final item in <var>path list A</var> is the empty string.</p>"
            },
            {
              "html": "<p>Remove the final item from <var>path list A</var>.</p>"
            }
          ]
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③④\">For each</a> <var>piece A</var> of <var>path list A</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>piece B</var> be the next item in <var>path list B</var>.</p>"
            },
            {
              "html": "<p>Let <var>decoded piece A</var> be the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#string-percent-decode\" id=\"ref-for-string-percent-decode\">percent-decoding</a> of <var>piece A</var>.</p>"
            },
            {
              "html": "<p>Let <var>decoded piece B</var> be the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#string-percent-decode\" id=\"ref-for-string-percent-decode①\">percent-decoding</a> of <var>piece B</var>.</p>"
            },
            {
              "html": "<p>If <var>decoded piece A</var> is not <var>decoded piece B</var>, return \"<code>Does Not Match</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>Matches</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element⑨\">Element</a></code> <var>element</var>, this algorithm returns \"<code>Nonceable</code>\" if\n  a <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-nonce-source\" id=\"ref-for-grammardef-nonce-source⑤\"><code>nonce-source</code></a> expression can match the element (as discussed\n  in <a href=\"https://www.w3.org/TR/CSP3/#security-nonce-hijacking\">§ 7.2 Nonce Hijacking</a>), and \"<code>Not Nonceable</code>\" if such expressions\n  should not be applied.",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>element</var> does not have an attribute named \"<code>nonce</code>\", return \"<code>Not       Nonceable</code>\".</p>"
        },
        {
          "html": "If <var>element</var> is a <code><a data-link-type=\"element\" href=\"https://html.spec.whatwg.org/multipage/scripting.html#script\" id=\"ref-for-script⑥\">script</a></code> element, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③⑤\">for each</a> <var>attribute</var> of <var>element</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#concept-element-attribute\" id=\"ref-for-concept-element-attribute\">attribute list</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>attribute</var>’s name contains an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive①⑨\">ASCII case-insensitive</a> match for\n  \"<code>&lt;script</code>\" or \"<code>&lt;style</code>\", return \"<code>Not Nonceable</code>\".</p>"
            },
            {
              "html": "<p>If <var>attribute</var>’s value contains an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②⓪\">ASCII case-insensitive</a> match for\n  \"<code>&lt;script</code>\" or \"<code>&lt;style</code>\", return \"<code>Not Nonceable</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>element</var> had a <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute\" id=\"ref-for-parse-error-duplicate-attribute\">duplicate-attribute</a> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/images.html#concept-microsyntax-parse-error\" id=\"ref-for-concept-microsyntax-parse-error\">parse error</a> during tokenization, return\n  \"<code>Not Nonceable</code>\".</p>"
        },
        {
          "html": "<p>Return \"<code>Nonceable</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists①⑨\">source list</a> <var>list</var> and a string <var>type</var>, the following\n  algorithm returns \"<code>Allows</code>\" if all inline content of a given <var>type</var> is\n  allowed and \"<code>Does Not Allow</code>\" otherwise.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>allow all inline</var> be <code>false</code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③⑥\">For each</a> <var>expression</var> of <var>list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-nonce-source\" id=\"ref-for-grammardef-nonce-source⑥\"><code>nonce-source</code></a> or <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-source\" id=\"ref-for-grammardef-hash-source⑥\"><code>hash-source</code></a> grammar, return \"<code>Does Not Allow</code>\".</p>"
            },
            {
              "html": "<p>If <var>type</var> is \"<code>script</code>\", \"<code>script attribute</code>\" or \"<code>navigation</code>\"\n  and <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-keyword-source\" id=\"ref-for-grammardef-keyword-source④\">keyword-source</a> \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-strict-dynamic\" id=\"ref-for-grammardef-strict-dynamic④\"><code>'strict-dynamic'</code></a>\", return \"<code>Does Not Allow</code>\".</p>"
            },
            {
              "html": "<p>If <var>expression</var> is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②①\">ASCII case-insensitive</a> match for the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-keyword-source\" id=\"ref-for-grammardef-keyword-source⑤\"><code>keyword-source</code></a> \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-unsafe-inline\" id=\"ref-for-grammardef-unsafe-inline②\"><code>'unsafe-inline'</code></a>\",\n  set <var>allow all inline</var> to <code>true</code>.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>allow all inline</var> is <code>true</code>, return \"<code>Allows</code>\".\n  Otherwise, return \"<code>Does Not Allow</code>\".</p>"
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element①⓪\">Element</a></code> <var>element</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists②③\">source list</a> <var>list</var>, a string <var>type</var>, and a string <var>source</var>, this algorithm returns \"<code>Matches</code>\" or\n  \"<code>Does Not Match</code>\".",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <a href=\"https://www.w3.org/TR/CSP3/#allow-all-inline\">§ 6.7.3.2 Does a source list allow all inline behavior for type?</a> returns \"<code>Allows</code>\" given <var>list</var> and <var>type</var>,\n  return \"<code>Matches</code>\".</p>"
        },
        {
          "html": "If <var>type</var> is \"<code>script</code>\" or \"<code>style</code>\", and <a href=\"https://www.w3.org/TR/CSP3/#is-element-nonceable\">§ 6.7.3.1 Is element nonceable?</a> returns \"<code>Nonceable</code>\" when executed upon <var>element</var>:",
          "rationale": "for",
          "steps": [
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③⑦\">For each</a> <var>expression</var> of <var>list</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-nonce-source\" id=\"ref-for-grammardef-nonce-source⑦\"><code>nonce-source</code></a> grammar,\n  and <var>element</var> has a <code><a data-link-type=\"element-sub\" href=\"https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce\" id=\"ref-for-attr-nonce\">nonce</a></code> attribute whose value <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-is\" id=\"ref-for-string-is②\">is</a> <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-base64-value\" id=\"ref-for-grammardef-base64-value⑥\"><code>base64-value</code></a> part,\n  return \"<code>Matches</code>\".</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Let <var>unsafe-hashes flag</var> be <code>false</code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③⑧\">For each</a> <var>expression</var> of <var>list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>expression</var> is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②②\">ASCII case-insensitive</a> match for the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-keyword-source\" id=\"ref-for-grammardef-keyword-source⑥\"><code>keyword-source</code></a> \"<a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-unsafe-hashes\" id=\"ref-for-grammardef-unsafe-hashes\"><code>'unsafe-hashes'</code></a>\",\n  set <var>unsafe-hashes flag</var> to <code>true</code>. Break out of the loop.</p>"
            }
          ]
        },
        {
          "html": "If <var>type</var> is \"<code>script</code>\" or \"<code>style</code>\", or <var>unsafe-hashes flag</var> is <code>true</code>:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>source</var> to the result of executing <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode\">UTF-8 encode</a> on the result of executing <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#javascript-string-convert\" id=\"ref-for-javascript-string-convert\">JavaScript string converting</a> on <var>source</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③⑨\">For each</a> <var>expression</var> of <var>list</var>:",
              "rationale": "if",
              "steps": [
                {
                  "html": "If <var>expression</var> matches the <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-source\" id=\"ref-for-grammardef-hash-source⑦\"><code>hash-source</code></a> grammar:",
                  "rationale": "let",
                  "steps": [
                    {
                      "html": "<p>Let <var>algorithm</var> be null.</p>"
                    },
                    {
                      "html": "<p>If <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm\" id=\"ref-for-grammardef-hash-algorithm③\"><code>hash-algorithm</code></a> part is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②③\">ASCII case-insensitive</a> match for \"sha256\", set <var>algorithm</var> to <a data-link-type=\"dfn\" href=\"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#\" id=\"ref-for-something①\">SHA-256</a>.</p>"
                    },
                    {
                      "html": "<p>If <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm\" id=\"ref-for-grammardef-hash-algorithm④\"><code>hash-algorithm</code></a> part is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②④\">ASCII case-insensitive</a> match for \"sha384\", set <var>algorithm</var> to <a data-link-type=\"dfn\" data-refhint-key=\"fe0b17c4\" href=\"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#\" id=\"ref-for-something②\">SHA-384</a>.</p>"
                    },
                    {
                      "html": "<p>If <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-hash-algorithm\" id=\"ref-for-grammardef-hash-algorithm⑤\"><code>hash-algorithm</code></a> part is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive②⑤\">ASCII case-insensitive</a> match for \"sha512\", set <var>algorithm</var> to <a data-link-type=\"dfn\" data-refhint-key=\"6a5840b7\" href=\"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#\" id=\"ref-for-something③\">SHA-512</a>.</p>"
                    },
                    {
                      "html": "If <var>algorithm</var> is not null:",
                      "rationale": "let",
                      "steps": [
                        {
                          "html": "<p>Let <var>actual</var> be the result of <a data-link-type=\"dfn\" href=\"https://tools.ietf.org/html/rfc4648#section-4\" id=\"ref-for-section-4①\">base64 encoding</a> the\n  result of applying <var>algorithm</var> to <var>source</var>.</p>"
                        },
                        {
                          "html": "<p>Let <var>expected</var> be <var>expression</var>’s <a data-link-type=\"grammar\" href=\"https://www.w3.org/TR/CSP3/#grammardef-base64-value\" id=\"ref-for-grammardef-base64-value⑦\"><code>base64-value</code></a> part,\n  with all '<code>-</code>' characters replaced with '<code>+</code>', and all '<code>_</code>' characters\n  replaced with '<code>/</code>'.</p>"
                        },
                        {
                          "html": "<p>If <var>actual</var> is <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#string-is\" id=\"ref-for-string-is③\">identical to</a> <var>expected</var>, return \"<code>Matches</code>\".</p>"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "html": "Given an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://dom.spec.whatwg.org/#element\" id=\"ref-for-element①⓪\">Element</a></code> <var>element</var>, a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#source-lists\" id=\"ref-for-source-lists②③\">source list</a> <var>list</var>, a string <var>type</var>, and a string <var>source</var>, this algorithm returns \"<code>Matches</code>\" or\n  \"<code>Does Not Match</code>\".",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return \"<code>Does Not Match</code>\".</p>"
        }
      ]
    },
    {
      "name": "request/effective directive",
      "href": "https://www.w3.org/TR/CSP3/#request-effective-directive",
      "html": "Each <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#fetch-directives\" id=\"ref-for-fetch-directives③\">fetch directive</a> controls a specific destination of <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑥③\">request</a>. Given\n  a <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request⑥④\">request</a> <var>request</var>, the following algorithm returns either\n  null or the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name①⑨\">name</a> of the request’s <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"request\" data-dfn-type=\"dfn\" data-export=\"\" id=\"request-effective-directive\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">effective directive</dfn>:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-initiator\" id=\"ref-for-concept-request-initiator②\">initiator</a> is \"<code>prefetch</code>\" or \"<code>prerender</code>\",\n  return <code>default-src</code>.</p>"
        },
        {
          "html": "<p>Switch on <var>request</var>’s <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination⑨\">destination</a>, and execute\n  the associated steps:</p>\n      <dl>\n       <dt data-md=\"\">the empty string\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>manifest</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>object</code>\"\n       </dt><dt data-md=\"\">\"<code>embed</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>frame</code>\"\n       </dt><dt data-md=\"\">\"<code>iframe</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>audio</code>\"\n       </dt><dt data-md=\"\">\"<code>track</code>\"\n       </dt><dt data-md=\"\">\"<code>video</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>font</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>image</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>style</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>script</code>\"\n       </dt><dt data-md=\"\">\"<code>xslt</code>\"\n       </dt><dt data-md=\"\">\"<code>audioworklet</code>\"\n       </dt><dt data-md=\"\">\"<code>paintworklet</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>serviceworker</code>\"\n       </dt><dt data-md=\"\">\"<code>sharedworker</code>\"\n       </dt><dt data-md=\"\">\"<code>worker</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>json</code>\"\n       </dt><dt data-md=\"\">\"<code>webidentity</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>report</code>\"\n       </dt><dd data-md=\"\">\n        \n      </dd></dl>",
          "rationale": "return",
          "steps": [
            {
              "html": "<p>Return <code>connect-src</code>.</p>"
            }
          ],
          "additional": [
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>manifest-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>object-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>frame-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>media-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>font-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>img-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>style-src-elem</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>script-src-elem</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>worker-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>connect-src</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return null.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <code>connect-src</code>.</p>"
        }
      ]
    },
    {
      "html": "Given a string <var>type</var>, this algorithm returns the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name②⓪\">name</a> of the effective directive.",
      "rationale": "switch",
      "steps": [
        {
          "html": "<p>Switch on <var>type</var>:</p>\n      <dl>\n       <dt data-md=\"\">\"<code>script</code>\"\n       </dt><dt data-md=\"\">\"<code>navigation</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>script attribute</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>style</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>style attribute</code>\"\n       </dt><dd data-md=\"\">\n        \n      </dd></dl>",
          "rationale": "return",
          "steps": [
            {
              "html": "<p>Return <code>script-src-elem</code>.</p>"
            }
          ],
          "additional": [
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>script-src-attr</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>style-src-elem</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>style-src-attr</code>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return null.</p>"
        }
      ]
    },
    {
      "html": "Given a string <var>directive name</var>:",
      "rationale": "switch",
      "steps": [
        {
          "html": "<p>Switch on <var>directive name</var>:</p>\n      <dl>\n       <dt data-md=\"\">\"<code>script-src-elem</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>script-src-attr</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>style-src-elem</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>style-src-attr</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>worker-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>connect-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>manifest-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>object-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>frame-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>media-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>font-src</code>\"\n       </dt><dd data-md=\"\">\n        \n       </dd><dt data-md=\"\">\"<code>img-src</code>\"\n       </dt><dd data-md=\"\">\n        \n      </dd></dl>",
          "rationale": "return",
          "steps": [
            {
              "html": "<p>Return <code>&lt;&lt; \"script-src-elem\", \"script-src\", \"default-src\" &gt;&gt;</code>.</p>"
            }
          ],
          "additional": [
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"script-src-attr\", \"script-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"style-src-elem\", \"style-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"style-src-attr\", \"style-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"worker-src\", \"child-src\", \"script-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"connect-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"manifest-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"object-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"frame-src\", \"child-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"media-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"font-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            },
            {
              "html": "",
              "rationale": "return",
              "steps": [
                {
                  "html": "<p>Return <code>&lt;&lt; \"img-src\", \"default-src\" &gt;&gt;</code>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <code>&lt;&lt; &gt;&gt;</code>.</p>"
        }
      ]
    },
    {
      "html": "Given a string <var>effective directive name</var>, a string <var>directive name</var> and\n  a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#content-security-policy-object\" id=\"ref-for-content-security-policy-object⑦⑤\">policy</a> <var>policy</var>:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>directive fallback list</var> be the result of executing <a href=\"https://www.w3.org/TR/CSP3/#directive-fallback-list\">§ 6.8.3 Get fetch directive fallback list</a> on <var>effective directive name</var>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate④⓪\">For each</a> <var>fallback directive</var> of <var>directive fallback list</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>directive name</var> is <var>fallback directive</var>, Return \"<code>Yes</code>\".</p>"
            },
            {
              "html": "<p>If <var>policy</var> contains a directive whose <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#directive-name\" id=\"ref-for-directive-name②①\">name</a> is <var>fallback directive</var>,  Return \"<code>No</code>\".</p>"
            }
          ]
        },
        {
          "html": "<p>Return \"<code>No</code>\".</p>"
        }
      ]
    }
  ]
}