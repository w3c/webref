{
  "spec": {
    "title": "WebTransport",
    "url": "https://www.w3.org/TR/webtransport/"
  },
  "algorithms": [
    {
      "name": "WebTransportDatagramsWritable/create",
      "href": "https://www.w3.org/TR/webtransport/#webtransportdatagramswritable-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportDatagramsWritable\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"create|creating\" id=\"webtransportdatagramswritable-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramswritable\" id=\"ref-for-webtransportdatagramswritable③\">WebTransportDatagramsWritable</a></code>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport①\">WebTransport</a></code> <var>transport</var>, a <var>sendGroup</var>,\n and a <var>sendOrder</var>, perform the following steps.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramswritable\" id=\"ref-for-webtransportdatagramswritable④\">WebTransportDatagramsWritable</a></code>, with:</p>\n     <dl>\n      <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot\">[[OutgoingDatagramsQueue]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>an empty queue</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-transport-slot\" id=\"ref-for-dom-webtransportdatagramswritable-transport-slot\">[[Transport]]</a></code>\n      </dt><dd data-md=\"\">\n       <p><var>transport</var></p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendgroup-slot\" id=\"ref-for-dom-webtransportdatagramswritable-sendgroup-slot\">[[SendGroup]]</a></code>\n      </dt><dd data-md=\"\">\n       <p><var>sendGroup</var></p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendorder-slot\" id=\"ref-for-dom-webtransportdatagramswritable-sendorder-slot\">[[SendOrder]]</a></code>\n      </dt><dd data-md=\"\">\n       <p><var>sendOrder</var></p>\n     </dd></dl>"
        },
        {
          "html": "<p>Let <var>writeDatagramsAlgorithm</var> be an action that runs <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#writedatagrams\" id=\"ref-for-writedatagrams\">writeDatagrams</a> with\n  <var>transport</var> and <var>stream</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up\" id=\"ref-for-writablestream-set-up\">Set up</a> <var>stream</var> with <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm\" id=\"ref-for-writablestream-set-up-writealgorithm\">writeAlgorithm</a>\n  set to <var>writeDatagramsAlgorithm</var>.</p>"
        },
        {
          "html": "<p>Return <var>stream</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramsWritable/sendGroup",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendgroup",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendgroup-slot\" id=\"ref-for-dom-webtransportdatagramswritable-sendgroup-slot①\">[[SendGroup]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramsWritable/sendGroup",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendgroup",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>value</var> is non-null, and\n  <var>value</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendgroup-transport-slot\" id=\"ref-for-dom-webtransportsendgroup-transport-slot\">[[Transport]]</a></code> is not\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-transport-slot\" id=\"ref-for-dom-webtransportdatagramswritable-transport-slot①\">[[Transport]]</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw\">throw</a>\n  an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendgroup-slot\" id=\"ref-for-dom-webtransportdatagramswritable-sendgroup-slot②\">[[SendGroup]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramsWritable/sendOrder",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendorder",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendorder-slot\" id=\"ref-for-dom-webtransportdatagramswritable-sendorder-slot①\">[[SendOrder]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramsWritable/sendOrder",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendorder",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "set",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-sendorder-slot\" id=\"ref-for-dom-webtransportdatagramswritable-sendorder-slot②\">[[SendOrder]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "writeDatagrams",
      "href": "https://www.w3.org/TR/webtransport/#writedatagrams",
      "html": "The <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"writedatagrams\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">writeDatagrams</dfn> algorithm is given a <var>transport</var> and <var>writable</var> as parameters and\n<var>data</var> as input. It is defined by running the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>timestamp</var> be a timestamp representing now.</p>"
        },
        {
          "html": "<p>If <var>data</var> is not a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#BufferSource\" id=\"ref-for-BufferSource\">BufferSource</a></code> object, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror\">TypeError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>datagrams</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot\">[[Datagrams]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot\">[[OutgoingMaxDatagramSize]]</a></code> is less than <var>data</var>’s [[ByteLength]], return\n <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\" id=\"ref-for-a-promise-resolved-with\">a promise resolved with</a> undefined.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be a new promise.</p>"
        },
        {
          "html": "<p>Let <var>bytes</var> be a copy of bytes which <var>data</var> represents.</p>"
        },
        {
          "html": "<p>Let <var>chunk</var> be a tuple of <var>bytes</var>, <var>timestamp</var> and <var>promise</var>.</p>"
        },
        {
          "html": "<p>Enqueue <var>chunk</var> to <var>writable</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot①\">[[OutgoingDatagramsQueue]]</a></code>.</p>"
        },
        {
          "html": "<p>If the length of <var>writable</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot②\">[[OutgoingDatagramsQueue]]</a></code> is less than\n <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot\">[[OutgoingDatagramsHighWaterMark]]</a></code>, then <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects\">resolve</a> <var>promise</var> with undefined.</p>"
        },
        {
          "html": "<p>Return <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "sendDatagrams",
      "href": "https://www.w3.org/TR/webtransport/#senddatagrams",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"senddatagrams\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">sendDatagrams</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport②\">WebTransport</a></code> object <var>transport</var> and a\n<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramswritable\" id=\"ref-for-webtransportdatagramswritable⑤\">WebTransportDatagramsWritable</a></code> object <var>writable</var>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task\">queue a network task</a>\nwith <var>transport</var> to run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>queue</var> be a copy of <var>writable</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot③\">[[OutgoingDatagramsQueue]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>maxSize</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot①\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot①\">[[OutgoingMaxDatagramSize]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>duration</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot②\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot\">[[OutgoingDatagramsExpirationDuration]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>duration</var> is null, then set <var>duration</var> to an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined\">implementation-defined</a> value.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel\">in parallel</a>:",
          "rationale": "while",
          "steps": [
            {
              "html": "While <var>queue</var> is not empty:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>bytes</var>, <var>timestamp</var> and <var>promise</var> be <var>queue</var>’s first element.</p>"
                },
                {
                  "html": "If more than <var>duration</var> milliseconds have passed since <var>timestamp</var>, then:",
                  "rationale": "remove",
                  "steps": [
                    {
                      "html": "<p>Remove the first element from <var>queue</var>.</p>"
                    },
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①\">Queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①\">resolve</a> <var>promise</var> with undefined.</p>"
                    }
                  ]
                },
                {
                  "html": "<p>Otherwise, break this loop.</p>"
                }
              ]
            },
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot\">[[State]]</a></code> is not <code>\"connected\"</code>, then return.</p>"
            },
            {
              "html": "While <var>queue</var> is not empty:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>bytes</var>, <var>timestamp</var> and <var>promise</var> be <var>queue</var>’s first element.</p>"
                },
                {
                  "html": "If <var>bytes</var>’s length ≤ <var>maxSize</var>:",
                  "rationale": "if",
                  "steps": [
                    {
                      "html": "<p>If it is not possible to send <var>bytes</var> to the network immediately, then break this loop.</p>"
                    },
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-send-a-datagram\" id=\"ref-for-session-send-a-datagram①\">Send a datagram</a>, with <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot\">[[Session]]</a></code> and <var>bytes</var>.</p>"
                    }
                  ]
                },
                {
                  "html": "<p>Remove the first element from <var>queue</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②\">Queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②\">resolve</a> <var>promise</var> with undefined.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/create",
      "href": "https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportDatagramDuplexStream\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"create|creating\" id=\"webtransportdatagramduplexstream-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream\" id=\"ref-for-webtransportdatagramduplexstream②\">WebTransportDatagramDuplexStream</a></code> given a\n <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportDatagramDuplexStream/create\" data-dfn-type=\"dfn\" data-export=\"\" id=\"webtransportdatagramduplexstream-create-readable\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><var>readable</var></dfn> and\n <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportDatagramDuplexStream/create\" data-dfn-type=\"dfn\" data-export=\"\" id=\"webtransportdatagramduplexstream-create-readablemode\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><var>readableMode</var></dfn>,\n perform the following steps.",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new①\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream\" id=\"ref-for-webtransportdatagramduplexstream③\">WebTransportDatagramDuplexStream</a></code>, with:</p>\n     <dl>\n      <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot\">[[Readable]]</a></code>\n      </dt><dd data-md=\"\">\n       <p><var>readable</var></p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readablemode-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readablemode-slot\">[[ReadableMode]]</a></code>\n      </dt><dd data-md=\"\">\n       <p><var>readableMode</var></p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-writables-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-writables-slot\">[[Writables]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set①\">ordered set</a>.</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot\">[[IncomingDatagramsQueue]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>an empty queue</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\">[[IncomingDatagramsPullPromise]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>null</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot\">[[IncomingDatagramsHighWaterMark]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined①\">implementation-defined</a> value</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot\">[[IncomingDatagramsExpirationDuration]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>null</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot①\">[[OutgoingDatagramsHighWaterMark]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined②\">implementation-defined</a> value</p>\n       \n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot①\">[[OutgoingDatagramsExpirationDuration]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>null</p>\n      </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot③\">[[OutgoingMaxDatagramSize]]</a></code>\n      </dt><dd data-md=\"\">\n       <p>an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined③\">implementation-defined</a> integer.</p>\n     </dd></dl>"
        },
        {
          "html": "<p>Return <var>stream</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/createWritable(options)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-createwritable",
      "html": "When <code>createWritable()</code> method is called, the user agent MUST\n run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport⑤\">WebTransport</a></code> object associated with <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑤\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot⑤\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>,\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①\">throw</a> an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>sendGroup</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-createwritable-options-options\" id=\"ref-for-dom-webtransportdatagramduplexstream-createwritable-options-options\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendoptions-sendgroup\" id=\"ref-for-dom-webtransportsendoptions-sendgroup\">sendGroup</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>sendOrder</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-createwritable-options-options\" id=\"ref-for-dom-webtransportdatagramduplexstream-createwritable-options-options①\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendoptions-sendorder\" id=\"ref-for-dom-webtransportsendoptions-sendorder\">sendOrder</a></code>.</p>"
        },
        {
          "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramswritable-create\" id=\"ref-for-webtransportdatagramswritable-create\">creating</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramswritable\" id=\"ref-for-webtransportdatagramswritable①⓪\">WebTransportDatagramsWritable</a></code>\n  with <var>transport</var>, <var>sendGroup</var> and <var>sendOrder</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/readable",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑥\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot①\">[[Readable]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/incomingMaxAge",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingmaxage",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑦\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot①\">[[IncomingDatagramsExpirationDuration]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/incomingMaxAge",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingmaxage",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>value</var> is negative or NaN, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw②\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror\">RangeError</a></code>.</p>"
        },
        {
          "html": "<p>If <var>value</var> is <code>0</code>, set <var>value</var> to null.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this⑧\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot②\">[[IncomingDatagramsExpirationDuration]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/outgoingMaxAge",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingmaxage",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⓪\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot②\">[[OutgoingDatagramsExpirationDuration]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/outgoingMaxAge",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingmaxage",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>value</var> is negative or NaN, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw③\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror①\">RangeError</a></code>.</p>"
        },
        {
          "html": "<p>If <var>value</var> is <code>0</code>, set <var>value</var> to null.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramsexpirationduration-slot③\">[[OutgoingDatagramsExpirationDuration]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/incomingHighWaterMark",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incominghighwatermark",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①②\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot①\">[[IncomingDatagramsHighWaterMark]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/incomingHighWaterMark",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incominghighwatermark",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>value</var> is negative or NaN, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw④\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror②\">RangeError</a></code>.</p>"
        },
        {
          "html": "<p>If <var>value</var> is &lt; <code>1</code>, set <var>value</var> to <code>1</code>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①③\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot②\">[[IncomingDatagramsHighWaterMark]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/outgoingHighWaterMark",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoinghighwatermark",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①④\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot②\">[[OutgoingDatagramsHighWaterMark]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportDatagramDuplexStream/outgoingHighWaterMark",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoinghighwatermark",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>value</var> is negative or NaN, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑤\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror③\">RangeError</a></code>.</p>"
        },
        {
          "html": "<p>If <var>value</var> is &lt; <code>1</code>, set <var>value</var> to <code>1</code>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑤\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingdatagramshighwatermark-slot③\">[[OutgoingDatagramsHighWaterMark]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "pullDatagrams",
      "href": "https://www.w3.org/TR/webtransport/#pulldatagrams",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pulldatagrams\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pullDatagrams</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport⑥\">WebTransport</a></code> object <var>transport</var>, run these steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>datagrams</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot③\">[[Datagrams]]</a></code>.</p>"
        },
        {
          "html": "<p class=\"assertion\">Assert: <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot①\">[[IncomingDatagramsPullPromise]]</a></code> is null.</p>"
        },
        {
          "html": "<p>Let <var>queue</var> be <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot①\">[[IncomingDatagramsQueue]]</a></code>.</p>"
        },
        {
          "html": "If <var>queue</var> is empty, then:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot②\">[[IncomingDatagramsPullPromise]]</a></code> to a new promise.</p>"
            },
            {
              "html": "<p>Return <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot③\">[[IncomingDatagramsPullPromise]]</a></code>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>datagram</var> and <var>timestamp</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue-dequeue\" id=\"ref-for-queue-dequeue\">dequeuing</a> <var>queue</var>.</p>"
        },
        {
          "html": "If <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readablemode-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readablemode-slot①\">[[ReadableMode]]</a></code> is <code>\"bytes\"</code>, then:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot②\">[[Readable]]</a></code>’s\n<a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\" id=\"ref-for-readablestream-current-byob-request-view\">current BYOB request view</a> is not null, then:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>view</var> be <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot③\">[[Readable]]</a></code>’s\n<a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\" id=\"ref-for-readablestream-current-byob-request-view①\">current BYOB request view</a>.</p>"
                },
                {
                  "html": "<p>If <var>view</var>’s <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-byte-length\" id=\"ref-for-buffersource-byte-length\">byte length</a> is less than the size of <var>datagram</var>, return\n<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with①\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror④\">RangeError</a></code>.</p>"
                },
                {
                  "html": "<p>Let <var>elementSize</var> be the element size specified in <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#table-49\" id=\"ref-for-table-49\">the typed array constructors table</a> for\n<var>view</var>.[[TypedArrayName]]. If <var>view</var> does not have a [[TypedArrayName]] internal slot\n(i.e. it is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DataView\" id=\"ref-for-idl-DataView\">DataView</a></code>), let <var>elementSize</var> be 0.</p>"
                },
                {
                  "html": "<p>If <var>elementSize</var> is not 1, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with②\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror①\">TypeError</a></code>.</p>"
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-pull-from-bytes\" id=\"ref-for-readablestream-pull-from-bytes\">Pull from bytes</a> <var>datagram</var> into\n <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot④\">[[Readable]]</a></code>.</p>"
            }
          ]
        },
        {
          "html": "Otherwise:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>chunk</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-Uint8Array\" id=\"ref-for-idl-Uint8Array\">Uint8Array</a></code> object representing <var>datagram</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-enqueue\" id=\"ref-for-readablestream-enqueue\">Enqueue</a> <var>chunk</var> to\n <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot④\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot⑤\">[[Readable]]</a></code>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-resolved-with\" id=\"ref-for-a-promise-resolved-with①\">a promise resolved with</a> undefined.</p>"
        }
      ]
    },
    {
      "name": "receiveDatagrams",
      "href": "https://www.w3.org/TR/webtransport/#receivedatagrams",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"receivedatagrams\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">receiveDatagrams</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport⑦\">WebTransport</a></code> object <var>transport</var>, run these steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>timestamp</var> be a timestamp representing now.</p>"
        },
        {
          "html": "<p>Let <var>queue</var> be <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot②\">[[IncomingDatagramsQueue]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>duration</var> be <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsexpirationduration-slot③\">[[IncomingDatagramsExpirationDuration]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>duration</var> is null, then set <var>duration</var> to an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined④\">implementation-defined</a> value.</p>"
        },
        {
          "html": "<p>Let <var>session</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot①\">[[Session]]</a></code>.</p>"
        },
        {
          "html": "While there are <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-receive-a-datagram\" id=\"ref-for-session-receive-a-datagram\">available incoming datagrams</a> on <var>session</var>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>datagram</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-receive-a-datagram\" id=\"ref-for-session-receive-a-datagram①\">receiving a datagram</a> with <var>session</var>.</p>"
            },
            {
              "html": "<p>Let <var>timestamp</var> be a timestamp representing now.</p>"
            },
            {
              "html": "<p>Let <var>chunk</var> be a pair of <var>datagram</var> and <var>timestamp</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue-enqueue\" id=\"ref-for-queue-enqueue\">Enqueue</a> <var>chunk</var> to <var>queue</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>toBeRemoved</var> be the length of <var>queue</var> minus <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramshighwatermark-slot③\">[[IncomingDatagramsHighWaterMark]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>toBeRemoved</var> is positive, repeat <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue-dequeue\" id=\"ref-for-queue-dequeue①\">dequeuing</a> <var>queue</var> <var>toBeRemoved</var>\n (<a href=\"https://tc39.github.io/ecma262/#eqn-floor\">rounded down</a>) times.</p>"
        },
        {
          "html": "While <var>queue</var> is not empty:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>bytes</var> and <var>timestamp</var> be <var>queue</var>’s first element.</p>"
            },
            {
              "html": "<p>If more than <var>duration</var> milliseconds have passed since <var>timestamp</var>, then <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue-dequeue\" id=\"ref-for-queue-dequeue②\">dequeue</a> <var>queue</var>.</p>"
            },
            {
              "html": "<p>Otherwise, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#iteration-break\" id=\"ref-for-iteration-break\">break</a> this loop.</p>"
            }
          ]
        },
        {
          "html": "If <var>queue</var> is not empty and <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot④\">[[IncomingDatagramsPullPromise]]</a></code> is non-null, then:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>bytes</var> and <var>timestamp</var> be the result of <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue-dequeue\" id=\"ref-for-queue-dequeue③\">dequeuing</a> <var>queue</var>.</p>"
            },
            {
              "html": "<p>Let <var>promise</var> be <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot⑤\">[[IncomingDatagramsPullPromise]]</a></code>.</p>"
            },
            {
              "html": "<p>Set <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramspullpromise-slot⑥\">[[IncomingDatagramsPullPromise]]</a></code> to null.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>chunk</var> be a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-Uint8Array\" id=\"ref-for-idl-Uint8Array①\">Uint8Array</a></code> object representing <var>bytes</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-enqueue\" id=\"ref-for-readablestream-enqueue①\">Enqueue</a> <var>chunk</var> to <var>datagrams</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot⑥\">[[Readable]]</a></code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③\">Resolve</a> <var>promise</var> with undefined.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "webtransport-contructor",
      "html": "When the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport\" id=\"ref-for-dom-webtransport-webtransport\">WebTransport()</a></code> constructor is invoked, the user\nagent MUST run the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>baseURL</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑥\">this</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object\">relevant settings object</a>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#api-base-url\" id=\"ref-for-api-base-url\">API base URL</a>.</p>"
        },
        {
          "html": "<p>Let <var>parsedURL</var> be the <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url\" id=\"ref-for-concept-url\">URL record</a> resulting from <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-parser\" id=\"ref-for-concept-url-parser\">parsing</a>\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-url\" id=\"ref-for-dom-webtransport-webtransport-url-options-url\">url</a></code> with <var>baseURL</var>.</p>"
        },
        {
          "html": "<p>If <var>parsedURL</var> is a failure, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑥\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\" id=\"ref-for-syntaxerror\">SyntaxError</a></code> exception.</p>"
        },
        {
          "html": "<p>If <var>parsedURL</var> <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-scheme\" id=\"ref-for-concept-url-scheme\">scheme</a> is not <code>https</code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑦\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\" id=\"ref-for-syntaxerror①\">SyntaxError</a></code> exception.</p>"
        },
        {
          "html": "<p>If <var>parsedURL</var> <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url-fragment\" id=\"ref-for-concept-url-fragment\">fragment</a> is not null, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑧\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\" id=\"ref-for-syntaxerror②\">SyntaxError</a></code> exception.</p>"
        },
        {
          "html": "<p>Let <var>allowPooling</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-allowpooling\" id=\"ref-for-dom-webtransportoptions-allowpooling\">allowPooling</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>dedicated</var> be the negation of <var>allowPooling</var>.</p>"
        },
        {
          "html": "<p>Let <var>serverCertificateHashes</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options①\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-servercertificatehashes\" id=\"ref-for-dom-webtransportoptions-servercertificatehashes\">serverCertificateHashes</a></code> if it exists, and null otherwise.</p>"
        },
        {
          "html": "<p>If <var>dedicated</var> is false and <var>serverCertificateHashes</var> is non-null, then <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw⑨\">throw</a> a\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#notsupportederror\" id=\"ref-for-notsupportederror\">NotSupportedError</a></code> exception.</p>"
        },
        {
          "html": "<p>Let <var>requireUnreliable</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options②\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-requireunreliable\" id=\"ref-for-dom-webtransportoptions-requireunreliable\">requireUnreliable</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>congestionControl</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options③\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-congestioncontrol\" id=\"ref-for-dom-webtransportoptions-congestioncontrol\">congestionControl</a></code>.</p>"
        },
        {
          "html": "<p>If <var>congestionControl</var> is not <code>\"default\"</code>, and the user agent does not support any\n congestion control algorithms that optimize for <var>congestionControl</var>, as allowed by\n <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-rfc9002\" title=\"QUIC Loss Detection and Congestion Control\">[RFC9002]</a> <a href=\"https://www.rfc-editor.org/rfc/rfc9002#section-7\">Section 7</a>,\n then set <var>congestionControl</var> to <code>\"default\"</code>.</p>"
        },
        {
          "html": "<p>Let <var>protocols</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options④\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-protocols\" id=\"ref-for-dom-webtransportoptions-protocols\">protocols</a></code></p>"
        },
        {
          "html": "<p>If any of the values in <var>protocols</var> occur more than once, fail to match\n the requirements for elements that comprise the value of the negotiated\n application protocol as defined by the WebTransport protocol, or have an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#isomorphic-encode\" id=\"ref-for-isomorphic-encode②\">isomorphic encoded</a>\n length of 0 or exceeding 512, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①⓪\">throw</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#syntaxerror\" id=\"ref-for-syntaxerror③\">SyntaxError</a></code> exception.\n <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-web-transport-overview\" title=\"WebTransport Protocol Framework\">[WEB-TRANSPORT-OVERVIEW]</a>\n <a href=\"https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview-09/#section-3.1\">Section 3.1</a>.</p>"
        },
        {
          "html": "<p>Let <var>anticipatedConcurrentIncomingUnidirectionalStreams</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options⑤\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-anticipatedconcurrentincomingunidirectionalstreams\" id=\"ref-for-dom-webtransportoptions-anticipatedconcurrentincomingunidirectionalstreams\">anticipatedConcurrentIncomingUnidirectionalStreams</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>anticipatedConcurrentIncomingBidirectionalStreams</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options⑥\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-anticipatedconcurrentincomingbidirectionalstreams\" id=\"ref-for-dom-webtransportoptions-anticipatedconcurrentincomingbidirectionalstreams\">anticipatedConcurrentIncomingBidirectionalStreams</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>datagramsReadableMode</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-webtransport-url-options-options\" id=\"ref-for-dom-webtransport-webtransport-url-options-options⑦\">options</a></code>’s\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportoptions-datagramsreadablemode\" id=\"ref-for-dom-webtransportoptions-datagramsreadablemode\">datagramsReadableMode</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>incomingDatagrams</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new②\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://streams.spec.whatwg.org/#readablestream\" id=\"ref-for-readablestream⑦\">ReadableStream</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>datagrams</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream-create\" id=\"ref-for-webtransportdatagramduplexstream-create\">creating</a> a\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream\" id=\"ref-for-webtransportdatagramduplexstream⑥\">WebTransportDatagramDuplexStream</a></code>, its <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream-create-readable\" id=\"ref-for-webtransportdatagramduplexstream-create-readable\">readable</a> set to\n <var>incomingDatagrams</var> and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportdatagramduplexstream-create-readablemode\" id=\"ref-for-webtransportdatagramduplexstream-create-readablemode\">readableMode</a> set to <var>datagramsReadableMode</var>.</p>"
        },
        {
          "html": "<p>Let <var>transport</var> be a newly constructed <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport①④\">WebTransport</a></code> object, with:</p>\n      <dl>\n       <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot\">[[SendStreams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set④\">ordered set</a></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot\">[[ReceiveStreams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set⑤\">ordered set</a></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingbidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingbidirectionalstreams-slot\">[[IncomingBidirectionalStreams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://streams.spec.whatwg.org/#readablestream\" id=\"ref-for-readablestream⑧\">ReadableStream</a></code></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingunidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingunidirectionalstreams-slot\">[[IncomingUnidirectionalStreams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://streams.spec.whatwg.org/#readablestream\" id=\"ref-for-readablestream⑨\">ReadableStream</a></code></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot⑦\">[[State]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><code>\"connecting\"</code></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-ready-slot\" id=\"ref-for-dom-webtransport-ready-slot\">[[Ready]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>a new promise</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-reliability-slot\" id=\"ref-for-dom-webtransport-reliability-slot\">[[Reliability]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>\"pending\"</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-congestioncontrol-slot\" id=\"ref-for-dom-webtransport-congestioncontrol-slot\">[[CongestionControl]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>congestionControl</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-anticipatedconcurrentincomingunidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-anticipatedconcurrentincomingunidirectionalstreams-slot\">[[AnticipatedConcurrentIncomingUnidirectionalStreams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>anticipatedConcurrentIncomingUnidirectionalStreams</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-anticipatedconcurrentincomingbidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-anticipatedconcurrentincomingbidirectionalstreams-slot\">[[AnticipatedConcurrentIncomingBidirectionalStreams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>anticipatedConcurrentIncomingBidirectionalStreams</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-protocol-slot\" id=\"ref-for-dom-webtransport-protocol-slot\">[[Protocol]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>an empty string</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-closed-slot\" id=\"ref-for-dom-webtransport-closed-slot\">[[Closed]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>a new promise</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-draining-slot\" id=\"ref-for-dom-webtransport-draining-slot\">[[Draining]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>a new promise</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot⑤\">[[Datagrams]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>datagrams</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot②\">[[Session]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>null</p>\n      </dd></dl>"
        },
        {
          "html": "<p>Let <var>pullDatagramsAlgorithm</var> be an action that runs <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#pulldatagrams\" id=\"ref-for-pulldatagrams①\">pullDatagrams</a> with <var>transport</var>.</p>"
        },
        {
          "html": "<p>If <var>datagramsReadableMode</var> is <code>\"bytes\"</code>, <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support\" id=\"ref-for-readablestream-set-up-with-byte-reading-support\">set up with byte reading support</a>\n <var>incomingDatagrams</var> with <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-pullalgorithm\" id=\"ref-for-readablestream-set-up-with-byte-reading-support-pullalgorithm\">pullAlgorithm</a> set\n to <var>pullDatagramsAlgorithm</var>, and <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-highwatermark\" id=\"ref-for-readablestream-set-up-with-byte-reading-support-highwatermark\">highWaterMark</a>\n set to 0. Otherwise, <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up\" id=\"ref-for-readablestream-set-up\">set up</a> <var>incomingDatagrams</var> with\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-pullalgorithm\" id=\"ref-for-readablestream-set-up-pullalgorithm\">pullAlgorithm</a> set to <var>pullDatagramsAlgorithm</var>, and\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-highwatermark\" id=\"ref-for-readablestream-set-up-highwatermark\">highWaterMark</a> set to 0.</p>"
        },
        {
          "html": "<p>Let <var>pullBidirectionalStreamAlgorithm</var> be an action that runs <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#pullbidirectionalstream\" id=\"ref-for-pullbidirectionalstream\">pullBidirectionalStream</a>\n with <var>transport</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up\" id=\"ref-for-readablestream-set-up①\">Set up</a> <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingbidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingbidirectionalstreams-slot①\">[[IncomingBidirectionalStreams]]</a></code> with\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-pullalgorithm\" id=\"ref-for-readablestream-set-up-pullalgorithm①\">pullAlgorithm</a> set to <var>pullBidirectionalStreamAlgorithm</var>, and\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-highwatermark\" id=\"ref-for-readablestream-set-up-highwatermark①\">highWaterMark</a> set to 0.</p>"
        },
        {
          "html": "<p>Let <var>pullUnidirectionalStreamAlgorithm</var> be an action that runs <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#pullunidirectionalstream\" id=\"ref-for-pullunidirectionalstream\">pullUnidirectionalStream</a>\n with <var>transport</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up\" id=\"ref-for-readablestream-set-up②\">Set up</a> <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingunidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingunidirectionalstreams-slot①\">[[IncomingUnidirectionalStreams]]</a></code> with\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-pullalgorithm\" id=\"ref-for-readablestream-set-up-pullalgorithm②\">pullAlgorithm</a> set to <var>pullUnidirectionalStreamAlgorithm</var>, and\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-highwatermark\" id=\"ref-for-readablestream-set-up-highwatermark②\">highWaterMark</a> set to 0.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#initialize-webtransport-over-http\" id=\"ref-for-initialize-webtransport-over-http\">Initialize WebTransport over HTTP</a> with <var>transport</var>, <var>parsedURL</var>, <var>dedicated</var>,\n <var>requireUnreliable</var>, <var>congestionControl</var>, <var>protocols</var>, and <var>serverCertificateHashes</var>.</p>"
        },
        {
          "html": "<p>Return <var>transport</var>.</p>"
        }
      ]
    },
    {
      "name": "initialize WebTransport over HTTP",
      "href": "https://www.w3.org/TR/webtransport/#initialize-webtransport-over-http",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"initialize-webtransport-over-http\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">initialize WebTransport over HTTP</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport①⑤\">WebTransport</a></code> object\n<var>transport</var>, a <a data-link-type=\"dfn\" href=\"https://url.spec.whatwg.org/#concept-url\" id=\"ref-for-concept-url①\">URL record</a> <var>url</var>, a boolean <var>dedicated</var>, a boolean\n<var>requireUnreliable</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#enumdef-webtransportcongestioncontrol\" id=\"ref-for-enumdef-webtransportcongestioncontrol②\">WebTransportCongestionControl</a></code> <var>congestionControl</var>,\na <var>protocols</var> array, and a\nsequence&lt;<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dictdef-webtransporthash\" id=\"ref-for-dictdef-webtransporthash\">WebTransportHash</a></code>&gt; <var>serverCertificateHashes</var>, run these steps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>client</var> be <var>transport</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object①\">relevant settings object</a>.</p>"
        },
        {
          "html": "<p>Let <var>origin</var> be <var>client</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin\" id=\"ref-for-concept-settings-object-origin\">origin</a>.</p>"
        },
        {
          "html": "<p>Let <var>request</var> be a new <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request\" id=\"ref-for-concept-request\">request</a> whose <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-url\" id=\"ref-for-concept-request-url\">URL</a> is <var>url</var>, <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-client\" id=\"ref-for-concept-request-client\">client</a> is\n <var>client</var>, <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-policy-container\" id=\"ref-for-concept-request-policy-container\">policy container</a> is <var>client</var>’s\n <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-policy-container\" id=\"ref-for-concept-settings-object-policy-container\">policy container</a>, <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-destination\" id=\"ref-for-concept-request-destination\">destination</a> is an empty string,\n <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-origin\" id=\"ref-for-concept-request-origin\">origin</a> is <var>origin</var> and <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-request-redirect-mode\" id=\"ref-for-concept-request-redirect-mode\">redirect mode</a> is \"error\".</p>"
        },
        {
          "html": "<p>Run <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#report-for-request\" id=\"ref-for-report-for-request\">report Content Security Policy violations for <var>request</var></a>.</p>"
        },
        {
          "html": "If <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/CSP3/#should-block-request\" id=\"ref-for-should-block-request\">should request be blocked by Content Security Policy?</a> with <var>request</var> returns\n <b>\"Blocked\"</b>, or if <var>request</var> <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#block-bad-port\" id=\"ref-for-block-bad-port\">should be blocked due to a bad port</a>\n returns <b>blocked</b>, then abort the remaining steps and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task④\">queue a network task</a> with <var>transport</var>\n to run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot⑧\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, then abort these steps.</p>"
            },
            {
              "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source\">source</a></code> is <code>\"session\"</code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>networkPartitionKey</var> be the result of <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#determine-the-network-partition-key\" id=\"ref-for-determine-the-network-partition-key\">determining the network partition key</a> with\n <var>transport</var>’s <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object\" id=\"ref-for-relevant-settings-object②\">relevant settings object</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①\">in parallel</a>, but <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#abort-when\" id=\"ref-for-abort-when\">abort when</a> <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot⑨\">[[State]]</a></code> becomes <code>\"closed\"</code> or <code>\"failed\"</code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>newConnection</var> be \"<code>no</code>\" if <var>dedicated</var> is false; otherwise \"<code>yes-and-dedicated</code>\".</p>"
            },
            {
              "html": "<p>Let <var>connection</var> be the result of <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-connection-obtain\" id=\"ref-for-concept-connection-obtain\">obtaining a connection</a> with\n <var>networkPartitionKey</var>, <var>url</var>, false, <var>newConnection</var>, and <var>requireUnreliable</var>. If the user agent\n supports more than one congestion control algorithm, choose one appropriate for\n <var>congestionControl</var> for sending of data on this <var>connection</var>. When obtaining a connection, if\n <var>serverCertificateHashes</var> is specified, instead of using the default certificate verification\n algorithm, consider the certificate valid if it meets the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#custom-certificate-requirements\" id=\"ref-for-custom-certificate-requirements\">custom certificate requirements</a> and if <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#verify-a-certificate-hash\" id=\"ref-for-verify-a-certificate-hash\">verifying the certificate hash</a> against\n <var>serverCertificateHashes</var> returns true. If either condition is not met, let <var>connection</var> be\n failure.</p>"
            },
            {
              "html": "If <var>connection</var> is failure, then abort the remaining steps and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task⑤\">queue a network task</a> with\n <var>transport</var> to run these steps:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①⓪\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, then abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception①\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror①\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source①\">source</a></code> is <code>\"session\"</code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup①\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
                }
              ]
            },
            {
              "html": "<p>Wait for <var>connection</var> to receive the first SETTINGS frame, and let <var>settings</var> be a dictionary that\n represents the SETTINGS frame.</p>"
            },
            {
              "html": "If <var>settings</var> doesn’t contain SETTINGS_ENABLE_WEBTRANPORT with a value of 1, or it doesn’t\n contain H3_DATAGRAM with a value of 1, then abort the remaining steps and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task⑥\">queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①①\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, then abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception②\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror②\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source②\">source</a></code> is <code>\"session\"</code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup②\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
                }
              ]
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-establish\" id=\"ref-for-session-establish②\">Establish</a> a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-session\" id=\"ref-for-protocol-webtransport-session①①\">WebTransport session</a> with <var>origin</var> and <var>protocols</var> on <var>connection</var>.</p>"
            },
            {
              "html": "If the previous step fails, abort the remaining steps and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task⑦\">queue a network task</a> with\n <var>transport</var> to run these steps:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①②\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, then abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception③\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror③\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source③\">source</a></code> is <code>\"session\"</code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup③\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
                }
              ]
            },
            {
              "html": "<p>Let <var>session</var> be the established <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-session\" id=\"ref-for-protocol-webtransport-session①②\">WebTransport session</a>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task⑧\">Queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "assert",
              "steps": [
                {
                  "html": "<p class=\"assertion\">Assert: <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this①⑦\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot⑥\">[[Datagrams]]</a></code>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-outgoingmaxdatagramsize-slot⑤\">[[OutgoingMaxDatagramSize]]</a></code> is an integer.</p>"
                },
                {
                  "html": "If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①③\">[[State]]</a></code> is not <code>\"connecting\"</code>:",
                  "rationale": "in parallel",
                  "steps": [
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel②\">In parallel</a>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-terminate\" id=\"ref-for-session-terminate\">terminate</a> <var>session</var>.</p>"
                    },
                    {
                      "html": "<p>Abort these steps.</p>"
                    }
                  ]
                },
                {
                  "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①④\">[[State]]</a></code> to <code>\"connected\"</code>.</p>"
                },
                {
                  "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot③\">[[Session]]</a></code> to <var>session</var>.</p>"
                },
                {
                  "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-protocol-slot\" id=\"ref-for-dom-webtransport-protocol-slot①\">[[Protocol]]</a></code> to either the string value of the negotiated application\n protocol if present, following <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-web-transport-overview\" title=\"WebTransport Protocol Framework\">[WEB-TRANSPORT-OVERVIEW]</a>\n <a href=\"https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview-09/#section-3.1\">Section 3.1</a>,\n or <code>\"\"</code> if not present.</p>"
                },
                {
                  "html": "<p>If the connection is an HTTP/3 connection, set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-reliability-slot\" id=\"ref-for-dom-webtransport-reliability-slot①\">[[Reliability]]</a></code> to <code>\"supports-unreliable\"</code>.</p>"
                },
                {
                  "html": "<p>If the connection is an HTTP/2 connection <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-web-transport-http2\" title=\"WebTransport over HTTP/2\">[WEB-TRANSPORT-HTTP2]</a>, set <var>transport</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-reliability-slot\" id=\"ref-for-dom-webtransport-reliability-slot②\">[[Reliability]]</a></code> to <code>\"reliable-only\"</code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects④\">Resolve</a> <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-ready-slot\" id=\"ref-for-dom-webtransport-ready-slot①\">[[Ready]]</a></code> with undefined.</p>"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "pullBidirectionalStream",
      "href": "https://www.w3.org/TR/webtransport/#pullbidirectionalstream",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pullbidirectionalstream\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pullBidirectionalStream</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport①⑥\">WebTransport</a></code> object <var>transport</var>, run\nthese steps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①⑤\">[[State]]</a></code> is <code>\"connecting\"</code>, then return the result of performing the\n following steps <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#upon-fulfillment\" id=\"ref-for-upon-fulfillment\">upon fulfillment</a> of <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-ready-slot\" id=\"ref-for-dom-webtransport-ready-slot②\">[[Ready]]</a></code>:",
          "rationale": "return",
          "steps": [
            {
              "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#pullbidirectionalstream\" id=\"ref-for-pullbidirectionalstream①\">pullBidirectionalStream</a> with <var>transport</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①⑥\">[[State]]</a></code> is not <code>\"connected\"</code>, then return a new <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑤\">rejected</a> promise with\n an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror②\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>session</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot④\">[[Session]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel③\">in parallel</a>:",
          "rationale": "wait",
          "steps": [
            {
              "html": "<p>Wait until there is an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-receive-a-bidirectional-stream\" id=\"ref-for-session-receive-a-bidirectional-stream\">available incoming bidirectional\n stream</a> in <var>session</var>.</p>"
            },
            {
              "html": "<p>Let <var>internalStream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-receive-a-bidirectional-stream\" id=\"ref-for-session-receive-a-bidirectional-stream①\">receiving a bidirectional stream</a> from <var>session</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task⑨\">Queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>stream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#bidirectionalstream-create\" id=\"ref-for-bidirectionalstream-create\">creating</a> a\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportbidirectionalstream\" id=\"ref-for-webtransportbidirectionalstream②\">WebTransportBidirectionalStream</a></code> with <var>internalStream</var> and <var>transport</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-enqueue\" id=\"ref-for-readablestream-enqueue②\">Enqueue</a> <var>stream</var> to <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingbidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingbidirectionalstreams-slot②\">[[IncomingBidirectionalStreams]]</a></code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑥\">Resolve</a> <var>p</var> with undefined.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "pullUnidirectionalStream",
      "href": "https://www.w3.org/TR/webtransport/#pullunidirectionalstream",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"pullunidirectionalstream\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pullUnidirectionalStream</dfn>, given a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport①⑦\">WebTransport</a></code> object <var>transport</var>, run\nthese steps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①⑦\">[[State]]</a></code> is <code>\"connecting\"</code>, then return the result of performing the\n following steps <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#upon-fulfillment\" id=\"ref-for-upon-fulfillment①\">upon fulfillment</a> of <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-ready-slot\" id=\"ref-for-dom-webtransport-ready-slot③\">[[Ready]]</a></code>:",
          "rationale": "return",
          "steps": [
            {
              "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#pullunidirectionalstream\" id=\"ref-for-pullunidirectionalstream①\">pullUnidirectionalStream</a> with <var>transport</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①⑧\">[[State]]</a></code> is not <code>\"connected\"</code>, then return a new <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑦\">rejected</a> promise with\n an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror③\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>session</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot⑤\">[[Session]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel④\">in parallel</a>:",
          "rationale": "wait",
          "steps": [
            {
              "html": "<p>Wait until there is an\n <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-receive-an-incoming-unidirectional-stream\" id=\"ref-for-session-receive-an-incoming-unidirectional-stream\">available incoming unidirectional stream</a> in <var>session</var>.</p>"
            },
            {
              "html": "<p>Let <var>internalStream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-receive-an-incoming-unidirectional-stream\" id=\"ref-for-session-receive-an-incoming-unidirectional-stream①\">receiving an incoming unidirectional stream</a> from <var>session</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①⓪\">Queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>stream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream-create\" id=\"ref-for-webtransportreceivestream-create\">creating</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream②\">WebTransportReceiveStream</a></code> with\n <var>internalStream</var> and <var>transport</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-enqueue\" id=\"ref-for-readablestream-enqueue③\">Enqueue</a> <var>stream</var> to <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingunidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingunidirectionalstreams-slot②\">[[IncomingUnidirectionalStreams]]</a></code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑧\">Resolve</a> <var>p</var> with undefined.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/datagrams",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams",
      "html": "A single duplex stream for sending and receiving datagrams over this session.\n The getter steps for the <code>datagrams</code> attribute SHALL be:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②①\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot⑦\">[[Datagrams]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/incomingBidirectionalStreams",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-incomingbidirectionalstreams",
      "html": "The getter steps for the <code>incomingBidirectionalStreams</code> attribute SHALL be:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②②\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingbidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingbidirectionalstreams-slot③\">[[IncomingBidirectionalStreams]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/incomingUnidirectionalStreams",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-incomingunidirectionalstreams",
      "html": "The getter steps for <code>incomingUnidirectionalStreams</code> are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this②③\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingunidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingunidirectionalstreams-slot③\">[[IncomingUnidirectionalStreams]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/close(closeInfo)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-close",
      "html": "<dl>\n     <dt data-md=\"\"><dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"WebTransport\" data-dfn-type=\"method\" data-export=\"\" data-lt=\"close(closeInfo)|close()\" id=\"dom-webtransport-close\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>close(closeInfo)</code></dfn>\n     </dt><dd data-md=\"\">\n      <p>Terminates the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-session\" id=\"ref-for-protocol-webtransport-session①⑤\">WebTransport session</a> associated with the WebTransport object.</p>\n      <p>When close is called, the user agent MUST run the following steps:</p>\n      \n    </dd></dl>",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③①\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot①⑨\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, then abort these steps.</p>"
        },
        {
          "html": "If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②⓪\">[[State]]</a></code> is <code>\"connecting\"</code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception④\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror④\">WebTransportError</a></code> whose\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source④\">source</a></code> is <code>\"session\"</code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup④\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
            },
            {
              "html": "<p>Abort these steps.</p>"
            }
          ]
        },
        {
          "html": "<p>Let <var>session</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot⑥\">[[Session]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>code</var> be <var>closeInfo</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportcloseinfo-closecode\" id=\"ref-for-dom-webtransportcloseinfo-closecode\">closeCode</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>reasonString</var> be the maximal <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#code-unit-prefix\" id=\"ref-for-code-unit-prefix\">code unit prefix</a> of\n  <var>closeInfo</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportcloseinfo-reason\" id=\"ref-for-dom-webtransportcloseinfo-reason\">reason</a></code> where the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence-length\" id=\"ref-for-byte-sequence-length\">length</a> of the\n  <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode\">UTF-8 encoded</a> prefix doesn’t exceed 1024.</p>"
        },
        {
          "html": "<p>Let <var>reason</var> be <var>reasonString</var>, <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-encode\" id=\"ref-for-utf-8-encode①\">UTF-8 encoded</a>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑤\">In parallel</a>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-terminate\" id=\"ref-for-session-terminate①\">terminate</a> <var>session</var> with <var>code</var> and <var>reason</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup⑤\">Cleanup</a> <var>transport</var> with <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror\">AbortError</a></code> and <var>closeInfo</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/getStats()",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-getstats",
      "html": "When getStats is called, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③②\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②①\">[[State]]</a></code> is <code>\"failed\"</code>, <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects⑨\">reject</a> <var>p</var> with an\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror④\">InvalidStateError</a></code> and abort these steps.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑥\">in parallel</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②②\">[[State]]</a></code> is <code>\"connecting\"</code>, wait until it changes.</p>"
            },
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②③\">[[State]]</a></code> is <code>\"failed\"</code>, abort these steps after\n  <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①①\">queueing a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⓪\">reject</a> <var>p</var> with an\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑤\">InvalidStateError</a></code>.</p>"
            },
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②④\">[[State]]</a></code> is <code>\"closed\"</code>, abort these steps after\n  <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①②\">queueing a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①①\">resolve</a> <var>p</var> with\n  the most recent stats available for the connection. The exact point\n  at which those stats are collected is <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined⑤\">implementation-defined</a>.</p>"
            },
            {
              "html": "<p>Gather the stats from the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#underlying-connection\" id=\"ref-for-underlying-connection①\">underlying connection</a>, including stats on datagrams.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①③\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>stats</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new③\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dictdef-webtransportconnectionstats\" id=\"ref-for-dictdef-webtransportconnectionstats①\">WebTransportConnectionStats</a></code> object representing the gathered stats.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①②\">Resolve</a> <var>p</var> with <var>stats</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/exportKeyingMaterial(label, context)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-exportkeyingmaterial",
      "html": "When <code>exportKeyingMaterial</code> is called, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③③\">this</a>.</p>"
        },
        {
          "html": "<p>Let <var>labelLength</var> be <var>label</var>.<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-byte-length\" id=\"ref-for-buffersource-byte-length①\">byte length</a>.</p>"
        },
        {
          "html": "<p>If <var>labelLength</var> is more than 255, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with③\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror⑤\">RangeError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>contextLength</var> be 0.</p>"
        },
        {
          "html": "<p>If <var>context</var> is given, set <var>contextLength</var> to <var>context</var>.<a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-byte-length\" id=\"ref-for-buffersource-byte-length②\">byte length</a>.</p>"
        },
        {
          "html": "<p>If <var>contextLength</var> is more than 255, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with④\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror⑥\">RangeError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑦\">in parallel</a>, but <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#abort-when\" id=\"ref-for-abort-when①\">abort when</a> <var>transport</var>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②⑤\">[[State]]</a></code> becomes <code>\"closed\"</code> or <code>\"failed\"</code>, and instead\n  <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①④\">queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①③\">reject</a> <var>p</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑥\">InvalidStateError</a></code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>keyingMaterial</var> be the result of exporting TLS keying material, as defined\n  in <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-web-transport-overview\" title=\"WebTransport Protocol Framework\">[WEB-TRANSPORT-OVERVIEW]</a> <a href=\"https://datatracker.ietf.org/doc/html/draft-ietf-webtrans-overview#section-4.1\">Section 4.1</a>,\n  with <var>labelLength</var>, <var>label</var>, <var>contextLength</var>, and if present, <var>context</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①⑤\">Queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①④\">resolve</a> <var>p</var> with <var>keyingMaterial</var>.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/createBidirectionalStream(options)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-createbidirectionalstream",
      "html": "When <code>createBidirectionalStream</code> is called, the user agent MUST run the\n following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③④\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②⑥\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>,\n  return a new <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑤\">rejected</a> promise with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑦\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>sendGroup</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-createbidirectionalstream-options-options\" id=\"ref-for-dom-webtransport-createbidirectionalstream-options-options\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendoptions-sendgroup\" id=\"ref-for-dom-webtransportsendoptions-sendgroup①\">sendGroup</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>sendOrder</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-createbidirectionalstream-options-options\" id=\"ref-for-dom-webtransport-createbidirectionalstream-options-options①\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendoptions-sendorder\" id=\"ref-for-dom-webtransportsendoptions-sendorder①\">sendOrder</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>waitUntilAvailable</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-createbidirectionalstream-options-options\" id=\"ref-for-dom-webtransport-createbidirectionalstream-options-options②\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstreamoptions-waituntilavailable\" id=\"ref-for-dom-webtransportsendstreamoptions-waituntilavailable\">waitUntilAvailable</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑧\">in parallel</a>, but <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#abort-when\" id=\"ref-for-abort-when②\">abort when</a> <var>transport</var>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②⑦\">[[State]]</a></code> becomes <code>\"closed\"</code> or <code>\"failed\"</code>, and instead\n  <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①⑥\">queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑥\">reject</a> <var>p</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑧\">InvalidStateError</a></code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>streamId</var> be a new stream ID that is valid and unique for\n <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot⑦\">[[Session]]</a></code>, as defined in <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-quic\" title=\"QUIC: A UDP-Based Multiplexed and Secure Transport\">[QUIC]</a>\n <a href=\"https://www.rfc-editor.org/rfc/rfc9000#section-19.11\">Section 19.11</a>. If one is not\n immediately available due to exhaustion, either wait for it to become\n available if <var>waitUntilAvailable</var> is true, or if <var>waitUntilAvailable</var> is false,\n abort these steps after <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①⑦\">queueing a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑦\">reject</a> <var>p</var>\n with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#quotaexceedederror\" id=\"ref-for-quotaexceedederror\">QuotaExceededError</a></code>.</p>"
            },
            {
              "html": "<p>Let <var>internalStream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-create-a-bidirectional-stream\" id=\"ref-for-session-create-a-bidirectional-stream\">creating a bidirectional stream</a> with\n   <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot⑧\">[[Session]]</a></code> and <var>streamId</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①⑧\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②⑧\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>,\n <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑧\">reject</a> <var>p</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror⑨\">InvalidStateError</a></code> and abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>stream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#bidirectionalstream-create\" id=\"ref-for-bidirectionalstream-create①\">creating</a> a\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportbidirectionalstream\" id=\"ref-for-webtransportbidirectionalstream⑤\">WebTransportBidirectionalStream</a></code> with <var>internalStream</var>, <var>transport</var>, <var>sendGroup</var>, and <var>sendOrder</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects①⑨\">Resolve</a> <var>p</var> with <var>stream</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/createUnidirectionalStream(options)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-createunidirectionalstream",
      "html": "When <code>createUnidirectionalStream()</code> method is called, the user agent MUST\n run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑤\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot②⑨\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>,\n  return a new <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②⓪\">rejected</a> promise with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①⓪\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>sendGroup</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-createunidirectionalstream-options-options\" id=\"ref-for-dom-webtransport-createunidirectionalstream-options-options\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendoptions-sendgroup\" id=\"ref-for-dom-webtransportsendoptions-sendgroup②\">sendGroup</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>sendOrder</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-createunidirectionalstream-options-options\" id=\"ref-for-dom-webtransport-createunidirectionalstream-options-options①\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendoptions-sendorder\" id=\"ref-for-dom-webtransportsendoptions-sendorder②\">sendOrder</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>waitUntilAvailable</var> be <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-createunidirectionalstream-options-options\" id=\"ref-for-dom-webtransport-createunidirectionalstream-options-options②\">options</a></code>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstreamoptions-waituntilavailable\" id=\"ref-for-dom-webtransportsendstreamoptions-waituntilavailable①\">waitUntilAvailable</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel⑨\">in parallel</a>, but <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#abort-when\" id=\"ref-for-abort-when③\">abort when</a> <var>transport</var>’s\n  <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③⓪\">[[State]]</a></code> becomes <code>\"closed\"</code> or <code>\"failed\"</code>, and instead\n  <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task①⑨\">queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②①\">reject</a> <var>p</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①①\">InvalidStateError</a></code>:",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>streamId</var> be a new stream ID that is valid and unique for\n <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot⑨\">[[Session]]</a></code>, as defined in <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-quic\" title=\"QUIC: A UDP-Based Multiplexed and Secure Transport\">[QUIC]</a>\n <a href=\"https://www.rfc-editor.org/rfc/rfc9000#section-19.11\">Section 19.11</a>. If one is not\n immediately available due to exhaustion, either wait for it to become\n available if <var>waitUntilAvailable</var> is true, or if <var>waitUntilAvailable</var> is false,\n abort these steps after <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②⓪\">queueing a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②②\">reject</a> <var>p</var>\n with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#quotaexceedederror\" id=\"ref-for-quotaexceedederror①\">QuotaExceededError</a></code>.</p>"
            },
            {
              "html": "<p>Let <var>internalStream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-create-an-outgoing-unidirectional-stream\" id=\"ref-for-session-create-an-outgoing-unidirectional-stream\">creating an outgoing unidirectional stream</a> with\n <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot①⓪\">[[Session]]</a></code> and <var>streamId</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②①\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "if",
              "steps": [
                {
                  "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③①\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>,\n <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②③\">reject</a> <var>p</var> with an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①②\">InvalidStateError</a></code> and abort these steps.</p>"
                },
                {
                  "html": "<p>Let <var>stream</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-create\" id=\"ref-for-webtransportsendstream-create\">creating</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream③\">WebTransportSendStream</a></code> with\n <var>internalStream</var>, <var>transport</var>, <var>sendGroup</var>, and <var>sendOrder</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②④\">Resolve</a> <var>p</var> with <var>stream</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransport/createSendGroup()",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransport-createsendgroup",
      "html": "When <code>createSendGroup()</code> method is called, the user agent MUST\n run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑥\">this</a>.</p>"
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③②\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>,\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①①\">throw</a> an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①③\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Return the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendgroup-create\" id=\"ref-for-webtransportsendgroup-create\">creating</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendgroup\" id=\"ref-for-webtransportsendgroup⑤\">WebTransportSendGroup</a></code> with <var>transport</var>.</p>"
        }
      ]
    },
    {
      "name": "cleanup a WebTransport",
      "href": "https://www.w3.org/TR/webtransport/#webtransport-cleanup",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransport\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransport-cleanup\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">cleanup</dfn> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport②⓪\">WebTransport</a></code> <var>transport</var> with <var>error</var> and\noptionally <var>closeInfo</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>sendStreams</var> be a copy of <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot②\">[[SendStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>receiveStreams</var> be a copy of <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot②\">[[ReceiveStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>outgoingDatagramWritables</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot⑧\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-writables-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-writables-slot①\">[[Writables]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>incomingDatagrams</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot⑨\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-readable-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-readable-slot⑦\">[[Readable]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>ready</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-ready-slot\" id=\"ref-for-dom-webtransport-ready-slot⑤\">[[Ready]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>closed</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-closed-slot\" id=\"ref-for-dom-webtransport-closed-slot②\">[[Closed]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>incomingBidirectionalStreams</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingbidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingbidirectionalstreams-slot④\">[[IncomingBidirectionalStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>incomingUnidirectionalStreams</var> be <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-incomingunidirectionalstreams-slot\" id=\"ref-for-dom-webtransport-incomingunidirectionalstreams-slot④\">[[IncomingUnidirectionalStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot③\">[[SendStreams]]</a></code> to an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set⑥\">set</a>.</p>"
        },
        {
          "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot③\">[[ReceiveStreams]]</a></code> to an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set⑦\">set</a>.</p>"
        },
        {
          "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot①⓪\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramswritable-outgoingdatagramsqueue-slot⑤\">[[OutgoingDatagramsQueue]]</a></code>\n to an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue\" id=\"ref-for-queue\">queue</a>.</p>"
        },
        {
          "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-datagrams-slot\" id=\"ref-for-dom-webtransport-datagrams-slot①①\">[[Datagrams]]</a></code>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot\" id=\"ref-for-dom-webtransportdatagramduplexstream-incomingdatagramsqueue-slot③\">[[IncomingDatagramsQueue]]</a></code>\n to an empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#queue\" id=\"ref-for-queue①\">queue</a>.</p>"
        },
        {
          "html": "<p>If <var>closeInfo</var> is given, then set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③③\">[[State]]</a></code> to <code>\"closed\"</code>.\n Otherwise, set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③④\">[[State]]</a></code> to <code>\"failed\"</code>.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate\">For each</a> <var>stream</var> in <var>sendStreams</var>, run the following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot\">[[PendingOperation]]</a></code> is not null, reject <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot①\">[[PendingOperation]]</a></code>\n with <var>error</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-error\" id=\"ref-for-writablestream-error①\">Error</a> <var>stream</var> with <var>error</var>.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate①\">For each</a> <var>stream</var> in <var>receiveStreams</var>, <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\" id=\"ref-for-readablestream-error\">error</a> <var>stream</var>\n with <var>error</var>.</p>"
        },
        {
          "html": "If <var>closeInfo</var> is given, then:",
          "rationale": "resolve",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②⑤\">Resolve</a> <var>closed</var> with <var>closeInfo</var>.</p>"
            },
            {
              "html": "<p class=\"assertion\">Assert: <var>ready</var> is <a data-link-type=\"dfn\" data-refhint-key=\"668a868f\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②⑥\">settled</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-close\" id=\"ref-for-readablestream-close\">Close</a> <var>incomingBidirectionalStreams</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-close\" id=\"ref-for-readablestream-close①\">Close</a> <var>incomingUnidirectionalStreams</var>.</p>"
            },
            {
              "html": "<p>For each <var>writable</var> in <var>outgoingDatagramWritables</var>, <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-close\" id=\"ref-for-writablestream-close\">close</a> <var>writable</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-close\" id=\"ref-for-readablestream-close②\">Close</a> <var>incomingDatagrams</var>.</p>"
            }
          ]
        },
        {
          "html": "Otherwise:",
          "rationale": "reject",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②⑦\">Reject</a> <var>closed</var> with <var>error</var>.</p>"
            },
            {
              "html": "<p>Set <var>closed</var>.<code>[[PromiseIsHandled]]</code> to true.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects②⑧\">Reject</a> <var>ready</var> with <var>error</var>.</p>"
            },
            {
              "html": "<p>Set <var>ready</var>.<code>[[PromiseIsHandled]]</code> to true.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\" id=\"ref-for-readablestream-error①\">Error</a> <var>incomingBidirectionalStreams</var> with <var>error</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\" id=\"ref-for-readablestream-error②\">Error</a> <var>incomingUnidirectionalStreams</var> with <var>error</var>.</p>"
            },
            {
              "html": "<p>For each <var>writable</var> in <var>outgoingDatagramWritables</var>, <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-error\" id=\"ref-for-writablestream-error②\">error</a> <var>writable</var> with <var>error</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\" id=\"ref-for-readablestream-error③\">Error</a> <var>incomingDatagrams</var> with <var>error</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "WebTransport/queue a network task",
      "href": "https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransport\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransport-queue-a-network-task\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">queue a network task</dfn> with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport②①\">WebTransport</a></code> <var>transport</var> and a\nseries of steps <var>steps</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task\" id=\"ref-for-queue-a-global-task\">Queue a global task</a> on the <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#networking-task-source\" id=\"ref-for-networking-task-source\">network task source</a> with <var>transport</var>’s\n <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global\" id=\"ref-for-concept-relevant-global\">relevant global object</a> to run <var>steps</var>.</p>"
        }
      ]
    },
    {
      "name": "termination-initiated-by-server",
      "html": "Whenever a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-session\" id=\"ref-for-protocol-webtransport-session①⑥\">WebTransport session</a> which is associated with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport②②\">WebTransport</a></code> <var>transport</var> is\n<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-terminated\" id=\"ref-for-session-terminated\">terminated</a> with optionally <var>code</var> and <var>reasonBytes</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②②\">Queue a network task</a> with <var>transport</var> to run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③⑤\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, abort these steps.</p>"
            },
            {
              "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception⑤\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror⑤\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source⑤\">source</a></code> is <code>\"session\"</code>.</p>"
            },
            {
              "html": "<p>Let <var>closeInfo</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new④\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dictdef-webtransportcloseinfo\" id=\"ref-for-dictdef-webtransportcloseinfo③\">WebTransportCloseInfo</a></code>.</p>"
            },
            {
              "html": "<p>If <var>code</var> is given, set <var>closeInfo</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportcloseinfo-closecode\" id=\"ref-for-dom-webtransportcloseinfo-closecode①\">closeCode</a></code> to <var>code</var>.</p>"
            },
            {
              "html": "<p>If <var>reasonBytes</var> is given, set <var>closeInfo</var>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportcloseinfo-reason\" id=\"ref-for-dom-webtransportcloseinfo-reason①\">reason</a></code> to <var>reasonBytes</var>,\n <a data-link-type=\"dfn\" href=\"https://encoding.spec.whatwg.org/#utf-8-decode\" id=\"ref-for-utf-8-decode\">UTF-8 decoded</a>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup⑥\">Cleanup</a> <var>transport</var> with <var>error</var> and <var>closeInfo</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "termination-caused-by-connection-error",
      "html": "Whenever a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport②③\">WebTransport</a></code> <var>transport</var>’s <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#underlying-connection\" id=\"ref-for-underlying-connection③\">underlying connection</a> gets a connection error,\nrun these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②③\">Queue a network task</a> with <var>transport</var> to run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③⑥\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, abort these steps.</p>"
            },
            {
              "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception⑥\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror⑥\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source⑥\">source</a></code> is <code>\"session\"</code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup⑦\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "context cleanup steps",
      "href": "https://www.w3.org/TR/webtransport/#context-cleanup-steps",
      "html": "This specification defines <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"context-cleanup-steps\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">context cleanup steps</dfn> as the following steps, given\n<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport②④\">WebTransport</a></code> <var>transport</var>:",
      "rationale": "if",
      "steps": [
        {
          "html": "If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③⑦\">[[State]]</a></code> is <code>\"connected\"</code>, then:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③⑧\">[[State]]</a></code> to <code>\"failed\"</code>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⓪\">In parallel</a>, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#session-terminate\" id=\"ref-for-session-terminate②\">terminate</a> <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-session-slot\" id=\"ref-for-dom-webtransport-session-slot①①\">[[Session]]</a></code>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②④\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception⑦\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror⑦\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source⑦\">source</a></code> is <code>\"session\"</code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-cleanup\" id=\"ref-for-webtransport-cleanup⑧\">Cleanup</a> <var>transport</var> with <var>error</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot③⑨\">[[State]]</a></code> is <code>\"connecting\"</code>, set <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot④⓪\">[[State]]</a></code> to\n <code>\"failed\"</code>.</p>"
        }
      ]
    },
    {
      "name": "compute a certificate hash",
      "href": "https://www.w3.org/TR/webtransport/#compute-a-certificate-hash",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"compute-a-certificate-hash\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">compute a certificate hash</dfn>, given a <var>certificate</var>, perform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>cert</var> be <var>certificate</var>, represented as a DER encoding of\n Certificate message defined in <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-rfc5280\" title=\"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\">[RFC5280]</a>.</p>"
        },
        {
          "html": "<p>Compute the SHA-256 hash of <var>cert</var> and return the computed value.</p>"
        }
      ]
    },
    {
      "name": "verify a certificate hash",
      "href": "https://www.w3.org/TR/webtransport/#verify-a-certificate-hash",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"verify-a-certificate-hash\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">verify a certificate hash</dfn>, given a <var>certificate</var> and an array of hashes <var>hashes</var>,\nperform the following steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>referenceHash</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#compute-a-certificate-hash\" id=\"ref-for-compute-a-certificate-hash\">computing a certificate hash</a> with <var>certificate</var>.</p>"
        },
        {
          "html": "For every hash <var>hash</var> in <var>hashes</var>:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var>hash</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporthash-value\" id=\"ref-for-dom-webtransporthash-value\">value</a></code> is not null and <var>hash</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporthash-algorithm\" id=\"ref-for-dom-webtransporthash-algorithm①\">algorithm</a></code>\n  is an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ascii-case-insensitive\" id=\"ref-for-ascii-case-insensitive\">ASCII case-insensitive</a> match with \"sha-256\":",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>hashValue</var> be the byte sequence which <var>hash</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporthash-value\" id=\"ref-for-dom-webtransporthash-value①\">value</a></code> represents.</p>"
                },
                {
                  "html": "<p>If <var>hashValue</var> is equal to <var>referenceHash</var>, return true.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return false.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/sendGroup",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑦\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup-slot\" id=\"ref-for-dom-webtransportsendstream-sendgroup-slot\">[[SendGroup]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/sendGroup",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "if",
      "steps": [
        {
          "html": "<p>If <var>value</var> is non-null, and\n  <var>value</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendgroup-transport-slot\" id=\"ref-for-dom-webtransportsendgroup-transport-slot①\">[[Transport]]</a></code> is not\n  <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑧\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot\">[[Transport]]</a></code>, <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-throw\" id=\"ref-for-dfn-throw①②\">throw</a>\n  an <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#invalidstateerror\" id=\"ref-for-invalidstateerror①④\">InvalidStateError</a></code>.</p>"
        },
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this③⑨\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup-slot\" id=\"ref-for-dom-webtransportsendstream-sendgroup-slot①\">[[SendGroup]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/sendOrder",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder",
      "html": "The getter steps are:",
      "rationale": "return",
      "steps": [
        {
          "html": "<p>Return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④⓪\">this</a>’s <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder-slot\" id=\"ref-for-dom-webtransportsendstream-sendorder-slot\">[[SendOrder]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/sendOrder",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder",
      "html": "The setter steps, given <var>value</var>, are:",
      "rationale": "set",
      "steps": [
        {
          "html": "<p>Set <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④①\">this</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder-slot\" id=\"ref-for-dom-webtransportsendstream-sendorder-slot①\">[[SendOrder]]</a></code> to <var>value</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/getStats()",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-getstats",
      "html": "When getStats is called, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①①\">in parallel</a>:",
          "rationale": "gather",
          "steps": [
            {
              "html": "<p>Gather the stats specific to this <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream⑨\">WebTransportSendStream</a></code>.</p>"
            },
            {
              "html": "<p>Wait for the stats to be ready.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②⑤\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>stats</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new⑤\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dictdef-webtransportsendstreamstats\" id=\"ref-for-dictdef-webtransportsendstreamstats①\">WebTransportSendStreamStats</a></code> object\n  representing the gathered stats.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③①\">Resolve</a> <var>p</var> with <var>stats</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "create a SendStream",
      "href": "https://www.w3.org/TR/webtransport/#webtransportsendstream-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportSendStream\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"create|creating\" id=\"webtransportsendstream-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a\n<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①②\">WebTransportSendStream</a></code>, with an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-outgoing-unidirectional\" id=\"ref-for-stream-outgoing-unidirectional⑤\">outgoing unidirectional</a> or <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-bidirectional\" id=\"ref-for-stream-bidirectional①⓪\">bidirectional</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-stream\" id=\"ref-for-protocol-webtransport-stream⑨\">WebTransport stream</a>\n<var>internalStream</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport③②\">WebTransport</a></code> <var>transport</var>, <var>sendGroup</var>, and a\n<var>sendOrder</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new⑥\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①③\">WebTransportSendStream</a></code>, with:</p>\n      <dl>\n       <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-internalstream-slot\" id=\"ref-for-dom-webtransportsendstream-internalstream-slot\">[[InternalStream]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>internalStream</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot②\">[[PendingOperation]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>null</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot①\">[[Transport]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>transport</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup-slot\" id=\"ref-for-dom-webtransportsendstream-sendgroup-slot②\">[[SendGroup]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>sendGroup</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder-slot\" id=\"ref-for-dom-webtransportsendstream-sendorder-slot②\">[[SendOrder]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>sendOrder</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot\">[[AtomicWriteRequests]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>An empty <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#ordered-set\" id=\"ref-for-ordered-set⑨\">ordered set</a> of promises.</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-byteswritten-slot\" id=\"ref-for-dom-webtransportsendstream-byteswritten-slot\">[[BytesWritten]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>0</p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-committedoffset-slot\" id=\"ref-for-dom-webtransportsendstream-committedoffset-slot\">[[CommittedOffset]]</a></code>\n       </dt><dd data-md=\"\">\n        <p>0</p>\n      </dd></dl>"
        },
        {
          "html": "<p>Let <var>writeAlgorithm</var> be an action that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-write\" id=\"ref-for-webtransportsendstream-write\">writes</a> <var>chunk</var> to <var>stream</var>, given <var>chunk</var>.</p>"
        },
        {
          "html": "<p>Let <var>closeAlgorithm</var> be an action that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-close\" id=\"ref-for-webtransportsendstream-close\">closes</a> <var>stream</var>.</p>"
        },
        {
          "html": "<p>Let <var>abortAlgorithm</var> be an action that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-abort\" id=\"ref-for-webtransportsendstream-abort\">aborts</a> <var>stream</var> with <var>reason</var>, given <var>reason</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up\" id=\"ref-for-writablestream-set-up①\">Set up</a> <var>stream</var> with <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm\" id=\"ref-for-writablestream-set-up-writealgorithm①\">writeAlgorithm</a> set to\n <var>writeAlgorithm</var>, <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up-closealgorithm\" id=\"ref-for-writablestream-set-up-closealgorithm\">closeAlgorithm</a> set to <var>closeAlgorithm</var>,\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-set-up-abortalgorithm\" id=\"ref-for-writablestream-set-up-abortalgorithm\">abortAlgorithm</a> set to <var>abortAlgorithm</var>.</p>"
        },
        {
          "html": "<p>Let <var>abortSignal</var> be <var>stream</var>’s [[controller]].[[abortController]].[[signal]].</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-add\" id=\"ref-for-abortsignal-add\">Add</a> the following steps to <var>abortSignal</var>.",
          "rationale": "let",
          "steps": [
            {
              "html": "<p>Let <var>pendingOperation</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot③\">[[PendingOperation]]</a></code>.</p>"
            },
            {
              "html": "<p>If <var>pendingOperation</var> is null, then abort these steps.</p>"
            },
            {
              "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot④\">[[PendingOperation]]</a></code> to null.</p>"
            },
            {
              "html": "<p>Let <var>reason</var> be <var>abortSignal</var>’s <a data-link-type=\"dfn\" href=\"https://dom.spec.whatwg.org/#abortsignal-abort-reason\" id=\"ref-for-abortsignal-abort-reason\">abort reason</a>.</p>"
            },
            {
              "html": "<p>Let <var>promise</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-abort\" id=\"ref-for-webtransportsendstream-abort①\">aborting</a> stream with <var>reason</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#upon-fulfillment\" id=\"ref-for-upon-fulfillment②\">Upon fulfillment</a> of <var>promise</var>, <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③②\">reject</a> <var>pendingOperation</var> with <var>reason</var>.</p>"
            }
          ]
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#set-append\" id=\"ref-for-set-append\">Append</a> <var>stream</var> to <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot④\">[[SendStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Return <var>stream</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/write",
      "href": "https://www.w3.org/TR/webtransport/#webtransportsendstream-write",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportSendStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransportsendstream-write\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">write</dfn> <var>chunk</var> to a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①④\">WebTransportSendStream</a></code> <var>stream</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot②\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>chunk</var> is not a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#BufferSource\" id=\"ref-for-BufferSource④\">BufferSource</a></code>, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑤\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-typeerror\" id=\"ref-for-exceptiondef-typeerror②\">TypeError</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be a new promise.</p>"
        },
        {
          "html": "<p>Let <var>bytes</var> be a copy of the <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#byte-sequence\" id=\"ref-for-byte-sequence②\">byte sequence</a> which <var>chunk</var> represents.</p>"
        },
        {
          "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot⑤\">[[PendingOperation]]</a></code> to <var>promise</var>.</p>"
        },
        {
          "html": "<p>Let <var>inFlightWriteRequest</var> be\n <var>stream</var>.<a href=\"https://streams.spec.whatwg.org/#writablestream-inflightwriterequest\">inFlightWriteRequest</a>.</p>"
        },
        {
          "html": "<p>Let <var>atomic</var> be true if <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-body-stream\" id=\"ref-for-concept-body-stream\">stream</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot①\">[[AtomicWriteRequests]]</a></code>\n <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain\">contains</a> <var>inFlightWriteRequest</var>, otherwise false.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①②\">in parallel</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "If <var>atomic</var> is true and the current <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-flow-control\" id=\"ref-for-stream-signal-flow-control①\">flow control</a> window is too small for <var>bytes</var> to be sent\n in its entirety, then abort the remaining steps and <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②⑥\">queue a network task</a> with <var>transport</var>\n to run these sub-steps:",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot⑥\">[[PendingOperation]]</a></code> to null.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-abort-all-atomic-write-requests\" id=\"ref-for-webtransportsendstream-abort-all-atomic-write-requests\">Abort all atomic write requests</a> on <var>stream</var>.</p>"
                }
              ]
            },
            {
              "html": "<p>Otherwise, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-send\" id=\"ref-for-stream-send\">send</a> <var>bytes</var> on <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-internalstream-slot\" id=\"ref-for-dom-webtransportsendstream-internalstream-slot①\">[[InternalStream]]</a></code>\n and wait for the operation to complete.\n This sending MAY be interleaved with sending of previously queued streams and datagrams,\n as well as streams and datagrams yet to be queued to be sent over this transport.</p>\n        <p>The user-agent MAY have a buffer to improve the transfer performance. Such a buffer\n SHOULD have a fixed upper limit, to carry the backpressure information to the user of the\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①⑤\">WebTransportSendStream</a></code>.</p>\n        <p>This sending MUST starve\n until all bytes queued for sending on streams with the\n same <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup-slot\" id=\"ref-for-dom-webtransportsendstream-sendgroup-slot③\">[[SendGroup]]</a></code> and a higher\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder-slot\" id=\"ref-for-dom-webtransportsendstream-sendorder-slot③\">[[SendOrder]]</a></code>, that are neither\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-error\" id=\"ref-for-writablestream-error③\"> errored</a> nor blocked by <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-flow-control\" id=\"ref-for-stream-signal-flow-control②\">flow control</a>, have been\n sent.</p>\n        <p>We access <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendorder-slot\" id=\"ref-for-dom-webtransportsendstream-sendorder-slot④\">[[SendOrder]]</a></code> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①③\">in parallel</a> here.\n User agents SHOULD respond to live updates of these values during sending, though\n the details are <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined⑨\">implementation-defined</a>.</p>\n        \n        <p>This sending MUST NOT starve otherwise,\n except for <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-flow-control\" id=\"ref-for-stream-signal-flow-control③\">flow control</a> reasons or <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-error\" id=\"ref-for-writablestream-error④\"> error</a>.</p>\n        <p>The user agent SHOULD divide bandwidth fairly between all streams that aren’t starved.</p>"
            },
            {
              "html": "<p>If the previous step failed due to a network error, abort the remaining steps.</p>"
            },
            {
              "html": "Otherwise, <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②⑦\">queue a network task</a> with <var>transport</var>\n to run these steps:",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot⑧\">[[PendingOperation]]</a></code> to null.</p>"
                },
                {
                  "html": "<p>Add the length of <var>bytes</var> to <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-byteswritten-slot\" id=\"ref-for-dom-webtransportsendstream-byteswritten-slot①\">[[BytesWritten]]</a></code>.</p>"
                },
                {
                  "html": "<p>If <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot②\">[[AtomicWriteRequests]]</a></code> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain①\">contains</a> <var>inFlightWriteRequest</var>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove\">remove</a> <var>inFlightWriteRequest</var>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③③\">Resolve</a> <var>promise</var> with undefined.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/close",
      "href": "https://www.w3.org/TR/webtransport/#webtransportsendstream-close",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportSendStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransportsendstream-close\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">close</dfn> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①⑥\">WebTransportSendStream</a></code> <var>stream</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot③\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be a new promise.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove①\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot⑤\">[[SendStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot⑨\">[[PendingOperation]]</a></code> to <var>promise</var>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①④\">in parallel</a>:",
          "rationale": "send",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-send\" id=\"ref-for-stream-send①\">Send</a> FIN on <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-internalstream-slot\" id=\"ref-for-dom-webtransportsendstream-internalstream-slot②\">[[InternalStream]]</a></code> and wait for the operation to\n complete.</p>"
            },
            {
              "html": "<p>Wait for <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-internalstream-slot\" id=\"ref-for-dom-webtransportsendstream-internalstream-slot③\">[[InternalStream]]</a></code> to enter the \"all data committed\" state. <a data-link-type=\"biblio\" href=\"https://www.w3.org/TR/webtransport/#biblio-quic\" title=\"QUIC: A UDP-Based Multiplexed and Secure Transport\">[QUIC]</a></p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②⑧\">Queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "set",
              "steps": [
                {
                  "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot①⓪\">[[PendingOperation]]</a></code> to null.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③⑤\">Resolve</a> <var>promise</var> with undefined.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/abort",
      "href": "https://www.w3.org/TR/webtransport/#webtransportsendstream-abort",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportSendStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransportsendstream-abort\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">abort</dfn> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①⑦\">WebTransportSendStream</a></code> <var>stream</var> with <var>reason</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot④\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be a new promise.</p>"
        },
        {
          "html": "<p>Let <var>code</var> be 0.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove②\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot⑥\">[[SendStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>reason</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror⑧\">WebTransportError</a></code> and <var>reason</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot\">[[StreamErrorCode]]</a></code> is not\n null, then set <var>code</var> to <var>reason</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot①\">[[StreamErrorCode]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>code</var> &lt; 0, then set <var>code</var> to 0.</p>"
        },
        {
          "html": "<p>If <var>code</var> &gt; 4294967295, then set <var>code</var> to 4294967295.</p>"
        },
        {
          "html": "<p>Let <var>committedOffset</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-committedoffset-slot\" id=\"ref-for-dom-webtransportsendstream-committedoffset-slot①\">[[CommittedOffset]]</a></code>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑤\">in parallel</a>:",
          "rationale": "abort",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-abort-sending\" id=\"ref-for-stream-abort-sending②\">Abort sending</a> on <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-internalstream-slot\" id=\"ref-for-dom-webtransportsendstream-internalstream-slot④\">[[InternalStream]]</a></code> with <var>code</var> and <var>committedOffset</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task②⑨\">Queue a network task</a> with <var>transport</var> to <a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③⑥\">resolve</a> <var>promise</var> with undefined.</p>"
            }
          ]
        },
        {
          "html": "<p>Return <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportSendStream/abort all atomic write requests",
      "href": "https://www.w3.org/TR/webtransport/#webtransportsendstream-abort-all-atomic-write-requests",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportSendStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransportsendstream-abort-all-atomic-write-requests\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">abort all atomic write requests</dfn> on a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①⑧\">WebTransportSendStream</a></code> <var>stream</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>writeRequests</var> be\n <var>stream</var>.<a href=\"https://streams.spec.whatwg.org/#writablestream-writerequests\">writeRequests</a>.</p>"
        },
        {
          "html": "<p>Let <var>requestsToAbort</var> be <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-body-stream\" id=\"ref-for-concept-body-stream①\">stream</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot③\">[[AtomicWriteRequests]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>writeRequests</var> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain②\">contains</a> a promise not in <var>requestsToAbort</var>, then\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-error\" id=\"ref-for-writablestream-error⑤\">error</a> <var>stream</var> with <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror①\">AbortError</a></code>, and abort these steps.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-empty\" id=\"ref-for-list-empty\">Empty</a> <a data-link-type=\"dfn\" href=\"https://fetch.spec.whatwg.org/#concept-body-stream\" id=\"ref-for-concept-body-stream②\">stream</a>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot④\">[[AtomicWriteRequests]]</a></code>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate②\">For each</a> <var>promise</var> in <var>requestsToAbort</var>, <a data-link-type=\"dfn\" data-refhint-key=\"c597a1f1\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③⑦\">reject</a> <var>promise</var> with <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#aborterror\" id=\"ref-for-aborterror②\">AbortError</a></code>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑥\">In parallel</a>, <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-iterate\" id=\"ref-for-list-iterate③\">for each</a> <var>promise</var> in <var>requestsToAbort</var>, abort the\n <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-send\" id=\"ref-for-stream-send②\">sending</a> of bytes associated with <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "receiving aborted signal",
      "html": "Whenever a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-stream\" id=\"ref-for-protocol-webtransport-stream①⓪\">WebTransport stream</a> associated with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream①⑨\">WebTransportSendStream</a></code> <var>stream</var> gets a\n<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-receiving-aborted\" id=\"ref-for-stream-signal-receiving-aborted\">receiving aborted</a> signal from the server, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot⑤\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>code</var> be the application protocol error code attached to the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-receiving-aborted\" id=\"ref-for-stream-signal-receiving-aborted①\">receiving aborted</a> signal.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③⓪\">Queue a network task</a> with <var>transport</var> to run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot④④\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, abort these steps.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove③\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot⑦\">[[SendStreams]]</a></code>.</p>"
            },
            {
              "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception⑧\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror⑨\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source⑧\">source</a></code> is <code>\"stream\"</code> and\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-streamerrorcode\" id=\"ref-for-dom-webtransporterroroptions-streamerrorcode\">streamErrorCode</a></code> is <var>code</var>.</p>"
            },
            {
              "html": "<p>If <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot①①\">[[PendingOperation]]</a></code> is not null, reject <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-pendingoperation-slot\" id=\"ref-for-dom-webtransportsendstream-pendingoperation-slot①②\">[[PendingOperation]]</a></code>\n with <var>error</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#writablestream-error\" id=\"ref-for-writablestream-error⑥\">Error</a> <var>stream</var> with <var>error</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "WebTransportSendGroup/getStats()",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportsendgroup-getstats",
      "html": "When getStats is called, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "<p>Let <var>streams</var> be all <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream②⑧\">WebTransportSendStream</a></code>s whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-sendgroup-slot\" id=\"ref-for-dom-webtransportsendstream-sendgroup-slot④\">[[SendGroup]]</a></code> is <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#this\" id=\"ref-for-this④④\">this</a>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑦\">in parallel</a>:",
          "rationale": "gather",
          "steps": [
            {
              "html": "<p>Gather stream statistics from all streams in <var>streams</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③①\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>stats</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new⑦\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dictdef-webtransportsendstreamstats\" id=\"ref-for-dictdef-webtransportsendstreamstats④\">WebTransportSendStreamStats</a></code> object\n  representing the aggregate numbers of the gathered stats.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③⑧\">Resolve</a> <var>p</var> with <var>stats</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "create a SendGroup",
      "href": "https://www.w3.org/TR/webtransport/#webtransportsendgroup-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportSendGroup\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"create|creating\" id=\"webtransportsendgroup-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a\n<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendgroup\" id=\"ref-for-webtransportsendgroup①⑨\">WebTransportSendGroup</a></code>, with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport③④\">WebTransport</a></code> <var>transport</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>sendGroup</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new⑧\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendgroup\" id=\"ref-for-webtransportsendgroup②⓪\">WebTransportSendGroup</a></code>, with:</p>\n      <dl>\n       <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendgroup-transport-slot\" id=\"ref-for-dom-webtransportsendgroup-transport-slot②\">[[Transport]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>transport</var></p>\n      </dd></dl>"
        },
        {
          "html": "<p>Return <var>sendGroup</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportReceiveStream/getStats()",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-getstats",
      "html": "When getStats is called, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>p</var> be a new promise.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑧\">in parallel</a>:",
          "rationale": "gather",
          "steps": [
            {
              "html": "<p>Gather the stats specific to this <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream①②\">WebTransportReceiveStream</a></code>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③②\">Queue a network task</a> with <var>transport</var> to run the following steps:",
              "rationale": "let",
              "steps": [
                {
                  "html": "<p>Let <var>stats</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new⑨\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dictdef-webtransportreceivestreamstats\" id=\"ref-for-dictdef-webtransportreceivestreamstats①\">WebTransportReceiveStreamStats</a></code> object\n  representing the gathered stats.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects③⑨\">Resolve</a> <var>p</var> with <var>stats</var>.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>p</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportReceiveStream/create",
      "href": "https://www.w3.org/TR/webtransport/#webtransportreceivestream-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportReceiveStream\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"create|creating\" id=\"webtransportreceivestream-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a\n<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream①⑤\">WebTransportReceiveStream</a></code>, with an <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-incoming-unidirectional\" id=\"ref-for-stream-incoming-unidirectional⑨\">incoming unidirectional</a> or <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-bidirectional\" id=\"ref-for-stream-bidirectional①③\">bidirectional</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-stream\" id=\"ref-for-protocol-webtransport-stream①③\">WebTransport stream</a>\n<var>internalStream</var> and a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport③⑥\">WebTransport</a></code> <var>transport</var>, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new①⓪\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream①⑥\">WebTransportReceiveStream</a></code>, with:</p>\n      <dl>\n       <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-internalstream-slot\" id=\"ref-for-dom-webtransportreceivestream-internalstream-slot\">[[InternalStream]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>internalStream</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-transport-slot\" id=\"ref-for-dom-webtransportreceivestream-transport-slot\">[[Transport]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>transport</var></p>\n      </dd></dl>"
        },
        {
          "html": "<p>Let <var>pullAlgorithm</var> be an action that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream-pull-bytes\" id=\"ref-for-webtransportreceivestream-pull-bytes\">pulls bytes</a> from <var>stream</var>.</p>"
        },
        {
          "html": "<p>Let <var>cancelAlgorithm</var> be an action that <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream-cancel\" id=\"ref-for-webtransportreceivestream-cancel\">cancels</a> <var>stream</var> with <var>reason</var>, given\n <var>reason</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support\" id=\"ref-for-readablestream-set-up-with-byte-reading-support①\">Set up with byte reading support</a> <var>stream</var> with\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-pullalgorithm\" id=\"ref-for-readablestream-set-up-with-byte-reading-support-pullalgorithm①\">pullAlgorithm</a> set to <var>pullAlgorithm</var> and\n <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-set-up-with-byte-reading-support-cancelalgorithm\" id=\"ref-for-readablestream-set-up-with-byte-reading-support-cancelalgorithm\">cancelAlgorithm</a> set to <var>cancelAlgorithm</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#set-append\" id=\"ref-for-set-append①\">Append</a> <var>stream</var> to <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot④\">[[ReceiveStreams]]</a></code>.</p>"
        },
        {
          "html": "<p>Return <var>stream</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportReceiveStream/pull bytes",
      "href": "https://www.w3.org/TR/webtransport/#webtransportreceivestream-pull-bytes",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportReceiveStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransportreceivestream-pull-bytes\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">pull bytes</dfn> from a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream①⑦\">WebTransportReceiveStream</a></code> <var>stream</var>, run these steps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-transport-slot\" id=\"ref-for-dom-webtransportreceivestream-transport-slot①\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>internalStream</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-internalstream-slot\" id=\"ref-for-dom-webtransportreceivestream-internalstream-slot①\">[[InternalStream]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be a new promise.</p>"
        },
        {
          "html": "<p>Let <var>buffer</var>, <var>offset</var>, and <var>maxBytes</var> be null.</p>"
        },
        {
          "html": "If <var>stream</var>’s <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\" id=\"ref-for-readablestream-current-byob-request-view②\">current BYOB request view</a> for <var>stream</var> is not null:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>offset</var> to <var>stream</var>’s <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\" id=\"ref-for-readablestream-current-byob-request-view③\">current BYOB request view</a>.[[ByteOffset]].</p>"
            },
            {
              "html": "<p>Set <var>maxBytes</var> to <var>stream</var>’s <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\" id=\"ref-for-readablestream-current-byob-request-view④\">current BYOB request view</a>’s\n <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-byte-length\" id=\"ref-for-buffersource-byte-length③\">byte length</a>.</p>"
            },
            {
              "html": "<p>Set <var>buffer</var> to <var>stream</var>’s <a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-current-byob-request-view\" id=\"ref-for-readablestream-current-byob-request-view⑤\">current BYOB request view</a>’s\n <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#buffersource-underlying-buffer\" id=\"ref-for-buffersource-underlying-buffer\">underlying buffer</a>.</p>"
            }
          ]
        },
        {
          "html": "Otherwise:",
          "rationale": "set",
          "steps": [
            {
              "html": "<p>Set <var>offset</var> to 0.</p>"
            },
            {
              "html": "<p>Set <var>maxBytes</var> to an <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#implementation-defined\" id=\"ref-for-implementation-defined①②\">implementation-defined</a> size.</p>"
            },
            {
              "html": "<p>Set <var>buffer</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new①①\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer①\">ArrayBuffer</a></code> with <var>maxBytes</var> size. If allocating the\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-ArrayBuffer\" id=\"ref-for-idl-ArrayBuffer②\">ArrayBuffer</a></code> fails, return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑥\">a promise rejected with</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#exceptiondef-rangeerror\" id=\"ref-for-exceptiondef-rangeerror⑦\">RangeError</a></code>.</p>"
            }
          ]
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel①⑨\">in parallel</a>:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#arraybuffer-write\" id=\"ref-for-arraybuffer-write\">Write</a> the bytes that area <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-receive\" id=\"ref-for-stream-receive\">read</a> from <var>internalStream</var> into\n <var>buffer</var> with offset <var>offset</var>, up to <var>maxBytes</var> bytes. Wait until either at least one byte is\n read or FIN is received. Let <var>read</var> be the number of read bytes, and let <var>hasReceivedFIN</var> be\n whether FIN was accompanied.</p>\n        <p>The user-agent MAY have a buffer to improve the transfer performance. Such a buffer\n SHOULD have a fixed upper limit, to carry the backpressure information to the server.</p>"
            },
            {
              "html": "<p>If the previous step failed, abort the remaining steps.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③③\">Queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "if",
              "steps": [
                {
                  "html": "If <var>read</var> &gt; 0:",
                  "rationale": "set",
                  "steps": [
                    {
                      "html": "<p>Set <var>view</var> to a new <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-Uint8Array\" id=\"ref-for-idl-Uint8Array④\">Uint8Array</a></code> with <var>buffer</var>, <var>offset</var> and <var>read</var>.</p>"
                    },
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-enqueue\" id=\"ref-for-readablestream-enqueue④\">Enqueue</a> <var>view</var> into <var>stream</var>.</p>"
                    }
                  ]
                },
                {
                  "html": "If <var>hasReceivedFIN</var> is true:",
                  "rationale": "remove",
                  "steps": [
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove④\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot⑤\">[[ReceiveStreams]]</a></code>.</p>"
                    },
                    {
                      "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-close\" id=\"ref-for-readablestream-close③\">Close</a> <var>stream</var>.</p>"
                    }
                  ]
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects④⓪\">Resolve</a> <var>promise</var> with undefined.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportReceiveStream/cancel",
      "href": "https://www.w3.org/TR/webtransport/#webtransportreceivestream-cancel",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportReceiveStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"webtransportreceivestream-cancel\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">cancel</dfn> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream①⑧\">WebTransportReceiveStream</a></code> <var>stream</var> with <var>reason</var>, run these\nsteps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-transport-slot\" id=\"ref-for-dom-webtransportreceivestream-transport-slot②\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>internalStream</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-internalstream-slot\" id=\"ref-for-dom-webtransportreceivestream-internalstream-slot②\">[[InternalStream]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>promise</var> be a new promise.</p>"
        },
        {
          "html": "<p>Let <var>code</var> be 0.</p>"
        },
        {
          "html": "<p>If <var>reason</var> is a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror①⓪\">WebTransportError</a></code> and <var>reason</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot②\">[[StreamErrorCode]]</a></code> is not\n null, then set <var>code</var> to <var>reason</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot③\">[[StreamErrorCode]]</a></code>.</p>"
        },
        {
          "html": "<p>If <var>code</var> &lt; 0, then set <var>code</var> to 0.</p>"
        },
        {
          "html": "<p>If <var>code</var> &gt; 4294967295, then set <var>code</var> to 4294967295.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove⑤\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-sendstreams-slot\" id=\"ref-for-dom-webtransport-sendstreams-slot⑧\">[[SendStreams]]</a></code>.</p>"
        },
        {
          "html": "Run the following steps <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel\" id=\"ref-for-in-parallel②⓪\">in parallel</a>:",
          "rationale": "abort",
          "steps": [
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-abort-receiving\" id=\"ref-for-stream-abort-receiving①\">Abort receiving</a> on <var>internalStream</var> with <var>code</var>.</p>"
            },
            {
              "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③④\">Queue a network task</a> with <var>transport</var> to run these steps:",
              "rationale": "remove",
              "steps": [
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove⑥\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot⑥\">[[ReceiveStreams]]</a></code>.</p>"
                },
                {
                  "html": "<p><a data-link-type=\"dfn\" href=\"http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise-objects\" id=\"ref-for-sec-promise-objects④①\">Resolve</a> <var>promise</var> with undefined.</p>"
                }
              ]
            }
          ]
        },
        {
          "html": "<p>Return <var>promise</var>.</p>"
        }
      ]
    },
    {
      "name": "sending aborted signal",
      "html": "Whenever a <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-stream\" id=\"ref-for-protocol-webtransport-stream①④\">WebTransport stream</a> associated with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream①⑨\">WebTransportReceiveStream</a></code> <var>stream</var> gets a\n<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-sending-aborted\" id=\"ref-for-stream-signal-sending-aborted\">sending aborted</a> signal from the server, run these steps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportreceivestream-transport-slot\" id=\"ref-for-dom-webtransportreceivestream-transport-slot③\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Let <var>code</var> be the application protocol error code attached to the <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-signal-sending-aborted\" id=\"ref-for-stream-signal-sending-aborted①\">sending aborted</a> signal.</p>"
        },
        {
          "html": "<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransport-queue-a-network-task\" id=\"ref-for-webtransport-queue-a-network-task③⑤\">Queue a network task</a> with <var>transport</var> to run these steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-state-slot\" id=\"ref-for-dom-webtransport-state-slot④⑤\">[[State]]</a></code> is <code>\"closed\"</code> or <code>\"failed\"</code>, abort these steps.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove⑦\">Remove</a> <var>stream</var> from <var>transport</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransport-receivestreams-slot\" id=\"ref-for-dom-webtransport-receivestreams-slot⑦\">[[ReceiveStreams]]</a></code>.</p>"
            },
            {
              "html": "<p>Let <var>error</var> be a newly <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#dfn-create-exception\" id=\"ref-for-dfn-create-exception⑨\">created</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror①①\">WebTransportError</a></code> whose\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source⑨\">source</a></code> is <code>\"stream\"</code> and\n <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-streamerrorcode\" id=\"ref-for-dom-webtransporterroroptions-streamerrorcode①\">streamErrorCode</a></code> is <var>code</var>.</p>"
            },
            {
              "html": "<p><a data-link-type=\"dfn\" href=\"https://streams.spec.whatwg.org/#readablestream-error\" id=\"ref-for-readablestream-error⑤\">Error</a> <var>stream</var> with <var>error</var>.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "create a BidirectionalStream",
      "href": "https://www.w3.org/TR/webtransport/#bidirectionalstream-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"BidirectionalStream\" data-dfn-type=\"dfn\" data-noexport=\"\" id=\"bidirectionalstream-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportbidirectionalstream\" id=\"ref-for-webtransportbidirectionalstream⑧\">WebTransportBidirectionalStream</a></code> with a\n<a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#stream-bidirectional\" id=\"ref-for-stream-bidirectional①④\">bidirectional</a> <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#protocol-webtransport-stream\" id=\"ref-for-protocol-webtransport-stream①⑤\">WebTransport stream</a> <var>internalStream</var>, a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransport\" id=\"ref-for-webtransport③⑧\">WebTransport</a></code>\nobject <var>transport</var>, and a <var>sendOrder</var>, run these steps.",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>readable</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream-create\" id=\"ref-for-webtransportreceivestream-create②\">creating</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportreceivestream\" id=\"ref-for-webtransportreceivestream②⑥\">WebTransportReceiveStream</a></code> with\n <var>internalStream</var> and <var>transport</var>.</p>"
        },
        {
          "html": "<p>Let <var>writable</var> be the result of <a data-link-type=\"dfn\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream-create\" id=\"ref-for-webtransportsendstream-create②\">creating</a> a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream③②\">WebTransportSendStream</a></code> with\n <var>internalStream</var>, <var>transport</var>, and <var>sendOrder</var>.</p>"
        },
        {
          "html": "<p>Let <var>stream</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new①②\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportbidirectionalstream\" id=\"ref-for-webtransportbidirectionalstream⑨\">WebTransportBidirectionalStream</a></code>, with:</p>\n      <dl>\n       <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportbidirectionalstream-readable-slot\" id=\"ref-for-dom-webtransportbidirectionalstream-readable-slot①\">[[Readable]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>readable</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportbidirectionalstream-writable-slot\" id=\"ref-for-dom-webtransportbidirectionalstream-writable-slot①\">[[Writable]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>writable</var></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportbidirectionalstream-transport-slot\" id=\"ref-for-dom-webtransportbidirectionalstream-transport-slot\">[[Transport]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>transport</var></p>\n      </dd></dl>"
        },
        {
          "html": "<p>Return <var>stream</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportWriter/atomicWrite(chunk)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportwriter-atomicwrite",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportwriter-atomicwrite\" id=\"ref-for-dom-webtransportwriter-atomicwrite⑤\">atomicWrite</a></code> is called, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>p</var> be the result of <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://streams.spec.whatwg.org/#default-writer-write\" id=\"ref-for-default-writer-write①\">write(chunk)</a></code>\n   on <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://streams.spec.whatwg.org/#writablestreamdefaultwriter\" id=\"ref-for-writablestreamdefaultwriter③\">WritableStreamDefaultWriter</a></code> with <var>chunk</var>.</p>"
        },
        {
          "html": "<p><a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#set-append\" id=\"ref-for-set-append②\">Append</a> <var>p</var> to <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot⑤\">[[AtomicWriteRequests]]</a></code>.</p>"
        },
        {
          "html": "Return the result of <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#dfn-perform-steps-once-promise-is-settled\" id=\"ref-for-dfn-perform-steps-once-promise-is-settled\">reacting</a> to <var>p</var> with the following steps:",
          "rationale": "if",
          "steps": [
            {
              "html": "<p>If <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-atomicwriterequests-slot\" id=\"ref-for-dom-webtransportsendstream-atomicwriterequests-slot⑥\">[[AtomicWriteRequests]]</a></code> <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-contain\" id=\"ref-for-list-contain③\">contains</a> <var>p</var>,\n <a data-link-type=\"dfn\" href=\"https://infra.spec.whatwg.org/#list-remove\" id=\"ref-for-list-remove⑧\">remove</a> <var>p</var>.</p>"
            },
            {
              "html": "<p>If <var>p</var> was rejected with reason <var>r</var>, then return <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#a-promise-rejected-with\" id=\"ref-for-a-promise-rejected-with⑦\">a promise rejected with</a> <var>r</var>.</p>"
            },
            {
              "html": "<p>Return undefined.</p>"
            }
          ]
        }
      ]
    },
    {
      "name": "WebTransportWriter/commit()",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransportwriter-commit",
      "html": "When <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportwriter-commit\" id=\"ref-for-dom-webtransportwriter-commit②\">commit</a></code> is called for <var>stream</var>, the user agent MUST run the following steps:",
      "rationale": "let",
      "steps": [
        {
          "html": "<p>Let <var>transport</var> be <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-transport-slot\" id=\"ref-for-dom-webtransportsendstream-transport-slot⑥\">[[Transport]]</a></code>.</p>"
        },
        {
          "html": "<p>Set <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-committedoffset-slot\" id=\"ref-for-dom-webtransportsendstream-committedoffset-slot③\">[[CommittedOffset]]</a></code>\n  to the value of <var>stream</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransportsendstream-byteswritten-slot\" id=\"ref-for-dom-webtransportsendstream-byteswritten-slot③\">[[BytesWritten]]</a></code>.</p>"
        }
      ]
    },
    {
      "name": "create a writer",
      "href": "https://www.w3.org/TR/webtransport/#webtransportwriter-create",
      "html": "To <dfn class=\"dfn-paneled has-dfn-panel\" data-dfn-for=\"WebTransportWriter\" data-dfn-type=\"dfn\" data-export=\"\" data-lt=\"create|creating\" id=\"webtransportwriter-create\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\">create</dfn> a\n<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportwriter\" id=\"ref-for-webtransportwriter④\">WebTransportWriter</a></code>, with a <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportsendstream\" id=\"ref-for-webtransportsendstream③③\">WebTransportSendStream</a></code> <var>stream</var>, run these\nsteps:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Let <var>writer</var> be a <a data-link-type=\"dfn\" href=\"https://webidl.spec.whatwg.org/#new\" id=\"ref-for-new①③\">new</a> <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransportwriter\" id=\"ref-for-webtransportwriter⑤\">WebTransportWriter</a></code>.</p>"
        },
        {
          "html": "<p>Run the <a href=\"https://streams.spec.whatwg.org/#default-writer-constructor\">new WritableStreamDefaultWriter(stream)</a>\n constructor steps passing <var>writer</var> as this, and <var>stream</var> as the constructor argument.</p>"
        },
        {
          "html": "<p>Return <var>writer</var>.</p>"
        }
      ]
    },
    {
      "name": "WebTransportError/WebTransportError(message, options)",
      "href": "https://www.w3.org/TR/webtransport/#dom-webtransporterror-webtransporterror",
      "html": "The <dfn class=\"dfn-paneled idl-code has-dfn-panel\" data-dfn-for=\"WebTransportError\" data-dfn-type=\"constructor\" data-export=\"\" data-lt=\"WebTransportError(message, options)|constructor(message, options)|WebTransportError(message)|constructor(message)|WebTransportError()|constructor()\" id=\"dom-webtransporterror-webtransporterror\" role=\"button\" aria-expanded=\"false\" tabindex=\"0\"><code>new WebTransportError(<var>message</var>, <var>options</var>)</code></dfn>\nconstructor steps are:",
      "rationale": ".algorithm",
      "steps": [
        {
          "html": "<p>Set <var>this</var>’s <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#domexception-name\" id=\"ref-for-domexception-name\">name</a> to <code>\"WebTransportError\"</code>.</p>"
        },
        {
          "html": "<p>Set <var>this</var>’s <a data-link-type=\"dfn\" href=\"https://heycam.github.io/webidl/#domexception-message\" id=\"ref-for-domexception-message\">message</a> to <var>message</var>.</p>"
        },
        {
          "html": "<p>Set <var>this</var>’s internal slots as follows:</p>\n      <dl>\n       <dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-source-slot\" id=\"ref-for-dom-webtransporterror-source-slot\">[[Source]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>options</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-source\" id=\"ref-for-dom-webtransporterroroptions-source①⓪\">source</a></code></p>\n       </dd><dt data-md=\"\"><code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot④\">[[StreamErrorCode]]</a></code>\n       </dt><dd data-md=\"\">\n        <p><var>options</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterroroptions-streamerrorcode\" id=\"ref-for-dom-webtransporterroroptions-streamerrorcode②\">streamErrorCode</a></code></p>\n      </dd></dl>"
        }
      ]
    },
    {
      "html": "<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#webtransporterror\" id=\"ref-for-webtransporterror①④\">WebTransportError</a></code> objects are <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#serializable-objects\" id=\"ref-for-serializable-objects\">serializable objects</a>.\nTheir <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#serialization-steps\" id=\"ref-for-serialization-steps\">serialization steps</a>, given <var>value</var> and <var>serialized</var>, are:",
      "rationale": "run",
      "steps": [
        {
          "html": "<p>Run the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException②\">DOMException</a></code> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#serialization-steps\" id=\"ref-for-serialization-steps①\">serialization steps</a> given <var>value</var> and <var>serialized</var>.</p>"
        },
        {
          "html": "<p>Set <var>serialized</var>.<code>[[Source]]</code> to <var>value</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-source-slot\" id=\"ref-for-dom-webtransporterror-source-slot②\">[[Source]]</a></code>.</p>"
        },
        {
          "html": "<p>Set <var>serialized</var>.<code>[[StreamErrorCode]]</code> to <var>value</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot⑥\">[[StreamErrorCode]]</a></code>.</p>"
        }
      ]
    },
    {
      "html": "Their <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#deserialization-steps\" id=\"ref-for-deserialization-steps\">deserialization steps</a>, given <var>serialized</var> and <var>value</var>, are:",
      "rationale": "run",
      "steps": [
        {
          "html": "<p>Run the <code class=\"idl\"><a data-link-type=\"idl\" href=\"https://webidl.spec.whatwg.org/#idl-DOMException\" id=\"ref-for-idl-DOMException③\">DOMException</a></code> <a data-link-type=\"dfn\" href=\"https://html.spec.whatwg.org/multipage/structured-data.html#deserialization-steps\" id=\"ref-for-deserialization-steps①\">deserialization steps</a> given <var>serialized</var> and <var>value</var>.</p>"
        },
        {
          "html": "<p>Set <var>value</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-source-slot\" id=\"ref-for-dom-webtransporterror-source-slot③\">[[Source]]</a></code> to <var>serialized</var>.<code>[[Source]]</code>.</p>"
        },
        {
          "html": "<p>Set <var>value</var>.<code class=\"idl\"><a data-link-type=\"idl\" href=\"https://www.w3.org/TR/webtransport/#dom-webtransporterror-streamerrorcode-slot\" id=\"ref-for-dom-webtransporterror-streamerrorcode-slot⑦\">[[StreamErrorCode]]</a></code> <var>serialized</var>.<code>[[StreamErrorCode]]</code>.</p>"
        }
      ]
    }
  ]
}